var bc=Object.defineProperty;var na=t=>{throw TypeError(t)};var yc=(t,e,r)=>e in t?bc(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var I=(t,e,r)=>yc(t,typeof e!="symbol"?e+"":e,r),sa=(t,e,r)=>e.has(t)||na("Cannot "+r);var ne=(t,e,r)=>(sa(t,e,"read from private field"),r?r.call(t):e.get(t)),lt=(t,e,r)=>e.has(t)?na("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),Qe=(t,e,r,n)=>(sa(t,e,"write to private field"),n?n.call(t,r):e.set(t,r),r);import{j as a,n as P,X as It,M as xc,L as aa,a as wc,U as ii,P as Mt,C as js,S as Sn,b as On,c as _c,d as jc,e as Nc,T as oi,f as ci,A as Sc,g as Oc,h as jt,F as Cc,R as Ns,i as Ss,B as Pc,k as kc,l as br,m as Vr,o as zr,p as Ac,q as li,r as Ec,s as di,t as Os,u as ui,H as Mc,v as Cs,w as Tc,x as Ic,y as Rc,z as Dc,D as Lc,E as Fc,G as is,I as $c,J as Bc,K as Uc}from"./ui-CkivApEX.js";import{a as hi,c as ia,r as w,N as fi,O as mi,b as oa,R as dn,u as Vc,d as zc,H as Wc,e as qc,f as Je}from"./vendor-CFExb5Qq.js";import{i as Gc,g as Hc,s as Yc,a as Kc,b as Xc,o as Qc,r as z,c as _e,q as ur,d as hr,e as fr,p as Nt,u as it,f as yr,h as Ve,j as xr}from"./firebase-DRNzPt5Q.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();var gi,ca=hi;gi=ca.createRoot,ca.hydrateRoot;/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var la;(function(t){(function(e){var r=typeof globalThis=="object"?globalThis:typeof ia=="object"?ia:typeof self=="object"?self:typeof this=="object"?this:c(),n=s(t);typeof r.Reflect<"u"&&(n=s(r.Reflect,n)),e(n,r),typeof r.Reflect>"u"&&(r.Reflect=t);function s(l,d){return function(u,h){Object.defineProperty(l,u,{configurable:!0,writable:!0,value:h}),d&&d(u,h)}}function i(){try{return Function("return this;")()}catch{}}function o(){try{return(0,eval)("(function() { return this; })()")}catch{}}function c(){return i()||o()}})(function(e,r){var n=Object.prototype.hasOwnProperty,s=typeof Symbol=="function",i=s&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",o=s&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",c=typeof Object.create=="function",l={__proto__:[]}instanceof Array,d=!c&&!l,u={create:c?function(){return Wn(Object.create(null))}:l?function(){return Wn({__proto__:null})}:function(){return Wn({})},has:d?function(v,_){return n.call(v,_)}:function(v,_){return _ in v},get:d?function(v,_){return n.call(v,_)?v[_]:void 0}:function(v,_){return v[_]}},h=Object.getPrototypeOf(Function),f=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:fc(),g=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:mc(),b=typeof WeakMap=="function"?WeakMap:gc(),p=s?Symbol.for("@reflect-metadata:registry"):void 0,y=dc(),x=uc(y);function m(v,_,j,O){if(L(j)){if(!Ks(v))throw new TypeError;if(!Xs(_))throw new TypeError;return V(v,_)}else{if(!Ks(v))throw new TypeError;if(!de(_))throw new TypeError;if(!de(O)&&!L(O)&&!Le(O))throw new TypeError;return Le(O)&&(O=void 0),j=Xe(j),ot(v,_,j,O)}}e("decorate",m);function N(v,_){function j(O,$){if(!de(O))throw new TypeError;if(!L($)&&!cc($))throw new TypeError;St(v,_,O,$)}return j}e("metadata",N);function S(v,_,j,O){if(!de(j))throw new TypeError;return L(O)||(O=Xe(O)),St(v,_,j,O)}e("defineMetadata",S);function A(v,_,j){if(!de(_))throw new TypeError;return L(j)||(j=Xe(j)),De(v,_,j)}e("hasMetadata",A);function B(v,_,j){if(!de(_))throw new TypeError;return L(j)||(j=Xe(j)),He(v,_,j)}e("hasOwnMetadata",B);function q(v,_,j){if(!de(_))throw new TypeError;return L(j)||(j=Xe(j)),Ye(v,_,j)}e("getMetadata",q);function le(v,_,j){if(!de(_))throw new TypeError;return L(j)||(j=Xe(j)),ct(v,_,j)}e("getOwnMetadata",le);function ge(v,_){if(!de(v))throw new TypeError;return L(_)||(_=Xe(_)),Ke(v,_)}e("getMetadataKeys",ge);function F(v,_){if(!de(v))throw new TypeError;return L(_)||(_=Xe(_)),Z(v,_)}e("getOwnMetadataKeys",F);function H(v,_,j){if(!de(_))throw new TypeError;if(L(j)||(j=Xe(j)),!de(_))throw new TypeError;L(j)||(j=Xe(j));var O=Nr(_,j,!1);return L(O)?!1:O.OrdinaryDeleteMetadata(v,_,j)}e("deleteMetadata",H);function V(v,_){for(var j=v.length-1;j>=0;--j){var O=v[j],$=O(_);if(!L($)&&!Le($)){if(!Xs($))throw new TypeError;_=$}}return _}function ot(v,_,j,O){for(var $=v.length-1;$>=0;--$){var pe=v[$],fe=pe(_,j,O);if(!L(fe)&&!Le(fe)){if(!de(fe))throw new TypeError;O=fe}}return O}function De(v,_,j){var O=He(v,_,j);if(O)return!0;var $=zn(_);return Le($)?!1:De(v,$,j)}function He(v,_,j){var O=Nr(_,j,!1);return L(O)?!1:Ys(O.OrdinaryHasOwnMetadata(v,_,j))}function Ye(v,_,j){var O=He(v,_,j);if(O)return ct(v,_,j);var $=zn(_);if(!Le($))return Ye(v,$,j)}function ct(v,_,j){var O=Nr(_,j,!1);if(!L(O))return O.OrdinaryGetOwnMetadata(v,_,j)}function St(v,_,j,O){var $=Nr(j,O,!0);$.OrdinaryDefineOwnMetadata(v,_,j,O)}function Ke(v,_){var j=Z(v,_),O=zn(v);if(O===null)return j;var $=Ke(O,_);if($.length<=0)return j;if(j.length<=0)return $;for(var pe=new g,fe=[],Y=0,k=j;Y<k.length;Y++){var E=k[Y],M=pe.has(E);M||(pe.add(E),fe.push(E))}for(var R=0,K=$;R<K.length;R++){var E=K[R],M=pe.has(E);M||(pe.add(E),fe.push(E))}return fe}function Z(v,_){var j=Nr(v,_,!1);return j?j.OrdinaryOwnMetadataKeys(v,_):[]}function re(v){if(v===null)return 1;switch(typeof v){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return v===null?1:6;default:return 6}}function L(v){return v===void 0}function Le(v){return v===null}function Un(v){return typeof v=="symbol"}function de(v){return typeof v=="object"?v!==null:typeof v=="function"}function er(v,_){switch(re(v)){case 0:return v;case 1:return v;case 2:return v;case 3:return v;case 4:return v;case 5:return v}var j="string",O=Qs(v,i);if(O!==void 0){var $=O.call(v,j);if(de($))throw new TypeError;return $}return $t(v)}function $t(v,_){var j,O;{var $=v.toString;if(Jr($)){var O=$.call(v);if(!de(O))return O}var j=v.valueOf;if(Jr(j)){var O=j.call(v);if(!de(O))return O}}throw new TypeError}function Ys(v){return!!v}function oc(v){return""+v}function Xe(v){var _=er(v);return Un(_)?_:oc(_)}function Ks(v){return Array.isArray?Array.isArray(v):v instanceof Object?v instanceof Array:Object.prototype.toString.call(v)==="[object Array]"}function Jr(v){return typeof v=="function"}function Xs(v){return typeof v=="function"}function cc(v){switch(re(v)){case 3:return!0;case 4:return!0;default:return!1}}function Vn(v,_){return v===_||v!==v&&_!==_}function Qs(v,_){var j=v[_];if(j!=null){if(!Jr(j))throw new TypeError;return j}}function Js(v){var _=Qs(v,o);if(!Jr(_))throw new TypeError;var j=_.call(v);if(!de(j))throw new TypeError;return j}function Zs(v){return v.value}function ea(v){var _=v.next();return _.done?!1:_}function ta(v){var _=v.return;_&&_.call(v)}function zn(v){var _=Object.getPrototypeOf(v);if(typeof v!="function"||v===h||_!==h)return _;var j=v.prototype,O=j&&Object.getPrototypeOf(j);if(O==null||O===Object.prototype)return _;var $=O.constructor;return typeof $!="function"||$===v?_:$}function lc(){var v;!L(p)&&typeof r.Reflect<"u"&&!(p in r.Reflect)&&typeof r.Reflect.defineMetadata=="function"&&(v=hc(r.Reflect));var _,j,O,$=new b,pe={registerProvider:fe,getProvider:k,setProvider:M};return pe;function fe(R){if(!Object.isExtensible(pe))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case v===R:break;case L(_):_=R;break;case _===R:break;case L(j):j=R;break;case j===R:break;default:O===void 0&&(O=new g),O.add(R);break}}function Y(R,K){if(!L(_)){if(_.isProviderFor(R,K))return _;if(!L(j)){if(j.isProviderFor(R,K))return _;if(!L(O))for(var ie=Js(O);;){var ue=ea(ie);if(!ue)return;var Fe=Zs(ue);if(Fe.isProviderFor(R,K))return ta(ie),Fe}}}if(!L(v)&&v.isProviderFor(R,K))return v}function k(R,K){var ie=$.get(R),ue;return L(ie)||(ue=ie.get(K)),L(ue)&&(ue=Y(R,K),L(ue)||(L(ie)&&(ie=new f,$.set(R,ie)),ie.set(K,ue))),ue}function E(R){if(L(R))throw new TypeError;return _===R||j===R||!L(O)&&O.has(R)}function M(R,K,ie){if(!E(ie))throw new Error("Metadata provider not registered.");var ue=k(R,K);if(ue!==ie){if(!L(ue))return!1;var Fe=$.get(R);L(Fe)&&(Fe=new f,$.set(R,Fe)),Fe.set(K,ie)}return!0}}function dc(){var v;return!L(p)&&de(r.Reflect)&&Object.isExtensible(r.Reflect)&&(v=r.Reflect[p]),L(v)&&(v=lc()),!L(p)&&de(r.Reflect)&&Object.isExtensible(r.Reflect)&&Object.defineProperty(r.Reflect,p,{enumerable:!1,configurable:!1,writable:!1,value:v}),v}function uc(v){var _=new b,j={isProviderFor:function(E,M){var R=_.get(E);return L(R)?!1:R.has(M)},OrdinaryDefineOwnMetadata:fe,OrdinaryHasOwnMetadata:$,OrdinaryGetOwnMetadata:pe,OrdinaryOwnMetadataKeys:Y,OrdinaryDeleteMetadata:k};return y.registerProvider(j),j;function O(E,M,R){var K=_.get(E),ie=!1;if(L(K)){if(!R)return;K=new f,_.set(E,K),ie=!0}var ue=K.get(M);if(L(ue)){if(!R)return;if(ue=new f,K.set(M,ue),!v.setProvider(E,M,j))throw K.delete(M),ie&&_.delete(E),new Error("Wrong provider for target.")}return ue}function $(E,M,R){var K=O(M,R,!1);return L(K)?!1:Ys(K.has(E))}function pe(E,M,R){var K=O(M,R,!1);if(!L(K))return K.get(E)}function fe(E,M,R,K){var ie=O(R,K,!0);ie.set(E,M)}function Y(E,M){var R=[],K=O(E,M,!1);if(L(K))return R;for(var ie=K.keys(),ue=Js(ie),Fe=0;;){var ra=ea(ue);if(!ra)return R.length=Fe,R;var pc=Zs(ra);try{R[Fe]=pc}catch(vc){try{ta(ue)}finally{throw vc}}Fe++}}function k(E,M,R){var K=O(M,R,!1);if(L(K)||!K.delete(E))return!1;if(K.size===0){var ie=_.get(M);L(ie)||(ie.delete(R),ie.size===0&&_.delete(ie))}return!0}}function hc(v){var _=v.defineMetadata,j=v.hasOwnMetadata,O=v.getOwnMetadata,$=v.getOwnMetadataKeys,pe=v.deleteMetadata,fe=new b,Y={isProviderFor:function(k,E){var M=fe.get(k);return!L(M)&&M.has(E)?!0:$(k,E).length?(L(M)&&(M=new g,fe.set(k,M)),M.add(E),!0):!1},OrdinaryDefineOwnMetadata:_,OrdinaryHasOwnMetadata:j,OrdinaryGetOwnMetadata:O,OrdinaryOwnMetadataKeys:$,OrdinaryDeleteMetadata:pe};return Y}function Nr(v,_,j){var O=y.getProvider(v,_);if(!L(O))return O;if(j){if(y.setProvider(v,_,x))return x;throw new Error("Illegal state.")}}function fc(){var v={},_=[],j=function(){function Y(k,E,M){this._index=0,this._keys=k,this._values=E,this._selector=M}return Y.prototype["@@iterator"]=function(){return this},Y.prototype[o]=function(){return this},Y.prototype.next=function(){var k=this._index;if(k>=0&&k<this._keys.length){var E=this._selector(this._keys[k],this._values[k]);return k+1>=this._keys.length?(this._index=-1,this._keys=_,this._values=_):this._index++,{value:E,done:!1}}return{value:void 0,done:!0}},Y.prototype.throw=function(k){throw this._index>=0&&(this._index=-1,this._keys=_,this._values=_),k},Y.prototype.return=function(k){return this._index>=0&&(this._index=-1,this._keys=_,this._values=_),{value:k,done:!0}},Y}(),O=function(){function Y(){this._keys=[],this._values=[],this._cacheKey=v,this._cacheIndex=-2}return Object.defineProperty(Y.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),Y.prototype.has=function(k){return this._find(k,!1)>=0},Y.prototype.get=function(k){var E=this._find(k,!1);return E>=0?this._values[E]:void 0},Y.prototype.set=function(k,E){var M=this._find(k,!0);return this._values[M]=E,this},Y.prototype.delete=function(k){var E=this._find(k,!1);if(E>=0){for(var M=this._keys.length,R=E+1;R<M;R++)this._keys[R-1]=this._keys[R],this._values[R-1]=this._values[R];return this._keys.length--,this._values.length--,Vn(k,this._cacheKey)&&(this._cacheKey=v,this._cacheIndex=-2),!0}return!1},Y.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=v,this._cacheIndex=-2},Y.prototype.keys=function(){return new j(this._keys,this._values,$)},Y.prototype.values=function(){return new j(this._keys,this._values,pe)},Y.prototype.entries=function(){return new j(this._keys,this._values,fe)},Y.prototype["@@iterator"]=function(){return this.entries()},Y.prototype[o]=function(){return this.entries()},Y.prototype._find=function(k,E){if(!Vn(this._cacheKey,k)){this._cacheIndex=-1;for(var M=0;M<this._keys.length;M++)if(Vn(this._keys[M],k)){this._cacheIndex=M;break}}return this._cacheIndex<0&&E&&(this._cacheIndex=this._keys.length,this._keys.push(k),this._values.push(void 0)),this._cacheIndex},Y}();return O;function $(Y,k){return Y}function pe(Y,k){return k}function fe(Y,k){return[Y,k]}}function mc(){var v=function(){function _(){this._map=new f}return Object.defineProperty(_.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),_.prototype.has=function(j){return this._map.has(j)},_.prototype.add=function(j){return this._map.set(j,j),this},_.prototype.delete=function(j){return this._map.delete(j)},_.prototype.clear=function(){this._map.clear()},_.prototype.keys=function(){return this._map.keys()},_.prototype.values=function(){return this._map.keys()},_.prototype.entries=function(){return this._map.entries()},_.prototype["@@iterator"]=function(){return this.keys()},_.prototype[o]=function(){return this.keys()},_}();return v}function gc(){var v=16,_=u.create(),j=O();return function(){function k(){this._key=O()}return k.prototype.has=function(E){var M=$(E,!1);return M!==void 0?u.has(M,this._key):!1},k.prototype.get=function(E){var M=$(E,!1);return M!==void 0?u.get(M,this._key):void 0},k.prototype.set=function(E,M){var R=$(E,!0);return R[this._key]=M,this},k.prototype.delete=function(E){var M=$(E,!1);return M!==void 0?delete M[this._key]:!1},k.prototype.clear=function(){this._key=O()},k}();function O(){var k;do k="@@WeakMap@@"+Y();while(u.has(_,k));return _[k]=!0,k}function $(k,E){if(!n.call(k,j)){if(!E)return;Object.defineProperty(k,j,{value:u.create()})}return k[j]}function pe(k,E){for(var M=0;M<E;++M)k[M]=Math.random()*255|0;return k}function fe(k){if(typeof Uint8Array=="function"){var E=new Uint8Array(k);return typeof crypto<"u"?crypto.getRandomValues(E):typeof msCrypto<"u"?msCrypto.getRandomValues(E):pe(E,k),E}return pe(new Array(k),k)}function Y(){var k=fe(v);k[6]=k[6]&79|64,k[8]=k[8]&191|128;for(var E="",M=0;M<v;++M){var R=k[M];(M===4||M===6||M===8)&&(E+="-"),R<16&&(E+="0"),E+=R.toString(16).toLowerCase()}return E}}function Wn(v){return v.__=void 0,delete v.__,v}})})(la||(la={}));const Jc=["VITE_FIREBASE_API_KEY","VITE_FIREBASE_AUTH_DOMAIN","VITE_FIREBASE_DATABASE_URL","VITE_FIREBASE_PROJECT_ID","VITE_FIREBASE_STORAGE_BUCKET","VITE_FIREBASE_MESSAGING_SENDER_ID","VITE_FIREBASE_APP_ID"],Zc={apiKey:"AIzaSyCswObxYzO5gjurKWnAI387lzoEXJjn24k",authDomain:"nrd-ordenes.firebaseapp.com",databaseURL:"https://nrd-ordenes-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"nrd-ordenes",storageBucket:"nrd-ordenes.firebasestorage.app",messagingSenderId:"158356819364",appId:"1:158356819364:web:c9a87a35706babd4608531"},el={BASE_URL:"/ordenes/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_FIREBASE_API_KEY:"AIzaSyBopcfbHLrWQZOsgitRYWk5h26ipYbD-hE",VITE_FIREBASE_APP_ID:"1:766340976237:web:e7123eedb37568a2f9b964",VITE_FIREBASE_AUTH_DOMAIN:"nrd-ordenes-prod.firebaseapp.com",VITE_FIREBASE_DATABASE_URL:"https://nrd-ordenes-prod-default-rtdb.firebaseio.com",VITE_FIREBASE_MESSAGING_SENDER_ID:"766340976237",VITE_FIREBASE_PROJECT_ID:"nrd-ordenes-prod",VITE_FIREBASE_STORAGE_BUCKET:"nrd-ordenes-prod.firebasestorage.app"};function tl(){const t=Jc.filter(r=>!el[r]);return t.length>0?{isValid:!1,missingVars:t,config:null}:{isValid:!0,missingVars:[],config:{apiKey:"AIzaSyBopcfbHLrWQZOsgitRYWk5h26ipYbD-hE",authDomain:"nrd-ordenes-prod.firebaseapp.com",databaseURL:"https://nrd-ordenes-prod-default-rtdb.firebaseio.com",projectId:"nrd-ordenes-prod",storageBucket:"nrd-ordenes-prod.firebasestorage.app",messagingSenderId:"766340976237",appId:"1:766340976237:web:e7123eedb37568a2f9b964"}}}function rl(){return{...Zc}}const Tr=tl(),nl=Tr.isValid?Tr.config:rl(),pi=Gc(nl);Tr.isValid?console.info("Firebase initialized in production mode"):console.warn("Firebase initialized in demo mode. The following environment variables are missing:",Tr.missingVars);const Zr=!Tr.isValid,me=Hc(pi);async function sl(t,e){try{return(await Yc(me,t,e)).user}catch(r){throw console.error("Authentication error:",r),new Error("Error de autenticación: credenciales inválidas")}}async function al(){try{await Kc(me)}catch(t){throw console.error("Sign out error:",t),new Error("Error al cerrar sesión")}}const W=Xc(pi),vi=w.createContext(void 0);function il({children:t}){const[e,r]=w.useState(null),[n,s]=w.useState(!0),[i,o]=w.useState(null);w.useEffect(()=>{try{return Qc(me,u=>{r(u),s(!1)})}catch(d){console.error("Auth initialization error:",d),o(d instanceof Error?d:new Error("Error de autenticación")),s(!1)}},[]);const c=async(d,u)=>{if(Zr){P.error("Autenticación no disponible en modo demo");return}try{await sl(d,u),P.success("¡Bienvenido!")}catch(h){throw console.error("Sign in error:",h),P.error("Credenciales inválidas"),h}},l=async()=>{if(Zr){P.error("Cierre de sesión no disponible en modo demo");return}try{await al(),P.success("Sesión cerrada")}catch(d){throw console.error("Sign out error:",d),P.error("Error al cerrar sesión"),d}};return i?a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 p-4",children:a.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg max-w-md w-full",children:[a.jsx("h2",{className:"text-xl font-bold text-red-600 mb-4",children:"Error de Inicialización"}),a.jsx("p",{className:"text-gray-600",children:"No se pudo inicializar la aplicación. Por favor, verifique la configuración e intente nuevamente."}),Zr&&a.jsx("p",{className:"mt-4 text-sm text-amber-600",children:"Ejecutando en modo demo. Algunas funciones estarán limitadas."})]})}):a.jsx(vi.Provider,{value:{user:e,loading:n,signIn:c,signOut:l,isDemoMode:Zr},children:!n&&t})}function Ps(){const t=w.useContext(vi);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}function ol(){const{user:t}=Ps();return t?a.jsx(mi,{}):a.jsx(fi,{to:"/login",replace:!0})}function Ne(t){const e=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&e==="[object Date]"?new t.constructor(+t):typeof t=="number"||e==="[object Number]"||typeof t=="string"||e==="[object String]"?new Date(t):new Date(NaN)}function zt(t,e){return t instanceof Date?new t.constructor(e):new Date(e)}const bi=6048e5,cl=864e5;let ll={};function Wr(){return ll}function mr(t,e){var c,l,d,u;const r=Wr(),n=(e==null?void 0:e.weekStartsOn)??((l=(c=e==null?void 0:e.locale)==null?void 0:c.options)==null?void 0:l.weekStartsOn)??r.weekStartsOn??((u=(d=r.locale)==null?void 0:d.options)==null?void 0:u.weekStartsOn)??0,s=Ne(t),i=s.getDay(),o=(i<n?7:0)+i-n;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function un(t){return mr(t,{weekStartsOn:1})}function yi(t){const e=Ne(t),r=e.getFullYear(),n=zt(t,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const s=un(n),i=zt(t,0);i.setFullYear(r,0,4),i.setHours(0,0,0,0);const o=un(i);return e.getTime()>=s.getTime()?r+1:e.getTime()>=o.getTime()?r:r-1}function os(t){const e=Ne(t);return e.setHours(0,0,0,0),e}function da(t){const e=Ne(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return r.setUTCFullYear(e.getFullYear()),+t-+r}function dl(t,e){const r=os(t),n=os(e),s=+r-da(r),i=+n-da(n);return Math.round((s-i)/cl)}function ul(t){const e=yi(t),r=zt(t,0);return r.setFullYear(e,0,4),r.setHours(0,0,0,0),un(r)}function hl(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function fl(t){if(!hl(t)&&typeof t!="number")return!1;const e=Ne(t);return!isNaN(Number(e))}function ml(t){const e=Ne(t);return e.setHours(23,59,59,999),e}function gl(t){const e=Ne(t),r=e.getMonth();return e.setFullYear(e.getFullYear(),r+1,0),e.setHours(23,59,59,999),e}function pl(t){const e=Ne(t);return e.setDate(1),e.setHours(0,0,0,0),e}function vl(t){const e=Ne(t),r=zt(t,0);return r.setFullYear(e.getFullYear(),0,1),r.setHours(0,0,0,0),r}function bl(t,e){var c,l;const r=Wr(),n=r.weekStartsOn??((l=(c=r.locale)==null?void 0:c.options)==null?void 0:l.weekStartsOn)??0,s=Ne(t),i=s.getDay(),o=(i<n?-7:0)+6-(i-n);return s.setDate(s.getDate()+o),s.setHours(23,59,59,999),s}const yl={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},xl=(t,e,r)=>{let n;const s=yl[t];return typeof s=="string"?n=s:e===1?n=s.one:n=s.other.replace("{{count}}",e.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function lr(t){return(e={})=>{const r=e.width?String(e.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const wl={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},_l={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},jl={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Nl={date:lr({formats:wl,defaultWidth:"full"}),time:lr({formats:_l,defaultWidth:"full"}),dateTime:lr({formats:jl,defaultWidth:"full"})},Sl={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Ol=(t,e,r,n)=>Sl[t];function Ze(t){return(e,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let s;if(n==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,c=r!=null&&r.width?String(r.width):o;s=t.formattingValues[c]||t.formattingValues[o]}else{const o=t.defaultWidth,c=r!=null&&r.width?String(r.width):t.defaultWidth;s=t.values[c]||t.values[o]}const i=t.argumentCallback?t.argumentCallback(e):e;return s[i]}}const Cl={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Pl={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},kl={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Al={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},El={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Ml={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Tl=(t,e)=>{const r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},Il={ordinalNumber:Tl,era:Ze({values:Cl,defaultWidth:"wide"}),quarter:Ze({values:Pl,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Ze({values:kl,defaultWidth:"wide"}),day:Ze({values:Al,defaultWidth:"wide"}),dayPeriod:Ze({values:El,defaultWidth:"wide",formattingValues:Ml,defaultFormattingWidth:"wide"})};function et(t){return(e,r={})=>{const n=r.width,s=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],i=e.match(s);if(!i)return null;const o=i[0],c=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],l=Array.isArray(c)?Dl(c,h=>h.test(o)):Rl(c,h=>h.test(o));let d;d=t.valueCallback?t.valueCallback(l):l,d=r.valueCallback?r.valueCallback(d):d;const u=e.slice(o.length);return{value:d,rest:u}}}function Rl(t,e){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return r}function Dl(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return r}function xi(t){return(e,r={})=>{const n=e.match(t.matchPattern);if(!n)return null;const s=n[0],i=e.match(t.parsePattern);if(!i)return null;let o=t.valueCallback?t.valueCallback(i[0]):i[0];o=r.valueCallback?r.valueCallback(o):o;const c=e.slice(s.length);return{value:o,rest:c}}}const Ll=/^(\d+)(th|st|nd|rd)?/i,Fl=/\d+/i,$l={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Bl={any:[/^b/i,/^(a|c)/i]},Ul={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Vl={any:[/1/i,/2/i,/3/i,/4/i]},zl={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Wl={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},ql={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Gl={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Hl={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Yl={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Kl={ordinalNumber:xi({matchPattern:Ll,parsePattern:Fl,valueCallback:t=>parseInt(t,10)}),era:et({matchPatterns:$l,defaultMatchWidth:"wide",parsePatterns:Bl,defaultParseWidth:"any"}),quarter:et({matchPatterns:Ul,defaultMatchWidth:"wide",parsePatterns:Vl,defaultParseWidth:"any",valueCallback:t=>t+1}),month:et({matchPatterns:zl,defaultMatchWidth:"wide",parsePatterns:Wl,defaultParseWidth:"any"}),day:et({matchPatterns:ql,defaultMatchWidth:"wide",parsePatterns:Gl,defaultParseWidth:"any"}),dayPeriod:et({matchPatterns:Hl,defaultMatchWidth:"any",parsePatterns:Yl,defaultParseWidth:"any"})},Xl={code:"en-US",formatDistance:xl,formatLong:Nl,formatRelative:Ol,localize:Il,match:Kl,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Ql(t){const e=Ne(t);return dl(e,vl(e))+1}function Jl(t){const e=Ne(t),r=+un(e)-+ul(e);return Math.round(r/bi)+1}function wi(t,e){var u,h,f,g;const r=Ne(t),n=r.getFullYear(),s=Wr(),i=(e==null?void 0:e.firstWeekContainsDate)??((h=(u=e==null?void 0:e.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??s.firstWeekContainsDate??((g=(f=s.locale)==null?void 0:f.options)==null?void 0:g.firstWeekContainsDate)??1,o=zt(t,0);o.setFullYear(n+1,0,i),o.setHours(0,0,0,0);const c=mr(o,e),l=zt(t,0);l.setFullYear(n,0,i),l.setHours(0,0,0,0);const d=mr(l,e);return r.getTime()>=c.getTime()?n+1:r.getTime()>=d.getTime()?n:n-1}function Zl(t,e){var c,l,d,u;const r=Wr(),n=(e==null?void 0:e.firstWeekContainsDate)??((l=(c=e==null?void 0:e.locale)==null?void 0:c.options)==null?void 0:l.firstWeekContainsDate)??r.firstWeekContainsDate??((u=(d=r.locale)==null?void 0:d.options)==null?void 0:u.firstWeekContainsDate)??1,s=wi(t,e),i=zt(t,0);return i.setFullYear(s,0,n),i.setHours(0,0,0,0),mr(i,e)}function ed(t,e){const r=Ne(t),n=+mr(r,e)-+Zl(r,e);return Math.round(n/bi)+1}function te(t,e){const r=t<0?"-":"",n=Math.abs(t).toString().padStart(e,"0");return r+n}const Ot={y(t,e){const r=t.getFullYear(),n=r>0?r:1-r;return te(e==="yy"?n%100:n,e.length)},M(t,e){const r=t.getMonth();return e==="M"?String(r+1):te(r+1,2)},d(t,e){return te(t.getDate(),e.length)},a(t,e){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(t,e){return te(t.getHours()%12||12,e.length)},H(t,e){return te(t.getHours(),e.length)},m(t,e){return te(t.getMinutes(),e.length)},s(t,e){return te(t.getSeconds(),e.length)},S(t,e){const r=e.length,n=t.getMilliseconds(),s=Math.trunc(n*Math.pow(10,r-3));return te(s,e.length)}},tr={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},ua={G:function(t,e,r){const n=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(t,e,r){if(e==="yo"){const n=t.getFullYear(),s=n>0?n:1-n;return r.ordinalNumber(s,{unit:"year"})}return Ot.y(t,e)},Y:function(t,e,r,n){const s=wi(t,n),i=s>0?s:1-s;if(e==="YY"){const o=i%100;return te(o,2)}return e==="Yo"?r.ordinalNumber(i,{unit:"year"}):te(i,e.length)},R:function(t,e){const r=yi(t);return te(r,e.length)},u:function(t,e){const r=t.getFullYear();return te(r,e.length)},Q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return te(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return te(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,e,r){const n=t.getMonth();switch(e){case"M":case"MM":return Ot.M(t,e);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(t,e,r){const n=t.getMonth();switch(e){case"L":return String(n+1);case"LL":return te(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(t,e,r,n){const s=ed(t,n);return e==="wo"?r.ordinalNumber(s,{unit:"week"}):te(s,e.length)},I:function(t,e,r){const n=Jl(t);return e==="Io"?r.ordinalNumber(n,{unit:"week"}):te(n,e.length)},d:function(t,e,r){return e==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):Ot.d(t,e)},D:function(t,e,r){const n=Ql(t);return e==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):te(n,e.length)},E:function(t,e,r){const n=t.getDay();switch(e){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(t,e,r,n){const s=t.getDay(),i=(s-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return te(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(s,{width:"short",context:"formatting"});case"eeee":default:return r.day(s,{width:"wide",context:"formatting"})}},c:function(t,e,r,n){const s=t.getDay(),i=(s-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return te(i,e.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(s,{width:"narrow",context:"standalone"});case"cccccc":return r.day(s,{width:"short",context:"standalone"});case"cccc":default:return r.day(s,{width:"wide",context:"standalone"})}},i:function(t,e,r){const n=t.getDay(),s=n===0?7:n;switch(e){case"i":return String(s);case"ii":return te(s,e.length);case"io":return r.ordinalNumber(s,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(t,e,r){const s=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(t,e,r){const n=t.getHours();let s;switch(n===12?s=tr.noon:n===0?s=tr.midnight:s=n/12>=1?"pm":"am",e){case"b":case"bb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(t,e,r){const n=t.getHours();let s;switch(n>=17?s=tr.evening:n>=12?s=tr.afternoon:n>=4?s=tr.morning:s=tr.night,e){case"B":case"BB":case"BBB":return r.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(t,e,r){if(e==="ho"){let n=t.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return Ot.h(t,e)},H:function(t,e,r){return e==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):Ot.H(t,e)},K:function(t,e,r){const n=t.getHours()%12;return e==="Ko"?r.ordinalNumber(n,{unit:"hour"}):te(n,e.length)},k:function(t,e,r){let n=t.getHours();return n===0&&(n=24),e==="ko"?r.ordinalNumber(n,{unit:"hour"}):te(n,e.length)},m:function(t,e,r){return e==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):Ot.m(t,e)},s:function(t,e,r){return e==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):Ot.s(t,e)},S:function(t,e){return Ot.S(t,e)},X:function(t,e,r){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return fa(n);case"XXXX":case"XX":return Bt(n);case"XXXXX":case"XXX":default:return Bt(n,":")}},x:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"x":return fa(n);case"xxxx":case"xx":return Bt(n);case"xxxxx":case"xxx":default:return Bt(n,":")}},O:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+ha(n,":");case"OOOO":default:return"GMT"+Bt(n,":")}},z:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+ha(n,":");case"zzzz":default:return"GMT"+Bt(n,":")}},t:function(t,e,r){const n=Math.trunc(t.getTime()/1e3);return te(n,e.length)},T:function(t,e,r){const n=t.getTime();return te(n,e.length)}};function ha(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),s=Math.trunc(n/60),i=n%60;return i===0?r+String(s):r+String(s)+e+te(i,2)}function fa(t,e){return t%60===0?(t>0?"-":"+")+te(Math.abs(t)/60,2):Bt(t,e)}function Bt(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),s=te(Math.trunc(n/60),2),i=te(n%60,2);return r+s+e+i}const ma=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},_i=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},td=(t,e)=>{const r=t.match(/(P+)(p+)?/)||[],n=r[1],s=r[2];if(!s)return ma(t,e);let i;switch(n){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",ma(n,e)).replace("{{time}}",_i(s,e))},rd={p:_i,P:td},nd=/^D+$/,sd=/^Y+$/,ad=["D","DD","YY","YYYY"];function id(t){return nd.test(t)}function od(t){return sd.test(t)}function cd(t,e,r){const n=ld(t,e,r);if(console.warn(n),ad.includes(t))throw new RangeError(n)}function ld(t,e,r){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const dd=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,ud=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,hd=/^'([^]*?)'?$/,fd=/''/g,md=/[a-zA-Z]/;function xe(t,e,r){var u,h,f,g,b,p,y,x;const n=Wr(),s=(r==null?void 0:r.locale)??n.locale??Xl,i=(r==null?void 0:r.firstWeekContainsDate)??((h=(u=r==null?void 0:r.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??n.firstWeekContainsDate??((g=(f=n.locale)==null?void 0:f.options)==null?void 0:g.firstWeekContainsDate)??1,o=(r==null?void 0:r.weekStartsOn)??((p=(b=r==null?void 0:r.locale)==null?void 0:b.options)==null?void 0:p.weekStartsOn)??n.weekStartsOn??((x=(y=n.locale)==null?void 0:y.options)==null?void 0:x.weekStartsOn)??0,c=Ne(t);if(!fl(c))throw new RangeError("Invalid time value");let l=e.match(ud).map(m=>{const N=m[0];if(N==="p"||N==="P"){const S=rd[N];return S(m,s.formatLong)}return m}).join("").match(dd).map(m=>{if(m==="''")return{isToken:!1,value:"'"};const N=m[0];if(N==="'")return{isToken:!1,value:gd(m)};if(ua[N])return{isToken:!0,value:m};if(N.match(md))throw new RangeError("Format string contains an unescaped latin alphabet character `"+N+"`");return{isToken:!1,value:m}});s.localize.preprocessor&&(l=s.localize.preprocessor(c,l));const d={firstWeekContainsDate:i,weekStartsOn:o,locale:s};return l.map(m=>{if(!m.isToken)return m.value;const N=m.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&od(N)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&id(N))&&cd(N,e,String(t));const S=ua[N[0]];return S(c,N,s.localize,d)}).join("")}function gd(t){const e=t.match(hd);return e?e[1].replace(fd,"'"):t}const pd={lessThanXSeconds:{one:"menos de un segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"medio minuto",lessThanXMinutes:{one:"menos de un minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"alrededor de 1 hora",other:"alrededor de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 día",other:"{{count}} días"},aboutXWeeks:{one:"alrededor de 1 semana",other:"alrededor de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"alrededor de 1 mes",other:"alrededor de {{count}} meses"},xMonths:{one:"1 mes",other:"{{count}} meses"},aboutXYears:{one:"alrededor de 1 año",other:"alrededor de {{count}} años"},xYears:{one:"1 año",other:"{{count}} años"},overXYears:{one:"más de 1 año",other:"más de {{count}} años"},almostXYears:{one:"casi 1 año",other:"casi {{count}} años"}},vd=(t,e,r)=>{let n;const s=pd[t];return typeof s=="string"?n=s:e===1?n=s.one:n=s.other.replace("{{count}}",e.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"en "+n:"hace "+n:n},bd={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/y"},yd={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},xd={full:"{{date}} 'a las' {{time}}",long:"{{date}} 'a las' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},wd={date:lr({formats:bd,defaultWidth:"full"}),time:lr({formats:yd,defaultWidth:"full"}),dateTime:lr({formats:xd,defaultWidth:"full"})},_d={lastWeek:"'el' eeee 'pasado a la' p",yesterday:"'ayer a la' p",today:"'hoy a la' p",tomorrow:"'mañana a la' p",nextWeek:"eeee 'a la' p",other:"P"},jd={lastWeek:"'el' eeee 'pasado a las' p",yesterday:"'ayer a las' p",today:"'hoy a las' p",tomorrow:"'mañana a las' p",nextWeek:"eeee 'a las' p",other:"P"},Nd=(t,e,r,n)=>e.getHours()!==1?jd[t]:_d[t],Sd={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","después de cristo"]},Od={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1º trimestre","2º trimestre","3º trimestre","4º trimestre"]},Cd={narrow:["e","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],wide:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]},Pd={narrow:["d","l","m","m","j","v","s"],short:["do","lu","ma","mi","ju","vi","sá"],abbreviated:["dom","lun","mar","mié","jue","vie","sáb"],wide:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"]},kd={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"}},Ad={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"}},Ed=(t,e)=>Number(t)+"º",Md={ordinalNumber:Ed,era:Ze({values:Sd,defaultWidth:"wide"}),quarter:Ze({values:Od,defaultWidth:"wide",argumentCallback:t=>Number(t)-1}),month:Ze({values:Cd,defaultWidth:"wide"}),day:Ze({values:Pd,defaultWidth:"wide"}),dayPeriod:Ze({values:kd,defaultWidth:"wide",formattingValues:Ad,defaultFormattingWidth:"wide"})},Td=/^(\d+)(º)?/i,Id=/\d+/i,Rd={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|a\.?\s?e\.?\s?c\.?|d\.?\s?c\.?|e\.?\s?c\.?)/i,wide:/^(antes de cristo|antes de la era com[uú]n|despu[eé]s de cristo|era com[uú]n)/i},Dd={any:[/^ac/i,/^dc/i],wide:[/^(antes de cristo|antes de la era com[uú]n)/i,/^(despu[eé]s de cristo|era com[uú]n)/i]},Ld={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234](º)? trimestre/i},Fd={any:[/1/i,/2/i,/3/i,/4/i]},$d={narrow:/^[efmajsond]/i,abbreviated:/^(ene|feb|mar|abr|may|jun|jul|ago|sep|oct|nov|dic)/i,wide:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i},Bd={narrow:[/^e/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^en/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i]},Ud={narrow:/^[dlmjvs]/i,short:/^(do|lu|ma|mi|ju|vi|s[áa])/i,abbreviated:/^(dom|lun|mar|mi[ée]|jue|vie|s[áa]b)/i,wide:/^(domingo|lunes|martes|mi[ée]rcoles|jueves|viernes|s[áa]bado)/i},Vd={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^do/i,/^lu/i,/^ma/i,/^mi/i,/^ju/i,/^vi/i,/^sa/i]},zd={narrow:/^(a|p|mn|md|(de la|a las) (mañana|tarde|noche))/i,any:/^([ap]\.?\s?m\.?|medianoche|mediodia|(de la|a las) (mañana|tarde|noche))/i},Wd={any:{am:/^a/i,pm:/^p/i,midnight:/^mn/i,noon:/^md/i,morning:/mañana/i,afternoon:/tarde/i,evening:/tarde/i,night:/noche/i}},qd={ordinalNumber:xi({matchPattern:Td,parsePattern:Id,valueCallback:function(t){return parseInt(t,10)}}),era:et({matchPatterns:Rd,defaultMatchWidth:"wide",parsePatterns:Dd,defaultParseWidth:"any"}),quarter:et({matchPatterns:Ld,defaultMatchWidth:"wide",parsePatterns:Fd,defaultParseWidth:"any",valueCallback:t=>t+1}),month:et({matchPatterns:$d,defaultMatchWidth:"wide",parsePatterns:Bd,defaultParseWidth:"any"}),day:et({matchPatterns:Ud,defaultMatchWidth:"wide",parsePatterns:Vd,defaultParseWidth:"any"}),dayPeriod:et({matchPatterns:zd,defaultMatchWidth:"any",parsePatterns:Wd,defaultParseWidth:"any"})},we={code:"es",formatDistance:vd,formatLong:wd,formatRelative:Nd,localize:Md,match:qd,options:{weekStartsOn:1,firstWeekContainsDate:1}};function ce(t){return new Intl.NumberFormat("es-UY",{style:"currency",currency:"UYU"}).format(t)}function ji(t){const e=t.replace(/\D/g,""),r=e.startsWith("598")?e.slice(3):e;return r.length>=8?`+598 ${[r.slice(0,2),r.slice(2,5),r.slice(5)].join(" ")}`:`+598 ${r}`}function ga(t){const e=t.replace(/\D/g,""),r=e.startsWith("598")?e.slice(3):e;return/^[0-9]{8,9}$/.test(r)}function Ni(t,e){const r=t.replace(/\D/g,"");return`https://wa.me/${r.startsWith("598")?r:`598${r}`}?text=${encodeURIComponent(e)}`}function Si(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(r=Si(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function Gd(){for(var t,e,r=0,n="",s=arguments.length;r<s;r++)(t=arguments[r])&&(e=Si(t))&&(n&&(n+=" "),n+=e);return n}const ks="-",Hd=t=>{const e=Kd(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:o=>{const c=o.split(ks);return c[0]===""&&c.length!==1&&c.shift(),Oi(c,e)||Yd(o)},getConflictingClassGroupIds:(o,c)=>{const l=r[o]||[];return c&&n[o]?[...l,...n[o]]:l}}},Oi=(t,e)=>{var o;if(t.length===0)return e.classGroupId;const r=t[0],n=e.nextPart.get(r),s=n?Oi(t.slice(1),n):void 0;if(s)return s;if(e.validators.length===0)return;const i=t.join(ks);return(o=e.validators.find(({validator:c})=>c(i)))==null?void 0:o.classGroupId},pa=/^\[(.+)\]$/,Yd=t=>{if(pa.test(t)){const e=pa.exec(t)[1],r=e==null?void 0:e.substring(0,e.indexOf(":"));if(r)return"arbitrary.."+r}},Kd=t=>{const{theme:e,prefix:r}=t,n={nextPart:new Map,validators:[]};return Qd(Object.entries(t.classGroups),r).forEach(([i,o])=>{cs(o,n,i,e)}),n},cs=(t,e,r,n)=>{t.forEach(s=>{if(typeof s=="string"){const i=s===""?e:va(e,s);i.classGroupId=r;return}if(typeof s=="function"){if(Xd(s)){cs(s(n),e,r,n);return}e.validators.push({validator:s,classGroupId:r});return}Object.entries(s).forEach(([i,o])=>{cs(o,va(e,i),r,n)})})},va=(t,e)=>{let r=t;return e.split(ks).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},Xd=t=>t.isThemeGetter,Qd=(t,e)=>e?t.map(([r,n])=>{const s=n.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,c])=>[e+o,c])):i);return[r,s]}):t,Jd=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,r=new Map,n=new Map;const s=(i,o)=>{r.set(i,o),e++,e>t&&(e=0,n=r,r=new Map)};return{get(i){let o=r.get(i);if(o!==void 0)return o;if((o=n.get(i))!==void 0)return s(i,o),o},set(i,o){r.has(i)?r.set(i,o):s(i,o)}}},Ci="!",Zd=t=>{const{separator:e,experimentalParseClassName:r}=t,n=e.length===1,s=e[0],i=e.length,o=c=>{const l=[];let d=0,u=0,h;for(let y=0;y<c.length;y++){let x=c[y];if(d===0){if(x===s&&(n||c.slice(y,y+i)===e)){l.push(c.slice(u,y)),u=y+i;continue}if(x==="/"){h=y;continue}}x==="["?d++:x==="]"&&d--}const f=l.length===0?c:c.substring(u),g=f.startsWith(Ci),b=g?f.substring(1):f,p=h&&h>u?h-u:void 0;return{modifiers:l,hasImportantModifier:g,baseClassName:b,maybePostfixModifierPosition:p}};return r?c=>r({className:c,parseClassName:o}):o},eu=t=>{if(t.length<=1)return t;const e=[];let r=[];return t.forEach(n=>{n[0]==="["?(e.push(...r.sort(),n),r=[]):r.push(n)}),e.push(...r.sort()),e},tu=t=>({cache:Jd(t.cacheSize),parseClassName:Zd(t),...Hd(t)}),ru=/\s+/,nu=(t,e)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:s}=e,i=[],o=t.trim().split(ru);let c="";for(let l=o.length-1;l>=0;l-=1){const d=o[l],{modifiers:u,hasImportantModifier:h,baseClassName:f,maybePostfixModifierPosition:g}=r(d);let b=!!g,p=n(b?f.substring(0,g):f);if(!p){if(!b){c=d+(c.length>0?" "+c:c);continue}if(p=n(f),!p){c=d+(c.length>0?" "+c:c);continue}b=!1}const y=eu(u).join(":"),x=h?y+Ci:y,m=x+p;if(i.includes(m))continue;i.push(m);const N=s(p,b);for(let S=0;S<N.length;++S){const A=N[S];i.push(x+A)}c=d+(c.length>0?" "+c:c)}return c};function su(){let t=0,e,r,n="";for(;t<arguments.length;)(e=arguments[t++])&&(r=Pi(e))&&(n&&(n+=" "),n+=r);return n}const Pi=t=>{if(typeof t=="string")return t;let e,r="";for(let n=0;n<t.length;n++)t[n]&&(e=Pi(t[n]))&&(r&&(r+=" "),r+=e);return r};function au(t,...e){let r,n,s,i=o;function o(l){const d=e.reduce((u,h)=>h(u),t());return r=tu(d),n=r.cache.get,s=r.cache.set,i=c,c(l)}function c(l){const d=n(l);if(d)return d;const u=nu(l,r);return s(l,u),u}return function(){return i(su.apply(null,arguments))}}const oe=t=>{const e=r=>r[t]||[];return e.isThemeGetter=!0,e},ki=/^\[(?:([a-z-]+):)?(.+)\]$/i,iu=/^\d+\/\d+$/,ou=new Set(["px","full","screen"]),cu=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,lu=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,du=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,uu=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,hu=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,dt=t=>dr(t)||ou.has(t)||iu.test(t),Ct=t=>wr(t,"length",xu),dr=t=>!!t&&!Number.isNaN(Number(t)),qn=t=>wr(t,"number",dr),Sr=t=>!!t&&Number.isInteger(Number(t)),fu=t=>t.endsWith("%")&&dr(t.slice(0,-1)),G=t=>ki.test(t),Pt=t=>cu.test(t),mu=new Set(["length","size","percentage"]),gu=t=>wr(t,mu,Ai),pu=t=>wr(t,"position",Ai),vu=new Set(["image","url"]),bu=t=>wr(t,vu,_u),yu=t=>wr(t,"",wu),Or=()=>!0,wr=(t,e,r)=>{const n=ki.exec(t);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):r(n[2]):!1},xu=t=>lu.test(t)&&!du.test(t),Ai=()=>!1,wu=t=>uu.test(t),_u=t=>hu.test(t),ju=()=>{const t=oe("colors"),e=oe("spacing"),r=oe("blur"),n=oe("brightness"),s=oe("borderColor"),i=oe("borderRadius"),o=oe("borderSpacing"),c=oe("borderWidth"),l=oe("contrast"),d=oe("grayscale"),u=oe("hueRotate"),h=oe("invert"),f=oe("gap"),g=oe("gradientColorStops"),b=oe("gradientColorStopPositions"),p=oe("inset"),y=oe("margin"),x=oe("opacity"),m=oe("padding"),N=oe("saturate"),S=oe("scale"),A=oe("sepia"),B=oe("skew"),q=oe("space"),le=oe("translate"),ge=()=>["auto","contain","none"],F=()=>["auto","hidden","clip","visible","scroll"],H=()=>["auto",G,e],V=()=>[G,e],ot=()=>["",dt,Ct],De=()=>["auto",dr,G],He=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],Ye=()=>["solid","dashed","dotted","double","none"],ct=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],St=()=>["start","end","center","between","around","evenly","stretch"],Ke=()=>["","0",G],Z=()=>["auto","avoid","all","avoid-page","page","left","right","column"],re=()=>[dr,G];return{cacheSize:500,separator:":",theme:{colors:[Or],spacing:[dt,Ct],blur:["none","",Pt,G],brightness:re(),borderColor:[t],borderRadius:["none","","full",Pt,G],borderSpacing:V(),borderWidth:ot(),contrast:re(),grayscale:Ke(),hueRotate:re(),invert:Ke(),gap:V(),gradientColorStops:[t],gradientColorStopPositions:[fu,Ct],inset:H(),margin:H(),opacity:re(),padding:V(),saturate:re(),scale:re(),sepia:Ke(),skew:re(),space:V(),translate:V()},classGroups:{aspect:[{aspect:["auto","square","video",G]}],container:["container"],columns:[{columns:[Pt]}],"break-after":[{"break-after":Z()}],"break-before":[{"break-before":Z()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...He(),G]}],overflow:[{overflow:F()}],"overflow-x":[{"overflow-x":F()}],"overflow-y":[{"overflow-y":F()}],overscroll:[{overscroll:ge()}],"overscroll-x":[{"overscroll-x":ge()}],"overscroll-y":[{"overscroll-y":ge()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[p]}],"inset-x":[{"inset-x":[p]}],"inset-y":[{"inset-y":[p]}],start:[{start:[p]}],end:[{end:[p]}],top:[{top:[p]}],right:[{right:[p]}],bottom:[{bottom:[p]}],left:[{left:[p]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Sr,G]}],basis:[{basis:H()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",G]}],grow:[{grow:Ke()}],shrink:[{shrink:Ke()}],order:[{order:["first","last","none",Sr,G]}],"grid-cols":[{"grid-cols":[Or]}],"col-start-end":[{col:["auto",{span:["full",Sr,G]},G]}],"col-start":[{"col-start":De()}],"col-end":[{"col-end":De()}],"grid-rows":[{"grid-rows":[Or]}],"row-start-end":[{row:["auto",{span:[Sr,G]},G]}],"row-start":[{"row-start":De()}],"row-end":[{"row-end":De()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",G]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",G]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...St()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...St(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...St(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[m]}],px:[{px:[m]}],py:[{py:[m]}],ps:[{ps:[m]}],pe:[{pe:[m]}],pt:[{pt:[m]}],pr:[{pr:[m]}],pb:[{pb:[m]}],pl:[{pl:[m]}],m:[{m:[y]}],mx:[{mx:[y]}],my:[{my:[y]}],ms:[{ms:[y]}],me:[{me:[y]}],mt:[{mt:[y]}],mr:[{mr:[y]}],mb:[{mb:[y]}],ml:[{ml:[y]}],"space-x":[{"space-x":[q]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[q]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",G,e]}],"min-w":[{"min-w":[G,e,"min","max","fit"]}],"max-w":[{"max-w":[G,e,"none","full","min","max","fit","prose",{screen:[Pt]},Pt]}],h:[{h:[G,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[G,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[G,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[G,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Pt,Ct]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",qn]}],"font-family":[{font:[Or]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",G]}],"line-clamp":[{"line-clamp":["none",dr,qn]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",dt,G]}],"list-image":[{"list-image":["none",G]}],"list-style-type":[{list:["none","disc","decimal",G]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Ye(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",dt,Ct]}],"underline-offset":[{"underline-offset":["auto",dt,G]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:V()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",G]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",G]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...He(),pu]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",gu]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},bu]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[b]}],"gradient-via-pos":[{via:[b]}],"gradient-to-pos":[{to:[b]}],"gradient-from":[{from:[g]}],"gradient-via":[{via:[g]}],"gradient-to":[{to:[g]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[c]}],"border-w-x":[{"border-x":[c]}],"border-w-y":[{"border-y":[c]}],"border-w-s":[{"border-s":[c]}],"border-w-e":[{"border-e":[c]}],"border-w-t":[{"border-t":[c]}],"border-w-r":[{"border-r":[c]}],"border-w-b":[{"border-b":[c]}],"border-w-l":[{"border-l":[c]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[...Ye(),"hidden"]}],"divide-x":[{"divide-x":[c]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[c]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:Ye()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...Ye()]}],"outline-offset":[{"outline-offset":[dt,G]}],"outline-w":[{outline:[dt,Ct]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:ot()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[dt,Ct]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Pt,yu]}],"shadow-color":[{shadow:[Or]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":[...ct(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":ct()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Pt,G]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[h]}],saturate:[{saturate:[N]}],sepia:[{sepia:[A]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[N]}],"backdrop-sepia":[{"backdrop-sepia":[A]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",G]}],duration:[{duration:re()}],ease:[{ease:["linear","in","out","in-out",G]}],delay:[{delay:re()}],animate:[{animate:["none","spin","ping","pulse","bounce",G]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[S]}],"scale-x":[{"scale-x":[S]}],"scale-y":[{"scale-y":[S]}],rotate:[{rotate:[Sr,G]}],"translate-x":[{"translate-x":[le]}],"translate-y":[{"translate-y":[le]}],"skew-x":[{"skew-x":[B]}],"skew-y":[{"skew-y":[B]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",G]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",G]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":V()}],"scroll-mx":[{"scroll-mx":V()}],"scroll-my":[{"scroll-my":V()}],"scroll-ms":[{"scroll-ms":V()}],"scroll-me":[{"scroll-me":V()}],"scroll-mt":[{"scroll-mt":V()}],"scroll-mr":[{"scroll-mr":V()}],"scroll-mb":[{"scroll-mb":V()}],"scroll-ml":[{"scroll-ml":V()}],"scroll-p":[{"scroll-p":V()}],"scroll-px":[{"scroll-px":V()}],"scroll-py":[{"scroll-py":V()}],"scroll-ps":[{"scroll-ps":V()}],"scroll-pe":[{"scroll-pe":V()}],"scroll-pt":[{"scroll-pt":V()}],"scroll-pr":[{"scroll-pr":V()}],"scroll-pb":[{"scroll-pb":V()}],"scroll-pl":[{"scroll-pl":V()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",G]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[dt,Ct,qn]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},Nu=au(ju);function je(...t){return Nu(Gd(t))}const At=[{code:"GRL",name:"General"},{code:"GFR",name:"Granja Fresco"},{code:"GRE",name:"Granja Refrigerado"},{code:"GTM",name:"Granja Terminado"},{code:"GPA",name:"Granja Panadería"},{code:"GSC",name:"Granja Seco"},{code:"HEL",name:"Heladería"},{code:"REF",name:"Refrigerado"},{code:"CON",name:"Congelado"},{code:"FRU",name:"Frutas"}],Tt={name:"Panadería Nueva Río D'or",owner:"TEJAS DE LA CRUZ YOSBANY"};function Ei(t){const e=t.toString().padStart(5,"0"),r=parseInt(e.slice(0,2))-1;return r>=0&&r<At.length?At[r].code:At[0].code}function Su(t){const e=t.toString().padStart(5,"0");return parseInt(e.slice(2))}function Mi(t){const e=Ei(t),r=Su(t);return`${e}-${r.toString().padStart(3,"0")}`}const ba=[{name:"Dashboard",to:"/",icon:wc},{name:"Proveedores",to:"/providers",icon:ii},{name:"Productos",to:"/products",icon:Mt},{name:"Recetas",to:"/recipes",icon:js},{name:"Órdenes",to:"/orders",icon:Sn},{name:"Cronograma",to:"/schedule",icon:On},{name:"Inventario",to:"/inventory",icon:_c}];function Ou(){const{signOut:t}=Ps(),[e,r]=w.useState(!1);return a.jsx("header",{className:"bg-white border-b border-gray-200",children:a.jsxs("div",{className:"mx-auto px-4",children:[a.jsxs("div",{className:"flex h-16 items-center justify-between",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("h1",{className:"text-xl font-bold text-gray-900 mr-4 whitespace-nowrap",children:"Gestión de Compras"}),a.jsx("button",{onClick:()=>r(!e),className:"md:hidden ml-2 p-2 rounded-md hover:bg-gray-100",children:e?a.jsx(It,{className:"h-6 w-6"}):a.jsx(xc,{className:"h-6 w-6"})})]}),a.jsxs("nav",{className:"hidden md:flex space-x-4",children:[ba.map(n=>a.jsxs(oa,{to:n.to,className:({isActive:s})=>je("inline-flex items-center px-3 py-2 text-sm font-medium rounded-md transition-colors",s?"text-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"),children:[a.jsx(n.icon,{className:"mr-2 h-5 w-5"}),n.name]},n.name)),a.jsxs("button",{onClick:()=>t(),className:"inline-flex items-center px-3 py-2 text-sm font-medium text-gray-600 hover:text-gray-900 hover:bg-gray-50 rounded-md transition-colors",children:[a.jsx(aa,{className:"mr-2 h-5 w-5"}),"Cerrar Sesión"]})]})]}),e&&a.jsxs("nav",{className:"md:hidden py-4 space-y-2",children:[ba.map(n=>a.jsxs(oa,{to:n.to,onClick:()=>r(!1),className:({isActive:s})=>je("flex items-center px-3 py-2 text-base font-medium rounded-md w-full transition-colors",s?"text-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"),children:[a.jsx(n.icon,{className:"mr-3 h-5 w-5"}),n.name]},n.name)),a.jsxs("button",{onClick:()=>t(),className:"flex items-center px-3 py-2 text-base font-medium text-gray-600 hover:text-gray-900 hover:bg-gray-50 rounded-md w-full transition-colors",children:[a.jsx(aa,{className:"mr-3 h-5 w-5"}),"Cerrar Sesión"]})]})]})})}function Cu(){return a.jsxs("div",{className:"min-h-screen flex flex-col",children:[a.jsx(Ou,{}),a.jsx("main",{className:"flex-1 overflow-auto bg-gray-100 p-4",children:a.jsx(mi,{})})]})}const T=({className:t,variant:e="primary",size:r="md",isLoading:n,children:s,...i})=>{const o="inline-flex items-center justify-center rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",c={primary:"bg-blue-600 text-white hover:bg-blue-700",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200",outline:"border border-gray-300 bg-transparent hover:bg-gray-100",ghost:"hover:bg-gray-100 hover:text-gray-900"},l={sm:"h-9 px-3 text-sm",md:"h-10 px-4",lg:"h-11 px-8"};return a.jsxs("button",{className:je(o,c[e],l[r],t),disabled:n,...i,children:[n?a.jsx("span",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}):null,s]})},ee=dn.forwardRef(({className:t,label:e,error:r,value:n,type:s,onChange:i,isCurrency:o,...c},l)=>{const[d,u]=w.useState(""),h=y=>{const x=y.toFixed(2).split(".");return x[0]=x[0].replace(/\B(?=(\d{3})+(?!\d))/g,"."),x.join(",")};w.useEffect(()=>{o&&typeof n=="number"&&u(h(n))},[n,o]);const f=y=>{var x;if(o){let m=y.target.value.replace(/[^\d.,]/g,"");if(m=m.replace(/,/g,"."),m.split(".").length-1>1){const B=m.split(".");m=B[0]+"."+B.slice(1).join("")}const S=m.split(".");((x=S[1])==null?void 0:x.length)>2&&(S[1]=S[1].slice(0,2),m=S.join("."));const A=parseFloat(m)||0;u(h(A)),i==null||i({...y,target:{...y.target,value:A.toString()}})}else if(s==="number"){const m=y.target.value;(m===""||!isNaN(Number(m)))&&(i==null||i(y))}else i==null||i(y)},g=y=>{var x;o&&typeof n=="number"&&u(n.toFixed(2).replace(".",",")),(x=c.onFocus)==null||x.call(c,y)},b=y=>{var x;o&&typeof n=="number"&&u(h(n)),(x=c.onBlur)==null||x.call(c,y)},p=o?d:s==="number"&&n===0&&!c.min?"":n;return a.jsxs("div",{className:"space-y-2",children:[e&&a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:e}),a.jsxs("div",{className:"relative",children:[o&&a.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",children:"$"}),a.jsx("input",{className:je("block w-full rounded-md border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-500","focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500","disabled:cursor-not-allowed disabled:bg-gray-50 disabled:text-gray-500",r&&"border-red-500 focus:border-red-500 focus:ring-red-500",o&&"pl-7 text-right",t),ref:l,value:p,onChange:f,onFocus:g,onBlur:b,type:o?"text":s,inputMode:o?"decimal":void 0,...c})]}),r&&a.jsx("p",{className:"text-sm text-red-600",children:r})]})});ee.displayName="Input";function Pu(){const{user:t,signIn:e}=Ps(),[r,n]=w.useState(!1),[s,i]=w.useState(""),[o,c]=w.useState(""),[l,d]=w.useState("");if(t)return a.jsx(fi,{to:"/",replace:!0});const u=async h=>{h.preventDefault(),d(""),n(!0);try{await e(s,o)}catch(f){console.error("Login error:",f),d("Credenciales inválidas")}finally{n(!1)}};return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 py-12 px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"max-w-md w-full space-y-8 bg-white p-8 rounded-lg shadow-lg",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Órdenes de Compra"}),a.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Inicia sesión para continuar"})]}),a.jsxs("form",{className:"mt-8 space-y-6",onSubmit:u,children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"sr-only",children:"Correo electrónico"}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(jc,{className:"h-5 w-5 text-gray-400"})}),a.jsx(ee,{id:"email",type:"email",value:s,onChange:h=>i(h.target.value),required:!0,className:"pl-10",placeholder:"Correo electrónico",autoComplete:"email"})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"sr-only",children:"Contraseña"}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Nc,{className:"h-5 w-5 text-gray-400"})}),a.jsx(ee,{id:"password",type:"password",value:o,onChange:h=>c(h.target.value),required:!0,className:"pl-10",placeholder:"Contraseña",autoComplete:"current-password"})]})]})]}),l&&a.jsx("div",{className:"text-red-600 text-sm text-center",children:l}),a.jsx(T,{type:"submit",className:"w-full",isLoading:r,children:"Iniciar sesión"})]})]})})}function Q(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];throw new Error(typeof t=="number"?"[MobX] minified error nr: "+t+(r.length?" "+r.map(String).join(","):"")+". Find the full error at: https://github.com/mobxjs/mobx/blob/main/packages/mobx/src/errors.ts":"[MobX] "+t)}var ku={};function Cn(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:ku}var Ti=Object.assign,hn=Object.getOwnPropertyDescriptor,nt=Object.defineProperty,Pn=Object.prototype,ls=[];Object.freeze(ls);var Ii={};Object.freeze(Ii);var Au=typeof Proxy<"u",Eu=Object.toString();function Ri(){Au||Q("Proxy not available")}function Di(t){var e=!1;return function(){if(!e)return e=!0,t.apply(this,arguments)}}var ar=function(){};function ze(t){return typeof t=="function"}function Wt(t){var e=typeof t;switch(e){case"string":case"symbol":case"number":return!0}return!1}function kn(t){return t!==null&&typeof t=="object"}function yt(t){if(!kn(t))return!1;var e=Object.getPrototypeOf(t);if(e==null)return!0;var r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r.toString()===Eu}function Li(t){var e=t==null?void 0:t.constructor;return e?e.name==="GeneratorFunction"||e.displayName==="GeneratorFunction":!1}function qr(t,e,r){nt(t,e,{enumerable:!1,writable:!0,configurable:!0,value:r})}function Fi(t,e,r){nt(t,e,{enumerable:!1,writable:!1,configurable:!0,value:r})}function Kt(t,e){var r="isMobX"+t;return e.prototype[r]=!0,function(n){return kn(n)&&n[r]===!0}}function _r(t){return t!=null&&Object.prototype.toString.call(t)==="[object Map]"}function Mu(t){var e=Object.getPrototypeOf(t),r=Object.getPrototypeOf(e),n=Object.getPrototypeOf(r);return n===null}function mt(t){return t!=null&&Object.prototype.toString.call(t)==="[object Set]"}var $i=typeof Object.getOwnPropertySymbols<"u";function Tu(t){var e=Object.keys(t);if(!$i)return e;var r=Object.getOwnPropertySymbols(t);return r.length?[].concat(e,r.filter(function(n){return Pn.propertyIsEnumerable.call(t,n)})):e}var gr=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:$i?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Object.getOwnPropertyNames;function Bi(t){return t===null?null:typeof t=="object"?""+t:t}function vt(t,e){return Pn.hasOwnProperty.call(t,e)}var Iu=Object.getOwnPropertyDescriptors||function(e){var r={};return gr(e).forEach(function(n){r[n]=hn(e,n)}),r};function Pe(t,e){return!!(t&e)}function ke(t,e,r){return r?t|=e:t&=~e,t}function ya(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function Ru(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Lu(n.key),n)}}function jr(t,e,r){return e&&Ru(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function ir(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=Fu(t))||e){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qt(){return qt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},qt.apply(null,arguments)}function Ui(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,ds(t,e)}function ds(t,e){return ds=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},ds(t,e)}function Du(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function Lu(t){var e=Du(t,"string");return typeof e=="symbol"?e:e+""}function Fu(t,e){if(t){if(typeof t=="string")return ya(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ya(t,e):void 0}}var rt=Symbol("mobx-stored-annotations");function st(t){function e(r,n){if(Hr(n))return t.decorate_20223_(r,n);Gr(r,n,t)}return Object.assign(e,t)}function Gr(t,e,r){vt(t,rt)||qr(t,rt,qt({},t[rt])),Hu(r)||(t[rt][e]=r)}function $u(t){return vt(t,rt)||qr(t,rt,qt({},t[rt])),t[rt]}function Hr(t){return typeof t=="object"&&typeof t.kind=="string"}var U=Symbol("mobx administration"),Rt=function(){function t(r){r===void 0&&(r="Atom"),this.name_=void 0,this.flags_=0,this.observers_=new Set,this.lastAccessedBy_=0,this.lowestObserverState_=J.NOT_TRACKING_,this.onBOL=void 0,this.onBUOL=void 0,this.name_=r}var e=t.prototype;return e.onBO=function(){this.onBOL&&this.onBOL.forEach(function(n){return n()})},e.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(n){return n()})},e.reportObserved=function(){return so(this)},e.reportChanged=function(){Te(),ao(this),Ie()},e.toString=function(){return this.name_},jr(t,[{key:"isBeingObserved",get:function(){return Pe(this.flags_,t.isBeingObservedMask_)},set:function(n){this.flags_=ke(this.flags_,t.isBeingObservedMask_,n)}},{key:"isPendingUnobservation",get:function(){return Pe(this.flags_,t.isPendingUnobservationMask_)},set:function(n){this.flags_=ke(this.flags_,t.isPendingUnobservationMask_,n)}},{key:"diffValue",get:function(){return Pe(this.flags_,t.diffValueMask_)?1:0},set:function(n){this.flags_=ke(this.flags_,t.diffValueMask_,n===1)}}])}();Rt.isBeingObservedMask_=1;Rt.isPendingUnobservationMask_=2;Rt.diffValueMask_=4;var As=Kt("Atom",Rt);function Vi(t,e,r){e===void 0&&(e=ar),r===void 0&&(r=ar);var n=new Rt(t);return e!==ar&&Kh(n,e),r!==ar&&ho(n,r),n}function Bu(t,e){return t===e}function Uu(t,e){return Ls(t,e)}function Vu(t,e){return Ls(t,e,1)}function zu(t,e){return Object.is?Object.is(t,e):t===e?t!==0||1/t===1/e:t!==t&&e!==e}var fn={identity:Bu,structural:Uu,default:zu,shallow:Vu};function Gt(t,e,r){return vo(t)?t:Array.isArray(t)?ye.array(t,{name:r}):yt(t)?ye.object(t,void 0,{name:r}):_r(t)?ye.map(t,{name:r}):mt(t)?ye.set(t,{name:r}):typeof t=="function"&&!Rr(t)&&!Dr(t)?Li(t)?pr(t):Ir(r,t):t}function Wu(t,e,r){if(t==null||Rn(t)||In(t)||Qt(t)||tt(t))return t;if(Array.isArray(t))return ye.array(t,{name:r,deep:!1});if(yt(t))return ye.object(t,void 0,{name:r,deep:!1});if(_r(t))return ye.map(t,{name:r,deep:!1});if(mt(t))return ye.set(t,{name:r,deep:!1})}function An(t){return t}function qu(t,e){return Ls(t,e)?e:t}var Gu="override";function Hu(t){return t.annotationType_===Gu}function Yr(t,e){return{annotationType_:t,options_:e,make_:Yu,extend_:Ku,decorate_20223_:Xu}}function Yu(t,e,r,n){var s;if((s=this.options_)!=null&&s.bound)return this.extend_(t,e,r,!1)===null?0:1;if(n===t.target_)return this.extend_(t,e,r,!1)===null?0:2;if(Rr(r.value))return 1;var i=zi(t,this,e,r,!1);return nt(n,e,i),2}function Ku(t,e,r,n){var s=zi(t,this,e,r);return t.defineProperty_(e,s,n)}function Xu(t,e){var r=e.kind,n=e.name,s=e.addInitializer,i=this,o=function(d){var u,h,f,g;return Ht((u=(h=i.options_)==null?void 0:h.name)!=null?u:n.toString(),d,(f=(g=i.options_)==null?void 0:g.autoAction)!=null?f:!1)};if(r=="field")return function(l){var d,u=l;return Rr(u)||(u=o(u)),(d=i.options_)!=null&&d.bound&&(u=u.bind(this),u.isMobxAction=!0),u};if(r=="method"){var c;return Rr(t)||(t=o(t)),(c=this.options_)!=null&&c.bound&&s(function(){var l=this,d=l[n].bind(l);d.isMobxAction=!0,l[n]=d}),t}Q("Cannot apply '"+i.annotationType_+"' to '"+String(n)+"' (kind: "+r+"):"+(`
'`+i.annotationType_+"' can only be used on properties with a function value."))}function Qu(t,e,r,n){e.annotationType_,n.value}function zi(t,e,r,n,s){var i,o,c,l,d,u,h;s===void 0&&(s=C.safeDescriptors),Qu(t,e,r,n);var f=n.value;if((i=e.options_)!=null&&i.bound){var g;f=f.bind((g=t.proxy_)!=null?g:t.target_)}return{value:Ht((o=(c=e.options_)==null?void 0:c.name)!=null?o:r.toString(),f,(l=(d=e.options_)==null?void 0:d.autoAction)!=null?l:!1,(u=e.options_)!=null&&u.bound?(h=t.proxy_)!=null?h:t.target_:void 0),configurable:s?t.isPlainObject_:!0,enumerable:!1,writable:!s}}function Wi(t,e){return{annotationType_:t,options_:e,make_:Ju,extend_:Zu,decorate_20223_:eh}}function Ju(t,e,r,n){var s;if(n===t.target_)return this.extend_(t,e,r,!1)===null?0:2;if((s=this.options_)!=null&&s.bound&&(!vt(t.target_,e)||!Dr(t.target_[e]))&&this.extend_(t,e,r,!1)===null)return 0;if(Dr(r.value))return 1;var i=qi(t,this,e,r,!1,!1);return nt(n,e,i),2}function Zu(t,e,r,n){var s,i=qi(t,this,e,r,(s=this.options_)==null?void 0:s.bound);return t.defineProperty_(e,i,n)}function eh(t,e){var r,n=e.name,s=e.addInitializer;return Dr(t)||(t=pr(t)),(r=this.options_)!=null&&r.bound&&s(function(){var i=this,o=i[n].bind(i);o.isMobXFlow=!0,i[n]=o}),t}function th(t,e,r,n){e.annotationType_,n.value}function qi(t,e,r,n,s,i){i===void 0&&(i=C.safeDescriptors),th(t,e,r,n);var o=n.value;if(Dr(o)||(o=pr(o)),s){var c;o=o.bind((c=t.proxy_)!=null?c:t.target_),o.isMobXFlow=!0}return{value:o,configurable:i?t.isPlainObject_:!0,enumerable:!1,writable:!i}}function Es(t,e){return{annotationType_:t,options_:e,make_:rh,extend_:nh,decorate_20223_:sh}}function rh(t,e,r){return this.extend_(t,e,r,!1)===null?0:1}function nh(t,e,r,n){return ah(t,this,e,r),t.defineComputedProperty_(e,qt({},this.options_,{get:r.get,set:r.set}),n)}function sh(t,e){var r=this,n=e.name,s=e.addInitializer;return s(function(){var i=Jt(this)[U],o=qt({},r.options_,{get:t,context:this});o.name||(o.name="ObservableObject."+n.toString()),i.values_.set(n,new We(o))}),function(){return this[U].getObservablePropValue_(n)}}function ah(t,e,r,n){e.annotationType_,n.get}function En(t,e){return{annotationType_:t,options_:e,make_:ih,extend_:oh,decorate_20223_:ch}}function ih(t,e,r){return this.extend_(t,e,r,!1)===null?0:1}function oh(t,e,r,n){var s,i;return lh(t,this),t.defineObservableProperty_(e,r.value,(s=(i=this.options_)==null?void 0:i.enhancer)!=null?s:Gt,n)}function ch(t,e){var r=this,n=e.kind,s=e.name,i=new WeakSet;function o(c,l){var d,u,h=Jt(c)[U],f=new Vt(l,(d=(u=r.options_)==null?void 0:u.enhancer)!=null?d:Gt,"ObservableObject."+s.toString(),!1);h.values_.set(s,f),i.add(c)}if(n=="accessor")return{get:function(){return i.has(this)||o(this,t.get.call(this)),this[U].getObservablePropValue_(s)},set:function(l){return i.has(this)||o(this,l),this[U].setObservablePropValue_(s,l)},init:function(l){return i.has(this)||o(this,l),l}}}function lh(t,e,r,n){e.annotationType_}var dh="true",uh=Gi();function Gi(t){return{annotationType_:dh,options_:t,make_:hh,extend_:fh,decorate_20223_:mh}}function hh(t,e,r,n){var s,i;if(r.get)return Mn.make_(t,e,r,n);if(r.set){var o=Ht(e.toString(),r.set);return n===t.target_?t.defineProperty_(e,{configurable:C.safeDescriptors?t.isPlainObject_:!0,set:o})===null?0:2:(nt(n,e,{configurable:!0,set:o}),2)}if(n!==t.target_&&typeof r.value=="function"){var c;if(Li(r.value)){var l,d=(l=this.options_)!=null&&l.autoBind?pr.bound:pr;return d.make_(t,e,r,n)}var u=(c=this.options_)!=null&&c.autoBind?Ir.bound:Ir;return u.make_(t,e,r,n)}var h=((s=this.options_)==null?void 0:s.deep)===!1?ye.ref:ye;if(typeof r.value=="function"&&(i=this.options_)!=null&&i.autoBind){var f;r.value=r.value.bind((f=t.proxy_)!=null?f:t.target_)}return h.make_(t,e,r,n)}function fh(t,e,r,n){var s,i;if(r.get)return Mn.extend_(t,e,r,n);if(r.set)return t.defineProperty_(e,{configurable:C.safeDescriptors?t.isPlainObject_:!0,set:Ht(e.toString(),r.set)},n);if(typeof r.value=="function"&&(s=this.options_)!=null&&s.autoBind){var o;r.value=r.value.bind((o=t.proxy_)!=null?o:t.target_)}var c=((i=this.options_)==null?void 0:i.deep)===!1?ye.ref:ye;return c.extend_(t,e,r,n)}function mh(t,e){Q("'"+this.annotationType_+"' cannot be used as a decorator")}var gh="observable",ph="observable.ref",vh="observable.shallow",bh="observable.struct",Hi={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};Object.freeze(Hi);function en(t){return t||Hi}var us=En(gh),yh=En(ph,{enhancer:An}),xh=En(vh,{enhancer:Wu}),wh=En(bh,{enhancer:qu}),Yi=st(us);function tn(t){return t.deep===!0?Gt:t.deep===!1?An:jh(t.defaultDecorator)}function _h(t){var e;return t?(e=t.defaultDecorator)!=null?e:Gi(t):void 0}function jh(t){var e,r;return t&&(e=(r=t.options_)==null?void 0:r.enhancer)!=null?e:Gt}function Ki(t,e,r){if(Hr(e))return us.decorate_20223_(t,e);if(Wt(e)){Gr(t,e,us);return}return vo(t)?t:yt(t)?ye.object(t,e,r):Array.isArray(t)?ye.array(t,e):_r(t)?ye.map(t,e):mt(t)?ye.set(t,e):typeof t=="object"&&t!==null?t:ye.box(t,e)}Ti(Ki,Yi);var Nh={box:function(e,r){var n=en(r);return new Vt(e,tn(n),n.name,!0,n.equals)},array:function(e,r){var n=en(r);return(C.useProxies===!1||n.proxy===!1?wf:uf)(e,tn(n),n.name)},map:function(e,r){var n=en(r);return new yo(e,tn(n),n.name)},set:function(e,r){var n=en(r);return new xo(e,tn(n),n.name)},object:function(e,r,n){return Dt(function(){return mo(C.useProxies===!1||(n==null?void 0:n.proxy)===!1?Jt({},n):af({},n),e,r)})},ref:st(yh),shallow:st(xh),deep:Yi,struct:st(wh)},ye=Ti(Ki,Nh),Xi="computed",Sh="computed.struct",hs=Es(Xi),Oh=Es(Sh,{equals:fn.structural}),Mn=function(e,r){if(Hr(r))return hs.decorate_20223_(e,r);if(Wt(r))return Gr(e,r,hs);if(yt(e))return st(Es(Xi,e));var n=yt(r)?r:{};return n.get=e,n.name||(n.name=e.name||""),new We(n)};Object.assign(Mn,hs);Mn.struct=st(Oh);var xa,wa,mn=0,Ch=1,Ph=(xa=(wa=hn(function(){},"name"))==null?void 0:wa.configurable)!=null?xa:!1,_a={value:"action",configurable:!0,writable:!1,enumerable:!1};function Ht(t,e,r,n){r===void 0&&(r=!1);function s(){return Qi(t,r,e,n||this,arguments)}return s.isMobxAction=!0,s.toString=function(){return e.toString()},Ph&&(_a.value=t,nt(s,"name",_a)),s}function Qi(t,e,r,n,s){var i=kh(t,e);try{return r.apply(n,s)}catch(o){throw i.error_=o,o}finally{Ah(i)}}function kh(t,e,r,n){var s=!1,i=0,o=C.trackingDerivation,c=!e||!o;Te();var l=C.allowStateChanges;c&&(Xt(),l=Ms(!0));var d=Is(!0),u={runAsAction_:c,prevDerivation_:o,prevAllowStateChanges_:l,prevAllowStateReads_:d,notifySpy_:s,startTime_:i,actionId_:Ch++,parentActionId_:mn};return mn=u.actionId_,u}function Ah(t){mn!==t.actionId_&&Q(30),mn=t.parentActionId_,t.error_!==void 0&&(C.suppressReactionErrors=!0),Ts(t.prevAllowStateChanges_),Ar(t.prevAllowStateReads_),Ie(),t.runAsAction_&&bt(t.prevDerivation_),C.suppressReactionErrors=!1}function Ms(t){var e=C.allowStateChanges;return C.allowStateChanges=t,e}function Ts(t){C.allowStateChanges=t}var Vt=function(t){function e(n,s,i,o,c){var l;return i===void 0&&(i="ObservableValue"),c===void 0&&(c=fn.default),l=t.call(this,i)||this,l.enhancer=void 0,l.name_=void 0,l.equals=void 0,l.hasUnreportedChange_=!1,l.interceptors_=void 0,l.changeListeners_=void 0,l.value_=void 0,l.dehancer=void 0,l.enhancer=s,l.name_=i,l.equals=c,l.value_=s(n,void 0,i),l}Ui(e,t);var r=e.prototype;return r.dehanceValue=function(s){return this.dehancer!==void 0?this.dehancer(s):s},r.set=function(s){this.value_,s=this.prepareNewValue_(s),s!==C.UNCHANGED&&this.setNewValue_(s)},r.prepareNewValue_=function(s){if(Ee(this)){var i=Me(this,{object:this,type:at,newValue:s});if(!i)return C.UNCHANGED;s=i.newValue}return s=this.enhancer(s,this.value_,this.name_),this.equals(this.value_,s)?C.UNCHANGED:s},r.setNewValue_=function(s){var i=this.value_;this.value_=s,this.reportChanged(),Be(this)&&Ue(this,{type:at,object:this,newValue:s,oldValue:i})},r.get=function(){return this.reportObserved(),this.dehanceValue(this.value_)},r.intercept_=function(s){return Kr(this,s)},r.observe_=function(s,i){return i&&s({observableKind:"value",debugObjectName:this.name_,object:this,type:at,newValue:this.value_,oldValue:void 0}),Xr(this,s)},r.raw=function(){return this.value_},r.toJSON=function(){return this.get()},r.toString=function(){return this.name_+"["+this.value_+"]"},r.valueOf=function(){return Bi(this.get())},r[Symbol.toPrimitive]=function(){return this.valueOf()},e}(Rt),We=function(){function t(r){this.dependenciesState_=J.NOT_TRACKING_,this.observing_=[],this.newObserving_=null,this.observers_=new Set,this.runId_=0,this.lastAccessedBy_=0,this.lowestObserverState_=J.UP_TO_DATE_,this.unboundDepsCount_=0,this.value_=new pn(null),this.name_=void 0,this.triggeredBy_=void 0,this.flags_=0,this.derivation=void 0,this.setter_=void 0,this.isTracing_=gn.NONE,this.scope_=void 0,this.equals_=void 0,this.requiresReaction_=void 0,this.keepAlive_=void 0,this.onBOL=void 0,this.onBUOL=void 0,r.get||Q(31),this.derivation=r.get,this.name_=r.name||"ComputedValue",r.set&&(this.setter_=Ht("ComputedValue-setter",r.set)),this.equals_=r.equals||(r.compareStructural||r.struct?fn.structural:fn.default),this.scope_=r.context,this.requiresReaction_=r.requiresReaction,this.keepAlive_=!!r.keepAlive}var e=t.prototype;return e.onBecomeStale_=function(){Rh(this)},e.onBO=function(){this.onBOL&&this.onBOL.forEach(function(n){return n()})},e.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(n){return n()})},e.get=function(){if(this.isComputing&&Q(32,this.name_,this.derivation),C.inBatch===0&&this.observers_.size===0&&!this.keepAlive_)fs(this)&&(this.warnAboutUntrackedRead_(),Te(),this.value_=this.computeValue_(!1),Ie());else if(so(this),fs(this)){var n=C.trackingContext;this.keepAlive_&&!n&&(C.trackingContext=this),this.trackAndCompute()&&Ih(this),C.trackingContext=n}var s=this.value_;if(sn(s))throw s.cause;return s},e.set=function(n){if(this.setter_){this.isRunningSetter&&Q(33,this.name_),this.isRunningSetter=!0;try{this.setter_.call(this.scope_,n)}finally{this.isRunningSetter=!1}}else Q(34,this.name_)},e.trackAndCompute=function(){var n=this.value_,s=this.dependenciesState_===J.NOT_TRACKING_,i=this.computeValue_(!0),o=s||sn(n)||sn(i)||!this.equals_(n,i);return o&&(this.value_=i),o},e.computeValue_=function(n){this.isComputing=!0;var s=Ms(!1),i;if(n)i=Ji(this,this.derivation,this.scope_);else if(C.disableErrorBoundaries===!0)i=this.derivation.call(this.scope_);else try{i=this.derivation.call(this.scope_)}catch(o){i=new pn(o)}return Ts(s),this.isComputing=!1,i},e.suspend_=function(){this.keepAlive_||(ms(this),this.value_=void 0)},e.observe_=function(n,s){var i=this,o=!0,c=void 0;return Wh(function(){var l=i.get();if(!o||s){var d=Xt();n({observableKind:"computed",debugObjectName:i.name_,type:at,object:i,newValue:l,oldValue:c}),bt(d)}o=!1,c=l})},e.warnAboutUntrackedRead_=function(){},e.toString=function(){return this.name_+"["+this.derivation.toString()+"]"},e.valueOf=function(){return Bi(this.get())},e[Symbol.toPrimitive]=function(){return this.valueOf()},jr(t,[{key:"isComputing",get:function(){return Pe(this.flags_,t.isComputingMask_)},set:function(n){this.flags_=ke(this.flags_,t.isComputingMask_,n)}},{key:"isRunningSetter",get:function(){return Pe(this.flags_,t.isRunningSetterMask_)},set:function(n){this.flags_=ke(this.flags_,t.isRunningSetterMask_,n)}},{key:"isBeingObserved",get:function(){return Pe(this.flags_,t.isBeingObservedMask_)},set:function(n){this.flags_=ke(this.flags_,t.isBeingObservedMask_,n)}},{key:"isPendingUnobservation",get:function(){return Pe(this.flags_,t.isPendingUnobservationMask_)},set:function(n){this.flags_=ke(this.flags_,t.isPendingUnobservationMask_,n)}},{key:"diffValue",get:function(){return Pe(this.flags_,t.diffValueMask_)?1:0},set:function(n){this.flags_=ke(this.flags_,t.diffValueMask_,n===1)}}])}();We.isComputingMask_=1;We.isRunningSetterMask_=2;We.isBeingObservedMask_=4;We.isPendingUnobservationMask_=8;We.diffValueMask_=16;var Tn=Kt("ComputedValue",We),J;(function(t){t[t.NOT_TRACKING_=-1]="NOT_TRACKING_",t[t.UP_TO_DATE_=0]="UP_TO_DATE_",t[t.POSSIBLY_STALE_=1]="POSSIBLY_STALE_",t[t.STALE_=2]="STALE_"})(J||(J={}));var gn;(function(t){t[t.NONE=0]="NONE",t[t.LOG=1]="LOG",t[t.BREAK=2]="BREAK"})(gn||(gn={}));var pn=function(e){this.cause=void 0,this.cause=e};function sn(t){return t instanceof pn}function fs(t){switch(t.dependenciesState_){case J.UP_TO_DATE_:return!1;case J.NOT_TRACKING_:case J.STALE_:return!0;case J.POSSIBLY_STALE_:{for(var e=Is(!0),r=Xt(),n=t.observing_,s=n.length,i=0;i<s;i++){var o=n[i];if(Tn(o)){if(C.disableErrorBoundaries)o.get();else try{o.get()}catch{return bt(r),Ar(e),!0}if(t.dependenciesState_===J.STALE_)return bt(r),Ar(e),!0}}return eo(t),bt(r),Ar(e),!1}}}function Ji(t,e,r){var n=Is(!0);eo(t),t.newObserving_=new Array(t.runId_===0?100:t.observing_.length),t.unboundDepsCount_=0,t.runId_=++C.runId;var s=C.trackingDerivation;C.trackingDerivation=t,C.inBatch++;var i;if(C.disableErrorBoundaries===!0)i=e.call(r);else try{i=e.call(r)}catch(o){i=new pn(o)}return C.inBatch--,C.trackingDerivation=s,Eh(t),Ar(n),i}function Eh(t){for(var e=t.observing_,r=t.observing_=t.newObserving_,n=J.UP_TO_DATE_,s=0,i=t.unboundDepsCount_,o=0;o<i;o++){var c=r[o];c.diffValue===0&&(c.diffValue=1,s!==o&&(r[s]=c),s++),c.dependenciesState_>n&&(n=c.dependenciesState_)}for(r.length=s,t.newObserving_=null,i=e.length;i--;){var l=e[i];l.diffValue===0&&ro(l,t),l.diffValue=0}for(;s--;){var d=r[s];d.diffValue===1&&(d.diffValue=0,Th(d,t))}n!==J.UP_TO_DATE_&&(t.dependenciesState_=n,t.onBecomeStale_())}function ms(t){var e=t.observing_;t.observing_=[];for(var r=e.length;r--;)ro(e[r],t);t.dependenciesState_=J.NOT_TRACKING_}function Zi(t){var e=Xt();try{return t()}finally{bt(e)}}function Xt(){var t=C.trackingDerivation;return C.trackingDerivation=null,t}function bt(t){C.trackingDerivation=t}function Is(t){var e=C.allowStateReads;return C.allowStateReads=t,e}function Ar(t){C.allowStateReads=t}function eo(t){if(t.dependenciesState_!==J.UP_TO_DATE_){t.dependenciesState_=J.UP_TO_DATE_;for(var e=t.observing_,r=e.length;r--;)e[r].lowestObserverState_=J.UP_TO_DATE_}}var an=function(){this.version=6,this.UNCHANGED={},this.trackingDerivation=null,this.trackingContext=null,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!1,this.allowStateReads=!0,this.enforceActions=!0,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1,this.useProxies=!0,this.verifyProxies=!1,this.safeDescriptors=!0},on=!0,to=!1,C=function(){var t=Cn();return t.__mobxInstanceCount>0&&!t.__mobxGlobals&&(on=!1),t.__mobxGlobals&&t.__mobxGlobals.version!==new an().version&&(on=!1),on?t.__mobxGlobals?(t.__mobxInstanceCount+=1,t.__mobxGlobals.UNCHANGED||(t.__mobxGlobals.UNCHANGED={}),t.__mobxGlobals):(t.__mobxInstanceCount=1,t.__mobxGlobals=new an):(setTimeout(function(){to||Q(35)},1),new an)}();function Mh(){if((C.pendingReactions.length||C.inBatch||C.isRunningReactions)&&Q(36),to=!0,on){var t=Cn();--t.__mobxInstanceCount===0&&(t.__mobxGlobals=void 0),C=new an}}function Th(t,e){t.observers_.add(e),t.lowestObserverState_>e.dependenciesState_&&(t.lowestObserverState_=e.dependenciesState_)}function ro(t,e){t.observers_.delete(e),t.observers_.size===0&&no(t)}function no(t){t.isPendingUnobservation===!1&&(t.isPendingUnobservation=!0,C.pendingUnobservations.push(t))}function Te(){C.inBatch++}function Ie(){if(--C.inBatch===0){io();for(var t=C.pendingUnobservations,e=0;e<t.length;e++){var r=t[e];r.isPendingUnobservation=!1,r.observers_.size===0&&(r.isBeingObserved&&(r.isBeingObserved=!1,r.onBUO()),r instanceof We&&r.suspend_())}C.pendingUnobservations=[]}}function so(t){var e=C.trackingDerivation;return e!==null?(e.runId_!==t.lastAccessedBy_&&(t.lastAccessedBy_=e.runId_,e.newObserving_[e.unboundDepsCount_++]=t,!t.isBeingObserved&&C.trackingContext&&(t.isBeingObserved=!0,t.onBO())),t.isBeingObserved):(t.observers_.size===0&&C.inBatch>0&&no(t),!1)}function ao(t){t.lowestObserverState_!==J.STALE_&&(t.lowestObserverState_=J.STALE_,t.observers_.forEach(function(e){e.dependenciesState_===J.UP_TO_DATE_&&e.onBecomeStale_(),e.dependenciesState_=J.STALE_}))}function Ih(t){t.lowestObserverState_!==J.STALE_&&(t.lowestObserverState_=J.STALE_,t.observers_.forEach(function(e){e.dependenciesState_===J.POSSIBLY_STALE_?e.dependenciesState_=J.STALE_:e.dependenciesState_===J.UP_TO_DATE_&&(t.lowestObserverState_=J.UP_TO_DATE_)}))}function Rh(t){t.lowestObserverState_===J.UP_TO_DATE_&&(t.lowestObserverState_=J.POSSIBLY_STALE_,t.observers_.forEach(function(e){e.dependenciesState_===J.UP_TO_DATE_&&(e.dependenciesState_=J.POSSIBLY_STALE_,e.onBecomeStale_())}))}var xt=function(){function t(r,n,s,i){r===void 0&&(r="Reaction"),this.name_=void 0,this.onInvalidate_=void 0,this.errorHandler_=void 0,this.requiresObservable_=void 0,this.observing_=[],this.newObserving_=[],this.dependenciesState_=J.NOT_TRACKING_,this.runId_=0,this.unboundDepsCount_=0,this.flags_=0,this.isTracing_=gn.NONE,this.name_=r,this.onInvalidate_=n,this.errorHandler_=s,this.requiresObservable_=i}var e=t.prototype;return e.onBecomeStale_=function(){this.schedule_()},e.schedule_=function(){this.isScheduled||(this.isScheduled=!0,C.pendingReactions.push(this),io())},e.runReaction_=function(){if(!this.isDisposed){Te(),this.isScheduled=!1;var n=C.trackingContext;if(C.trackingContext=this,fs(this)){this.isTrackPending=!0;try{this.onInvalidate_()}catch(s){this.reportExceptionInDerivation_(s)}}C.trackingContext=n,Ie()}},e.track=function(n){if(!this.isDisposed){Te(),this.isRunning=!0;var s=C.trackingContext;C.trackingContext=this;var i=Ji(this,n,void 0);C.trackingContext=s,this.isRunning=!1,this.isTrackPending=!1,this.isDisposed&&ms(this),sn(i)&&this.reportExceptionInDerivation_(i.cause),Ie()}},e.reportExceptionInDerivation_=function(n){var s=this;if(this.errorHandler_){this.errorHandler_(n,this);return}if(C.disableErrorBoundaries)throw n;var i="[mobx] uncaught error in '"+this+"'";C.suppressReactionErrors||console.error(i,n),C.globalReactionErrorHandlers.forEach(function(o){return o(n,s)})},e.dispose=function(){this.isDisposed||(this.isDisposed=!0,this.isRunning||(Te(),ms(this),Ie()))},e.getDisposer_=function(n){var s=this,i=function o(){s.dispose(),n==null||n.removeEventListener==null||n.removeEventListener("abort",o)};return n==null||n.addEventListener==null||n.addEventListener("abort",i),i[U]=this,i},e.toString=function(){return"Reaction["+this.name_+"]"},e.trace=function(n){},jr(t,[{key:"isDisposed",get:function(){return Pe(this.flags_,t.isDisposedMask_)},set:function(n){this.flags_=ke(this.flags_,t.isDisposedMask_,n)}},{key:"isScheduled",get:function(){return Pe(this.flags_,t.isScheduledMask_)},set:function(n){this.flags_=ke(this.flags_,t.isScheduledMask_,n)}},{key:"isTrackPending",get:function(){return Pe(this.flags_,t.isTrackPendingMask_)},set:function(n){this.flags_=ke(this.flags_,t.isTrackPendingMask_,n)}},{key:"isRunning",get:function(){return Pe(this.flags_,t.isRunningMask_)},set:function(n){this.flags_=ke(this.flags_,t.isRunningMask_,n)}},{key:"diffValue",get:function(){return Pe(this.flags_,t.diffValueMask_)?1:0},set:function(n){this.flags_=ke(this.flags_,t.diffValueMask_,n===1)}}])}();xt.isDisposedMask_=1;xt.isScheduledMask_=2;xt.isTrackPendingMask_=4;xt.isRunningMask_=8;xt.diffValueMask_=16;var Dh=100,gs=function(e){return e()};function io(){C.inBatch>0||C.isRunningReactions||gs(Lh)}function Lh(){C.isRunningReactions=!0;for(var t=C.pendingReactions,e=0;t.length>0;){++e===Dh&&(console.error("[mobx] cycle in reaction: "+t[0]),t.splice(0));for(var r=t.splice(0),n=0,s=r.length;n<s;n++)r[n].runReaction_()}C.isRunningReactions=!1}var vn=Kt("Reaction",xt);function Fh(t){var e=gs;gs=function(n){return t(function(){return e(n)})}}function Er(){return!1}function $h(t){return console.warn("[mobx.spy] Is a no-op in production builds"),function(){}}var oo="action",Bh="action.bound",co="autoAction",Uh="autoAction.bound",lo="<unnamed action>",ps=Yr(oo),Vh=Yr(Bh,{bound:!0}),vs=Yr(co,{autoAction:!0}),zh=Yr(Uh,{autoAction:!0,bound:!0});function uo(t){var e=function(n,s){if(ze(n))return Ht(n.name||lo,n,t);if(ze(s))return Ht(n,s,t);if(Hr(s))return(t?vs:ps).decorate_20223_(n,s);if(Wt(s))return Gr(n,s,t?vs:ps);if(Wt(n))return st(Yr(t?co:oo,{name:n,autoAction:t}))};return e}var or=uo(!1);Object.assign(or,ps);var Ir=uo(!0);Object.assign(Ir,vs);or.bound=st(Vh);Ir.bound=st(zh);function Gn(t){return Qi(t.name||lo,!1,t,this,void 0)}function Rr(t){return ze(t)&&t.isMobxAction===!0}function Wh(t,e){var r,n,s,i;e===void 0&&(e=Ii);var o=(r=(n=e)==null?void 0:n.name)!=null?r:"Autorun",c=!e.scheduler&&!e.delay,l;if(c)l=new xt(o,function(){this.track(h)},e.onError,e.requiresObservable);else{var d=Gh(e),u=!1;l=new xt(o,function(){u||(u=!0,d(function(){u=!1,l.isDisposed||l.track(h)}))},e.onError,e.requiresObservable)}function h(){t(l)}return(s=e)!=null&&(s=s.signal)!=null&&s.aborted||l.schedule_(),l.getDisposer_((i=e)==null?void 0:i.signal)}var qh=function(e){return e()};function Gh(t){return t.scheduler?t.scheduler:t.delay?function(e){return setTimeout(e,t.delay)}:qh}var Hh="onBO",Yh="onBUO";function Kh(t,e,r){return fo(Hh,t,e,r)}function ho(t,e,r){return fo(Yh,t,e,r)}function fo(t,e,r,n){var s=xn(e),i=ze(n)?n:r,o=t+"L";return s[o]?s[o].add(i):s[o]=new Set([i]),function(){var c=s[o];c&&(c.delete(i),c.size===0&&delete s[o])}}var Xh="never",rn="always",Qh="observed";function Jh(t){t.isolateGlobalState===!0&&Mh();var e=t.useProxies,r=t.enforceActions;if(e!==void 0&&(C.useProxies=e===rn?!0:e===Xh?!1:typeof Proxy<"u"),e==="ifavailable"&&(C.verifyProxies=!0),r!==void 0){var n=r===rn?rn:r===Qh;C.enforceActions=n,C.allowStateChanges=!(n===!0||n===rn)}["computedRequiresReaction","reactionRequiresObservable","observableRequiresReaction","disableErrorBoundaries","safeDescriptors"].forEach(function(s){s in t&&(C[s]=!!t[s])}),C.allowStateReads=!C.observableRequiresReaction,t.reactionScheduler&&Fh(t.reactionScheduler)}function mo(t,e,r,n){var s=Iu(e);return Dt(function(){var i=Jt(t,n)[U];gr(s).forEach(function(o){i.extend_(o,s[o],r&&o in r?r[o]:!0)})}),t}function Zh(t,e){return go(xn(t,e))}function go(t){var e={name:t.name_};return t.observing_&&t.observing_.length>0&&(e.dependencies=ef(t.observing_).map(go)),e}function ef(t){return Array.from(new Set(t))}var tf=0;function po(){this.message="FLOW_CANCELLED"}po.prototype=Object.create(Error.prototype);var Hn=Wi("flow"),rf=Wi("flow.bound",{bound:!0}),pr=Object.assign(function(e,r){if(Hr(r))return Hn.decorate_20223_(e,r);if(Wt(r))return Gr(e,r,Hn);var n=e,s=n.name||"<unnamed flow>",i=function(){var c=this,l=arguments,d=++tf,u=or(s+" - runid: "+d+" - init",n).apply(c,l),h,f=void 0,g=new Promise(function(b,p){var y=0;h=p;function x(S){f=void 0;var A;try{A=or(s+" - runid: "+d+" - yield "+y++,u.next).call(u,S)}catch(B){return p(B)}N(A)}function m(S){f=void 0;var A;try{A=or(s+" - runid: "+d+" - yield "+y++,u.throw).call(u,S)}catch(B){return p(B)}N(A)}function N(S){if(ze(S==null?void 0:S.then)){S.then(N,p);return}return S.done?b(S.value):(f=Promise.resolve(S.value),f.then(x,m))}x(void 0)});return g.cancel=or(s+" - runid: "+d+" - cancel",function(){try{f&&ja(f);var b=u.return(void 0),p=Promise.resolve(b.value);p.then(ar,ar),ja(p),h(new po)}catch(y){h(y)}}),g};return i.isMobXFlow=!0,i},Hn);pr.bound=st(rf);function ja(t){ze(t.cancel)&&t.cancel()}function Dr(t){return(t==null?void 0:t.isMobXFlow)===!0}function nf(t,e){return t?Rn(t)||!!t[U]||As(t)||vn(t)||Tn(t):!1}function vo(t){return nf(t)}function gt(t,e){e===void 0&&(e=void 0),Te();try{return t.apply(e)}finally{Ie()}}function rr(t){return t[U]}var sf={has:function(e,r){return rr(e).has_(r)},get:function(e,r){return rr(e).get_(r)},set:function(e,r,n){var s;return Wt(r)?(s=rr(e).set_(r,n,!0))!=null?s:!0:!1},deleteProperty:function(e,r){var n;return Wt(r)?(n=rr(e).delete_(r,!0))!=null?n:!0:!1},defineProperty:function(e,r,n){var s;return(s=rr(e).defineProperty_(r,n))!=null?s:!0},ownKeys:function(e){return rr(e).ownKeys_()},preventExtensions:function(e){Q(13)}};function af(t,e){var r,n;return Ri(),t=Jt(t,e),(n=(r=t[U]).proxy_)!=null?n:r.proxy_=new Proxy(t,sf)}function Ee(t){return t.interceptors_!==void 0&&t.interceptors_.length>0}function Kr(t,e){var r=t.interceptors_||(t.interceptors_=[]);return r.push(e),Di(function(){var n=r.indexOf(e);n!==-1&&r.splice(n,1)})}function Me(t,e){var r=Xt();try{for(var n=[].concat(t.interceptors_||[]),s=0,i=n.length;s<i&&(e=n[s](e),e&&!e.type&&Q(14),!!e);s++);return e}finally{bt(r)}}function Be(t){return t.changeListeners_!==void 0&&t.changeListeners_.length>0}function Xr(t,e){var r=t.changeListeners_||(t.changeListeners_=[]);return r.push(e),Di(function(){var n=r.indexOf(e);n!==-1&&r.splice(n,1)})}function Ue(t,e){var r=Xt(),n=t.changeListeners_;if(n){n=n.slice();for(var s=0,i=n.length;s<i;s++)n[s](e);bt(r)}}function of(t,e,r){return Dt(function(){var n,s=Jt(t,r)[U];(n=e)!=null||(e=$u(t)),gr(e).forEach(function(i){return s.make_(i,e[i])})}),t}var Yn=Symbol("mobx-keys");function cf(t,e,r){return yt(t)?mo(t,t,e,r):(Dt(function(){var n=Jt(t,r)[U];if(!t[Yn]){var s=Object.getPrototypeOf(t),i=new Set([].concat(gr(t),gr(s)));i.delete("constructor"),i.delete(U),qr(s,Yn,i)}t[Yn].forEach(function(o){return n.make_(o,e&&o in e?e[o]:!0)})}),t)}var Na="splice",at="update",lf=1e4,df={get:function(e,r){var n=e[U];return r===U?n:r==="length"?n.getArrayLength_():typeof r=="string"&&!isNaN(r)?n.get_(parseInt(r)):vt(bn,r)?bn[r]:e[r]},set:function(e,r,n){var s=e[U];return r==="length"&&s.setArrayLength_(n),typeof r=="symbol"||isNaN(r)?e[r]=n:s.set_(parseInt(r),n),!0},preventExtensions:function(){Q(15)}},Rs=function(){function t(r,n,s,i){r===void 0&&(r="ObservableArray"),this.owned_=void 0,this.legacyMode_=void 0,this.atom_=void 0,this.values_=[],this.interceptors_=void 0,this.changeListeners_=void 0,this.enhancer_=void 0,this.dehancer=void 0,this.proxy_=void 0,this.lastKnownLength_=0,this.owned_=s,this.legacyMode_=i,this.atom_=new Rt(r),this.enhancer_=function(o,c){return n(o,c,"ObservableArray[..]")}}var e=t.prototype;return e.dehanceValue_=function(n){return this.dehancer!==void 0?this.dehancer(n):n},e.dehanceValues_=function(n){return this.dehancer!==void 0&&n.length>0?n.map(this.dehancer):n},e.intercept_=function(n){return Kr(this,n)},e.observe_=function(n,s){return s===void 0&&(s=!1),s&&n({observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:"splice",index:0,added:this.values_.slice(),addedCount:this.values_.length,removed:[],removedCount:0}),Xr(this,n)},e.getArrayLength_=function(){return this.atom_.reportObserved(),this.values_.length},e.setArrayLength_=function(n){(typeof n!="number"||isNaN(n)||n<0)&&Q("Out of range: "+n);var s=this.values_.length;if(n!==s)if(n>s){for(var i=new Array(n-s),o=0;o<n-s;o++)i[o]=void 0;this.spliceWithArray_(s,0,i)}else this.spliceWithArray_(n,s-n)},e.updateArrayLength_=function(n,s){n!==this.lastKnownLength_&&Q(16),this.lastKnownLength_+=s,this.legacyMode_&&s>0&&No(n+s+1)},e.spliceWithArray_=function(n,s,i){var o=this;this.atom_;var c=this.values_.length;if(n===void 0?n=0:n>c?n=c:n<0&&(n=Math.max(0,c+n)),arguments.length===1?s=c-n:s==null?s=0:s=Math.max(0,Math.min(s,c-n)),i===void 0&&(i=ls),Ee(this)){var l=Me(this,{object:this.proxy_,type:Na,index:n,removedCount:s,added:i});if(!l)return ls;s=l.removedCount,i=l.added}if(i=i.length===0?i:i.map(function(h){return o.enhancer_(h,void 0)}),this.legacyMode_){var d=i.length-s;this.updateArrayLength_(c,d)}var u=this.spliceItemsIntoValues_(n,s,i);return(s!==0||i.length!==0)&&this.notifyArraySplice_(n,i,u),this.dehanceValues_(u)},e.spliceItemsIntoValues_=function(n,s,i){if(i.length<lf){var o;return(o=this.values_).splice.apply(o,[n,s].concat(i))}else{var c=this.values_.slice(n,n+s),l=this.values_.slice(n+s);this.values_.length+=i.length-s;for(var d=0;d<i.length;d++)this.values_[n+d]=i[d];for(var u=0;u<l.length;u++)this.values_[n+i.length+u]=l[u];return c}},e.notifyArrayChildUpdate_=function(n,s,i){var o=!this.owned_&&Er(),c=Be(this),l=c||o?{observableKind:"array",object:this.proxy_,type:at,debugObjectName:this.atom_.name_,index:n,newValue:s,oldValue:i}:null;this.atom_.reportChanged(),c&&Ue(this,l)},e.notifyArraySplice_=function(n,s,i){var o=!this.owned_&&Er(),c=Be(this),l=c||o?{observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:Na,index:n,removed:i,added:s,removedCount:i.length,addedCount:s.length}:null;this.atom_.reportChanged(),c&&Ue(this,l)},e.get_=function(n){if(this.legacyMode_&&n>=this.values_.length){console.warn("[mobx] Out of bounds read: "+n);return}return this.atom_.reportObserved(),this.dehanceValue_(this.values_[n])},e.set_=function(n,s){var i=this.values_;if(this.legacyMode_&&n>i.length&&Q(17,n,i.length),n<i.length){this.atom_;var o=i[n];if(Ee(this)){var c=Me(this,{type:at,object:this.proxy_,index:n,newValue:s});if(!c)return;s=c.newValue}s=this.enhancer_(s,o);var l=s!==o;l&&(i[n]=s,this.notifyArrayChildUpdate_(n,s,o))}else{for(var d=new Array(n+1-i.length),u=0;u<d.length-1;u++)d[u]=void 0;d[d.length-1]=s,this.spliceWithArray_(i.length,0,d)}},t}();function uf(t,e,r,n){return r===void 0&&(r="ObservableArray"),n===void 0&&(n=!1),Ri(),Dt(function(){var s=new Rs(r,e,n,!1);Fi(s.values_,U,s);var i=new Proxy(s.values_,df);return s.proxy_=i,t&&t.length&&s.spliceWithArray_(0,0,t),i})}var bn={clear:function(){return this.splice(0)},replace:function(e){var r=this[U];return r.spliceWithArray_(0,r.values_.length,e)},toJSON:function(){return this.slice()},splice:function(e,r){for(var n=arguments.length,s=new Array(n>2?n-2:0),i=2;i<n;i++)s[i-2]=arguments[i];var o=this[U];switch(arguments.length){case 0:return[];case 1:return o.spliceWithArray_(e);case 2:return o.spliceWithArray_(e,r)}return o.spliceWithArray_(e,r,s)},spliceWithArray:function(e,r,n){return this[U].spliceWithArray_(e,r,n)},push:function(){for(var e=this[U],r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return e.spliceWithArray_(e.values_.length,0,n),e.values_.length},pop:function(){return this.splice(Math.max(this[U].values_.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var e=this[U],r=arguments.length,n=new Array(r),s=0;s<r;s++)n[s]=arguments[s];return e.spliceWithArray_(0,0,n),e.values_.length},reverse:function(){return C.trackingDerivation&&Q(37,"reverse"),this.replace(this.slice().reverse()),this},sort:function(){C.trackingDerivation&&Q(37,"sort");var e=this.slice();return e.sort.apply(e,arguments),this.replace(e),this},remove:function(e){var r=this[U],n=r.dehanceValues_(r.values_).indexOf(e);return n>-1?(this.splice(n,1),!0):!1}};ae("at",Ae);ae("concat",Ae);ae("flat",Ae);ae("includes",Ae);ae("indexOf",Ae);ae("join",Ae);ae("lastIndexOf",Ae);ae("slice",Ae);ae("toString",Ae);ae("toLocaleString",Ae);ae("toSorted",Ae);ae("toSpliced",Ae);ae("with",Ae);ae("every",Ge);ae("filter",Ge);ae("find",Ge);ae("findIndex",Ge);ae("findLast",Ge);ae("findLastIndex",Ge);ae("flatMap",Ge);ae("forEach",Ge);ae("map",Ge);ae("some",Ge);ae("toReversed",Ge);ae("reduce",bo);ae("reduceRight",bo);function ae(t,e){typeof Array.prototype[t]=="function"&&(bn[t]=e(t))}function Ae(t){return function(){var e=this[U];e.atom_.reportObserved();var r=e.dehanceValues_(e.values_);return r[t].apply(r,arguments)}}function Ge(t){return function(e,r){var n=this,s=this[U];s.atom_.reportObserved();var i=s.dehanceValues_(s.values_);return i[t](function(o,c){return e.call(r,o,c,n)})}}function bo(t){return function(){var e=this,r=this[U];r.atom_.reportObserved();var n=r.dehanceValues_(r.values_),s=arguments[0];return arguments[0]=function(i,o,c){return s(i,o,c,e)},n[t].apply(n,arguments)}}var hf=Kt("ObservableArrayAdministration",Rs);function In(t){return kn(t)&&hf(t[U])}var ff={},kt="add",yn="delete",yo=function(){function t(r,n,s){var i=this;n===void 0&&(n=Gt),s===void 0&&(s="ObservableMap"),this.enhancer_=void 0,this.name_=void 0,this[U]=ff,this.data_=void 0,this.hasMap_=void 0,this.keysAtom_=void 0,this.interceptors_=void 0,this.changeListeners_=void 0,this.dehancer=void 0,this.enhancer_=n,this.name_=s,ze(Map)||Q(18),Dt(function(){i.keysAtom_=Vi("ObservableMap.keys()"),i.data_=new Map,i.hasMap_=new Map,r&&i.merge(r)})}var e=t.prototype;return e.has_=function(n){return this.data_.has(n)},e.has=function(n){var s=this;if(!C.trackingDerivation)return this.has_(n);var i=this.hasMap_.get(n);if(!i){var o=i=new Vt(this.has_(n),An,"ObservableMap.key?",!1);this.hasMap_.set(n,o),ho(o,function(){return s.hasMap_.delete(n)})}return i.get()},e.set=function(n,s){var i=this.has_(n);if(Ee(this)){var o=Me(this,{type:i?at:kt,object:this,newValue:s,name:n});if(!o)return this;s=o.newValue}return i?this.updateValue_(n,s):this.addValue_(n,s),this},e.delete=function(n){var s=this;if(this.keysAtom_,Ee(this)){var i=Me(this,{type:yn,object:this,name:n});if(!i)return!1}if(this.has_(n)){var o=Er(),c=Be(this),l=c||o?{observableKind:"map",debugObjectName:this.name_,type:yn,object:this,oldValue:this.data_.get(n).value_,name:n}:null;return gt(function(){var d;s.keysAtom_.reportChanged(),(d=s.hasMap_.get(n))==null||d.setNewValue_(!1);var u=s.data_.get(n);u.setNewValue_(void 0),s.data_.delete(n)}),c&&Ue(this,l),!0}return!1},e.updateValue_=function(n,s){var i=this.data_.get(n);if(s=i.prepareNewValue_(s),s!==C.UNCHANGED){var o=Er(),c=Be(this),l=c||o?{observableKind:"map",debugObjectName:this.name_,type:at,object:this,oldValue:i.value_,name:n,newValue:s}:null;i.setNewValue_(s),c&&Ue(this,l)}},e.addValue_=function(n,s){var i=this;this.keysAtom_,gt(function(){var d,u=new Vt(s,i.enhancer_,"ObservableMap.key",!1);i.data_.set(n,u),s=u.value_,(d=i.hasMap_.get(n))==null||d.setNewValue_(!0),i.keysAtom_.reportChanged()});var o=Er(),c=Be(this),l=c||o?{observableKind:"map",debugObjectName:this.name_,type:kt,object:this,name:n,newValue:s}:null;c&&Ue(this,l)},e.get=function(n){return this.has(n)?this.dehanceValue_(this.data_.get(n).get()):this.dehanceValue_(void 0)},e.dehanceValue_=function(n){return this.dehancer!==void 0?this.dehancer(n):n},e.keys=function(){return this.keysAtom_.reportObserved(),this.data_.keys()},e.values=function(){var n=this,s=this.keys();return Sa({next:function(){var o=s.next(),c=o.done,l=o.value;return{done:c,value:c?void 0:n.get(l)}}})},e.entries=function(){var n=this,s=this.keys();return Sa({next:function(){var o=s.next(),c=o.done,l=o.value;return{done:c,value:c?void 0:[l,n.get(l)]}}})},e[Symbol.iterator]=function(){return this.entries()},e.forEach=function(n,s){for(var i=ir(this),o;!(o=i()).done;){var c=o.value,l=c[0],d=c[1];n.call(s,d,l,this)}},e.merge=function(n){var s=this;return Qt(n)&&(n=new Map(n)),gt(function(){yt(n)?Tu(n).forEach(function(i){return s.set(i,n[i])}):Array.isArray(n)?n.forEach(function(i){var o=i[0],c=i[1];return s.set(o,c)}):_r(n)?(Mu(n)||Q(19,n),n.forEach(function(i,o){return s.set(o,i)})):n!=null&&Q(20,n)}),this},e.clear=function(){var n=this;gt(function(){Zi(function(){for(var s=ir(n.keys()),i;!(i=s()).done;){var o=i.value;n.delete(o)}})})},e.replace=function(n){var s=this;return gt(function(){for(var i=mf(n),o=new Map,c=!1,l=ir(s.data_.keys()),d;!(d=l()).done;){var u=d.value;if(!i.has(u)){var h=s.delete(u);if(h)c=!0;else{var f=s.data_.get(u);o.set(u,f)}}}for(var g=ir(i.entries()),b;!(b=g()).done;){var p=b.value,y=p[0],x=p[1],m=s.data_.has(y);if(s.set(y,x),s.data_.has(y)){var N=s.data_.get(y);o.set(y,N),m||(c=!0)}}if(!c)if(s.data_.size!==o.size)s.keysAtom_.reportChanged();else for(var S=s.data_.keys(),A=o.keys(),B=S.next(),q=A.next();!B.done;){if(B.value!==q.value){s.keysAtom_.reportChanged();break}B=S.next(),q=A.next()}s.data_=o}),this},e.toString=function(){return"[object ObservableMap]"},e.toJSON=function(){return Array.from(this)},e.observe_=function(n,s){return Xr(this,n)},e.intercept_=function(n){return Kr(this,n)},jr(t,[{key:"size",get:function(){return this.keysAtom_.reportObserved(),this.data_.size}},{key:Symbol.toStringTag,get:function(){return"Map"}}])}(),Qt=Kt("ObservableMap",yo);function Sa(t){return t[Symbol.toStringTag]="MapIterator",Fs(t)}function mf(t){if(_r(t)||Qt(t))return t;if(Array.isArray(t))return new Map(t);if(yt(t)){var e=new Map;for(var r in t)e.set(r,t[r]);return e}else return Q(21,t)}var gf={},xo=function(){function t(r,n,s){var i=this;n===void 0&&(n=Gt),s===void 0&&(s="ObservableSet"),this.name_=void 0,this[U]=gf,this.data_=new Set,this.atom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.dehancer=void 0,this.enhancer_=void 0,this.name_=s,ze(Set)||Q(22),this.enhancer_=function(o,c){return n(o,c,s)},Dt(function(){i.atom_=Vi(i.name_),r&&i.replace(r)})}var e=t.prototype;return e.dehanceValue_=function(n){return this.dehancer!==void 0?this.dehancer(n):n},e.clear=function(){var n=this;gt(function(){Zi(function(){for(var s=ir(n.data_.values()),i;!(i=s()).done;){var o=i.value;n.delete(o)}})})},e.forEach=function(n,s){for(var i=ir(this),o;!(o=i()).done;){var c=o.value;n.call(s,c,c,this)}},e.add=function(n){var s=this;if(this.atom_,Ee(this)){var i=Me(this,{type:kt,object:this,newValue:n});if(!i)return this}if(!this.has(n)){gt(function(){s.data_.add(s.enhancer_(n,void 0)),s.atom_.reportChanged()});var o=!1,c=Be(this),l=c||o?{observableKind:"set",debugObjectName:this.name_,type:kt,object:this,newValue:n}:null;c&&Ue(this,l)}return this},e.delete=function(n){var s=this;if(Ee(this)){var i=Me(this,{type:yn,object:this,oldValue:n});if(!i)return!1}if(this.has(n)){var o=!1,c=Be(this),l=c||o?{observableKind:"set",debugObjectName:this.name_,type:yn,object:this,oldValue:n}:null;return gt(function(){s.atom_.reportChanged(),s.data_.delete(n)}),c&&Ue(this,l),!0}return!1},e.has=function(n){return this.atom_.reportObserved(),this.data_.has(this.dehanceValue_(n))},e.entries=function(){var n=0,s=Array.from(this.keys()),i=Array.from(this.values());return Oa({next:function(){var c=n;return n+=1,c<i.length?{value:[s[c],i[c]],done:!1}:{value:void 0,done:!0}}})},e.keys=function(){return this.values()},e.values=function(){this.atom_.reportObserved();var n=this,s=0,i=Array.from(this.data_.values());return Oa({next:function(){return s<i.length?{value:n.dehanceValue_(i[s++]),done:!1}:{value:void 0,done:!0}}})},e.intersection=function(n){if(mt(n)&&!tt(n))return n.intersection(this);var s=new Set(this);return s.intersection(n)},e.union=function(n){if(mt(n)&&!tt(n))return n.union(this);var s=new Set(this);return s.union(n)},e.difference=function(n){return new Set(this).difference(n)},e.symmetricDifference=function(n){if(mt(n)&&!tt(n))return n.symmetricDifference(this);var s=new Set(this);return s.symmetricDifference(n)},e.isSubsetOf=function(n){return new Set(this).isSubsetOf(n)},e.isSupersetOf=function(n){return new Set(this).isSupersetOf(n)},e.isDisjointFrom=function(n){if(mt(n)&&!tt(n))return n.isDisjointFrom(this);var s=new Set(this);return s.isDisjointFrom(n)},e.replace=function(n){var s=this;return tt(n)&&(n=new Set(n)),gt(function(){Array.isArray(n)?(s.clear(),n.forEach(function(i){return s.add(i)})):mt(n)?(s.clear(),n.forEach(function(i){return s.add(i)})):n!=null&&Q("Cannot initialize set from "+n)}),this},e.observe_=function(n,s){return Xr(this,n)},e.intercept_=function(n){return Kr(this,n)},e.toJSON=function(){return Array.from(this)},e.toString=function(){return"[object ObservableSet]"},e[Symbol.iterator]=function(){return this.values()},jr(t,[{key:"size",get:function(){return this.atom_.reportObserved(),this.data_.size}},{key:Symbol.toStringTag,get:function(){return"Set"}}])}(),tt=Kt("ObservableSet",xo);function Oa(t){return t[Symbol.toStringTag]="SetIterator",Fs(t)}var Ca=Object.create(null),Pa="remove",wo=function(){function t(r,n,s,i){n===void 0&&(n=new Map),i===void 0&&(i=uh),this.target_=void 0,this.values_=void 0,this.name_=void 0,this.defaultAnnotation_=void 0,this.keysAtom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.proxy_=void 0,this.isPlainObject_=void 0,this.appliedAnnotations_=void 0,this.pendingKeys_=void 0,this.target_=r,this.values_=n,this.name_=s,this.defaultAnnotation_=i,this.keysAtom_=new Rt("ObservableObject.keys"),this.isPlainObject_=yt(this.target_)}var e=t.prototype;return e.getObservablePropValue_=function(n){return this.values_.get(n).get()},e.setObservablePropValue_=function(n,s){var i=this.values_.get(n);if(i instanceof We)return i.set(s),!0;if(Ee(this)){var o=Me(this,{type:at,object:this.proxy_||this.target_,name:n,newValue:s});if(!o)return null;s=o.newValue}if(s=i.prepareNewValue_(s),s!==C.UNCHANGED){var c=Be(this),l=!1,d=c||l?{type:at,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,oldValue:i.value_,name:n,newValue:s}:null;i.setNewValue_(s),c&&Ue(this,d)}return!0},e.get_=function(n){return C.trackingDerivation&&!vt(this.target_,n)&&this.has_(n),this.target_[n]},e.set_=function(n,s,i){return i===void 0&&(i=!1),vt(this.target_,n)?this.values_.has(n)?this.setObservablePropValue_(n,s):i?Reflect.set(this.target_,n,s):(this.target_[n]=s,!0):this.extend_(n,{value:s,enumerable:!0,writable:!0,configurable:!0},this.defaultAnnotation_,i)},e.has_=function(n){if(!C.trackingDerivation)return n in this.target_;this.pendingKeys_||(this.pendingKeys_=new Map);var s=this.pendingKeys_.get(n);return s||(s=new Vt(n in this.target_,An,"ObservableObject.key?",!1),this.pendingKeys_.set(n,s)),s.get()},e.make_=function(n,s){if(s===!0&&(s=this.defaultAnnotation_),s!==!1){if(!(n in this.target_)){var i;if((i=this.target_[rt])!=null&&i[n])return;Q(1,s.annotationType_,this.name_+"."+n.toString())}for(var o=this.target_;o&&o!==Pn;){var c=hn(o,n);if(c){var l=s.make_(this,n,c,o);if(l===0)return;if(l===1)break}o=Object.getPrototypeOf(o)}Aa(this,s,n)}},e.extend_=function(n,s,i,o){if(o===void 0&&(o=!1),i===!0&&(i=this.defaultAnnotation_),i===!1)return this.defineProperty_(n,s,o);var c=i.extend_(this,n,s,o);return c&&Aa(this,i,n),c},e.defineProperty_=function(n,s,i){i===void 0&&(i=!1),this.keysAtom_;try{Te();var o=this.delete_(n);if(!o)return o;if(Ee(this)){var c=Me(this,{object:this.proxy_||this.target_,name:n,type:kt,newValue:s.value});if(!c)return null;var l=c.newValue;s.value!==l&&(s=qt({},s,{value:l}))}if(i){if(!Reflect.defineProperty(this.target_,n,s))return!1}else nt(this.target_,n,s);this.notifyPropertyAddition_(n,s.value)}finally{Ie()}return!0},e.defineObservableProperty_=function(n,s,i,o){o===void 0&&(o=!1),this.keysAtom_;try{Te();var c=this.delete_(n);if(!c)return c;if(Ee(this)){var l=Me(this,{object:this.proxy_||this.target_,name:n,type:kt,newValue:s});if(!l)return null;s=l.newValue}var d=ka(n),u={configurable:C.safeDescriptors?this.isPlainObject_:!0,enumerable:!0,get:d.get,set:d.set};if(o){if(!Reflect.defineProperty(this.target_,n,u))return!1}else nt(this.target_,n,u);var h=new Vt(s,i,"ObservableObject.key",!1);this.values_.set(n,h),this.notifyPropertyAddition_(n,h.value_)}finally{Ie()}return!0},e.defineComputedProperty_=function(n,s,i){i===void 0&&(i=!1),this.keysAtom_;try{Te();var o=this.delete_(n);if(!o)return o;if(Ee(this)){var c=Me(this,{object:this.proxy_||this.target_,name:n,type:kt,newValue:void 0});if(!c)return null}s.name||(s.name="ObservableObject.key"),s.context=this.proxy_||this.target_;var l=ka(n),d={configurable:C.safeDescriptors?this.isPlainObject_:!0,enumerable:!1,get:l.get,set:l.set};if(i){if(!Reflect.defineProperty(this.target_,n,d))return!1}else nt(this.target_,n,d);this.values_.set(n,new We(s)),this.notifyPropertyAddition_(n,void 0)}finally{Ie()}return!0},e.delete_=function(n,s){if(s===void 0&&(s=!1),this.keysAtom_,!vt(this.target_,n))return!0;if(Ee(this)){var i=Me(this,{object:this.proxy_||this.target_,name:n,type:Pa});if(!i)return null}try{var o;Te();var c=Be(this),l=!1,d=this.values_.get(n),u=void 0;if(!d&&(c||l)){var h;u=(h=hn(this.target_,n))==null?void 0:h.value}if(s){if(!Reflect.deleteProperty(this.target_,n))return!1}else delete this.target_[n];if(d&&(this.values_.delete(n),d instanceof Vt&&(u=d.value_),ao(d)),this.keysAtom_.reportChanged(),(o=this.pendingKeys_)==null||(o=o.get(n))==null||o.set(n in this.target_),c||l){var f={type:Pa,observableKind:"object",object:this.proxy_||this.target_,debugObjectName:this.name_,oldValue:u,name:n};c&&Ue(this,f)}}finally{Ie()}return!0},e.observe_=function(n,s){return Xr(this,n)},e.intercept_=function(n){return Kr(this,n)},e.notifyPropertyAddition_=function(n,s){var i,o=Be(this),c=!1;if(o||c){var l=o||c?{type:kt,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,name:n,newValue:s}:null;o&&Ue(this,l)}(i=this.pendingKeys_)==null||(i=i.get(n))==null||i.set(!0),this.keysAtom_.reportChanged()},e.ownKeys_=function(){return this.keysAtom_.reportObserved(),gr(this.target_)},e.keys_=function(){return this.keysAtom_.reportObserved(),Object.keys(this.target_)},t}();function Jt(t,e){var r;if(vt(t,U))return t;var n=(r=e==null?void 0:e.name)!=null?r:"ObservableObject",s=new wo(t,new Map,String(n),_h(e));return qr(t,U,s),t}var pf=Kt("ObservableObjectAdministration",wo);function ka(t){return Ca[t]||(Ca[t]={get:function(){return this[U].getObservablePropValue_(t)},set:function(r){return this[U].setObservablePropValue_(t,r)}})}function Rn(t){return kn(t)?pf(t[U]):!1}function Aa(t,e,r){var n;(n=t.target_[rt])==null||delete n[r]}var vf=jo(0),bf=function(){var t=!1,e={};return Object.defineProperty(e,"0",{set:function(){t=!0}}),Object.create(e)[0]=1,t===!1}(),Kn=0,_o=function(){};function yf(t,e){Object.setPrototypeOf?Object.setPrototypeOf(t.prototype,e):t.prototype.__proto__!==void 0?t.prototype.__proto__=e:t.prototype=e}yf(_o,Array.prototype);var Ds=function(t){function e(n,s,i,o){var c;return i===void 0&&(i="ObservableArray"),o===void 0&&(o=!1),c=t.call(this)||this,Dt(function(){var l=new Rs(i,s,o,!0);l.proxy_=c,Fi(c,U,l),n&&n.length&&c.spliceWithArray(0,0,n),bf&&Object.defineProperty(c,"0",vf)}),c}Ui(e,t);var r=e.prototype;return r.concat=function(){this[U].atom_.reportObserved();for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return Array.prototype.concat.apply(this.slice(),i.map(function(c){return In(c)?c.slice():c}))},r[Symbol.iterator]=function(){var n=this,s=0;return Fs({next:function(){return s<n.length?{value:n[s++],done:!1}:{done:!0,value:void 0}}})},jr(e,[{key:"length",get:function(){return this[U].getArrayLength_()},set:function(s){this[U].setArrayLength_(s)}},{key:Symbol.toStringTag,get:function(){return"Array"}}])}(_o);Object.entries(bn).forEach(function(t){var e=t[0],r=t[1];e!=="concat"&&qr(Ds.prototype,e,r)});function jo(t){return{enumerable:!1,configurable:!0,get:function(){return this[U].get_(t)},set:function(r){this[U].set_(t,r)}}}function xf(t){nt(Ds.prototype,""+t,jo(t))}function No(t){if(t>Kn){for(var e=Kn;e<t+100;e++)xf(e);Kn=t}}No(1e3);function wf(t,e,r){return new Ds(t,e,r)}function xn(t,e){if(typeof t=="object"&&t!==null){if(In(t))return e!==void 0&&Q(23),t[U].atom_;if(tt(t))return t.atom_;if(Qt(t)){if(e===void 0)return t.keysAtom_;var r=t.data_.get(e)||t.hasMap_.get(e);return r||Q(25,e,bs(t)),r}if(Rn(t)){if(!e)return Q(26);var n=t[U].values_.get(e);return n||Q(27,e,bs(t)),n}if(As(t)||Tn(t)||vn(t))return t}else if(ze(t)&&vn(t[U]))return t[U];Q(28)}function _f(t,e){if(t||Q(29),As(t)||Tn(t)||vn(t)||Qt(t)||tt(t))return t;if(t[U])return t[U];Q(24,t)}function bs(t,e){var r;if(e!==void 0)r=xn(t,e);else{if(Rr(t))return t.name;Rn(t)||Qt(t)||tt(t)?r=_f(t):r=xn(t)}return r.name_}function Dt(t){var e=Xt(),r=Ms(!0);Te();try{return t()}finally{Ie(),Ts(r),bt(e)}}var Ea=Pn.toString;function Ls(t,e,r){return r===void 0&&(r=-1),ys(t,e,r)}function ys(t,e,r,n,s){if(t===e)return t!==0||1/t===1/e;if(t==null||e==null)return!1;if(t!==t)return e!==e;var i=typeof t;if(i!=="function"&&i!=="object"&&typeof e!="object")return!1;var o=Ea.call(t);if(o!==Ea.call(e))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:+t==0?1/+t===1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object Symbol]":return typeof Symbol<"u"&&Symbol.valueOf.call(t)===Symbol.valueOf.call(e);case"[object Map]":case"[object Set]":r>=0&&r++;break}t=Ma(t),e=Ma(e);var c=o==="[object Array]";if(!c){if(typeof t!="object"||typeof e!="object")return!1;var l=t.constructor,d=e.constructor;if(l!==d&&!(ze(l)&&l instanceof l&&ze(d)&&d instanceof d)&&"constructor"in t&&"constructor"in e)return!1}if(r===0)return!1;r<0&&(r=-1),n=n||[],s=s||[];for(var u=n.length;u--;)if(n[u]===t)return s[u]===e;if(n.push(t),s.push(e),c){if(u=t.length,u!==e.length)return!1;for(;u--;)if(!ys(t[u],e[u],r-1,n,s))return!1}else{var h=Object.keys(t),f;if(u=h.length,Object.keys(e).length!==u)return!1;for(;u--;)if(f=h[u],!(vt(e,f)&&ys(t[f],e[f],r-1,n,s)))return!1}return n.pop(),s.pop(),!0}function Ma(t){return In(t)?t.slice():_r(t)||Qt(t)||mt(t)||tt(t)?Array.from(t.entries()):t}var Ta,jf=((Ta=Cn().Iterator)==null?void 0:Ta.prototype)||{};function Fs(t){return t[Symbol.iterator]=Nf,Object.assign(Object.create(jf),t)}function Nf(){return this}["Symbol","Map","Set"].forEach(function(t){var e=Cn();typeof e[t]>"u"&&Q("MobX requires global '"+t+"' to be available or polyfilled")});typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__=="object"&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:$h,extras:{getDebugName:bs},$mobx:U});if(!w.useState)throw new Error("mobx-react-lite requires React with Hooks support");if(!of)throw new Error("mobx-react-lite@3 requires mobx at least version 6 to be available");function Sf(t){t()}function Of(t){t||(t=Sf),Jh({reactionScheduler:t})}function Cf(t){return Zh(t)}var Pf=1e4,kf=1e4,Af=function(){function t(e){var r=this;Object.defineProperty(this,"finalize",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"registrations",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"sweepTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sweep",{enumerable:!0,configurable:!0,writable:!0,value:function(n){n===void 0&&(n=Pf),clearTimeout(r.sweepTimeout),r.sweepTimeout=void 0;var s=Date.now();r.registrations.forEach(function(i,o){s-i.registeredAt>=n&&(r.finalize(i.value),r.registrations.delete(o))}),r.registrations.size>0&&r.scheduleSweep()}}),Object.defineProperty(this,"finalizeAllImmediately",{enumerable:!0,configurable:!0,writable:!0,value:function(){r.sweep(0)}})}return Object.defineProperty(t.prototype,"register",{enumerable:!1,configurable:!0,writable:!0,value:function(e,r,n){this.registrations.set(n,{value:r,registeredAt:Date.now()}),this.scheduleSweep()}}),Object.defineProperty(t.prototype,"unregister",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this.registrations.delete(e)}}),Object.defineProperty(t.prototype,"scheduleSweep",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.sweepTimeout===void 0&&(this.sweepTimeout=setTimeout(this.sweep,kf))}}),t}(),Ef=typeof FinalizationRegistry<"u"?FinalizationRegistry:Af,xs=new Ef(function(t){var e;(e=t.reaction)===null||e===void 0||e.dispose(),t.reaction=null}),So={exports:{}},Oo={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vr=w;function Mf(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Tf=typeof Object.is=="function"?Object.is:Mf,If=vr.useState,Rf=vr.useEffect,Df=vr.useLayoutEffect,Lf=vr.useDebugValue;function Ff(t,e){var r=e(),n=If({inst:{value:r,getSnapshot:e}}),s=n[0].inst,i=n[1];return Df(function(){s.value=r,s.getSnapshot=e,Xn(s)&&i({inst:s})},[t,r,e]),Rf(function(){return Xn(s)&&i({inst:s}),t(function(){Xn(s)&&i({inst:s})})},[t]),Lf(r),r}function Xn(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!Tf(t,r)}catch{return!0}}function $f(t,e){return e()}var Bf=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?$f:Ff;Oo.useSyncExternalStore=vr.useSyncExternalStore!==void 0?vr.useSyncExternalStore:Bf;So.exports=Oo;var Uf=So.exports;function Ia(t){t.reaction=new xt("observer".concat(t.name),function(){var e;t.stateVersion=Symbol(),(e=t.onStoreChange)===null||e===void 0||e.call(t)})}function Vf(t,e){e===void 0&&(e="observed");var r=dn.useRef(null);if(!r.current){var n={reaction:null,onStoreChange:null,stateVersion:Symbol(),name:e,subscribe:function(c){return xs.unregister(n),n.onStoreChange=c,n.reaction||(Ia(n),n.stateVersion=Symbol()),function(){var l;n.onStoreChange=null,(l=n.reaction)===null||l===void 0||l.dispose(),n.reaction=null}},getSnapshot:function(){return n.stateVersion}};r.current=n}var s=r.current;s.reaction||(Ia(s),xs.register(r,s,s)),dn.useDebugValue(s.reaction,Cf),Uf.useSyncExternalStore(s.subscribe,s.getSnapshot,s.getSnapshot);var i,o;if(s.reaction.track(function(){try{i=t()}catch(c){o=c}}),o)throw o;return i}var Qn,Jn,Co=typeof Symbol=="function"&&Symbol.for,zf=(Jn=(Qn=Object.getOwnPropertyDescriptor(function(){},"name"))===null||Qn===void 0?void 0:Qn.configurable)!==null&&Jn!==void 0?Jn:!1,Ra=Co?Symbol.for("react.forward_ref"):typeof w.forwardRef=="function"&&w.forwardRef(function(t){return null}).$$typeof,Da=Co?Symbol.for("react.memo"):typeof w.memo=="function"&&w.memo(function(t){return null}).$$typeof;function Wf(t,e){var r;if(Da&&t.$$typeof===Da)throw new Error("[mobx-react-lite] You are trying to use `observer` on a function component wrapped in either another `observer` or `React.memo`. The observer already applies 'React.memo' for you.");var n=(r=void 0)!==null&&r!==void 0?r:!1,s=t,i=t.displayName||t.name;if(Ra&&t.$$typeof===Ra&&(n=!0,s=t.render,typeof s!="function"))throw new Error("[mobx-react-lite] `render` property of ForwardRef was not a function");var o=function(c,l){return Vf(function(){return s(c,l)},i)};return o.displayName=t.displayName,zf&&Object.defineProperty(o,"name",{value:t.name,writable:!0,configurable:!0}),t.contextTypes&&(o.contextTypes=t.contextTypes),n&&(o=w.forwardRef(o)),o=w.memo(o),Gf(t,o),o}var qf={$$typeof:!0,render:!0,compare:!0,type:!0,displayName:!0};function Gf(t,e){Object.keys(t).forEach(function(r){qf[r]||Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}var Zn;Of(hi.unstable_batchedUpdates);Zn=xs.finalizeAllImmediately;function D({children:t,className:e,isSelected:r,onClick:n}){return a.jsx("div",{className:je("rounded-lg transition-all duration-200 h-full",r?"border-2 border-blue-500 shadow-sm ring-2 ring-blue-100 bg-blue-50":"border border-gray-200 shadow-sm hover:border-gray-300 hover:shadow bg-gradient-to-br from-slate-50 to-gray-50",n&&"cursor-pointer",e),onClick:n,children:t})}D.Header=function({children:e,className:r}){return a.jsx("div",{className:je("p-3 sm:p-4 space-y-2",r),children:e})};D.Content=function({children:e,className:r}){return a.jsx("div",{className:je("px-3 sm:px-4 pb-3 sm:pb-4",r),children:e})};D.Footer=function({children:e,className:r}){return a.jsx("div",{className:je("px-3 sm:px-4 py-2 sm:py-3 border-t bg-white/50 rounded-b-lg",r),children:e})};D.Title=function({children:e,className:r}){return a.jsx("h3",{className:je("text-base sm:text-lg font-semibold text-gray-900 line-clamp-2",r),children:e})};D.Grid=function({children:e,className:r}){return a.jsx("div",{className:je("grid grid-cols-2 gap-2 text-sm text-gray-600",r),children:e})};const es=Symbol.for("@inversifyjs/common/islazyServiceIdentifier");var ti,Lr,ri;let Hf=(ti=es,ri=class{constructor(e){I(this,ti);lt(this,Lr);Qe(this,Lr,e),this[es]=!0}static is(e){return typeof e=="object"&&e!==null&&e[es]===!0}unwrap(){return ne(this,Lr).call(this)}},Lr=new WeakMap,ri);function wt(t,e){return Reflect.getMetadata(e,t)}function La(t,e,r,n){const s=n(wt(t,e)??r);Reflect.defineMetadata(e,s,t)}const Dn="named",$s="name",Bs="unmanaged",Us="optional",Vs="inject",zs="multi_inject",Po="post_construct",ko="pre_destroy",Yf=[Vs,zs,$s,Bs,Dn,Us],ts=Symbol.for("@inversifyjs/core/InversifyCoreError");var ni,si;let Yt=class Ao extends(si=Error,ni=ts,si){constructor(r,n,s){super(n,s);I(this,ni);I(this,"kind");this[ts]=!0,this.kind=r}static is(r){return typeof r=="object"&&r!==null&&r[ts]===!0}static isErrorOfKind(r,n){return Ao.is(r)&&r.kind===n}};var _t,Ce;function Eo(t,e){const r=[];for(let n=0;n<e.length;++n)e[n]===void 0&&r.push(n);if(r.length>0)throw new Yt(_t.missingInjectionDecorator,`Found unexpected missing metadata on type "${t.name}" at constructor indexes "${r.join('", "')}".

Are you using @inject, @multiInject or @unmanaged decorators at those indexes?

If you're using typescript and want to rely on auto injection, set "emitDecoratorMetadata" compiler option to true`)}function Mo(t){return{kind:Ce.singleInjection,name:void 0,optional:!1,tags:new Map,targetName:void 0,value:t}}function Ln(t){const e=t.find(o=>o.key===Vs),r=t.find(o=>o.key===zs);if(t.find(o=>o.key===Bs)!==void 0)return function(o,c){if(c!==void 0||o!==void 0)throw new Yt(_t.missingInjectionDecorator,"Expected a single @inject, @multiInject or @unmanaged metadata");return{kind:Ce.unmanaged}}(e,r);if(r===void 0&&e===void 0)throw new Yt(_t.missingInjectionDecorator,"Expected @inject, @multiInject or @unmanaged metadata");const n=t.find(o=>o.key===Dn),s=t.find(o=>o.key===Us),i=t.find(o=>o.key===$s);return{kind:e===void 0?Ce.multipleInjection:Ce.singleInjection,name:n==null?void 0:n.value,optional:s!==void 0,tags:new Map(t.filter(o=>Yf.every(c=>o.key!==c)).map(o=>[o.key,o.value])),targetName:i==null?void 0:i.value,value:e===void 0?r==null?void 0:r.value:e.value}}function To(t,e,r){try{return Ln(r)}catch(n){throw Yt.isErrorOfKind(n,_t.missingInjectionDecorator)?new Yt(_t.missingInjectionDecorator,`Expected a single @inject, @multiInject or @unmanaged decorator at type "${t.name}" at constructor arguments at index "${e.toString()}"`,{cause:n}):n}}function Kf(t){const e=wt(t,"design:paramtypes"),r=wt(t,"inversify:tagged"),n=[];if(r!==void 0)for(const[s,i]of Object.entries(r)){const o=parseInt(s);n[o]=To(t,o,i)}if(e!==void 0){for(let s=0;s<e.length;++s)if(n[s]===void 0){const i=e[s];n[s]=Mo(i)}}return Eo(t,n),n}function Io(t,e,r){try{return Ln(r)}catch(n){throw Yt.isErrorOfKind(n,_t.missingInjectionDecorator)?new Yt(_t.missingInjectionDecorator,`Expected a single @inject, @multiInject or @unmanaged decorator at type "${t.name}" at property "${e.toString()}"`,{cause:n}):n}}function Ro(t){const e=wt(t,"inversify:tagged_props"),r=new Map;if(e!==void 0)for(const n of Reflect.ownKeys(e)){const s=e[n];r.set(n,Io(t,n,s))}return r}function Xf(t){const e=wt(t,Po),r=wt(t,ko);return{constructorArguments:Kf(t),lifecycle:{postConstructMethodName:e==null?void 0:e.value,preDestroyMethodName:r==null?void 0:r.value},properties:Ro(t)}}function Qf(t,e){const r=e.getConstructorMetadata(t),n=[];for(const[s,i]of Object.entries(r.userGeneratedMetadata)){const o=parseInt(s);n[o]=To(t,o,i)}if(r.compilerGeneratedMetadata!==void 0){for(let s=0;s<r.compilerGeneratedMetadata.length;++s)if(n[s]===void 0){const i=r.compilerGeneratedMetadata[s];n[s]=Mo(i)}}return Eo(t,n),n}function Do(t,e){const r=e.getPropertiesMetadata(t),n=new Map;for(const s of Reflect.ownKeys(r)){const i=r[s];n.set(s,Io(t,s,i))}return n}function Jf(t,e){const r=wt(t,Po),n=wt(t,ko);return{constructorArguments:Qf(t,e),lifecycle:{postConstructMethodName:r==null?void 0:r.value,preDestroyMethodName:n==null?void 0:n.value},properties:Do(t,e)}}function Fa(t){const e=Object.getPrototypeOf(t.prototype);return e==null?void 0:e.constructor}function Zf(t){return t.kind===Ce.unmanaged?[{key:Bs,value:!0}]:function(e){const r=[em(e)];e.name!==void 0&&r.push({key:Dn,value:e.name}),e.optional&&r.push({key:Us,value:!0});for(const[n,s]of e.tags)r.push({key:n,value:s});return e.targetName!==void 0&&r.push({key:$s,value:e.targetName}),r}(t)}function em(t){let e;switch(t.kind){case Ce.multipleInjection:e={key:zs,value:t.value};break;case Ce.singleInjection:e={key:Vs,value:t.value}}return e}(function(t){t[t.injectionDecoratorConflict=0]="injectionDecoratorConflict",t[t.missingInjectionDecorator=1]="missingInjectionDecorator",t[t.planning=2]="planning",t[t.unknown=3]="unknown"})(_t||(_t={})),function(t){t[t.multipleInjection=0]="multipleInjection",t[t.singleInjection=1]="singleInjection",t[t.unmanaged=2]="unmanaged"}(Ce||(Ce={}));var ft,ai;let tm=(ai=class{constructor(e){lt(this,ft);Qe(this,ft,e)}startsWith(e){return ne(this,ft).startsWith(e)}endsWith(e){return ne(this,ft).endsWith(e)}contains(e){return ne(this,ft).includes(e)}equals(e){return ne(this,ft)===e}value(){return ne(this,ft)}},ft=new WeakMap,ai);const rs="@inversifyjs/core/targetId";var be,Fr,$r,Ut,Br,Ur;class wn{constructor(e,r,n){lt(this,be);lt(this,Fr);lt(this,$r);lt(this,Ut);lt(this,Br);lt(this,Ur);Qe(this,Fr,function(){const s=wt(Object,rs)??0;return s===Number.MAX_SAFE_INTEGER?La(Object,rs,s,()=>Number.MIN_SAFE_INTEGER):La(Object,rs,s,i=>i+1),s}()),Qe(this,$r,e),Qe(this,Ut,void 0),Qe(this,be,r),Qe(this,Br,new tm(typeof e=="string"?e:e.toString().slice(7,-1))),Qe(this,Ur,n)}get id(){return ne(this,Fr)}get identifier(){return ne(this,$r)}get metadata(){return ne(this,Ut)===void 0&&Qe(this,Ut,Zf(ne(this,be))),ne(this,Ut)}get name(){return ne(this,Br)}get type(){return ne(this,Ur)}get serviceIdentifier(){return Hf.is(ne(this,be).value)?ne(this,be).value.unwrap():ne(this,be).value}getCustomTags(){return[...ne(this,be).tags.entries()].map(([e,r])=>({key:e,value:r}))}getNamedTag(){return ne(this,be).name===void 0?null:{key:Dn,value:ne(this,be).name}}hasTag(e){return this.metadata.some(r=>r.key===e)}isArray(){return ne(this,be).kind===Ce.multipleInjection}isNamed(){return ne(this,be).name!==void 0}isOptional(){return ne(this,be).optional}isTagged(){return ne(this,be).tags.size>0}matchesArray(e){return this.isArray()&&ne(this,be).value===e}matchesNamedTag(e){return ne(this,be).name===e}matchesTag(e){return r=>this.metadata.some(n=>n.key===e&&n.value===r)}}be=new WeakMap,Fr=new WeakMap,$r=new WeakMap,Ut=new WeakMap,Br=new WeakMap,Ur=new WeakMap;const Lo=t=>function(e,r){return function(n){const s=e(n);let i=Fa(n);for(;i!==void 0&&i!==Object;){const c=r(i);for(const[l,d]of c)s.properties.has(l)||s.properties.set(l,d);i=Fa(i)}const o=[];for(const c of s.constructorArguments)if(c.kind!==Ce.unmanaged){const l=c.targetName??"";o.push(new wn(l,c,"ConstructorArgument"))}for(const[c,l]of s.properties)if(l.kind!==Ce.unmanaged){const d=l.targetName??c;o.push(new wn(d,l,"ClassProperty"))}return o}}(t===void 0?Xf:e=>Jf(e,t),t===void 0?Ro:e=>Do(e,t)),$e="named",rm="unmanaged",nm="optional",sm="inject",am="multi_inject",im="inversify:tagged",om="inversify:tagged_props",cm="design:paramtypes",$a="post_construct",ws="pre_destroy",he={Request:"Request",Singleton:"Singleton",Transient:"Transient"},se={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"},Fo={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};let lm=0;function Fn(){return lm++}class Ws{constructor(e,r){I(this,"id");I(this,"moduleId");I(this,"activated");I(this,"serviceIdentifier");I(this,"implementationType");I(this,"cache");I(this,"dynamicValue");I(this,"scope");I(this,"type");I(this,"factory");I(this,"provider");I(this,"constraint");I(this,"onActivation");I(this,"onDeactivation");this.id=Fn(),this.activated=!1,this.serviceIdentifier=e,this.scope=r,this.type=se.Invalid,this.constraint=n=>!0,this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.onDeactivation=null,this.dynamicValue=null}clone(){const e=new Ws(this.serviceIdentifier,this.scope);return e.activated=e.scope===he.Singleton&&this.activated,e.implementationType=this.implementationType,e.dynamicValue=this.dynamicValue,e.scope=this.scope,e.type=this.type,e.factory=this.factory,e.provider=this.provider,e.constraint=this.constraint,e.onActivation=this.onActivation,e.onDeactivation=this.onDeactivation,e.cache=this.cache,e}}const Ba="NULL argument",Ua="Key Not Found",dm="Ambiguous match found for serviceIdentifier:",um="No matching bindings found for serviceIdentifier:",_s=(t,e)=>`onDeactivation() error in class ${t}: ${e}`;class hm{getConstructorMetadata(e){return{compilerGeneratedMetadata:Reflect.getMetadata(cm,e)??[],userGeneratedMetadata:Reflect.getMetadata(im,e)??{}}}getPropertiesMetadata(e){return Reflect.getMetadata(om,e)??{}}}var cr;function $o(t){return t instanceof RangeError||t.message==="Maximum call stack size exceeded"}(function(t){t[t.MultipleBindingsAvailable=2]="MultipleBindingsAvailable",t[t.NoBindingsAvailable=0]="NoBindingsAvailable",t[t.OnlyOneBindingAvailable=1]="OnlyOneBindingAvailable"})(cr||(cr={}));function Et(t){return typeof t=="function"?t.name:typeof t=="symbol"?t.toString():t}function Va(t,e,r){let n="";const s=r(t,e);return s.length!==0&&(n=`
Registered bindings:`,s.forEach(i=>{let o="Object";i.implementationType!==null&&(o=Vo(i.implementationType)),n=`${n}
 ${o}`,i.constraint.metaData&&(n=`${n} - ${i.constraint.metaData}`)})),n}function Bo(t,e){return t.parentRequest!==null&&(t.parentRequest.serviceIdentifier===e||Bo(t.parentRequest,e))}function Uo(t){t.childRequests.forEach(e=>{if(Bo(t,e.serviceIdentifier)){const r=function(n){return function i(o,c=[]){const l=Et(o.serviceIdentifier);return c.push(l),o.parentRequest!==null?i(o.parentRequest,c):c}(n).reverse().join(" --> ")}(e);throw new Error(`Circular dependency found: ${r}`)}Uo(e)})}function Vo(t){if(t.name!=null&&t.name!=="")return t.name;{const e=t.toString(),r=e.match(/^function\s*([^\s(]+)/);return r===null?`Anonymous function: ${e}`:r[1]}}function za(t){return`{"key":"${t.key.toString()}","value":"${t.value.toString()}"}`}class zo{constructor(e){I(this,"id");I(this,"container");I(this,"plan");I(this,"currentRequest");this.id=Fn(),this.container=e}addPlan(e){this.plan=e}setCurrentRequest(e){this.currentRequest=e}}class cn{constructor(e,r){I(this,"key");I(this,"value");this.key=e,this.value=r}toString(){return this.key===$e?`named: ${String(this.value).toString()} `:`tagged: { key:${this.key.toString()}, value: ${String(this.value)} }`}}class fm{constructor(e,r){I(this,"parentContext");I(this,"rootRequest");this.parentContext=e,this.rootRequest=r}}function Wo(t,e){const r=function(c){const l=Object.getPrototypeOf(c.prototype);return l==null?void 0:l.constructor}(e);if(r===void 0||r===Object)return 0;const n=Lo(t)(r),s=n.map(c=>c.metadata.filter(l=>l.key===rm)),i=[].concat.apply([],s).length,o=n.length-i;return o>0?o:Wo(t,r)}class Qr{constructor(e,r,n,s,i){I(this,"id");I(this,"serviceIdentifier");I(this,"parentContext");I(this,"parentRequest");I(this,"bindings");I(this,"childRequests");I(this,"target");I(this,"requestScope");this.id=Fn(),this.serviceIdentifier=e,this.parentContext=r,this.parentRequest=n,this.target=i,this.childRequests=[],this.bindings=Array.isArray(s)?s:[s],this.requestScope=n===null?new Map:null}addChildRequest(e,r,n){const s=new Qr(e,this.parentContext,this,r,n);return this.childRequests.push(s),s}}function _n(t){return t._bindingDictionary}function Wa(t,e,r,n,s){let i=Pr(r.container,s.serviceIdentifier),o=[];return i.length===cr.NoBindingsAvailable&&r.container.options.autoBindInjectable===!0&&typeof s.serviceIdentifier=="function"&&t.getConstructorMetadata(s.serviceIdentifier).compilerGeneratedMetadata&&(r.container.bind(s.serviceIdentifier).toSelf(),i=Pr(r.container,s.serviceIdentifier)),o=e?i:i.filter(c=>{const l=new Qr(c.serviceIdentifier,r,n,c,s);return c.constraint(l)}),function(c,l,d,u,h){switch(l.length){case cr.NoBindingsAvailable:if(u.isOptional())return l;{const f=Et(c);let g=um;throw g+=function(b,p){if(p.isTagged()||p.isNamed()){let y="";const x=p.getNamedTag(),m=p.getCustomTags();return x!==null&&(y+=za(x)+`
`),m!==null&&m.forEach(N=>{y+=za(N)+`
`}),` ${b}
 ${b} - ${y}`}return` ${b}`}(f,u),g+=Va(h,f,Pr),d!==null&&(g+=`
Trying to resolve bindings for "${Et(d.serviceIdentifier)}"`),new Error(g)}case cr.OnlyOneBindingAvailable:return l;case cr.MultipleBindingsAvailable:default:if(u.isArray())return l;{const f=Et(c);let g=`${dm} ${f}`;throw g+=Va(h,f,Pr),new Error(g)}}}(s.serviceIdentifier,o,n,s,r.container),o}function qo(t,e){const r=e.isMultiInject?am:sm,n=[new cn(r,t)];return e.customTag!==void 0&&n.push(new cn(e.customTag.key,e.customTag.value)),e.isOptional===!0&&n.push(new cn(nm,!0)),n}function Go(t,e,r,n,s,i){let o,c;if(s===null){o=Wa(t,e,n,null,i),c=new Qr(r,n,null,o,i);const l=new fm(n,c);n.addPlan(l)}else o=Wa(t,e,n,s,i),c=s.addChildRequest(i.serviceIdentifier,o,i);o.forEach(l=>{let d=null;if(i.isArray())d=c.addChildRequest(l.serviceIdentifier,l,i);else{if(l.cache!==null)return;d=c}if(l.type===se.Instance&&l.implementationType!==null){const u=function(h,f){return Lo(h)(f)}(t,l.implementationType);if(n.container.options.skipBaseClassChecks!==!0){const h=Wo(t,l.implementationType);if(u.length<h){const f=`The number of constructor arguments in the derived class ${Vo(l.implementationType)} must be >= than the number of constructor arguments of its base class.`;throw new Error(f)}}u.forEach(h=>{Go(t,!1,h.serviceIdentifier,n,d,h)})}})}function Pr(t,e){let r=[];const n=_n(t);return n.hasKey(e)?r=n.get(e):t.parent!==null&&(r=Pr(t.parent,e)),r}function mm(t,e,r,n,s,i=!1){const o=new zo(e),c=function(l,d,u){const h=qo(d,u),f=Ln(h);if(f.kind===Ce.unmanaged)throw new Error("Unexpected metadata when creating target");return new wn("",f,l)}(r,n,s);try{return Go(t,i,n,o,null,c),o}catch(l){throw $o(l)&&Uo(o.plan.rootRequest),l}}function Se(t){return(typeof t=="object"&&t!==null||typeof t=="function")&&typeof t.then=="function"}function Ho(t){return!!Se(t)||Array.isArray(t)&&t.some(Se)}const gm=(t,e,r)=>{t.has(e.id)||t.set(e.id,r)},pm=(t,e)=>{t.cache=e,t.activated=!0,Se(e)&&vm(t,e)},vm=async(t,e)=>{try{const r=await e;t.cache=r}catch(r){throw t.cache=null,t.activated=!1,r}};var Mr;(function(t){t.DynamicValue="toDynamicValue",t.Factory="toFactory",t.Provider="toProvider"})(Mr||(Mr={}));function bm(t,e,r){let n;if(e.length>0){const s=function(o,c){return o.reduce((l,d)=>{const u=c(d);return d.target.type===Fo.ConstructorArgument?l.constructorInjections.push(u):(l.propertyRequests.push(d),l.propertyInjections.push(u)),l.isAsync||(l.isAsync=Ho(u)),l},{constructorInjections:[],isAsync:!1,propertyInjections:[],propertyRequests:[]})}(e,r),i={...s,constr:t};n=s.isAsync?async function(o){const c=await Ga(o.constructorInjections),l=await Ga(o.propertyInjections);return qa({...o,constructorInjections:c,propertyInjections:l})}(i):qa(i)}else n=new t;return n}function qa(t){const e=new t.constr(...t.constructorInjections);return t.propertyRequests.forEach((r,n)=>{const s=r.target.identifier,i=t.propertyInjections[n];r.target.isOptional()&&i===void 0||(e[s]=i)}),e}async function Ga(t){const e=[];for(const r of t)Array.isArray(r)?e.push(Promise.all(r)):e.push(r);return Promise.all(e)}function Ha(t,e){const r=function(n,s){var c;if(Reflect.hasMetadata($a,n)){const l=Reflect.getMetadata($a,n);try{return(c=s[l.value])==null?void 0:c.call(s)}catch(d){if(d instanceof Error)throw new Error((i=n.name,o=d.message,`@postConstruct error in class ${i}: ${o}`))}}var i,o}(t,e);return Se(r)?r.then(()=>e):e}function ym(t,e){t.scope!==he.Singleton&&function(r,n){const s=`Class cannot be instantiated in ${r.scope===he.Request?"request":"transient"} scope.`;if(typeof r.onDeactivation=="function")throw new Error(_s(n.name,s));if(Reflect.hasMetadata(ws,n))throw new Error(`@preDestroy error in class ${n.name}: ${s}`)}(t,e)}const qs=t=>e=>{e.parentContext.setCurrentRequest(e);const r=e.bindings,n=e.childRequests,s=e.target&&e.target.isArray(),i=!(e.parentRequest&&e.parentRequest.target&&e.target&&e.parentRequest.target.matchesArray(e.target.serviceIdentifier));if(s&&i)return n.map(o=>qs(t)(o));{if(e.target.isOptional()&&r.length===0)return;const o=r[0];return jm(t,e,o)}},xm=(t,e)=>{const r=(n=>{switch(n.type){case se.Factory:return{factory:n.factory,factoryType:Mr.Factory};case se.Provider:return{factory:n.provider,factoryType:Mr.Provider};case se.DynamicValue:return{factory:n.dynamicValue,factoryType:Mr.DynamicValue};default:throw new Error(`Unexpected factory type ${n.type}`)}})(t);return((n,s)=>{try{return n()}catch(i){throw $o(i)?s():i}})(()=>r.factory.bind(t)(e),()=>{return new Error((n=r.factoryType,s=e.currentRequest.serviceIdentifier.toString(),`It looks like there is a circular dependency in one of the '${n}' bindings. Please investigate bindings with service identifier '${s}'.`));var n,s})},wm=(t,e,r)=>{let n;const s=e.childRequests;switch((i=>{let o=null;switch(i.type){case se.ConstantValue:case se.Function:o=i.cache;break;case se.Constructor:case se.Instance:o=i.implementationType;break;case se.DynamicValue:o=i.dynamicValue;break;case se.Provider:o=i.provider;break;case se.Factory:o=i.factory}if(o===null){const c=Et(i.serviceIdentifier);throw new Error(`Invalid binding type: ${c}`)}})(r),r.type){case se.ConstantValue:case se.Function:n=r.cache;break;case se.Constructor:n=r.implementationType;break;case se.Instance:n=function(i,o,c,l){ym(i,o);const d=bm(o,c,l);return Se(d)?d.then(u=>Ha(o,u)):Ha(o,d)}(r,r.implementationType,s,qs(t));break;default:n=xm(r,e.parentContext)}return n},_m=(t,e,r)=>{let n=((s,i)=>i.scope===he.Singleton&&i.activated?i.cache:i.scope===he.Request&&s.has(i.id)?s.get(i.id):null)(t,e);return n!==null||(n=r(),((s,i,o)=>{i.scope===he.Singleton&&pm(i,o),i.scope===he.Request&&gm(s,i,o)})(t,e,n)),n},jm=(t,e,r)=>_m(t,r,()=>{let n=wm(t,e,r);return n=Se(n)?n.then(s=>Ya(e,r,s)):Ya(e,r,n),n});function Ya(t,e,r){let n=Nm(t.parentContext,e,r);const s=Cm(t.parentContext.container);let i,o=s.next();do{i=o.value;const c=t.parentContext,l=t.serviceIdentifier,d=Om(i,l);n=Se(n)?Yo(d,c,n):Sm(d,c,n),o=s.next()}while(o.done!==!0&&!_n(i).hasKey(t.serviceIdentifier));return n}const Nm=(t,e,r)=>{let n;return n=typeof e.onActivation=="function"?e.onActivation(t,r):r,n},Sm=(t,e,r)=>{let n=t.next();for(;n.done!==!0;){if(Se(r=n.value(e,r)))return Yo(t,e,r);n=t.next()}return r},Yo=async(t,e,r)=>{let n=await r,s=t.next();for(;s.done!==!0;)n=await s.value(e,n),s=t.next();return n},Om=(t,e)=>{const r=t._activations;return r.hasKey(e)?r.get(e).values():[].values()},Cm=t=>{const e=[t];let r=t.parent;for(;r!==null;)e.push(r),r=r.parent;return{next:()=>{const n=e.pop();return n!==void 0?{done:!1,value:n}:{done:!0,value:void 0}}}},ut=(t,e)=>{const r=t.parentRequest;return r!==null&&(!!e(r)||ut(r,e))},kr=t=>e=>{const r=n=>n!==null&&n.target!==null&&n.target.matchesTag(t)(e);return r.metaData=new cn(t,e),r},nn=kr($e),ns=t=>e=>{let r=null;if(e!==null){if(r=e.bindings[0],typeof t=="string")return r.serviceIdentifier===t;{const n=e.bindings[0].implementationType;return t===n}}return!1};class jn{constructor(e){I(this,"_binding");this._binding=e}when(e){return this._binding.constraint=e,new ve(this._binding)}whenTargetNamed(e){return this._binding.constraint=nn(e),new ve(this._binding)}whenTargetIsDefault(){return this._binding.constraint=e=>e===null?!1:e.target!==null&&!e.target.isNamed()&&!e.target.isTagged(),new ve(this._binding)}whenTargetTagged(e,r){return this._binding.constraint=kr(e)(r),new ve(this._binding)}whenInjectedInto(e){return this._binding.constraint=r=>r!==null&&ns(e)(r.parentRequest),new ve(this._binding)}whenParentNamed(e){return this._binding.constraint=r=>r!==null&&nn(e)(r.parentRequest),new ve(this._binding)}whenParentTagged(e,r){return this._binding.constraint=n=>n!==null&&kr(e)(r)(n.parentRequest),new ve(this._binding)}whenAnyAncestorIs(e){return this._binding.constraint=r=>r!==null&&ut(r,ns(e)),new ve(this._binding)}whenNoAncestorIs(e){return this._binding.constraint=r=>r!==null&&!ut(r,ns(e)),new ve(this._binding)}whenAnyAncestorNamed(e){return this._binding.constraint=r=>r!==null&&ut(r,nn(e)),new ve(this._binding)}whenNoAncestorNamed(e){return this._binding.constraint=r=>r!==null&&!ut(r,nn(e)),new ve(this._binding)}whenAnyAncestorTagged(e,r){return this._binding.constraint=n=>n!==null&&ut(n,kr(e)(r)),new ve(this._binding)}whenNoAncestorTagged(e,r){return this._binding.constraint=n=>n!==null&&!ut(n,kr(e)(r)),new ve(this._binding)}whenAnyAncestorMatches(e){return this._binding.constraint=r=>r!==null&&ut(r,e),new ve(this._binding)}whenNoAncestorMatches(e){return this._binding.constraint=r=>r!==null&&!ut(r,e),new ve(this._binding)}}class ve{constructor(e){I(this,"_binding");this._binding=e}onActivation(e){return this._binding.onActivation=e,new jn(this._binding)}onDeactivation(e){return this._binding.onDeactivation=e,new jn(this._binding)}}class ht{constructor(e){I(this,"_bindingWhenSyntax");I(this,"_bindingOnSyntax");I(this,"_binding");this._binding=e,this._bindingWhenSyntax=new jn(this._binding),this._bindingOnSyntax=new ve(this._binding)}when(e){return this._bindingWhenSyntax.when(e)}whenTargetNamed(e){return this._bindingWhenSyntax.whenTargetNamed(e)}whenTargetIsDefault(){return this._bindingWhenSyntax.whenTargetIsDefault()}whenTargetTagged(e,r){return this._bindingWhenSyntax.whenTargetTagged(e,r)}whenInjectedInto(e){return this._bindingWhenSyntax.whenInjectedInto(e)}whenParentNamed(e){return this._bindingWhenSyntax.whenParentNamed(e)}whenParentTagged(e,r){return this._bindingWhenSyntax.whenParentTagged(e,r)}whenAnyAncestorIs(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)}whenNoAncestorIs(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)}whenAnyAncestorNamed(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)}whenAnyAncestorTagged(e,r){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,r)}whenNoAncestorNamed(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)}whenNoAncestorTagged(e,r){return this._bindingWhenSyntax.whenNoAncestorTagged(e,r)}whenAnyAncestorMatches(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)}whenNoAncestorMatches(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)}onActivation(e){return this._bindingOnSyntax.onActivation(e)}onDeactivation(e){return this._bindingOnSyntax.onDeactivation(e)}}class Pm{constructor(e){I(this,"_binding");this._binding=e}inRequestScope(){return this._binding.scope=he.Request,new ht(this._binding)}inSingletonScope(){return this._binding.scope=he.Singleton,new ht(this._binding)}inTransientScope(){return this._binding.scope=he.Transient,new ht(this._binding)}}class Ka{constructor(e){I(this,"_bindingInSyntax");I(this,"_bindingWhenSyntax");I(this,"_bindingOnSyntax");I(this,"_binding");this._binding=e,this._bindingWhenSyntax=new jn(this._binding),this._bindingOnSyntax=new ve(this._binding),this._bindingInSyntax=new Pm(e)}inRequestScope(){return this._bindingInSyntax.inRequestScope()}inSingletonScope(){return this._bindingInSyntax.inSingletonScope()}inTransientScope(){return this._bindingInSyntax.inTransientScope()}when(e){return this._bindingWhenSyntax.when(e)}whenTargetNamed(e){return this._bindingWhenSyntax.whenTargetNamed(e)}whenTargetIsDefault(){return this._bindingWhenSyntax.whenTargetIsDefault()}whenTargetTagged(e,r){return this._bindingWhenSyntax.whenTargetTagged(e,r)}whenInjectedInto(e){return this._bindingWhenSyntax.whenInjectedInto(e)}whenParentNamed(e){return this._bindingWhenSyntax.whenParentNamed(e)}whenParentTagged(e,r){return this._bindingWhenSyntax.whenParentTagged(e,r)}whenAnyAncestorIs(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)}whenNoAncestorIs(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)}whenAnyAncestorNamed(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)}whenAnyAncestorTagged(e,r){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,r)}whenNoAncestorNamed(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)}whenNoAncestorTagged(e,r){return this._bindingWhenSyntax.whenNoAncestorTagged(e,r)}whenAnyAncestorMatches(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)}whenNoAncestorMatches(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)}onActivation(e){return this._bindingOnSyntax.onActivation(e)}onDeactivation(e){return this._bindingOnSyntax.onDeactivation(e)}}class km{constructor(e){I(this,"_binding");this._binding=e}to(e){return this._binding.type=se.Instance,this._binding.implementationType=e,new Ka(this._binding)}toSelf(){if(typeof this._binding.serviceIdentifier!="function")throw new Error("The toSelf function can only be applied when a constructor is used as service identifier");const e=this._binding.serviceIdentifier;return this.to(e)}toConstantValue(e){return this._binding.type=se.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=he.Singleton,new ht(this._binding)}toDynamicValue(e){return this._binding.type=se.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new Ka(this._binding)}toConstructor(e){return this._binding.type=se.Constructor,this._binding.implementationType=e,this._binding.scope=he.Singleton,new ht(this._binding)}toFactory(e){return this._binding.type=se.Factory,this._binding.factory=e,this._binding.scope=he.Singleton,new ht(this._binding)}toFunction(e){if(typeof e!="function")throw new Error("Value provided to function binding must be a function!");const r=this.toConstantValue(e);return this._binding.type=se.Function,this._binding.scope=he.Singleton,r}toAutoFactory(e){return this._binding.type=se.Factory,this._binding.factory=r=>()=>r.container.get(e),this._binding.scope=he.Singleton,new ht(this._binding)}toAutoNamedFactory(e){return this._binding.type=se.Factory,this._binding.factory=r=>n=>r.container.getNamed(e,n),new ht(this._binding)}toProvider(e){return this._binding.type=se.Provider,this._binding.provider=e,this._binding.scope=he.Singleton,new ht(this._binding)}toService(e){this._binding.type=se.DynamicValue,Object.defineProperty(this._binding,"cache",{configurable:!0,enumerable:!0,get:()=>null,set(r){}}),this._binding.dynamicValue=r=>{try{return r.container.get(e)}catch{return r.container.getAsync(e)}},this._binding.implementationType=null}}class Gs{constructor(){I(this,"bindings");I(this,"activations");I(this,"deactivations");I(this,"middleware");I(this,"moduleActivationStore")}static of(e,r,n,s,i){const o=new Gs;return o.bindings=e,o.middleware=r,o.deactivations=s,o.activations=n,o.moduleActivationStore=i,o}}class pt{constructor(){I(this,"_map");this._map=new Map}getMap(){return this._map}add(e,r){if(this._checkNonNulish(e),r==null)throw new Error(Ba);const n=this._map.get(e);n!==void 0?n.push(r):this._map.set(e,[r])}get(e){this._checkNonNulish(e);const r=this._map.get(e);if(r!==void 0)return r;throw new Error(Ua)}remove(e){if(this._checkNonNulish(e),!this._map.delete(e))throw new Error(Ua)}removeIntersection(e){this.traverse((r,n)=>{const s=e.hasKey(r)?e.get(r):void 0;if(s!==void 0){const i=n.filter(o=>!s.some(c=>o===c));this._setValue(r,i)}})}removeByCondition(e){const r=[];return this._map.forEach((n,s)=>{const i=[];for(const o of n)e(o)?r.push(o):i.push(o);this._setValue(s,i)}),r}hasKey(e){return this._checkNonNulish(e),this._map.has(e)}clone(){const e=new pt;return this._map.forEach((r,n)=>{r.forEach(s=>{var i;e.add(n,typeof(i=s)=="object"&&i!==null&&"clone"in i&&typeof i.clone=="function"?s.clone():s)})}),e}traverse(e){this._map.forEach((r,n)=>{e(n,r)})}_checkNonNulish(e){if(e==null)throw new Error(Ba)}_setValue(e,r){r.length>0?this._map.set(e,r):this._map.delete(e)}}class Hs{constructor(){I(this,"_map",new Map)}remove(e){const r=this._map.get(e);return r===void 0?this._getEmptyHandlersStore():(this._map.delete(e),r)}addDeactivation(e,r,n){this._getModuleActivationHandlers(e).onDeactivations.add(r,n)}addActivation(e,r,n){this._getModuleActivationHandlers(e).onActivations.add(r,n)}clone(){const e=new Hs;return this._map.forEach((r,n)=>{e._map.set(n,{onActivations:r.onActivations.clone(),onDeactivations:r.onDeactivations.clone()})}),e}_getModuleActivationHandlers(e){let r=this._map.get(e);return r===void 0&&(r=this._getEmptyHandlersStore(),this._map.set(e,r)),r}_getEmptyHandlersStore(){return{onActivations:new pt,onDeactivations:new pt}}}class Nn{constructor(e){I(this,"id");I(this,"parent");I(this,"options");I(this,"_middleware");I(this,"_bindingDictionary");I(this,"_activations");I(this,"_deactivations");I(this,"_snapshots");I(this,"_metadataReader");I(this,"_moduleActivationStore");const r=e||{};if(typeof r!="object")throw new Error("Invalid Container constructor argument. Container options must be an object.");if(r.defaultScope===void 0)r.defaultScope=he.Transient;else if(r.defaultScope!==he.Singleton&&r.defaultScope!==he.Transient&&r.defaultScope!==he.Request)throw new Error('Invalid Container option. Default scope must be a string ("singleton" or "transient").');if(r.autoBindInjectable===void 0)r.autoBindInjectable=!1;else if(typeof r.autoBindInjectable!="boolean")throw new Error("Invalid Container option. Auto bind injectable must be a boolean");if(r.skipBaseClassChecks===void 0)r.skipBaseClassChecks=!1;else if(typeof r.skipBaseClassChecks!="boolean")throw new Error("Invalid Container option. Skip base check must be a boolean");this.options={autoBindInjectable:r.autoBindInjectable,defaultScope:r.defaultScope,skipBaseClassChecks:r.skipBaseClassChecks},this.id=Fn(),this._bindingDictionary=new pt,this._snapshots=[],this._middleware=null,this._activations=new pt,this._deactivations=new pt,this.parent=null,this._metadataReader=new hm,this._moduleActivationStore=new Hs}static merge(e,r,...n){const s=new Nn,i=[e,r,...n].map(c=>_n(c)),o=_n(s);return i.forEach(c=>{var l;l=o,c.traverse((d,u)=>{u.forEach(h=>{l.add(h.serviceIdentifier,h.clone())})})}),s}load(...e){const r=this._getContainerModuleHelpersFactory();for(const n of e){const s=r(n.id);n.registry(s.bindFunction,s.unbindFunction,s.isboundFunction,s.rebindFunction,s.unbindAsyncFunction,s.onActivationFunction,s.onDeactivationFunction)}}async loadAsync(...e){const r=this._getContainerModuleHelpersFactory();for(const n of e){const s=r(n.id);await n.registry(s.bindFunction,s.unbindFunction,s.isboundFunction,s.rebindFunction,s.unbindAsyncFunction,s.onActivationFunction,s.onDeactivationFunction)}}unload(...e){e.forEach(r=>{const n=this._removeModuleBindings(r.id);this._deactivateSingletons(n),this._removeModuleHandlers(r.id)})}async unloadAsync(...e){for(const r of e){const n=this._removeModuleBindings(r.id);await this._deactivateSingletonsAsync(n),this._removeModuleHandlers(r.id)}}bind(e){return this._bind(this._buildBinding(e))}rebind(e){return this.unbind(e),this.bind(e)}async rebindAsync(e){return await this.unbindAsync(e),this.bind(e)}unbind(e){if(this._bindingDictionary.hasKey(e)){const r=this._bindingDictionary.get(e);this._deactivateSingletons(r)}this._removeServiceFromDictionary(e)}async unbindAsync(e){if(this._bindingDictionary.hasKey(e)){const r=this._bindingDictionary.get(e);await this._deactivateSingletonsAsync(r)}this._removeServiceFromDictionary(e)}unbindAll(){this._bindingDictionary.traverse((e,r)=>{this._deactivateSingletons(r)}),this._bindingDictionary=new pt}async unbindAllAsync(){const e=[];this._bindingDictionary.traverse((r,n)=>{e.push(this._deactivateSingletonsAsync(n))}),await Promise.all(e),this._bindingDictionary=new pt}onActivation(e,r){this._activations.add(e,r)}onDeactivation(e,r){this._deactivations.add(e,r)}isBound(e){let r=this._bindingDictionary.hasKey(e);return!r&&this.parent&&(r=this.parent.isBound(e)),r}isCurrentBound(e){return this._bindingDictionary.hasKey(e)}isBoundNamed(e,r){return this.isBoundTagged(e,$e,r)}isBoundTagged(e,r,n){let s=!1;if(this._bindingDictionary.hasKey(e)){const i=this._bindingDictionary.get(e),o=function(c,l,d){const u=qo(l,d),h=Ln(u);if(h.kind===Ce.unmanaged)throw new Error("Unexpected metadata when creating target");const f=new wn("",h,"Variable"),g=new zo(c);return new Qr(l,g,null,[],f)}(this,e,{customTag:{key:r,value:n},isMultiInject:!1});s=i.some(c=>c.constraint(o))}return!s&&this.parent&&(s=this.parent.isBoundTagged(e,r,n)),s}snapshot(){this._snapshots.push(Gs.of(this._bindingDictionary.clone(),this._middleware,this._activations.clone(),this._deactivations.clone(),this._moduleActivationStore.clone()))}restore(){const e=this._snapshots.pop();if(e===void 0)throw new Error("No snapshot available to restore.");this._bindingDictionary=e.bindings,this._activations=e.activations,this._deactivations=e.deactivations,this._middleware=e.middleware,this._moduleActivationStore=e.moduleActivationStore}createChild(e){const r=new Nn(e||this.options);return r.parent=this,r}applyMiddleware(...e){const r=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce((n,s)=>s(n),r)}applyCustomMetadataReader(e){this._metadataReader=e}get(e){const r=this._getNotAllArgs(e,!1,!1);return this._getButThrowIfAsync(r)}async getAsync(e){const r=this._getNotAllArgs(e,!1,!1);return this._get(r)}getTagged(e,r,n){const s=this._getNotAllArgs(e,!1,!1,r,n);return this._getButThrowIfAsync(s)}async getTaggedAsync(e,r,n){const s=this._getNotAllArgs(e,!1,!1,r,n);return this._get(s)}getNamed(e,r){return this.getTagged(e,$e,r)}async getNamedAsync(e,r){return this.getTaggedAsync(e,$e,r)}getAll(e,r){const n=this._getAllArgs(e,r,!1);return this._getButThrowIfAsync(n)}async getAllAsync(e,r){const n=this._getAllArgs(e,r,!1);return this._getAll(n)}getAllTagged(e,r,n){const s=this._getNotAllArgs(e,!0,!1,r,n);return this._getButThrowIfAsync(s)}async getAllTaggedAsync(e,r,n){const s=this._getNotAllArgs(e,!0,!1,r,n);return this._getAll(s)}getAllNamed(e,r){return this.getAllTagged(e,$e,r)}async getAllNamedAsync(e,r){return this.getAllTaggedAsync(e,$e,r)}resolve(e){const r=this.isBound(e);r||this.bind(e).toSelf();const n=this.get(e);return r||this.unbind(e),n}tryGet(e){const r=this._getNotAllArgs(e,!1,!0);return this._getButThrowIfAsync(r)}async tryGetAsync(e){const r=this._getNotAllArgs(e,!1,!0);return this._get(r)}tryGetTagged(e,r,n){const s=this._getNotAllArgs(e,!1,!0,r,n);return this._getButThrowIfAsync(s)}async tryGetTaggedAsync(e,r,n){const s=this._getNotAllArgs(e,!1,!0,r,n);return this._get(s)}tryGetNamed(e,r){return this.tryGetTagged(e,$e,r)}async tryGetNamedAsync(e,r){return this.tryGetTaggedAsync(e,$e,r)}tryGetAll(e,r){const n=this._getAllArgs(e,r,!0);return this._getButThrowIfAsync(n)}async tryGetAllAsync(e,r){const n=this._getAllArgs(e,r,!0);return this._getAll(n)}tryGetAllTagged(e,r,n){const s=this._getNotAllArgs(e,!0,!0,r,n);return this._getButThrowIfAsync(s)}async tryGetAllTaggedAsync(e,r,n){const s=this._getNotAllArgs(e,!0,!0,r,n);return this._getAll(s)}tryGetAllNamed(e,r){return this.tryGetAllTagged(e,$e,r)}async tryGetAllNamedAsync(e,r){return this.tryGetAllTaggedAsync(e,$e,r)}_preDestroy(e,r){var n;if(e!==void 0&&Reflect.hasMetadata(ws,e)){const s=Reflect.getMetadata(ws,e);return(n=r[s.value])==null?void 0:n.call(r)}}_removeModuleHandlers(e){const r=this._moduleActivationStore.remove(e);this._activations.removeIntersection(r.onActivations),this._deactivations.removeIntersection(r.onDeactivations)}_removeModuleBindings(e){return this._bindingDictionary.removeByCondition(r=>r.moduleId===e)}_deactivate(e,r){const n=r==null?void 0:Object.getPrototypeOf(r).constructor;try{if(this._deactivations.hasKey(e.serviceIdentifier)){const i=this._deactivateContainer(r,this._deactivations.get(e.serviceIdentifier).values());if(Se(i))return this._handleDeactivationError(i.then(async()=>this._propagateContainerDeactivationThenBindingAndPreDestroyAsync(e,r,n)),e.serviceIdentifier)}const s=this._propagateContainerDeactivationThenBindingAndPreDestroy(e,r,n);if(Se(s))return this._handleDeactivationError(s,e.serviceIdentifier)}catch(s){if(s instanceof Error)throw new Error(_s(Et(e.serviceIdentifier),s.message))}}async _handleDeactivationError(e,r){try{await e}catch(n){if(n instanceof Error)throw new Error(_s(Et(r),n.message))}}_deactivateContainer(e,r){let n=r.next();for(;typeof n.value=="function";){const s=n.value(e);if(Se(s))return s.then(async()=>this._deactivateContainerAsync(e,r));n=r.next()}}async _deactivateContainerAsync(e,r){let n=r.next();for(;typeof n.value=="function";)await n.value(e),n=r.next()}_getContainerModuleHelpersFactory(){const e=l=>d=>{const u=this._buildBinding(d);return u.moduleId=l,this._bind(u)},r=()=>l=>{this.unbind(l)},n=()=>async l=>this.unbindAsync(l),s=()=>l=>this.isBound(l),i=l=>{const d=e(l);return u=>(this.unbind(u),d(u))},o=l=>(d,u)=>{this._moduleActivationStore.addActivation(l,d,u),this.onActivation(d,u)},c=l=>(d,u)=>{this._moduleActivationStore.addDeactivation(l,d,u),this.onDeactivation(d,u)};return l=>({bindFunction:e(l),isboundFunction:s(),onActivationFunction:o(l),onDeactivationFunction:c(l),rebindFunction:i(l),unbindAsyncFunction:n(),unbindFunction:r()})}_bind(e){return this._bindingDictionary.add(e.serviceIdentifier,e),new km(e)}_buildBinding(e){const r=this.options.defaultScope||he.Transient;return new Ws(e,r)}async _getAll(e){return Promise.all(this._get(e))}_get(e){const r={...e,contextInterceptor:n=>n,targetType:Fo.Variable};if(this._middleware){const n=this._middleware(r);if(n==null)throw new Error("Invalid return type in middleware. Middleware must return!");return n}return this._planAndResolve()(r)}_getButThrowIfAsync(e){const r=this._get(e);if(Ho(r))throw new Error(`You are attempting to construct ${function(n){return typeof n=="function"?`[function/class ${n.name||"<anonymous>"}]`:typeof n=="symbol"?n.toString():`'${n}'`}(e.serviceIdentifier)} in a synchronous way but it has asynchronous dependencies.`);return r}_getAllArgs(e,r,n){return{avoidConstraints:!(r!=null&&r.enforceBindingConstraints),isMultiInject:!0,isOptional:n,serviceIdentifier:e}}_getNotAllArgs(e,r,n,s,i){return{avoidConstraints:!1,isMultiInject:r,isOptional:n,key:s,serviceIdentifier:e,value:i}}_getPlanMetadataFromNextArgs(e){const r={isMultiInject:e.isMultiInject};return e.key!==void 0&&(r.customTag={key:e.key,value:e.value}),e.isOptional===!0&&(r.isOptional=!0),r}_planAndResolve(){return e=>{let r=mm(this._metadataReader,this,e.targetType,e.serviceIdentifier,this._getPlanMetadataFromNextArgs(e),e.avoidConstraints);return r=e.contextInterceptor(r),function(s){return qs(s.plan.rootRequest.requestScope)(s.plan.rootRequest)}(r)}}_deactivateIfSingleton(e){if(e.activated)return Se(e.cache)?e.cache.then(r=>this._deactivate(e,r)):this._deactivate(e,e.cache)}_deactivateSingletons(e){for(const r of e)if(Se(this._deactivateIfSingleton(r)))throw new Error("Attempting to unbind dependency with asynchronous destruction (@preDestroy or onDeactivation)")}async _deactivateSingletonsAsync(e){await Promise.all(e.map(async r=>this._deactivateIfSingleton(r)))}_propagateContainerDeactivationThenBindingAndPreDestroy(e,r,n){return this.parent?this._deactivate.bind(this.parent)(e,r):this._bindingDeactivationAndPreDestroy(e,r,n)}async _propagateContainerDeactivationThenBindingAndPreDestroyAsync(e,r,n){this.parent?await this._deactivate.bind(this.parent)(e,r):await this._bindingDeactivationAndPreDestroyAsync(e,r,n)}_removeServiceFromDictionary(e){try{this._bindingDictionary.remove(e)}catch{throw new Error(`Could not unbind serviceIdentifier: ${Et(e)}`)}}_bindingDeactivationAndPreDestroy(e,r,n){if(typeof e.onDeactivation=="function"){const s=e.onDeactivation(r);if(Se(s))return s.then(()=>this._preDestroy(n,r))}return this._preDestroy(n,r)}async _bindingDeactivationAndPreDestroyAsync(e,r,n){typeof e.onDeactivation=="function"&&await e.onDeactivation(r),await this._preDestroy(n,r)}}const Oe={Logger:Symbol.for("Logger"),OrderRepository:Symbol.for("OrderRepository"),ProductRepository:Symbol.for("ProductRepository"),ProviderRepository:Symbol.for("ProviderRepository"),AnalyticsService:Symbol.for("AnalyticsService"),DashboardViewModel:Symbol.for("DashboardViewModel")};class Am{formatMessage(e,r,...n){const s=new Date().toISOString(),i=n.map(o=>o instanceof Error?`${o.name}: ${o.message}
${o.stack}`:JSON.stringify(o)).join(" ");return`[${s}] [${e}] ${r} ${i}`.trim()}debug(e,...r){}info(e,...r){console.info(this.formatMessage("INFO",e,...r))}warn(e,...r){console.warn(this.formatMessage("WARN",e,...r))}error(e,r,...n){console.error(this.formatMessage("ERROR",e,r,...n))}}class Em extends Error{constructor(e,r){super(e,r),this.name=this.constructor.name,Error.captureStackTrace(this,this.constructor)}}let X=class extends Em{constructor(e,r){super(e,r),this.name="DatabaseError"}};class Mm{constructor(){this.COLLECTION="orders"}checkAuth(){if(!me.currentUser)throw new X("User not authenticated")}async getAll(){try{this.checkAuth();const e=z(W,this.COLLECTION),r=await _e(e);return r.exists()?Object.entries(r.val()).map(([n,s])=>({id:n,...s})):[]}catch(e){throw e instanceof X?e:new X("Failed to fetch orders",{cause:e})}}async getById(e){try{this.checkAuth();const r=z(W,`${this.COLLECTION}/${e}`),n=await _e(r);return n.exists()?{id:e,...n.val()}:null}catch(r){throw r instanceof X?r:new X("Failed to fetch order",{cause:r})}}async getByProvider(e){try{this.checkAuth();const r=z(W,this.COLLECTION),n=ur(r,hr("providerId"),fr(e)),s=await _e(n);return s.exists()?Object.entries(s.val()).map(([i,o])=>({id:i,...o})).sort((i,o)=>o.date-i.date):[]}catch(r){throw r instanceof X?r:new X("Failed to fetch provider orders",{cause:r})}}async create(e){try{this.checkAuth();const r=z(W,this.COLLECTION),n=Nt(r);if(!n.key)throw new X("Failed to generate order ID");return await it(n,e),n.key}catch(r){throw r instanceof X?r:new X("Failed to create order",{cause:r})}}async update(e,r){try{this.checkAuth();const n=z(W,`${this.COLLECTION}/${e}`);await it(n,r)}catch(n){throw n instanceof X?n:new X("Failed to update order",{cause:n})}}async delete(e){try{this.checkAuth();const r=z(W,`${this.COLLECTION}/${e}`);await yr(r)}catch(r){throw r instanceof X?r:new X("Failed to delete order",{cause:r})}}subscribeToProviderOrders(e,r){try{this.checkAuth();const n=z(W,this.COLLECTION),s=ur(n,hr("providerId"),fr(e));return Ve(s,o=>{if(!o.exists()){r([]);return}const c=Object.entries(o.val()).map(([l,d])=>({id:l,...d})).sort((l,d)=>d.date-l.date);r(c)})}catch(n){throw n instanceof X?n:new X("Failed to subscribe to provider orders",{cause:n})}}}function Xa(t){var e,r,n;return(e=t.name)!=null&&e.trim()?(r=t.sku)!=null&&r.trim()?(n=t.purchasePackaging)!=null&&n.trim()?t.providerId?typeof t.minPackageStock!="number"||isNaN(t.minPackageStock)?{field:"minPackageStock",message:"El stock mínimo debe ser un número válido"}:typeof t.desiredStock!="number"||isNaN(t.desiredStock)?{field:"desiredStock",message:"El stock deseado debe ser un número válido"}:t.minPackageStock<0?{field:"minPackageStock",message:"El stock mínimo no puede ser negativo"}:t.desiredStock<0?{field:"desiredStock",message:"El stock deseado no puede ser negativo"}:t.minPackageStock>t.desiredStock?{field:"minPackageStock",message:"El stock mínimo no puede ser mayor al stock deseado"}:typeof t.price!="number"||isNaN(t.price)?{field:"price",message:"El precio debe ser un número válido"}:t.price<0?{field:"price",message:"El precio no puede ser negativo"}:typeof t.order!="number"||isNaN(t.order)?{field:"order",message:"El orden debe ser un número válido"}:null:{field:"providerId",message:"El proveedor es requerido"}:{field:"purchasePackaging",message:"El empaque de compra es requerido"}:{field:"sku",message:"El SKU es requerido"}:{field:"name",message:"El nombre es requerido"}}class Tm{constructor(){this.COLLECTION="products"}checkAuth(){if(!me.currentUser)throw new X("User not authenticated")}async getAll(){try{this.checkAuth();const e=z(W,this.COLLECTION),r=await _e(e);return r.exists()?Object.entries(r.val()).map(([n,s])=>({id:n,...s})):[]}catch(e){throw new X("Failed to fetch products",{cause:e})}}async getById(e){try{this.checkAuth();const r=z(W,`${this.COLLECTION}/${e}`),n=await _e(r);return n.exists()?{id:e,...n.val()}:null}catch(r){throw new X("Failed to fetch product",{cause:r})}}async getByProvider(e){try{this.checkAuth();const r=z(W,this.COLLECTION),n=ur(r,hr("providerId"),fr(e)),s=await _e(n);return s.exists()?Object.entries(s.val()).map(([i,o])=>({id:i,...o})).sort((i,o)=>i.order-o.order):[]}catch(r){throw new X("Failed to fetch provider products",{cause:r})}}async create(e){var r,n;try{this.checkAuth();const s=Xa(e);if(s)throw new X(s.message);const i=z(W,this.COLLECTION),o=Nt(i);if(!o.key)throw new X("Failed to generate product ID");const c={...e,name:e.name.trim().toUpperCase(),sku:e.sku.trim().toUpperCase(),supplierCode:((r=e.supplierCode)==null?void 0:r.trim().toUpperCase())||"",purchasePackaging:e.purchasePackaging.trim().toUpperCase(),salePackaging:((n=e.salePackaging)==null?void 0:n.trim().toUpperCase())||"",price:Number(e.price)||0,minPackageStock:Number(e.minPackageStock)||0,desiredStock:Number(e.desiredStock)||0,order:Number(e.order)||0,tags:Array.isArray(e.tags)?e.tags:[],isProduction:!!e.isProduction,unitMeasure:e.isProduction?e.unitMeasure||"UNIDAD":void 0,pricePerUnit:e.isProduction?Number(e.pricePerUnit)||0:void 0};return await it(o,c),o.key}catch(s){throw new X("Failed to create product",{cause:s})}}async update(e,r){var n,s,i,o,c,l;try{this.checkAuth();const d=z(W,`${this.COLLECTION}/${e}`),u=await _e(d);if(!u.exists())throw new X("Product not found");const h=u.val(),f={...h,...r,name:((n=r.name)==null?void 0:n.trim().toUpperCase())??h.name,sku:((s=r.sku)==null?void 0:s.trim().toUpperCase())??h.sku,supplierCode:((i=r.supplierCode)==null?void 0:i.trim().toUpperCase())??h.supplierCode??"",purchasePackaging:((o=r.purchasePackaging)==null?void 0:o.trim().toUpperCase())??h.purchasePackaging,salePackaging:((c=r.salePackaging)==null?void 0:c.trim().toUpperCase())??h.salePackaging??"",price:typeof r.price=="number"?Number(r.price):h.price,minPackageStock:typeof r.minPackageStock=="number"?Number(r.minPackageStock):h.minPackageStock,desiredStock:typeof r.desiredStock=="number"?Number(r.desiredStock):h.desiredStock,order:typeof r.order=="number"?Number(r.order):h.order,tags:r.tags??h.tags??[],isProduction:typeof r.isProduction=="boolean"?r.isProduction:h.isProduction};f.isProduction?(f.unitMeasure=((l=r.unitMeasure)==null?void 0:l.trim().toUpperCase())??h.unitMeasure??"UNIDAD",f.pricePerUnit=typeof r.pricePerUnit=="number"?Number(r.pricePerUnit):h.pricePerUnit??0):(delete f.unitMeasure,delete f.pricePerUnit);const g=Xa(f);if(g)throw new X(g.message);await it(d,f)}catch(d){throw new X("Failed to update product",{cause:d})}}async delete(e){try{this.checkAuth();const r=z(W,`${this.COLLECTION}/${e}`);await yr(r)}catch(r){throw new X("Failed to delete product",{cause:r})}}subscribeToProviderProducts(e,r){try{this.checkAuth();const n=z(W,this.COLLECTION),s=ur(n,hr("providerId"),fr(e));return Ve(s,o=>{if(!o.exists()){r([]);return}const c=Object.entries(o.val()).map(([l,d])=>({id:l,...d})).sort((l,d)=>l.order-d.order);r(c)})}catch(n){throw new X("Failed to subscribe to provider products",{cause:n})}}}class Im{constructor(){this.COLLECTION="providers"}async getAll(){try{const e=z(W,this.COLLECTION),r=await _e(e);return r.exists()?Object.entries(r.val()).map(([n,s])=>({id:n,...s})):[]}catch(e){throw new X("Failed to fetch providers",{cause:e})}}async getById(e){try{const r=z(W,`${this.COLLECTION}/${e}`),n=await _e(r);return n.exists()?{id:e,...n.val()}:null}catch(r){throw new X("Failed to fetch provider",{cause:r})}}async create(e){try{const r=z(W,this.COLLECTION),n=Nt(r);if(!n.key)throw new X("Failed to generate provider ID");return await it(n,e),n.key}catch(r){throw new X("Failed to create provider",{cause:r})}}async update(e,r){try{const n=z(W,`${this.COLLECTION}/${e}`);await it(n,r)}catch(n){throw new X("Failed to update provider",{cause:n})}}async delete(e){try{const r=z(W,`${this.COLLECTION}/${e}`);await yr(r)}catch(r){throw new X("Failed to delete provider",{cause:r})}}subscribeToProviders(e){const r=z(W,this.COLLECTION);return Ve(r,s=>{if(!s.exists()){e([]);return}const i=Object.entries(s.val()).map(([o,c])=>({id:o,...c}));e(i)})}}class Rm{constructor(e,r,n,s){this.orderRepository=e,this.productRepository=r,this.providerRepository=n,this.logger=s}calculateOrderStats(e){const r=e.length,n=e.reduce((s,i)=>s+i.total,0);return{total:r,totalAmount:n,averageAmount:r>0?n/r:0,byStatus:{pending:e.filter(s=>s.status==="pending").length,completed:e.filter(s=>s.status==="completed").length}}}calculateProductStats(e,r){const n=new Map;for(const s of e)for(const i of s.items){const o=r.get(i.productId);if(!o)continue;const c=n.get(i.productId)||{name:o.name,totalQuantity:0,totalAmount:0,orderCount:0,lastOrderDate:null};c.totalQuantity+=i.quantity,c.totalAmount+=i.subtotal,c.orderCount++,c.lastOrderDate=Math.max(s.date,c.lastOrderDate||0),n.set(i.productId,c)}return Array.from(n.entries()).map(([s,i])=>({id:s,name:i.name,totalQuantity:i.totalQuantity,totalAmount:i.totalAmount,orderCount:i.orderCount,averageQuantityPerOrder:i.totalQuantity/i.orderCount,lastOrderDate:i.lastOrderDate})).sort((s,i)=>i.totalAmount-s.totalAmount)}calculateProviderStats(e,r){const n=new Map;for(const s of e){if(!r.get(s.providerId))continue;const o=n.get(s.providerId)||{totalOrders:0,totalAmount:0,lastOrderDate:null};o.totalOrders++,o.totalAmount+=s.total,o.lastOrderDate=Math.max(s.date,o.lastOrderDate||0),n.set(s.providerId,o)}return Array.from(n.entries()).map(([s,i])=>{const o=r.get(s);return{id:s,name:o.commercialName,totalOrders:i.totalOrders,totalAmount:i.totalAmount,averageOrderAmount:i.totalAmount/i.totalOrders,lastOrderDate:i.lastOrderDate}}).sort((s,i)=>i.totalAmount-s.totalAmount)}async getDashboardStats(){try{this.logger.debug("Fetching dashboard stats");const[e,r,n]=await Promise.all([this.orderRepository.getAll(),this.productRepository.getAll(),this.providerRepository.getAll()]),s=new Map(r.map(p=>[p.id,p])),i=new Map(n.map(p=>[p.id,p])),o=new Date,c=mr(o),l=bl(o),d=pl(o),u=gl(o),h=e.filter(p=>{const y=new Date(p.date);return y>=os(o)&&y<=ml(o)}),f=e.filter(p=>{const y=new Date(p.date);return y>=c&&y<=l}),g=e.filter(p=>{const y=new Date(p.date);return y>=d&&y<=u}),b={orders:{today:this.calculateOrderStats(h),week:this.calculateOrderStats(f),month:this.calculateOrderStats(g)},topProducts:this.calculateProductStats(e,s).slice(0,10),topProviders:this.calculateProviderStats(e,i).slice(0,5),totals:{products:r.length,providers:n.length,orders:e.length}};return this.logger.debug("Dashboard stats calculated successfully",{todayOrders:b.orders.today.total,weekOrders:b.orders.week.total,monthOrders:b.orders.month.total,topProducts:b.topProducts.length,topProviders:b.topProviders.length}),b}catch(e){throw this.logger.error("Error calculating dashboard stats",e),e}}}class Dm{constructor(e,r){this.analyticsService=e,this.logger=r,this.stats={orders:{today:{total:0,totalAmount:0,averageAmount:0,byStatus:{pending:0,completed:0}},week:{total:0,totalAmount:0,averageAmount:0,byStatus:{pending:0,completed:0}},month:{total:0,totalAmount:0,averageAmount:0,byStatus:{pending:0,completed:0}}},topProducts:[],topProductsByTags:[],totals:{products:0,providers:0,orders:0}},this.loading=!0,this.error=null,this.lastUpdate=null,cf(this),this.loadStats()}async loadStats(){try{this.loading=!0,this.error=null,this.logger.info("Loading dashboard stats");const e=await this.analyticsService.getDashboardStats();Gn(()=>{this.stats={orders:e.orders||this.stats.orders,topProducts:e.topProducts||[],topProductsByTags:e.topProductsByTags||[],totals:e.totals||this.stats.totals},this.lastUpdate=Date.now()}),this.logger.debug("Dashboard stats loaded successfully",{todayOrders:e.orders.today.total,weekOrders:e.orders.week.total,monthOrders:e.orders.month.total})}catch(e){Gn(()=>{this.error="Error al cargar las estadísticas"}),this.logger.error("Failed to load dashboard stats",e),P.error(this.error)}finally{Gn(()=>{this.loading=!1})}}get todayOrdersCount(){return this.stats.orders.today.total}get todayOrdersAmount(){return this.stats.orders.today.totalAmount}get weekOrdersCount(){return this.stats.orders.week.total}get weekOrdersAmount(){return this.stats.orders.week.totalAmount}get monthOrdersCount(){return this.stats.orders.month.total}get monthOrdersAmount(){return this.stats.orders.month.totalAmount}get pendingOrdersCount(){return this.stats.orders.today.byStatus.pending}get completedOrdersCount(){return this.stats.orders.today.byStatus.completed}get totalProducts(){return this.stats.totals.products}get totalProviders(){return this.stats.totals.providers}get totalOrders(){return this.stats.totals.orders}get topProducts(){return this.stats.topProducts||[]}get topProductsByTags(){return this.stats.topProductsByTags||[]}get currentDayName(){const e=xe(new Date,"EEEE",{locale:we});return{lunes:"monday",martes:"tuesday",miércoles:"wednesday",jueves:"thursday",viernes:"friday",sábado:"saturday",domingo:"sunday"}[e]}get formattedLastUpdate(){return this.lastUpdate?xe(this.lastUpdate,"d 'de' MMMM, yyyy HH:mm",{locale:we}):null}get isStale(){return this.lastUpdate?Date.now()-this.lastUpdate>5*60*1e3:!0}}const Lt=new Nn;Lt.bind(Oe.Logger).to(Am).inSingletonScope();Lt.bind(Oe.OrderRepository).to(Mm).inSingletonScope();Lt.bind(Oe.ProductRepository).to(Tm).inSingletonScope();Lt.bind(Oe.ProviderRepository).to(Im).inSingletonScope();Lt.bind(Oe.AnalyticsService).toDynamicValue(t=>{const e=t.container.get(Oe.OrderRepository),r=t.container.get(Oe.ProductRepository),n=t.container.get(Oe.ProviderRepository),s=t.container.get(Oe.Logger);return new Rm(e,r,n,s)}).inSingletonScope();Lt.bind(Oe.DashboardViewModel).toDynamicValue(t=>{const e=t.container.get(Oe.AnalyticsService),r=t.container.get(Oe.Logger);return new Dm(e,r)}).inSingletonScope();function Lm(){return Lt.get(Oe.DashboardViewModel)}function nr({title:t,icon:e,children:r,loading:n,className:s,onClick:i}){return a.jsx(D,{className:s,onClick:i,children:a.jsx(D.Header,{className:"!p-4",children:a.jsxs("div",{className:"flex items-start justify-between gap-4",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-1",children:t}),n?a.jsx("div",{className:"h-6 w-24 bg-gray-200 rounded animate-pulse"}):a.jsx("div",{className:"break-words",children:r})]}),a.jsx("div",{className:"flex-shrink-0 p-2 bg-blue-100 rounded-lg",children:e})]})})})}function qe({isOpen:t,onClose:e,title:r,children:n,className:s}){return t?a.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:a.jsxs("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:[a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25",onClick:e}),a.jsxs("div",{className:je("relative transform overflow-hidden rounded-lg bg-white p-6 text-left shadow-xl transition-all w-full max-w-md",s),children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:r}),a.jsx("button",{onClick:e,className:"rounded-full p-1 hover:bg-gray-100",children:a.jsx(It,{className:"w-5 h-5"})})]}),n]})]})}):null}function Fm({isOpen:t,onClose:e,products:r}){return a.jsx(qe,{isOpen:t,onClose:e,title:"Top 10 Productos Más Valorados",children:a.jsx("div",{className:"space-y-4",children:r.map((n,s)=>a.jsxs("div",{className:"flex items-start gap-4 p-4 bg-white rounded-lg border transition-colors hover:bg-gray-50",children:[a.jsx("div",{className:"flex-shrink-0 w-8 h-8 flex items-center justify-center rounded-full bg-blue-100 text-blue-600 font-bold",children:s+1}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"font-medium text-gray-900 truncate",children:n.name}),a.jsxs("div",{className:"mt-2 grid grid-cols-3 gap-2 text-sm text-gray-600",children:[a.jsx("div",{className:"flex items-center gap-1",children:a.jsx("span",{className:"font-medium text-blue-600",children:ce(n.totalAmount)})}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Mt,{className:"w-4 h-4"}),a.jsxs("span",{children:[n.totalQuantity," ",n.purchasePackaging]})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Sn,{className:"w-4 h-4"}),a.jsxs("span",{children:[n.orderCount," órdenes"]})]})]})]})]},n.id))})})}function $m({isOpen:t,onClose:e,tagStats:r}){const[n,s]=w.useState(null);return a.jsx(qe,{isOpen:t,onClose:e,title:"Top Productos por Etiquetas",children:a.jsxs("div",{className:"space-y-4",children:[r.map(i=>a.jsxs("div",{className:"bg-white p-4 rounded-lg border transition-colors hover:bg-gray-50",children:[a.jsx("button",{onClick:()=>s(n===i.tag?null:i.tag),className:"w-full",children:a.jsxs("div",{className:"flex items-start justify-between gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"p-2 rounded-full bg-blue-100",children:a.jsx(oi,{className:"w-4 h-4 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-gray-900",children:i.tag}),a.jsxs("p",{className:"text-sm text-gray-500",children:[i.products.length," productos"]})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:"font-medium text-blue-600",children:ce(i.totalAmount)}),a.jsxs("div",{className:"text-sm text-gray-500",children:[i.orderCount," órdenes"]})]})]})}),n===i.tag&&a.jsx("div",{className:"mt-4 space-y-3",children:i.products.map(o=>a.jsxs("div",{className:"flex items-center justify-between gap-4 p-3 bg-gray-50 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:o.name}),a.jsxs("div",{className:"flex items-center gap-4 mt-1 text-sm text-gray-600",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Mt,{className:"w-4 h-4"}),o.totalQuantity," ",o.purchasePackaging]}),a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Sn,{className:"w-4 h-4"}),o.orderCount," órdenes"]})]})]}),a.jsx("div",{className:"text-right",children:a.jsx("div",{className:"font-medium text-blue-600",children:ce(o.totalAmount)})})]},o.id))})]},i.tag)),r.length===0&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:"No hay datos disponibles"})]})})}function Ft(){const[t,e]=w.useState([]),[r,n]=w.useState(!0);return w.useEffect(()=>{const i=z(W,"products"),o=Ve(i,c=>{if(!c.exists()){e([]),n(!1);return}const l=Object.entries(c.val()).map(([d,u])=>({id:d,...u}));e(l),n(!1)});return()=>o()},[]),{products:t,loading:r,updateProduct:async(i,o)=>{try{const c=z(W,`products/${i}`);await it(c,o),P.success("Producto actualizado exitosamente")}catch(c){throw console.error("Error updating product:",c),P.error("Error al actualizar el producto"),c}}}}function Zt(){const[t,e]=w.useState([]),[r,n]=w.useState(!0);return w.useEffect(()=>{const l=z(W,"providers"),d=Ve(l,u=>{const h=u.val(),f=h?Object.entries(h).map(([g,b])=>({id:g,...b})):[];e(f),n(!1)});return()=>d()},[]),{providers:t,loading:r,addProvider:async l=>{const d=z(W,"providers");await Nt(d,l)},updateProvider:async(l,d)=>{const u=z(W,`providers/${l}`);await it(u,d)},deleteProvider:async l=>{const d=z(W,`providers/${l}`);await yr(d)},getProvider:async l=>{const d=z(W,`providers/${l}`),u=await _e(d);return u.exists()?{id:l,...u.val()}:null}}}class Re extends Error{constructor(e,r){super(e,r),this.name="DatabaseError"}}async function Bm(t,e){var r,n,s,i,o;if(!me.currentUser)throw new Re("User not authenticated");try{const c=z(W,`products/${t}`),l=await _e(c);if(!l.exists())throw new Re("Product not found");const d=l.val(),u={...d,...e,name:((r=e.name)==null?void 0:r.trim().toUpperCase())??d.name,sku:((n=e.sku)==null?void 0:n.trim().toUpperCase())??d.sku,supplierCode:((s=e.supplierCode)==null?void 0:s.trim().toUpperCase())??d.supplierCode??"",purchasePackaging:((i=e.purchasePackaging)==null?void 0:i.trim().toUpperCase())??d.purchasePackaging,salePackaging:((o=e.salePackaging)==null?void 0:o.trim().toUpperCase())??d.salePackaging??"",price:typeof e.price=="number"?Number(e.price):d.price,minPackageStock:typeof e.minPackageStock=="number"?Number(e.minPackageStock):d.minPackageStock,desiredStock:typeof e.desiredStock=="number"?Number(e.desiredStock):d.desiredStock,order:typeof e.order=="number"?Number(e.order):d.order,tags:e.tags??d.tags??[],isProduction:typeof e.isProduction=="boolean"?e.isProduction:d.isProduction};await it(c,u)}catch(c){throw console.error("Error updating product:",c),new Re("Failed to update product",{cause:c})}}function Um(t){const e=[];let r="",n=!1;for(let s=0;s<t.length;s++){const i=t[s];i==='"'?n&&t[s+1]==='"'?(r+='"',s++):n=!n:i===","&&!n?(e.push(r.trim()),r=""):r+=i}return e.push(r.trim()),e}function Vm(t){return t.trim().split(/\r?\n/).map(r=>Um(r))}function zm(t){return t.map(e=>e.toLowerCase().trim().normalize("NFD").replace(/[\u0300-\u036f]/g,""))}function Wm(t){const e=Vm(t);if(e.length<2)throw new Error("El archivo está vacío o no tiene el formato correcto");const r=zm(e[0]),n=["fecha","rut","codigo","nombre","precio"],s=n.filter(o=>!r.includes(o));if(s.length>0)throw new Error(`Faltan las siguientes columnas: ${s.join(", ")}`);const i=n.map(o=>r.indexOf(o));return e.slice(1).map(o=>{if(o.length<i.length)throw new Error("Número incorrecto de columnas");return{fecha:o[i[0]],rut:o[i[1]],codigo:o[i[2]],nombre:o[i[3]],precio:o[i[4]]}})}function qm(t){const e=t.rut.replace(/\D/g,"");if(!e)return"RUT vacío";if(!/^\d{12}$/.test(e))return"RUT inválido";if(!t.codigo.trim())return"Código vacío";const n=t.precio.replace(/[^\d.,]/g,"").replace(/\./g,"").replace(",","."),s=parseFloat(n);return isNaN(s)||s<0?"Precio inválido":null}function Gm(t){let e=t.replace(/[^\d.,]/g,"");e.includes(",")&&(e.indexOf(".")<e.indexOf(",")?e=e.replace(/\./g,"").replace(",","."):e=e.replace(",","."));const r=parseFloat(e);if(isNaN(r))throw new Error(`Precio inválido: ${t}`);return Number(r.toFixed(2))}async function Hm(t,e,r){const n={updated:0,errors:[],details:{updatedProducts:[],notFoundProducts:[],invalidRows:[]}};try{if(!t.trim())throw new Error("El archivo está vacío");const s=Wm(t);if(s.length===0)throw new Error("No se encontraron datos para procesar");for(const[i,o]of s.entries())try{const c=qm(o);if(c){n.details.invalidRows.push({row:i+2,reason:c});continue}const l=o.rut.replace(/\D/g,""),d=r.find(h=>{var f;return((f=h.rut)==null?void 0:f.replace(/\D/g,""))===l});if(!d){n.details.notFoundProducts.push({code:o.codigo,providerRut:o.rut,csvName:o.nombre});continue}const u=e.find(h=>{var f;return h.providerId===d.id&&((f=h.supplierCode)==null?void 0:f.toLowerCase())===o.codigo.toLowerCase()});if(!u){n.details.notFoundProducts.push({code:o.codigo,providerRut:o.rut,csvName:o.nombre});continue}try{const h=Gm(o.precio);Math.abs(u.price-h)>.01&&(await Bm(u.id,{price:h}),n.updated++,n.details.updatedProducts.push({name:u.name,oldPrice:u.price,newPrice:h,csvName:o.nombre}))}catch(h){n.details.invalidRows.push({row:i+2,reason:h instanceof Error?h.message:"Precio inválido"})}}catch(c){n.details.invalidRows.push({row:i+2,reason:c instanceof Error?c.message:"Error desconocido"})}return n}catch(s){throw new Error(s instanceof Error?s.message:"Error procesando el archivo")}}function Ym({isOpen:t,onClose:e,result:r}){const[n,s]=w.useState(""),i=w.useMemo(()=>{if(!r)return null;const l=n.toLowerCase();return{updatedProducts:r.details.updatedProducts.filter(d=>d.name.toLowerCase().includes(l)||d.csvName.toLowerCase().includes(l)),notFoundProducts:r.details.notFoundProducts.filter(d=>d.code.toLowerCase().includes(l)||d.csvName.toLowerCase().includes(l)||d.providerRut.toLowerCase().includes(l)),invalidRows:r.details.invalidRows.filter(d=>d.reason.toLowerCase().includes(l))}},[r,n]);if(!r||!i)return null;const o=r.updated>0,c=r.errors.length>0;return a.jsx(qe,{isOpen:t,onClose:e,title:"Resultado de la Importación",children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-lg bg-gray-50",children:[o&&!c?a.jsx(ci,{className:"w-6 h-6 text-green-500 flex-shrink-0"}):c?a.jsx(Sc,{className:"w-6 h-6 text-amber-500 flex-shrink-0"}):a.jsx(Oc,{className:"w-6 h-6 text-red-500 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium",children:"Resumen de la importación"}),a.jsxs("p",{className:"text-sm text-gray-600",children:[r.updated," producto",r.updated!==1?"s":""," actualizado",r.updated!==1?"s":""]})]})]}),a.jsxs("div",{className:"relative",children:[a.jsx(ee,{placeholder:"Buscar en los resultados...",value:n,onChange:l=>s(l.target.value),className:"pl-10"}),a.jsx(jt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"})]}),a.jsxs("div",{className:"space-y-6 max-h-[60vh] overflow-y-auto",children:[i.updatedProducts.length>0&&a.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[a.jsxs("h4",{className:"font-medium text-green-800 mb-3",children:["Productos Actualizados (",i.updatedProducts.length,")"]}),a.jsx("div",{className:"space-y-3",children:i.updatedProducts.map((l,d)=>a.jsxs("div",{className:"bg-white rounded-lg p-3 shadow-sm",children:[a.jsx("div",{className:"font-medium text-green-700",children:l.name}),a.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:["Nombre en CSV: ",l.csvName]}),a.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:["Precio anterior: $",l.oldPrice.toFixed(2)," → Nuevo precio: $",l.newPrice.toFixed(2)]})]},d))})]}),i.notFoundProducts.length>0&&a.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:[a.jsxs("h4",{className:"font-medium text-amber-800 mb-3",children:["Productos no encontrados (",i.notFoundProducts.length,")"]}),a.jsx("div",{className:"space-y-3",children:i.notFoundProducts.map((l,d)=>a.jsxs("div",{className:"bg-white rounded-lg p-3 shadow-sm",children:[a.jsxs("div",{className:"font-medium text-amber-700",children:["Código: ",l.code]}),a.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:["Nombre en CSV: ",l.csvName]}),a.jsxs("div",{className:"text-sm text-gray-600",children:["RUT Proveedor: ",l.providerRut]})]},d))})]}),i.invalidRows.length>0&&a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[a.jsxs("h4",{className:"font-medium text-red-800 mb-3",children:["Filas con errores (",i.invalidRows.length,")"]}),a.jsx("div",{className:"space-y-3",children:i.invalidRows.map((l,d)=>a.jsxs("div",{className:"bg-white rounded-lg p-3 shadow-sm",children:[a.jsxs("div",{className:"font-medium text-red-700",children:["Fila ",l.row]}),a.jsx("div",{className:"text-sm text-gray-600 mt-1",children:l.reason})]},d))})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsx(T,{onClick:e,children:"Cerrar"})})]})})}function Km(){const t=w.useRef(null),[e,r]=w.useState(!1),[n,s]=w.useState(null),[i,o]=w.useState(!1),{products:c,loading:l}=Ft(),{providers:d,loading:u}=Zt(),h=async g=>{var p;const b=(p=g.target.files)==null?void 0:p[0];if(b){if(!b.name.toLowerCase().endsWith(".csv")){P.error("El archivo debe ser de tipo CSV");return}r(!0);try{const y=await b.text(),x=await Hm(y,c,d);s(x),o(!0),x.updated>0&&P.success(`${x.updated} productos actualizados`)}catch(y){P.error(y instanceof Error?y.message:"Error al procesar el archivo")}finally{r(!1),t.current&&(t.current.value="")}}},f=()=>{var g;(g=t.current)==null||g.click()};return l||u?a.jsx(D,{children:a.jsx(D.Header,{className:"!p-4",children:a.jsxs("div",{className:"animate-pulse",children:[a.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),a.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})})}):a.jsxs(a.Fragment,{children:[a.jsx(D,{children:a.jsxs(D.Header,{className:"!p-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{children:a.jsx("h3",{className:"text-lg font-bold mt-1",children:"Actualizar Precios"})}),a.jsx("div",{className:"p-2 bg-violet-100 rounded-lg",children:a.jsx(Cc,{className:"w-5 h-5 text-violet-600"})})]}),a.jsxs("div",{className:"mt-4",children:[a.jsx("input",{ref:t,type:"file",accept:".csv",onChange:h,className:"hidden"}),a.jsx(T,{onClick:f,isLoading:e,className:"w-full",children:e?"Procesando...":"Seleccionar Archivo"}),a.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Formato: Fecha, RUT, Código, Nombre, Precio"})]})]})}),a.jsx(Ym,{isOpen:i,onClose:()=>o(!1),result:n})]})}const Xm=Wf(()=>{const t=Lm(),[e,r]=w.useState(!1),[n,s]=w.useState(!1),[i,o]=w.useState(!1),c=async()=>{o(!0),await t.loadStats(),o(!1)},l=t.topProducts[0],d=t.topProductsByTags[0];return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard"}),a.jsxs(T,{variant:"outline",size:"sm",onClick:c,disabled:t.loading||i,className:"gap-2",children:[a.jsx(Ns,{className:`w-4 h-4 ${i?"animate-spin":""}`}),"Actualizar"]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[a.jsx(D,{children:a.jsx(D.Header,{className:"!p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-2xl font-bold capitalize",children:xe(new Date,"EEEE",{locale:we})}),a.jsx("div",{className:"text-sm text-gray-600 mt-1",children:xe(new Date,"dd/MM/yyyy")})]}),a.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:a.jsx(On,{className:"w-5 h-5 text-orange-600"})})]})})}),a.jsx(nr,{title:"Total Productos",icon:a.jsx(Ss,{className:"w-5 h-5 text-indigo-600"}),loading:t.loading,children:a.jsx("h3",{className:"text-2xl font-bold mt-1",children:t.totalProducts})}),a.jsx(nr,{title:"Total Proveedores",icon:a.jsx(ii,{className:"w-5 h-5 text-emerald-600"}),loading:t.loading,children:a.jsx("h3",{className:"text-2xl font-bold mt-1",children:t.totalProviders})}),a.jsx(nr,{title:"Total Órdenes",icon:a.jsx(Sn,{className:"w-5 h-5 text-amber-600"}),loading:t.loading,children:a.jsx("h3",{className:"text-2xl font-bold mt-1",children:t.totalOrders})}),a.jsx(D,{children:a.jsx(D.Header,{className:"!p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pedidos Hoy"}),a.jsx("h3",{className:"text-2xl font-bold mt-1",children:t.loading?a.jsx("span",{className:"text-gray-400",children:"..."}):t.todayOrdersCount}),a.jsx("div",{className:"text-sm text-gray-500 mt-1",children:ce(t.todayOrdersAmount)})]}),a.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:a.jsx(Mt,{className:"w-5 h-5 text-purple-600"})})]})})}),a.jsxs(nr,{title:"Órdenes Semanales",icon:a.jsx(Pc,{className:"w-5 h-5 text-blue-600"}),loading:t.loading,children:[a.jsx("h3",{className:"text-2xl font-bold mt-1",children:t.weekOrdersCount}),a.jsx("div",{className:"text-sm text-gray-500 mt-1",children:ce(t.weekOrdersAmount)})]}),a.jsx(nr,{title:"Producto Más Valorado",icon:a.jsx(kc,{className:"w-5 h-5 text-green-600"}),loading:t.loading,className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>r(!0),children:l&&a.jsxs("div",{className:"mt-1",children:[a.jsx("h3",{className:"text-lg font-bold break-words",children:l.name}),a.jsxs("div",{className:"flex items-center justify-between mt-1",children:[a.jsx("span",{className:"text-lg font-bold text-blue-600",children:ce(l.totalAmount)}),a.jsxs("span",{className:"text-sm text-gray-500",children:[l.totalQuantity," unidades"]})]})]})}),a.jsx(nr,{title:"Etiqueta Más Valorada",icon:a.jsx(oi,{className:"w-5 h-5 text-rose-600"}),loading:t.loading,className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>s(!0),children:d&&a.jsxs("div",{className:"mt-1",children:[a.jsx("h3",{className:"text-lg font-bold break-words",children:d.tag}),a.jsxs("div",{className:"flex items-center justify-between mt-1",children:[a.jsx("span",{className:"text-lg font-bold text-blue-600",children:ce(d.totalAmount)}),a.jsxs("span",{className:"text-sm text-gray-500",children:[d.products.length," productos"]})]})]})}),a.jsx(Km,{})]}),a.jsx(Fm,{isOpen:e,onClose:()=>r(!1),products:t.topProducts}),a.jsx($m,{isOpen:n,onClose:()=>s(!1),tagStats:t.topProductsByTags}),t.formattedLastUpdate&&a.jsxs("div",{className:"text-center text-sm text-gray-500",children:["Última actualización: ",t.formattedLastUpdate,t.isStale&&a.jsx("span",{className:"text-amber-500 ml-2",children:"(Datos desactualizados)"})]})]})}),Qa=[{value:"monday",label:"Lunes"},{value:"tuesday",label:"Martes"},{value:"wednesday",label:"Miércoles"},{value:"thursday",label:"Jueves"},{value:"friday",label:"Viernes"},{value:"saturday",label:"Sábado"},{value:"sunday",label:"Domingo"}];function Qm({initialData:t,onSubmit:e,onCancel:r,isLoading:n}){const[s,i]=dn.useState({commercialName:(t==null?void 0:t.commercialName)||"",legalName:(t==null?void 0:t.legalName)||"",rut:(t==null?void 0:t.rut)||"",phone:(t==null?void 0:t.phone)||"",deliveryDays:(t==null?void 0:t.deliveryDays)||[],orderDays:(t==null?void 0:t.orderDays)||[]}),[o,c]=w.useState(""),l=f=>{let g=f.target.value;g=g.replace(/\D/g,""),g.startsWith("598")&&(g=g.slice(3)),g=g.slice(0,9),i(b=>({...b,phone:g})),g&&!ga(g)?c("Ingrese un número de celular válido de Uruguay (8 o 9 dígitos)"):c("")},d=async f=>{if(f.preventDefault(),s.phone&&!ga(s.phone)){c("Ingrese un número de celular válido de Uruguay (8 o 9 dígitos)");return}await e(s)},u=(f,g)=>{i(b=>{var p,y;return{...b,[g==="delivery"?"deliveryDays":"orderDays"]:(p=b[g==="delivery"?"deliveryDays":"orderDays"])!=null&&p.includes(f)?(y=b[g==="delivery"?"deliveryDays":"orderDays"])==null?void 0:y.filter(x=>x!==f):[...b[g==="delivery"?"deliveryDays":"orderDays"]||[],f]}})},h=s.phone?ji(s.phone):"";return a.jsxs("form",{onSubmit:d,className:"space-y-6",children:[a.jsx(ee,{label:"Nombre comercial",value:s.commercialName,onChange:f=>i(g=>({...g,commercialName:f.target.value})),required:!0}),a.jsx(ee,{label:"Razón social",value:s.legalName,onChange:f=>i(g=>({...g,legalName:f.target.value}))}),a.jsx(ee,{label:"RUT",value:s.rut,onChange:f=>i(g=>({...g,rut:f.target.value}))}),a.jsxs("div",{children:[a.jsx(ee,{label:"Celular",type:"tel",value:s.phone,onChange:l,error:o,placeholder:"93609319"}),s.phone&&a.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:["Se guardará como: ",h]})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"space-y-3",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Días de pedido"}),a.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-7 gap-2",children:Qa.map(({value:f,label:g})=>{var b;return a.jsx("button",{type:"button",onClick:()=>u(f,"order"),className:`
                  px-3 py-2 text-sm font-medium rounded-md transition-colors
                  ${(b=s.orderDays)!=null&&b.includes(f)?"bg-blue-100 text-blue-800 hover:bg-blue-200":"bg-gray-50 text-gray-600 hover:bg-gray-100"}
                `,children:g},f)})})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Días de entrega"}),a.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-7 gap-2",children:Qa.map(({value:f,label:g})=>{var b;return a.jsx("button",{type:"button",onClick:()=>u(f,"delivery"),className:`
                  px-3 py-2 text-sm font-medium rounded-md transition-colors
                  ${(b=s.deliveryDays)!=null&&b.includes(f)?"bg-green-100 text-green-800 hover:bg-green-200":"bg-gray-50 text-gray-600 hover:bg-gray-100"}
                `,children:g},f)})})]})]}),a.jsxs("div",{className:"flex justify-end space-x-4",children:[a.jsx(T,{type:"button",variant:"outline",onClick:r,children:"Cancelar"}),a.jsxs(T,{type:"submit",isLoading:n,children:[t?"Actualizar":"Crear"," Proveedor"]})]})]})}function Jm(){const{providers:t,loading:e,addProvider:r,updateProvider:n,deleteProvider:s}=Zt(),[i,o]=w.useState(!1),[c,l]=w.useState(null),[d,u]=w.useState(!1),[h,f]=w.useState(null),g=async N=>{u(!0);try{c?(await n(c.id,N),P.success("Proveedor actualizado exitosamente")):(await r(N),P.success("Proveedor creado exitosamente")),y()}catch{P.error("Ocurrió un error al guardar el proveedor")}finally{u(!1)}},b=async N=>{f(N)},p=async()=>{if(h)try{await s(h.id),P.success("Proveedor eliminado exitosamente"),f(null)}catch{P.error("Ocurrió un error al eliminar el proveedor")}},y=()=>{o(!1),l(null)},x=N=>{l(N),o(!0)},m=()=>{if(c){const N=qe({isOpen:!0,onClose:()=>{},title:"Advertencia",children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-amber-600",children:"Hay un proveedor en edición. ¿Desea cancelar los cambios y crear uno nuevo?"}),a.jsxs("div",{className:"flex justify-end space-x-2",children:[a.jsx(T,{variant:"outline",onClick:()=>N.close(),children:"Cancelar"}),a.jsx(T,{onClick:()=>{l(null),o(!0),N.close()},children:"Continuar"})]})]})})}else o(!0)};return e?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):i||c?a.jsxs("div",{className:"bg-white p-4 md:p-6 rounded-lg shadow",children:[a.jsxs("h2",{className:"text-xl font-semibold mb-4",children:[c?"Editar":"Nuevo"," Proveedor"]}),a.jsx(Qm,{initialData:c||void 0,onSubmit:g,onCancel:y,isLoading:d})]}):a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"flex justify-end",children:a.jsxs(T,{onClick:m,children:[a.jsx(br,{className:"w-4 h-4 mr-2"}),"Nuevo Proveedor"]})}),a.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:t.map(N=>a.jsxs("div",{className:"bg-white p-4 md:p-6 rounded-lg shadow-sm space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("h3",{className:"text-lg font-semibold break-words",children:N.commercialName}),N.legalName&&a.jsx("p",{className:"text-sm text-gray-600 break-words",children:N.legalName}),N.rut&&a.jsxs("p",{className:"text-sm text-gray-600",children:["RUT: ",N.rut]}),N.phone&&a.jsxs("p",{className:"text-sm text-gray-600",children:["Celular: ",ji(N.phone)]})]}),a.jsxs("div",{className:"flex flex-wrap gap-2 items-center justify-between",children:[a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs(T,{variant:"outline",size:"sm",onClick:()=>x(N),children:[a.jsx(Vr,{className:"w-4 h-4 mr-2"}),"Editar"]}),a.jsxs(T,{variant:"outline",size:"sm",onClick:()=>b(N),children:[a.jsx(zr,{className:"w-4 h-4 mr-2"}),"Eliminar"]})]}),N.phone&&a.jsx("a",{href:Ni(N.phone,""),target:"_blank",rel:"noopener noreferrer",children:a.jsx(T,{variant:"ghost",size:"sm",children:a.jsx(Ac,{className:"w-4 h-4"})})})]})]},N.id))}),a.jsx(qe,{isOpen:!!h,onClose:()=>f(null),title:"Eliminar proveedor",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("p",{className:"text-amber-600",children:['¿Está seguro que desea eliminar el proveedor "',h==null?void 0:h.commercialName,'"?']}),a.jsxs("div",{className:"flex justify-end space-x-2",children:[a.jsx(T,{variant:"outline",onClick:()=>f(null),children:"Cancelar"}),a.jsx(T,{onClick:p,children:"Eliminar"})]})]})})]})}function Ko({providers:t,selectedProviderId:e,onChange:r}){const[n,s]=w.useState(!1),[i,o]=w.useState(""),c=t.find(f=>f.id===e),l=w.useRef(null);w.useEffect(()=>{const f=g=>{l.current&&!l.current.contains(g.target)&&s(!1)};return document.addEventListener("mousedown",f),()=>document.removeEventListener("mousedown",f)},[]);const d=t.filter(f=>{var g;return f.commercialName.toLowerCase().includes(i.toLowerCase())||((g=f.legalName)==null?void 0:g.toLowerCase().includes(i.toLowerCase()))}),u=f=>{r(f),s(!1),o("")},h=f=>{f.stopPropagation(),r(""),o("")};return a.jsxs("div",{className:"relative",ref:l,children:[a.jsx("div",{className:"mb-2",children:a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Proveedor"})}),a.jsx("div",{role:"button",tabIndex:0,onClick:()=>s(!n),onKeyDown:f=>{(f.key==="Enter"||f.key===" ")&&s(!n)},className:je("relative w-full rounded-lg border bg-white px-4 py-3 h-[48px] cursor-pointer","focus:outline-none focus:ring-2 focus:ring-blue-500",e?"border-blue-200 hover:border-blue-300":"border-gray-200 hover:border-gray-300","transition-all duration-200 flex items-center"),children:a.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[a.jsx(li,{className:`
            w-5 h-5 flex-shrink-0
            ${e?"text-blue-500":"text-gray-400"}
          `}),a.jsx("div",{className:"flex-1 min-w-0",children:c?a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900 truncate",children:c.commercialName}),c.legalName&&c.legalName!==c.commercialName&&a.jsx("div",{className:"text-sm text-gray-500 truncate",children:c.legalName})]}):a.jsx("span",{className:"text-gray-500",children:"Seleccionar proveedor..."})}),a.jsxs("div",{className:"flex items-center gap-2",children:[e&&a.jsx("div",{role:"button",tabIndex:0,onClick:h,onKeyDown:f=>{(f.key==="Enter"||f.key===" ")&&h(f)},className:"p-1 hover:bg-gray-100 rounded-full transition-colors cursor-pointer",children:a.jsx(It,{className:"w-4 h-4 text-gray-400"})}),a.jsx(Ec,{className:`
              w-5 h-5 transition-transform duration-200
              ${e?"text-blue-500":"text-gray-400"}
              ${n?"rotate-180":""}
            `})]})]})}),n&&a.jsxs("div",{className:"absolute z-10 mt-2 w-full rounded-lg bg-white shadow-lg border border-gray-200",children:[a.jsx("div",{className:"p-2 border-b",children:a.jsxs("div",{className:"relative",children:[a.jsx(jt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),a.jsx("input",{type:"text",value:i,onChange:f=>o(f.target.value),placeholder:"Buscar proveedor...",className:`
                  w-full rounded-md border border-gray-200 pl-9 pr-4 py-2 text-sm
                  placeholder-gray-400 focus:border-blue-500 focus:ring-1 focus:ring-blue-500
                `})]})}),a.jsx("div",{className:"max-h-60 overflow-auto",children:d.length>0?a.jsx("div",{className:"py-1",children:d.map(f=>a.jsxs("div",{role:"button",tabIndex:0,onClick:()=>u(f.id),onKeyDown:g=>{(g.key==="Enter"||g.key===" ")&&u(f.id)},className:je("px-4 py-2 cursor-pointer hover:bg-gray-50 transition-colors",f.id===e&&"bg-blue-50"),children:[a.jsx("div",{className:"font-medium text-gray-900",children:f.commercialName}),f.legalName&&f.legalName!==f.commercialName&&a.jsx("div",{className:"text-sm text-gray-500",children:f.legalName})]},f.id))}):a.jsx("div",{className:"px-4 py-3 text-sm text-gray-500 text-center",children:"No se encontraron proveedores"})})]})]})}function Xo(t){const[e,r]=w.useState([]),[n,s]=w.useState(!0),i=Lt.get(Oe.ProductRepository);return w.useEffect(()=>{if(!t){r([]),s(!1);return}const d=i.subscribeToProviderProducts(t,u=>{r(u),s(!1)});return()=>d()},[t,i]),{products:e,loading:n,addProduct:async d=>{try{await i.create(d),P.success("Producto creado exitosamente")}catch(u){throw console.error("Error creating product:",u),u}},updateProduct:async(d,u)=>{try{await i.update(d,u),P.success("Producto actualizado exitosamente")}catch(h){throw console.error("Error updating product:",h),h}},deleteProduct:async d=>{try{await i.delete(d),P.success("Producto eliminado exitosamente")}catch(u){throw console.error("Error deleting product:",u),u}}}}function Ja({product:t,onEdit:e,onDelete:r}){return a.jsx("div",{className:"bg-gradient-to-br from-gray-50 to-white rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-shadow p-4",children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"flex items-start justify-between gap-2",children:a.jsxs("h3",{className:"text-lg font-semibold text-gray-900 truncate",children:[t.name,t.isProduction&&a.jsxs("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-amber-100 text-amber-800",children:[a.jsx(js,{className:"w-3 h-3 mr-1"}),"Producción"]})]})}),a.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm text-gray-600",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(Mt,{className:"w-4 h-4 mr-1.5 flex-shrink-0 text-gray-500"}),a.jsx("span",{className:"truncate",children:t.purchasePackaging})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(Ss,{className:"w-4 h-4 mr-1.5 flex-shrink-0 text-gray-500"}),a.jsxs("span",{children:["Stock: ",t.minPackageStock," - ",t.desiredStock]})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(di,{className:"w-4 h-4 mr-1.5 flex-shrink-0 text-gray-500"}),a.jsx("span",{className:"truncate",children:t.supplierCode||"Sin código"})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(Os,{className:"w-4 h-4 mr-1.5 text-gray-400"}),a.jsx("span",{children:Mi(t.order)})]})]}),a.jsxs("div",{className:"flex items-center justify-between gap-2 pt-2 border-t",children:[a.jsx("div",{className:"text-xl font-bold text-blue-600",children:ce(t.price)}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(T,{variant:"outline",size:"sm",onClick:()=>e(t),children:[a.jsx(Vr,{className:"w-4 h-4 mr-2"}),"Editar"]}),a.jsxs(T,{variant:"outline",size:"sm",onClick:()=>r(t),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:[a.jsx(zr,{className:"w-4 h-4 mr-2"}),"Eliminar"]})]})]})]})})}function Zm(t){const[e,r]=w.useState(!1);return w.useEffect(()=>{const n=window.matchMedia(t);r(n.matches);const s=i=>{r(i.matches)};return n.addEventListener("change",s),()=>n.removeEventListener("change",s)},[t]),e}function eg({products:t,onEdit:e,onDelete:r}){const n=Zm("(min-width: 1024px)"),s=[...t].sort((i,o)=>i.order-o.order);return n?a.jsx("div",{className:"grid grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-4",children:s.map(i=>a.jsx(Ja,{product:i,onEdit:e,onDelete:r},i.id))}):a.jsx("div",{className:"space-y-4",children:s.map(i=>a.jsx(Ja,{product:i,onEdit:e,onDelete:r},i.id))})}function tg({onProductSelect:t}){const[e,r]=w.useState(""),[n,s]=w.useState([]),{products:i,loading:o}=Ft();return w.useEffect(()=>{if(!e.trim()){s([]);return}const c=e.toLowerCase(),l=i.filter(d=>{var u,h;return d.name.toLowerCase().includes(c)||d.sku.toLowerCase().includes(c)||((u=d.supplierCode)==null?void 0:u.toLowerCase().includes(c))||((h=d.tags)==null?void 0:h.some(f=>f.toLowerCase().includes(c)))}).sort((d,u)=>{const h=d.name.toLowerCase().startsWith(c),f=u.name.toLowerCase().startsWith(c);return h&&!f?-1:!h&&f?1:d.name.localeCompare(u.name)}).slice(0,5);s(l)},[e,i]),a.jsxs("div",{className:"relative mb-6",children:[a.jsxs("div",{className:"relative",children:[a.jsx(ee,{placeholder:"Buscar productos globalmente...",value:e,onChange:c=>r(c.target.value),className:"pl-10"}),a.jsx(jt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"})]}),n.length>0&&a.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-auto",children:n.map(c=>a.jsx("button",{onClick:()=>t(c),className:"w-full px-4 py-2 text-left hover:bg-gray-50",children:a.jsxs("div",{className:"flex items-center justify-between gap-4",children:[a.jsxs("div",{className:"min-w-0",children:[a.jsx("div",{className:"font-medium text-gray-900 truncate",children:c.name}),a.jsxs("div",{className:"text-sm text-gray-500",children:["SKU: ",c.sku,c.supplierCode&&a.jsxs("span",{className:"ml-2",children:["• Código: ",c.supplierCode]})]})]}),a.jsx("div",{className:"text-blue-600 font-medium whitespace-nowrap",children:ce(c.price)})]})},c.id))}),e&&n.length===0&&!o&&a.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg p-4 text-center text-gray-500",children:"No se encontraron productos"})]})}function rg({products:t,onFilter:e}){const[r,n]=w.useState(""),[s,i]=w.useState(!1);w.useEffect(()=>{const c=r.toLowerCase(),d=t.filter(u=>{var h,f;return s&&!u.isProduction?!1:!c&&!s?!0:u.name.toLowerCase().includes(c)||u.sku.toLowerCase().includes(c)||((h=u.supplierCode)==null?void 0:h.toLowerCase().includes(c))||((f=u.tags)==null?void 0:f.some(g=>g.toLowerCase().includes(c)))}).sort((u,h)=>{if(s){if(u.isProduction&&!h.isProduction)return-1;if(!u.isProduction&&h.isProduction)return 1}return u.name.localeCompare(h.name)});e(d,r.length>0||s)},[r,s,t,e]);const o=t.filter(c=>c.isProduction).length;return a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx(ee,{placeholder:"Filtrar productos...",value:r,onChange:c=>n(c.target.value),className:"pl-10"}),a.jsx(jt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"})]}),a.jsxs(T,{variant:s?"primary":"outline",onClick:()=>i(!s),className:"flex items-center gap-2 min-w-[140px] justify-center",title:s?"Mostrar todos":"Solo producción",children:[a.jsx(ui,{className:"w-4 h-4"}),a.jsxs("span",{className:"text-sm",children:["Producción (",o,")"]})]})]})}function ng({label:t,value:e=[],onChange:r,suggestions:n=[],error:s,className:i}){const[o,c]=w.useState(""),[l,d]=w.useState(!1),u=w.useRef(null),h=w.useRef(null);w.useEffect(()=>{const m=N=>{h.current&&!h.current.contains(N.target)&&d(!1)};return document.addEventListener("mousedown",m),()=>document.removeEventListener("mousedown",m)},[]);const f=m=>{c(m.target.value.toUpperCase()),d(!0)},g=m=>{m.key==="Enter"&&o.trim()?(m.preventDefault(),b(o.trim())):m.key==="Backspace"&&!o&&e.length>0&&p(e[e.length-1])},b=m=>{const N=m.toUpperCase();e.includes(N)||r([...e,N]),c(""),d(!1)},p=m=>{r(e.filter(N=>N!==m))},y=m=>{var N;b(m),(N=u.current)==null||N.focus()},x=n.filter(m=>!e.includes(m)&&m.includes(o.toUpperCase()));return a.jsxs("div",{ref:h,className:"relative",children:[t&&a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:t}),a.jsxs("div",{className:je("flex flex-wrap items-center gap-2 min-h-[42px] w-full rounded-lg border border-gray-300 bg-white px-3 py-1.5","focus-within:border-blue-500 focus-within:ring-1 focus-within:ring-blue-500",s&&"border-red-500 focus-within:border-red-500 focus-within:ring-red-500",i),children:[e.map(m=>a.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-sm bg-blue-100 text-blue-800",children:[m,a.jsx("button",{type:"button",onClick:()=>p(m),className:"ml-1 p-0.5 hover:bg-blue-200 rounded-full transition-colors",children:a.jsx(It,{className:"w-3 h-3"})})]},m)),a.jsx("div",{className:"flex-1 min-w-[120px]",children:a.jsx("input",{ref:u,type:"text",className:"w-full outline-none bg-transparent text-gray-900 placeholder-gray-500 text-sm",value:o,onChange:f,onKeyDown:g,onFocus:()=>d(!0),placeholder:"Agregar etiqueta..."})})]}),s&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:s}),l&&o&&x.length>0&&a.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-auto",children:x.map(m=>a.jsxs("button",{type:"button",className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 focus:bg-gray-100 focus:outline-none flex items-center gap-2",onClick:()=>y(m),children:[a.jsx(br,{className:"w-4 h-4 text-gray-400"}),m]},m))})]})}function sg(){const[t,e]=w.useState([]),[r,n]=w.useState(!0);return w.useEffect(()=>{const i=z(W,"measures"),o=Ve(i,c=>{const l=c.val(),d=l?Object.values(l):[];e([...d].sort()),n(!1)});return()=>o()},[]),{measures:t,loading:r,addMeasure:async i=>{const o=z(W,"measures"),c=Nt(o);await xr(c,i.toUpperCase())}}}function ln({value:t,onChange:e,required:r,className:n,label:s,placeholder:i="Seleccionar..."}){const{measures:o,loading:c}=sg();return a.jsxs("div",{className:"space-y-2",children:[s&&a.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[s,r&&a.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),a.jsxs("select",{value:t,onChange:l=>e(l.target.value),required:r,disabled:c,className:je("w-full rounded-md border border-gray-300 px-3 py-2 text-gray-900","focus:border-blue-500 focus:ring-1 focus:ring-blue-500","disabled:bg-gray-50 disabled:text-gray-500",n),children:[a.jsx("option",{value:"",disabled:!0,children:c?"Cargando...":i}),!c&&o.map(l=>a.jsx("option",{value:l,children:l},l))]})]})}function ag(){const[t,e]=w.useState([]),[r,n]=w.useState(!0);return w.useEffect(()=>{const i=z(W,"tags"),o=z(W,"products"),c=Ve(i,d=>{const u=d.val(),h=u?Object.values(u):[];e(h.sort()),n(!1)}),l=Ve(o,d=>{const u=d.val();if(u){const h=Object.values(u).flatMap(f=>f.tags||[]).filter(Boolean).map(f=>f.toUpperCase());e(f=>[...new Set([...f,...h])].sort())}});return()=>{c(),l()}},[]),{tags:t,loading:r,addTag:async i=>{const o=z(W,"tags"),c=Nt(o);await xr(c,i.toUpperCase())}}}const Za={GRL:{bg:"bg-gray-100",border:"border-gray-200",text:"text-gray-800"},GFR:{bg:"bg-green-100",border:"border-green-200",text:"text-green-800"},GRE:{bg:"bg-emerald-100",border:"border-emerald-200",text:"text-emerald-800"},GTM:{bg:"bg-teal-100",border:"border-teal-200",text:"text-teal-800"},GPA:{bg:"bg-amber-100",border:"border-amber-200",text:"text-amber-800"},GSC:{bg:"bg-orange-100",border:"border-orange-200",text:"text-orange-800"},HEL:{bg:"bg-blue-100",border:"border-blue-200",text:"text-blue-800"},REF:{bg:"bg-indigo-100",border:"border-indigo-200",text:"text-indigo-800"},CON:{bg:"bg-purple-100",border:"border-purple-200",text:"text-purple-800"},FRU:{bg:"bg-rose-100",border:"border-rose-200",text:"text-rose-800"}};function ig(t){return Za[t]||Za.GRL}function Qo({providerId:t,initialData:e,onSubmit:r,onCancel:n,isLoading:s,onDirtyChange:i}){const{providers:o}=Zt(),{tags:c,addTag:l}=ag(),[d,u]=w.useState({name:(e==null?void 0:e.name)||"",sku:(e==null?void 0:e.sku)||"",supplierCode:(e==null?void 0:e.supplierCode)||"",purchasePackaging:(e==null?void 0:e.purchasePackaging)||"",salePackaging:(e==null?void 0:e.salePackaging)||"",order:(e==null?void 0:e.order)||0,price:(e==null?void 0:e.price)||0,desiredStock:(e==null?void 0:e.desiredStock)||0,minPackageStock:(e==null?void 0:e.minPackageStock)||0,providerId:(e==null?void 0:e.providerId)||t,tags:(e==null?void 0:e.tags)||[],isProduction:(e==null?void 0:e.isProduction)||!1,unitMeasure:(e==null?void 0:e.unitMeasure)||"UNIDAD",pricePerUnit:(e==null?void 0:e.pricePerUnit)||0}),h=(b,p)=>{u(y=>{const x={[b]:p};return b==="isProduction"&&p===!0&&(x.unitMeasure=y.unitMeasure||"UNIDAD"),{...y,...x}})},f=async b=>{b.preventDefault(),await r(d)},g=ig(Ei(d.order));return a.jsxs("form",{onSubmit:f,className:"space-y-6",children:[a.jsxs(D,{children:[a.jsx(D.Header,{children:a.jsx(D.Title,{children:"Información Básica"})}),a.jsxs(D.Content,{className:"space-y-4",children:[a.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[a.jsx(ee,{label:"Nombre del producto",value:d.name,onChange:b=>h("name",b.target.value.toUpperCase()),required:!0}),a.jsx(ee,{label:"SKU",value:d.sku,onChange:b=>h("sku",b.target.value.toUpperCase()),required:!0})]}),a.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Proveedor"}),a.jsx("select",{value:d.providerId,onChange:b=>h("providerId",b.target.value),className:"w-full rounded-md border border-gray-300 px-3 py-2 text-gray-900 focus:border-blue-500 focus:ring-1 focus:ring-blue-500",children:o.map(b=>a.jsx("option",{value:b.id,children:b.commercialName},b.id))})]}),a.jsx(ee,{label:"Código de proveedor",value:d.supplierCode,onChange:b=>h("supplierCode",b.target.value.toUpperCase()),placeholder:"Código asignado por el proveedor"})]}),a.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[a.jsx(ln,{label:"Empaque de Compra",value:d.purchasePackaging,onChange:b=>h("purchasePackaging",b),required:!0,placeholder:"Seleccionar empaque de compra"}),a.jsx(ln,{label:"Empaque de Venta",value:d.salePackaging,onChange:b=>h("salePackaging",b),placeholder:"Seleccionar empaque de venta"})]})]})]}),a.jsxs(D,{children:[a.jsx(D.Header,{children:a.jsx(D.Title,{children:"Material de Producción"})}),a.jsx(D.Content,{children:a.jsxs("fieldset",{children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",id:"isProduction",checked:d.isProduction,onChange:b=>h("isProduction",b.target.checked),className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),a.jsxs("label",{htmlFor:"isProduction",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[a.jsx(js,{className:"w-4 h-4"}),"Material de producción"]})]}),d.isProduction&&a.jsxs("div",{className:"mt-4 grid gap-4 sm:grid-cols-2",children:[a.jsx(ln,{label:"Unidad de Medida",value:d.unitMeasure||"UNIDAD",onChange:b=>h("unitMeasure",b),required:!0,placeholder:"Seleccionar unidad de medida"}),a.jsx(ee,{label:"Precio por Unidad",type:"number",value:d.pricePerUnit,onChange:b=>h("pricePerUnit",parseFloat(b.target.value)||0),min:0,step:"0.01",required:!0,isCurrency:!0})]})]})})]}),a.jsxs(D,{children:[a.jsx(D.Header,{children:a.jsx(D.Title,{children:"Etiquetas y Orden"})}),a.jsxs(D.Content,{className:"space-y-4",children:[a.jsx(ng,{label:"Etiquetas",value:d.tags,onChange:async b=>{h("tags",b);for(const p of b)c.includes(p)||await l(p)},suggestions:c}),a.jsx("div",{className:`rounded-lg p-4 border ${g.bg} ${g.border}`,children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("label",{className:`text-sm font-medium ${g.text}`,children:"Orden del Producto"}),a.jsx("div",{className:`text-lg font-bold mt-1 ${g.text}`,children:Mi(d.order)})]}),a.jsx(Os,{className:`w-5 h-5 ${g.text}`})]})})]})]}),a.jsxs(D,{children:[a.jsx(D.Header,{children:a.jsx(D.Title,{children:"Precio y Stock"})}),a.jsxs(D.Content,{className:"space-y-4",children:[a.jsx(ee,{label:"Precio",value:d.price,onChange:b=>h("price",parseFloat(b.target.value)||0),min:0,required:!0,isCurrency:!0}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsx(ee,{label:"Stock mínimo",type:"number",value:d.minPackageStock,onChange:b=>h("minPackageStock",parseInt(b.target.value)||0),min:0,required:!0}),a.jsx(ee,{label:"Stock deseado",type:"number",value:d.desiredStock,onChange:b=>h("desiredStock",parseInt(b.target.value)||0),min:0,required:!0})]})]})]}),a.jsxs("div",{className:"flex justify-end space-x-4",children:[a.jsx(T,{type:"button",variant:"outline",onClick:n,disabled:s,children:"Cancelar"}),a.jsxs(T,{type:"submit",isLoading:s,children:[e?"Actualizar":"Crear"," Producto"]})]})]})}function og({providerId:t,initialData:e,onSubmit:r,onCancel:n,isLoading:s}){const[i,o]=w.useState(!1),c=()=>{i?confirm("¿Está seguro que desea descartar los cambios?")&&n():n()};return a.jsxs("div",{className:"fixed inset-0 bg-white z-50 flex flex-col",children:[a.jsx("div",{className:"border-b bg-white",children:a.jsxs("div",{className:"flex items-center justify-between px-4 h-14",children:[a.jsxs("h2",{className:"text-lg font-semibold",children:[e?"Editar":"Nuevo"," Producto"]}),a.jsx(T,{variant:"ghost",size:"sm",onClick:c,className:"p-2 hover:bg-gray-100 rounded-full",children:a.jsx(It,{className:"w-5 h-5"})})]})}),a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx("div",{className:"h-full overflow-y-auto px-4 py-6",children:a.jsx("div",{className:"max-w-3xl mx-auto",children:a.jsx(Qo,{providerId:t,initialData:e,onSubmit:r,onCancel:n,isLoading:s,onDirtyChange:o})})})})]})}function Jo(t){const e=t.toString().padStart(5,"0"),r=parseInt(e.slice(0,2))-1;return r>=0&&r<At.length?At[r].code:At[0].code}function cg(t){const e=t.toString().padStart(5,"0");return parseInt(e.slice(2))}function lg(t,e){const r=At.findIndex(n=>n.code===t)+1;return parseInt(`${r.toString().padStart(2,"0")}${e.toString().padStart(3,"0")}`)}function dg(t){const e=Jo(t),r=cg(t);return`${e}-${r.toString().padStart(3,"0")}`}function ug(){const{providers:t}=Zt(),[e,r]=w.useState(""),{products:n,loading:s,addProduct:i,updateProduct:o,deleteProduct:c}=Xo(e),[l,d]=w.useState([]),[u,h]=w.useState(!1),[f,g]=w.useState(null),[b,p]=w.useState(!1),[y,x]=w.useState(null),[m,N]=w.useState(!1),S=async H=>{p(!0);try{if(f)await o(f.id,H),q();else{const V=At[0].code,ot=n.filter(He=>Jo(He.order)===V),De=lg(V,ot.length+1);await i({...H,order:De}),q()}}catch(V){console.error("Error al guardar producto:",V),P.error("Error al guardar el producto")}finally{p(!1)}},A=async H=>{x(H)},B=async()=>{if(y)try{await c(y.id),x(null)}catch{P.error("Error al eliminar el producto")}},q=()=>{h(!1),g(null)},le=H=>{g(H),h(!0)},ge=()=>{if(f){const H=qe({isOpen:!0,onClose:()=>{},title:"Advertencia",children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-amber-600",children:"Hay un producto en edición. ¿Desea cancelar los cambios y crear uno nuevo?"}),a.jsxs("div",{className:"flex justify-end space-x-2",children:[a.jsx(T,{variant:"outline",onClick:()=>H.close(),children:"Cancelar"}),a.jsx(T,{onClick:()=>{g(null),h(!0),H.close()},children:"Continuar"})]})]})})}else h(!0)},F=w.useCallback((H,V)=>{d(H),N(V)},[]);return a.jsxs("div",{className:"space-y-6",children:[a.jsx(tg,{onProductSelect:le}),a.jsx("div",{className:"space-y-4 md:space-y-0",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:items-end gap-4",children:[a.jsx("div",{className:"flex-1",children:a.jsx(Ko,{providers:t,selectedProviderId:e,onChange:r})}),e&&a.jsx("div",{className:"flex-shrink-0 w-full md:w-auto",children:a.jsxs(T,{onClick:ge,className:"w-full md:w-auto bg-blue-500 hover:bg-blue-600 text-white h-[48px] px-6 rounded-lg shadow-sm hover:shadow transition-all",children:[a.jsx(br,{className:"w-5 h-5 mr-2"}),a.jsx("span",{className:"whitespace-nowrap",children:"Nuevo Producto"})]})})]})}),u&&a.jsx(og,{providerId:(f==null?void 0:f.providerId)||e,initialData:f||void 0,onSubmit:S,onCancel:q,isLoading:b}),e?s?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):!u&&a.jsxs(a.Fragment,{children:[a.jsx(rg,{products:n,onFilter:F}),!m||l.length>0?a.jsx(eg,{products:m?l:n,onEdit:le,onDelete:A,providerId:e}):a.jsx("div",{className:"flex items-center justify-center h-64 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:a.jsx("p",{className:"text-gray-500 text-center px-4",children:"No se encontraron productos que coincidan con la búsqueda"})})]}):a.jsx("div",{className:"flex items-center justify-center h-64 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:a.jsx("p",{className:"text-gray-500 text-center px-4",children:"Seleccione un proveedor para ver sus productos"})}),a.jsx(qe,{isOpen:!!y,onClose:()=>x(null),title:"Eliminar producto",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("p",{className:"text-amber-600",children:['¿Está seguro que desea eliminar el producto "',y==null?void 0:y.name,'"?']}),a.jsxs("div",{className:"flex justify-end space-x-2",children:[a.jsx(T,{variant:"outline",onClick:()=>x(null),children:"Cancelar"}),a.jsx(T,{onClick:B,children:"Eliminar"})]})]})})]})}const Zo=`
  /* Reset */
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  /* Base styles */
  body {
    font-family: 'Courier New', monospace;
    font-size: 12px;
    line-height: 1.2;
    background: #f3f4f6;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  /* Preview Container */
  .content {
    width: 80mm;
    background: white;
    margin: 20px auto;
    padding: 2mm;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    border-radius: 4px;
  }

  /* Header */
  .header {
    margin-bottom: 3mm;
    border-bottom: 1px dashed #000;
    padding-bottom: 2mm;
  }

  .header div {
    margin-bottom: 1mm;
    font-weight: bold;
  }

  /* Business Info - Larger */
  .header div:nth-child(1) {
    font-size: 14px;
  }

  /* Owner Info */
  .header div:nth-child(2) {
    font-size: 12px;
  }

  /* Date - Smaller */
  .header div:nth-child(3) {
    font-size: 10px;
  }

  /* Table */
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 2mm;
  }

  tr {
    border-bottom: none;
  }

  td {
    padding: 0.5mm 1mm;
    font-size: 12px;
    vertical-align: top;
  }

  td.quantity {
    white-space: nowrap;
    padding-right: 2mm;
    width: 1%;
    font-weight: bold;
  }

  td.name {
    word-break: break-word;
  }

  /* Summary Section */
  .summary {
    margin-top: 3mm;
    padding-top: 2mm;
    border-top: 1px dashed #000;
  }

  .summary-row {
    display: flex;
    justify-content: space-between;
    margin-bottom: 1mm;
    font-size: 12px;
  }

  .summary-label {
    font-weight: normal;
  }

  .summary-value {
    font-weight: bold;
  }

  /* Print Controls */
  .controls {
    position: fixed;
    top: 20px;
    right: 20px;
    display: flex;
    gap: 10px;
    z-index: 100;
  }

  .print-button {
    padding: 12px 24px;
    background: #2563eb;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all 0.2s;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }

  .print-button:hover {
    background: #1d4ed8;
    transform: translateY(-1px);
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  }

  .print-button:active {
    transform: translateY(0);
  }

  .print-button:disabled {
    background: #9ca3af;
    cursor: not-allowed;
    transform: none;
  }

  .print-button svg {
    width: 16px;
    height: 16px;
  }

  /* Print Media Styles */
  @media print {
    @page {
      size: 80mm auto;
      margin: 0;
    }

    body {
      width: 80mm;
      margin: 0;
      padding: 0;
      background: white;
      min-height: auto;
    }

    .content {
      width: 100%;
      margin: 0;
      padding: 2mm;
      box-shadow: none;
      border-radius: 0;
    }

    .controls {
      display: none !important;
    }

    /* Print header styles */
    .header {
      margin-bottom: 3mm;
      padding-bottom: 2mm;
    }

    .header div:nth-child(1) {
      font-size: 14px;
      font-weight: bold;
    }

    .header div:nth-child(2) {
      font-size: 12px;
      font-weight: bold;
    }

    .header div:nth-child(3) {
      font-size: 10px;
    }

    /* Print table styles */
    table {
      margin: 2mm 0;
    }

    td {
      padding: 0.5mm 1mm;
      font-size: 12px;
    }

    td.quantity {
      font-weight: bold;
    }

    /* Print summary styles */
    .summary {
      margin-top: 3mm;
      padding-top: 2mm;
      border-top: 1px dashed #000;
    }

    .summary-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 1mm;
      font-size: 12px;
    }

    .summary-label {
      font-weight: normal;
    }

    .summary-value {
      font-weight: bold;
    }
  }
`,ec=`
  let isPrinting = false;
  let retryCount = 0;
  const MAX_RETRIES = 3;

  function createPrintIcon() {
    return \`
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z" />
      </svg>
    \`;
  }

  function showError(message) {
    const existingError = document.querySelector('.error-message');
    if (existingError) {
      existingError.remove();
    }

    const errorDiv = document.createElement('div');
    errorDiv.className = 'error-message';
    errorDiv.textContent = message;
    document.body.appendChild(errorDiv);

    const printButton = document.getElementById('print-button');
    if (printButton) {
      printButton.disabled = false;
    }

    // Auto-hide error after 5 seconds
    setTimeout(() => {
      errorDiv.remove();
    }, 5000);
  }

  function setupPrintButton() {
    const printButton = document.getElementById('print-button');
    if (printButton) {
      printButton.innerHTML = createPrintIcon() + 'Imprimir';
    }
  }

  function handlePrint() {
    if (isPrinting) return;

    try {
      const printButton = document.getElementById('print-button');
      printButton.disabled = true;
      isPrinting = true;

      window.print();

      // Handle print completion
      window.onafterprint = () => {
        isPrinting = false;
        setTimeout(() => {
          window.close();
        }, 100);
      };

      // Timeout handler for print dialog
      setTimeout(() => {
        if (!window.closed && isPrinting) {
          isPrinting = false;
          printButton.disabled = false;
          
          if (retryCount < MAX_RETRIES) {
            retryCount++;
            showError('La impresión está tardando más de lo esperado. Intente nuevamente.');
          } else {
            showError('No se pudo completar la impresión. Por favor, cierre esta ventana e intente nuevamente.');
          }
        }
      }, 2000);

    } catch (error) {
      console.error('Print error:', error);
      isPrinting = false;
      showError('Error al imprimir. Por favor, intente nuevamente.');
    }
  }

  window.onload = () => {
    try {
      setupPrintButton();
      // Delay initial print to ensure content is rendered
      setTimeout(handlePrint, 800);
    } catch (error) {
      console.error('Print error:', error);
      showError('Error al iniciar la impresión. Por favor, use el botón Imprimir.');
    }
  };

  window.onerror = (message, source, lineno, colno, error) => {
    console.error('Print error:', { message, source, lineno, colno, error });
    showError('Ocurrió un error inesperado. Por favor, intente nuevamente.');
    return false;
  };
`;function hg(t,e){const r=xe(new Date,"dd/MM/yyyy HH:mm",{locale:we}),s=t.materials.sort((i,o)=>{const c=e.find(d=>d.id===i.productId),l=e.find(d=>d.id===o.productId);return!c||!l?0:c.order-l.order}).map(i=>{const o=e.find(c=>c.id===i.productId);return o?`
        <tr>
          <td class="quantity">${i.quantity} ${i.unit}</td>
          <td class="material">${o.name}</td>
        </tr>
      `:""}).join("");return`
    <!DOCTYPE html>
    <html>
      <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Receta: ${t.name}</title>
        <style>
          ${Zo}
          
          /* Recipe specific styles */
          .recipe-header {
            text-align: center;
            margin: 3mm 0;
            padding-bottom: 2mm;
            border-bottom: 1px dashed #000;
          }
          
          .recipe-header h1 {
            font-size: 16px;
            font-weight: bold;
            margin: 0 0 2mm 0;
          }
          
          .recipe-header p {
            font-size: 12px;
            margin: 0;
          }
          
          table thead tr th {
            font-size: 12px;
            font-weight: bold;
            padding: 1mm 0;
          }
          
          table thead tr th.quantity-header {
            text-align: left;
            width: 30%;
          }
          
          table thead tr th.material-header {
            text-align: right;
            width: 70%;
          }
          
          td.quantity {
            font-weight: bold;
            width: 30%;
            text-align: left;
            white-space: nowrap;
          }
          
          td.material {
            width: 70%;
            text-align: right;
            padding-left: 2mm;
          }
          
          .notes {
            margin-top: 3mm;
            padding-top: 2mm;
            border-top: 1px dashed #000;
          }
          
          .notes h2 {
            font-size: 12px;
            font-weight: bold;
            margin: 0 0 1mm 0;
          }
          
          .notes p {
            font-size: 12px;
            margin: 0;
            white-space: pre-line;
          }
        </style>
      </head>
      <body>
        <div class="content">
          <div class="header">
            <div>${Tt.name}</div>
            <div>${Tt.owner}</div>
            <div>Fecha: ${r}</div>
          </div>

          <div class="recipe-header">
            <h1>${t.name}</h1>
            <p>Rendimiento: ${t.yield} ${t.yieldUnit}</p>
          </div>

          <table>
            <thead>
              <tr>
                <th class="quantity-header">Cantidad</th>
                <th class="material-header">Material</th>
              </tr>
            </thead>
            <tbody>
              ${s}
            </tbody>
          </table>

          ${t.notes?`
            <div class="notes">
              <h2>Notas:</h2>
              <p>${t.notes.replace(/\n/g,"<br>")}</p>
            </div>
          `:""}
        </div>

        <div class="controls">
          <button id="print-button" class="print-button">
            Imprimir
          </button>
        </div>

        <script>${ec}<\/script>
      </body>
    </html>
  `}function fg({recipes:t,onEdit:e,onDelete:r}){var f;const[n,s]=w.useState(null),[i,o]=w.useState(null),{products:c}=Ft(),l=g=>{s(g)},d=async()=>{n&&(await r(n),s(null))},u=g=>{const b=hg(g,c),p=window.open("","_blank");if(!p)throw new Error("No se pudo crear la pestaña de impresión");p.document.write(b),p.document.close()},h=g=>{var y;if(!((y=g.costHistory)!=null&&y.length))return"";const b=g.costHistory[g.costHistory.length-1],p=g.costThreshold||20;return Math.abs(b.changePercentage)>p?b.changePercentage>0?"bg-red-50 border-red-200":"bg-green-50 border-green-200":""};return t.length===0?a.jsx("div",{className:"text-center py-12 bg-gray-50 rounded-lg border-2 border-dashed",children:a.jsx("p",{className:"text-gray-500",children:"No hay recetas para mostrar"})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:t.map(g=>a.jsxs("div",{className:`bg-white rounded-lg shadow-sm border p-4 space-y-4 transition-colors ${h(g)}`,children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:g.name}),a.jsxs("p",{className:"text-sm text-gray-500",children:["Rendimiento: ",g.yield," ",g.yieldUnit]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Costo Total:"}),a.jsx("p",{className:"font-medium",children:ce(g.totalCost)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Costo Unitario:"}),a.jsxs("p",{className:"font-medium",children:[ce(g.unitCost)," / ",g.yieldUnit]})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("span",{className:"text-gray-500",children:"Precio Sugerido:"}),a.jsxs("p",{className:"font-medium text-blue-600",children:[ce(g.suggestedPrice)," / ",g.yieldUnit]})]})]}),a.jsxs("div",{className:"flex justify-end gap-1 pt-2 border-t",children:[a.jsx(T,{variant:"ghost",size:"sm",onClick:()=>o(g),title:"Ver historial de costos",className:"w-9 h-9 p-0",children:a.jsx(Mc,{className:"w-4 h-4"})}),a.jsx(T,{variant:"ghost",size:"sm",onClick:()=>u(g),title:"Imprimir receta",className:"w-9 h-9 p-0",children:a.jsx(Cs,{className:"w-4 h-4"})}),a.jsx(T,{variant:"ghost",size:"sm",onClick:()=>e(g),title:"Editar receta",className:"w-9 h-9 p-0",children:a.jsx(Vr,{className:"w-4 h-4"})}),a.jsx(T,{variant:"ghost",size:"sm",onClick:()=>l(g),title:"Eliminar receta",className:"w-9 h-9 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",children:a.jsx(zr,{className:"w-4 h-4"})})]})]},g.id))}),a.jsx(qe,{isOpen:!!n,onClose:()=>s(null),title:"Eliminar receta",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("p",{className:"text-amber-600",children:['¿Está seguro que desea eliminar la receta "',n==null?void 0:n.name,'"?']}),a.jsxs("div",{className:"flex justify-end space-x-2",children:[a.jsx(T,{variant:"outline",onClick:()=>s(null),children:"Cancelar"}),a.jsx(T,{onClick:d,children:"Eliminar"})]})]})}),a.jsx(qe,{isOpen:!!i,onClose:()=>o(null),title:`Historial de Costos - ${i==null?void 0:i.name}`,children:a.jsxs("div",{className:"space-y-4",children:[(f=i==null?void 0:i.costHistory)!=null&&f.length?a.jsx("div",{className:"space-y-3",children:i.costHistory.map((g,b)=>{const p=b===0?i.unitCost:i.costHistory[b-1].unitCost;return a.jsxs("div",{className:`p-3 rounded-lg ${Math.abs(g.changePercentage)>(i.costThreshold||20)?g.changePercentage>0?"bg-red-50":"bg-green-50":"bg-gray-50"}`,children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:xe(g.date,"d 'de' MMMM, yyyy HH:mm",{locale:we})}),a.jsxs("span",{className:`text-sm font-medium ${g.changePercentage>0?"text-red-600":"text-green-600"}`,children:[g.changePercentage>0?"+":"",g.changePercentage.toFixed(2),"%"]})]}),a.jsxs("div",{className:"mt-1 flex items-center gap-2",children:[a.jsx("span",{className:"text-gray-500",children:ce(p)}),a.jsx("span",{className:"text-gray-400",children:"→"}),a.jsx("span",{className:"font-medium",children:ce(g.unitCost)}),a.jsxs("span",{className:"text-gray-500",children:["/ ",i.yieldUnit]})]})]},g.date)})}):a.jsx("p",{className:"text-gray-500 text-center py-4",children:"No hay historial de costos disponible"}),a.jsx("div",{className:"flex justify-end",children:a.jsx(T,{onClick:()=>o(null),children:"Cerrar"})})]})})]})}function mg({products:t,onSelect:e,selectedMaterials:r}){const[n,s]=w.useState(""),[i,o]=w.useState(null),[c,l]=w.useState(0),[d,u]=w.useState(!1),h=t.filter(p=>p.isProduction&&!r.includes(p.id)),f=h.filter(p=>{var x,m;const y=n.toLowerCase();return p.name.toLowerCase().includes(y)||p.sku.toLowerCase().includes(y)||((x=p.supplierCode)==null?void 0:x.toLowerCase().includes(y))||((m=p.tags)==null?void 0:m.some(N=>N.toLowerCase().includes(y)))}).sort((p,y)=>{const x=p.name.toLowerCase().startsWith(n.toLowerCase()),m=y.name.toLowerCase().startsWith(n.toLowerCase());return x&&!m?-1:!x&&m?1:p.name.localeCompare(y.name)}).slice(0,5),g=p=>{o(p),s(p.name),u(!1)},b=()=>{i&&c>0&&(e(i,c),o(null),s(""),l(0))};return a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[a.jsxs("div",{className:"relative",children:[a.jsx(ee,{placeholder:"Buscar material de producción...",value:n,onChange:p=>{s(p.target.value),u(!0),o(null)},onFocus:()=>u(!0),className:"pl-10"}),a.jsx(jt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),d&&n&&f.length>0&&a.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border rounded-md shadow-lg",children:f.map(p=>a.jsxs("button",{type:"button",onClick:()=>g(p),className:"w-full px-4 py-2 text-left hover:bg-gray-50",children:[a.jsx("div",{className:"font-medium",children:p.name}),a.jsxs("div",{className:"text-sm text-gray-500 flex items-center justify-between",children:[a.jsx("span",{children:p.sku}),a.jsxs("span",{className:"text-blue-600 font-medium",children:[ce(p.pricePerUnit||0)," / ",p.unitMeasure]})]})]},p.id))}),d&&n&&f.length===0&&a.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border rounded-md shadow-lg p-4 text-center text-gray-500",children:"No se encontraron materiales de producción disponibles"}),!n&&a.jsxs("div",{className:"mt-1 text-xs text-gray-500",children:[h.length," materiales de producción disponibles"]})]}),i&&a.jsxs("div",{className:"flex gap-2",children:[a.jsx(ee,{type:"number",value:c,onChange:p=>l(Number(p.target.value)),min:0,step:"0.01",placeholder:`Cantidad en ${i.unitMeasure}`,className:"flex-1"}),a.jsx(T,{type:"button",onClick:b,disabled:c<=0,children:"Agregar"})]})]})})}function gg({materials:t,products:e,onRemove:r,onUpdate:n,onEditProduct:s}){if(t.length===0)return a.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:[a.jsx(Mt,{className:"w-8 h-8 text-gray-400 mx-auto mb-3"}),a.jsx("p",{className:"text-gray-500",children:"No hay materiales agregados"}),a.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Utilice el buscador para agregar materiales a la receta"})]});const i=t.reduce((o,c)=>o+c.totalCost,0);return a.jsx("div",{className:"space-y-4",children:a.jsx("div",{className:"overflow-hidden rounded-lg border border-gray-200 bg-white",children:a.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-sm font-medium text-gray-500",children:"Material"}),a.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-sm font-medium text-gray-500 w-32",children:"Cantidad"}),a.jsx("th",{scope:"col",className:"px-4 py-3 text-right text-sm font-medium text-gray-500 w-32",children:"Costo"}),a.jsx("th",{scope:"col",className:"px-4 py-3 text-right text-sm font-medium text-gray-500 w-16",children:a.jsx("span",{className:"sr-only",children:"Acciones"})})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:t.map((o,c)=>{const l=e.find(d=>d.id===o.productId);return l?a.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-4 py-3",children:a.jsx("div",{className:"flex items-center",children:a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{type:"button",onClick:()=>s==null?void 0:s(l),className:"font-medium text-gray-900 hover:text-blue-600 truncate",children:l.name}),a.jsx(T,{type:"button",variant:"ghost",size:"sm",onClick:()=>s==null?void 0:s(l),className:"p-1 hover:bg-gray-100 rounded-full",title:"Editar material",children:a.jsx(Vr,{className:"w-4 h-4 text-gray-500"})})]}),a.jsxs("div",{className:"mt-1 flex items-center gap-3 text-sm text-gray-500",children:[a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Mt,{className:"w-4 h-4"}),l.sku]}),l.unitMeasure&&a.jsxs("span",{className:"flex items-center gap-1",children:[a.jsx(Tc,{className:"w-4 h-4"}),l.unitMeasure]})]})]})})}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ee,{type:"number",value:o.quantity,onChange:d=>n(c,Number(d.target.value)),min:0,step:"0.01",className:"w-24 text-right"}),a.jsx("span",{className:"text-sm text-gray-500 whitespace-nowrap",children:l.unitMeasure||l.purchasePackaging})]})}),a.jsxs("td",{className:"px-4 py-3 text-right",children:[a.jsx("div",{className:"font-medium text-gray-900",children:ce(o.totalCost)}),a.jsxs("div",{className:"text-sm text-gray-500",children:[ce(l.pricePerUnit||l.price)," c/u"]})]}),a.jsx("td",{className:"px-4 py-3 text-right",children:a.jsx(T,{type:"button",variant:"ghost",size:"sm",onClick:()=>r(c),className:"text-red-600 hover:text-red-700 hover:bg-red-50 p-1 rounded-full",children:a.jsx(zr,{className:"w-4 h-4"})})})]},`${o.productId}-${c}`):null})}),a.jsx("tfoot",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("td",{colSpan:2,className:"px-4 py-3 text-sm font-medium text-gray-500",children:"Total Materiales"}),a.jsx("td",{colSpan:2,className:"px-4 py-3 text-right",children:a.jsx("span",{className:"font-bold text-blue-600",children:ce(i)})})]})})]})})})}function tc({providerId:t,product:e,onSubmit:r,onCancel:n,isSubmitting:s}){const[i,o]=w.useState(!1),c=()=>{i?confirm("¿Está seguro que desea descartar los cambios?")&&n():n()},l=async d=>{await r(e,d)};return a.jsxs("div",{className:"fixed inset-0 bg-white z-50 flex flex-col",children:[a.jsx("div",{className:"border-b bg-white",children:a.jsxs("div",{className:"flex items-center justify-between px-4 h-14",children:[a.jsx("h2",{className:"text-lg font-semibold",children:"Editar Producto"}),a.jsx(T,{variant:"ghost",size:"sm",onClick:c,className:"p-2 hover:bg-gray-100 rounded-full",children:a.jsx(It,{className:"w-5 h-5"})})]})}),a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx("div",{className:"h-full overflow-y-auto px-4 py-6",children:a.jsx("div",{className:"max-w-3xl mx-auto",children:a.jsx(Qo,{providerId:t,initialData:e,onSubmit:l,onCancel:n,isLoading:s,onDirtyChange:o})})})})]})}function rc(t,e,r,n,s,i){const o=t.reduce((g,b)=>{const p=e.find(x=>x.id===b.productId);if(!p)return g;const y=p.pricePerUnit||0;return g+y*b.quantity},0),c=o*n/100,l=o+c,d=r>0?l/r:0,u=s/100,h=u<1?d/(1-u):d*2,f=i?[{date:Date.now(),unitCost:d,changePercentage:(d-i)/i*100}]:void 0;return{totalCost:Number(l.toFixed(2)),unitCost:Number(d.toFixed(2)),suggestedPrice:Number(h.toFixed(2)),costHistory:f}}function pg({initialData:t,onSubmit:e,onCancel:r,isLoading:n}){const[s,i]=w.useState({name:(t==null?void 0:t.name)||"",yield:(t==null?void 0:t.yield)||0,yieldUnit:(t==null?void 0:t.yieldUnit)||"UNIDAD",materials:(t==null?void 0:t.materials)||[],fixedCostPercentage:(t==null?void 0:t.fixedCostPercentage)||15,profitPercentage:(t==null?void 0:t.profitPercentage)||90,notes:(t==null?void 0:t.notes)||"",totalCost:(t==null?void 0:t.totalCost)||0,unitCost:(t==null?void 0:t.unitCost)||0,suggestedPrice:(t==null?void 0:t.suggestedPrice)||0,lastUpdated:Date.now()}),{products:o,loading:c,updateProduct:l}=Ft(),[d,u]=w.useState(null);w.useEffect(()=>{if(o.length>0){const x=rc(s.materials,o,s.yield,s.fixedCostPercentage,s.profitPercentage);i(m=>({...m,totalCost:x.totalCost,unitCost:x.unitCost,suggestedPrice:x.suggestedPrice}))}},[s.materials,s.yield,s.fixedCostPercentage,s.profitPercentage,o]);const h=async x=>{if(x.preventDefault(),s.materials.length===0){P.error("Debe agregar al menos un material");return}if(s.profitPercentage>=100){P.error("El beneficio esperado debe ser menor al 100%");return}await e(s)},f=(x,m)=>{if(s.materials.find(q=>q.productId===x.id)){P.error("Este material ya está agregado a la receta");return}const S=x.pricePerUnit||0,A=S*m,B={productId:x.id,quantity:m,unit:x.unitMeasure||x.purchasePackaging,unitCost:S,totalCost:A};i(q=>({...q,materials:[...q.materials,B]}))},g=x=>{i(m=>({...m,materials:m.materials.filter((N,S)=>S!==x)}))},b=(x,m)=>{i(N=>{const S=[...N.materials],A=S[x],B=o.find(le=>le.id===A.productId);if(!B)return N;const q=B.pricePerUnit||0;return S[x]={...A,quantity:m,unitCost:q,totalCost:q*m},{...N,materials:S}})},p=x=>{u(x)},y=async(x,m)=>{await l(x.id,m),u(null)};return c?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):a.jsxs(a.Fragment,{children:[a.jsxs("form",{onSubmit:h,className:"space-y-6",children:[a.jsxs(D,{children:[a.jsx(D.Header,{children:a.jsx(D.Title,{children:"Información Básica"})}),a.jsxs(D.Content,{className:"space-y-4",children:[a.jsx(ee,{label:"Nombre de la receta",value:s.name,onChange:x=>i(m=>({...m,name:x.target.value})),required:!0}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsx(ee,{type:"number",label:"Rendimiento",value:s.yield,onChange:x=>i(m=>({...m,yield:Number(x.target.value)})),min:0,step:"0.01",required:!0}),a.jsx(ln,{label:"Unidad de Rendimiento",value:s.yieldUnit,onChange:x=>i(m=>({...m,yieldUnit:x})),required:!0,placeholder:"Seleccionar unidad de rendimiento"})]})]})]}),a.jsxs(D,{children:[a.jsx(D.Header,{children:a.jsx(D.Title,{children:"Materiales"})}),a.jsxs(D.Content,{className:"space-y-4",children:[a.jsx(mg,{products:o,onSelect:f,selectedMaterials:s.materials.map(x=>x.productId)}),a.jsx(gg,{materials:s.materials,products:o,onRemove:g,onUpdate:b,onEditProduct:p})]})]}),a.jsxs(D,{children:[a.jsx(D.Header,{children:a.jsx(D.Title,{children:"Configuración de Costos"})}),a.jsxs(D.Content,{children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsx(ee,{type:"number",label:"Gastos Fijos (%)",value:s.fixedCostPercentage,onChange:x=>i(m=>({...m,fixedCostPercentage:Number(x.target.value)})),min:0,max:100,required:!0}),a.jsx(ee,{type:"number",label:"Beneficio Esperado (%)",value:s.profitPercentage,onChange:x=>i(m=>({...m,profitPercentage:Number(x.target.value)})),min:0,max:99.99,required:!0})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-4 bg-gray-50 p-4 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-500",children:"Costo Total:"}),a.jsx("p",{className:"text-lg font-medium",children:ce(s.totalCost)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-500",children:"Costo Unitario:"}),a.jsxs("p",{className:"text-lg font-medium",children:[ce(s.unitCost)," / ",s.yieldUnit]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-500",children:"Precio Sugerido:"}),a.jsxs("p",{className:"text-lg font-medium text-blue-600",children:[ce(s.suggestedPrice)," / ",s.yieldUnit]})]})]})]})]}),a.jsxs(D,{children:[a.jsx(D.Header,{children:a.jsx(D.Title,{children:"Notas Adicionales"})}),a.jsx(D.Content,{children:a.jsx("textarea",{value:s.notes,onChange:x=>i(m=>({...m,notes:x.target.value})),rows:3,className:"w-full rounded-md border border-gray-300 px-3 py-2 focus:border-blue-500 focus:ring-1 focus:ring-blue-500"})})]}),a.jsxs("div",{className:"flex justify-end space-x-4",children:[a.jsx(T,{type:"button",variant:"outline",onClick:r,disabled:n,children:"Cancelar"}),a.jsxs(T,{type:"submit",isLoading:n,children:[t?"Actualizar":"Crear"," Receta"]})]})]}),d&&a.jsx(tc,{providerId:d.providerId,product:d,onSubmit:y,onCancel:()=>u(null)})]})}function vg(){const[t,e]=w.useState([]),[r,n]=w.useState(!0);return w.useEffect(()=>{const c=z(W,"recipes"),l=Ve(c,d=>{if(!d.exists()){e([]),n(!1);return}const u=Object.entries(d.val()).map(([h,f])=>({id:h,...f}));e(u),n(!1)});return()=>l()},[]),{recipes:t,loading:r,addRecipe:async c=>{const l=z(W,"recipes");await Nt(l,{...c,lastUpdated:Date.now()})},updateRecipe:async(c,l)=>{const d=z(W,`recipes/${c}`);await it(d,{...l,lastUpdated:Date.now()})},deleteRecipe:async c=>{const l=z(W,`recipes/${c}`);await yr(l)}}}function bg(){const{recipes:t,loading:e,addRecipe:r,updateRecipe:n,deleteRecipe:s}=vg(),{products:i,loading:o}=Ft(),[c,l]=w.useState(!1),[d,u]=w.useState(null),[h,f]=w.useState(""),[g,b]=w.useState(!1),[p,y]=w.useState(!1),x=t.filter(q=>q.name.toLowerCase().includes(h.toLowerCase())),m=async q=>{b(!0);try{d?(await n(d.id,{...q,costThreshold:q.costThreshold||20}),P.success("Receta actualizada exitosamente")):(await r({...q,costHistory:[],costThreshold:20}),P.success("Receta creada exitosamente")),S()}catch{P.error("Error al guardar la receta")}finally{b(!1)}},N=async q=>{try{await s(q.id),P.success("Receta eliminada exitosamente")}catch{P.error("Error al eliminar la receta")}},S=()=>{l(!1),u(null)},A=q=>{u(q),l(!0)},B=async()=>{var ge;if(!i.length){P.error("No hay productos disponibles para actualizar los costos");return}y(!0);let q=0,le=0;try{for(const F of t)try{const H=rc(F.materials,i,F.yield,F.fixedCostPercentage,F.profitPercentage,F.unitCost);if(H.totalCost!==F.totalCost||H.unitCost!==F.unitCost||H.suggestedPrice!==F.suggestedPrice){const V=F.costHistory||[];(ge=H.costHistory)!=null&&ge[0]&&V.push(H.costHistory[0]),await n(F.id,{...F,totalCost:H.totalCost,unitCost:H.unitCost,suggestedPrice:H.suggestedPrice,costHistory:V,lastUpdated:Date.now()}),q++}}catch(H){console.error(`Error updating recipe ${F.id}:`,H),le++}q>0?P.success(`${q} recetas actualizadas exitosamente`):le===0&&P.success("Los costos están actualizados"),le>0&&P.error(`Error al actualizar ${le} recetas`)}catch{P.error("Error al actualizar los costos")}finally{y(!1)}};return a.jsx("div",{className:"space-y-6",children:c||d?a.jsx(pg,{initialData:d,onSubmit:m,onCancel:S,isLoading:g}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-between",children:[a.jsxs("div",{className:"relative flex-1 w-full",children:[a.jsx(ee,{placeholder:"Buscar recetas...",value:h,onChange:q=>f(q.target.value),className:"pl-10"}),a.jsx(jt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"})]}),a.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[a.jsxs(T,{onClick:B,variant:"outline",isLoading:p,disabled:p||e||o,className:"flex-1 sm:flex-none",children:[a.jsx(Ns,{className:"w-4 h-4 mr-2"}),"Actualizar Costos"]}),a.jsxs(T,{onClick:()=>l(!0),className:"flex-1 sm:flex-none",children:[a.jsx(br,{className:"w-4 h-4 mr-2"}),"Nueva Receta"]})]})]}),e?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):a.jsx(fg,{recipes:x,onEdit:A,onDelete:N})]})})}async function yg(t,e){if(!me.currentUser)throw new Re("User not authenticated");try{const r=z(W,t),n=Nt(r);if(!n.key)throw new Re("Failed to generate document ID");return await xr(n,e),n.key}catch(r){throw new Re("Failed to create document",{cause:r})}}async function xg(t,e,r){if(!me.currentUser)throw new Re("User not authenticated");try{const n=z(W,`${t}/${e}`);await xr(n,r)}catch(n){throw new Re("Failed to update document",{cause:n})}}async function wg(t,e){if(!me.currentUser)throw new Re("User not authenticated");try{const r=z(W,`${t}/${e}`);await yr(r)}catch(r){throw new Re("Failed to delete document",{cause:r})}}async function _g(t,e,r){if(!me.currentUser)throw new Re("User not authenticated");try{const n=z(W,t),s=ur(n,hr(e),fr(r)),i=await _e(s);return i.exists()?Object.entries(i.val()).map(([o,c])=>({id:o,...c})):[]}catch(n){throw new Re("Failed to query documents",{cause:n})}}const jg=["UNIDAD","KILOGRAMO","GRAMO","LITRO","CENTÍMETRO","MILILITRO","BOLSA","PLANCHA","CAJON","CAJA","FRACO","BOTELLA","FUNDA","SACHET","ATADO","ROLLO"].sort();async function Ng(){try{const t=z(W,"measures"),e=await _e(t),n=(e.exists()?Object.values(e.val()):[]).map(i=>i.toUpperCase()),s=jg.filter(i=>!n.includes(i.toUpperCase()));for(const i of s){const o=Nt(t);await xr(o,i)}console.info(`Initialized ${s.length} standard measures`)}catch(t){console.error("Error initializing measures:",t)}}const Sg=["orders","products","providers","measures"];async function Og(t){try{if(!me.currentUser)return{name:t,exists:!1};const e=z(W,t),r=await _e(e);return{name:t,exists:r.exists()}}catch(e){return{name:t,exists:!1,error:e instanceof Error?e.message:"Unknown error"}}}async function Cg(t){if(!me.currentUser){console.warn(`Skipping collection creation for "${t}" - user not authenticated`);return}const e=z(W,t);await xr(e,{})}async function Pg(){try{if(!me.currentUser){console.info("Skipping collections initialization - user not authenticated");return}console.info("Starting collections initialization...");const e=(await Promise.all(Sg.map(r=>Og(r)))).filter(r=>!r.exists).map(async({name:r})=>{try{await Cg(r),console.info(`Collection "${r}" created successfully`)}catch(n){console.error(`Failed to create collection "${r}":`,n)}});await Promise.all(e),await Ng(),console.info("Collections initialization completed")}catch(t){console.error("Failed to initialize collections:",t)}}me.onAuthStateChanged(t=>{t&&Pg().catch(e=>{console.error("Critical error during collections initialization:",e)})});const sr="orders";async function kg(t){if(!me.currentUser)return console.warn("User not authenticated, returning empty orders"),[];try{return(await _g(sr,"providerId",t)).sort((r,n)=>new Date(n.date).getTime()-new Date(r.date).getTime())}catch(e){return console.error("Error fetching provider orders:",e),P.error("Error al cargar las órdenes"),[]}}const Cr={subscribeToProviderOrders(t,e){if(!me.currentUser)return console.warn("User not authenticated, skipping subscription"),e([]),()=>{};const r=z(W,sr),n=ur(r,hr("providerId"),fr(t));return Ve(n,i=>{if(!i.exists()){e([]);return}const c=Object.entries(i.val()).map(([l,d])=>({id:l,...d})).sort((l,d)=>new Date(d.date).getTime()-new Date(l.date).getTime());e(c)},i=>{console.error("Error fetching provider orders:",i),P.error("Error al cargar las órdenes"),e([])})},async getByProvider(t){return kg(t)},async create(t){if(!me.currentUser)throw new Error("User not authenticated");try{return await yg(sr,t)}catch(e){throw console.error("Error creating order:",e),P.error("Error al crear la orden"),e}},async update(t,e){if(!me.currentUser)throw new Error("User not authenticated");try{const r=z(W,`${sr}/${t}`),n=await _e(r);if(!n.exists())throw new Error("Order not found");const i={...n.val(),...e};await xg(sr,t,i)}catch(r){throw console.error("Error updating order:",r),P.error("Error al actualizar la orden"),r}},async delete(t){if(!me.currentUser)throw new Error("User not authenticated");try{await wg(sr,t)}catch(e){throw console.error("Error deleting order:",e),P.error("Error al eliminar la orden"),e}}};function $n(t){const[e,r]=w.useState([]),[n,s]=w.useState(!0);return w.useEffect(()=>{let l;return(async()=>{if(!t){r([]),s(!1);return}try{const u=await Cr.getByProvider(t);u&&r(u),l=Cr.subscribeToProviderOrders(t,h=>{r(h)})}catch(u){console.error("Error setting up orders subscription:",u),P.error("Error al cargar las órdenes")}finally{s(!1)}})(),()=>{l&&l()}},[t]),{orders:e,loading:n,addOrder:async l=>{try{const d=await Cr.create(l);if(!d)throw new Error("Failed to create order");return d}catch(d){throw console.error("Error creating order:",d),new Error("Error al crear la orden")}},updateOrder:async(l,d)=>{try{await Cr.update(l,d)}catch(u){throw console.error("Error updating order:",u),new Error("Error al actualizar la orden")}},deleteOrder:async l=>{try{await Cr.delete(l)}catch(d){throw console.error("Error deleting order:",d),new Error("Error al eliminar la orden")}}}}function Ag(){const[t,e]=w.useState([]),[r,n]=w.useState(!0);return w.useEffect(()=>{const s=z(W,"orders"),i=Ve(s,o=>{if(!o.exists()){e([]),n(!1);return}const l=Object.entries(o.val()).map(([d,u])=>({id:d,...u})).sort((d,u)=>new Date(u.date).getTime()-new Date(d.date).getTime());e(l),n(!1)});return()=>i()},[]),{orders:t,loading:r}}function Bn(t){return new Date(t)}function Eg(){return Date.now()}function Mg(t){const e=xe(Bn(t),"dd/MM/yyyy HH:mm",{locale:we});return[Tt.name,Tt.owner,`Pedido Fecha: ${e}`,""]}function Tg(t,e,r){return`${`${t} ${e}`.padEnd(15)}${r}`}function Ig(t,e){return e.sort((r,n)=>{const s=t.find(o=>o.id===r.productId),i=t.find(o=>o.id===n.productId);return!s||!i?0:s.order-i.order}).map(r=>{const n=t.find(s=>s.id===r.productId);return n?Tg(r.quantity,n.purchasePackaging,n.name):null}).filter(r=>r!==null)}function Rg(t){const e=t.length,r=t.reduce((n,s)=>n+s.quantity,0);return["","--------------------------------",`Total Items: ${e}`,`Total Unidades: ${r}`,""]}function nc(t,e,r=!1){if(r){const o=[`Pedido Fecha: ${xe(Bn(t.date),"dd/MM/yyyy HH:mm",{locale:we})}`,Tt.name,Tt.owner,""],c=t.items.sort((h,f)=>{const g=e.find(p=>p.id===h.productId),b=e.find(p=>p.id===f.productId);return!g||!b?0:g.order-b.order}).map(h=>{const f=e.find(g=>g.id===h.productId);return f?`• *${h.quantity} ${f.purchasePackaging}* - ${f.name}`:null}).filter(Boolean),l=t.items.length,d=t.items.reduce((h,f)=>h+f.quantity,0),u=["","--------------------------------",`Total Items: ${l}`,`Total Unidades: ${d}`];return[...o,...c,...u].join(`
`)}const n=Mg(t.date),s=Ig(e,t.items),i=Rg(t.items);return[...n,...s,...i].join(`
`)}function Dg(t,e,r){return nc(t,e,!0)}function Lg(t,e){const r=xe(Bn(t.date),"dd/MM/yyyy HH:mm",{locale:we}),n=t.items.sort((c,l)=>{const d=e.find(h=>h.id===c.productId),u=e.find(h=>h.id===l.productId);return!d||!u?0:d.order-u.order}),s=n.length,i=n.reduce((c,l)=>c+l.quantity,0),o=n.map(c=>{const l=e.find(d=>d.id===c.productId);return l?`
        <tr>
          <td class="quantity">${c.quantity} ${l.purchasePackaging}</td>
          <td class="name">${l.name}</td>
        </tr>
      `:""}).join("");return`
    <!DOCTYPE html>
    <html>
      <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Orden de Compra</title>
        <style>${Zo}</style>
      </head>
      <body>
        <div class="content">
          <div class="header">
            <div>${Tt.name}</div>
            <div>${Tt.owner}</div>
            <div>Pedido Fecha: ${r}</div>
          </div>

          <table>
            <tbody>
              ${o}
            </tbody>
          </table>

          <div class="summary">
            <div class="summary-row">
              <span class="summary-label">Total Items:</span>
              <span class="summary-value">${s}</span>
            </div>
            <div class="summary-row">
              <span class="summary-label">Total Unidades:</span>
              <span class="summary-value">${i}</span>
            </div>
          </div>
        </div>

        <div class="controls">
          <button id="print-button" class="print-button">
            Imprimir
          </button>
        </div>

        <script>${ec}<\/script>
      </body>
    </html>
  `}function sc({order:t,products:e,provider:r,onReopen:n}){const{updateOrder:s,deleteOrder:i}=$n(r.id),[o,c]=w.useState(!1),[l,d]=w.useState(!1),u=async()=>{if(!r.phone){P.error("Este proveedor no tiene número de teléfono registrado");return}d(!0);try{t.status==="pending"&&await s(t.id,{...t,status:"completed"});const g=Dg(t,e,r),b=Ni(r.phone,g);window.open(b,"_blank"),t.status==="pending"&&P.success("Orden completada y enviada por WhatsApp")}catch(g){console.error("Error sending WhatsApp:",g),P.error("Error al enviar por WhatsApp")}finally{d(!1)}},h=async()=>{d(!0);try{t.status==="pending"&&await s(t.id,{...t,status:"completed"});const g=Lg(t,e),b=window.open("","_blank");if(!b)throw new Error("No se pudo crear la pestaña de impresión");b.document.write(g),b.document.close(),t.status==="pending"&&P.success("Orden completada e impresa")}catch(g){console.error("Error printing order:",g),P.error("Error al imprimir la orden")}finally{d(!1)}},f=async()=>{d(!0);try{await i(t.id),P.success("Orden eliminada exitosamente"),c(!1)}catch(g){console.error("Error deleting order:",g),P.error("Error al eliminar la orden")}finally{d(!1)}};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-end gap-2",children:[r.phone&&a.jsx(T,{type:"button",variant:"ghost",size:"sm",onClick:u,disabled:l,className:"text-green-600 hover:text-green-700 hover:bg-green-50 w-11 h-11 p-0",title:"Enviar por WhatsApp",children:a.jsx(Ic,{className:"w-5 h-5"})}),a.jsx(T,{type:"button",variant:"ghost",size:"sm",onClick:h,disabled:l,className:"text-gray-600 hover:text-gray-700 hover:bg-gray-50 w-11 h-11 p-0",title:"Imprimir",children:a.jsx(Cs,{className:"w-5 h-5"})}),t.status==="completed"&&n&&a.jsx(T,{type:"button",variant:"ghost",size:"sm",onClick:n,disabled:l,className:"text-blue-600 hover:text-blue-700 hover:bg-blue-50 w-11 h-11 p-0",title:"Reabrir orden",children:a.jsx(Rc,{className:"w-5 h-5"})}),a.jsx(T,{type:"button",variant:"ghost",size:"sm",onClick:()=>c(!0),disabled:l,className:"text-red-600 hover:text-red-700 hover:bg-red-50 w-11 h-11 p-0",title:"Eliminar orden",children:a.jsx(zr,{className:"w-5 h-5"})})]}),a.jsx(qe,{isOpen:o,onClose:()=>c(!1),title:"Eliminar orden",children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-amber-600",children:"¿Está seguro que desea eliminar esta orden?"}),a.jsxs("div",{className:"flex justify-end space-x-2",children:[a.jsx(T,{variant:"outline",onClick:()=>c(!1),disabled:l,children:"Cancelar"}),a.jsx(T,{onClick:f,isLoading:l,children:"Eliminar"})]})]})})]})}function ei({orders:t,products:e,provider:r,onSelect:n}){const{providers:s}=Zt(),i=[...t].sort((o,c)=>new Date(c.date).getTime()-new Date(o.date).getTime());return a.jsxs("div",{className:"space-y-4",children:[i.map((o,c)=>{const l=new Set(o.items.map(f=>f.productId)).size,d=o.items.reduce((f,g)=>f+g.quantity,0),u=i.length-c,h=r||s.find(f=>f.id===o.providerId);return h?a.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm hover:shadow-md transition-shadow",children:[a.jsxs("div",{className:"cursor-pointer",onClick:()=>n(o,u),children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[o.status==="completed"?a.jsx(ci,{className:"w-5 h-5 text-green-500"}):a.jsx(Dc,{className:"w-5 h-5 text-yellow-500"}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold",children:["Orden #",u," - ",xe(new Date(o.date),"d 'de' MMMM, yyyy",{locale:we})]}),a.jsxs("p",{className:"text-sm text-gray-600",children:[h.commercialName,h.legalName&&h.legalName!==h.commercialName&&a.jsxs("span",{className:"text-gray-400",children:[" • ",h.legalName]})]})]})]})}),a.jsxs("div",{className:"flex items-center justify-between text-gray-600 mt-2",children:[a.jsxs("div",{className:"space-x-2",children:[a.jsxs("span",{children:[l," ",l===1?"producto":"productos"]}),a.jsx("span",{className:"text-gray-400",children:"•"}),a.jsxs("span",{children:[d," ",d===1?"unidad":"unidades"]})]}),a.jsx("span",{className:"font-medium text-blue-600",children:ce(o.total)})]})]}),a.jsx("div",{className:"mt-4 pt-4 border-t",children:a.jsx(sc,{order:o,products:e,provider:h})})]},o.id):null}),t.length===0&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:"No hay órdenes para mostrar"})]})}function Fg({order:t,products:e,provider:r,preview:n=!0}){[...t.items].sort((i,o)=>{const c=e.find(d=>d.id===i.productId),l=e.find(d=>d.id===o.productId);return!c||!l?0:c.order-l.order});const s=nc(t,e,n);return a.jsx("div",{className:"font-mono text-sm bg-gray-50 p-4 rounded-lg overflow-x-auto whitespace-pre-wrap",children:s})}function $g({order:t,orderNumber:e,products:r,provider:n,onClose:s,onEdit:i}){const[o,c]=w.useState(!1),{updateOrder:l}=$n(n.id),[d,u]=w.useState(!1),h=xe(Bn(t.date),"d 'de' MMMM, yyyy HH:mm",{locale:we}),f=t.items.length,g=t.items.reduce((p,y)=>p+y.quantity,0),b=async()=>{u(!0);try{await l(t.id,{...t,status:"pending"}),P.success("Orden reabierta exitosamente"),i==null||i()}catch(p){console.error("Error reopening order:",p),P.error("Error al reabrir la orden")}finally{u(!1),c(!1)}};return a.jsxs("div",{className:"fixed inset-0 bg-gray-50 z-50 flex flex-col",children:[a.jsx("div",{className:"bg-white border-b print:hidden sticky top-0 z-10",children:a.jsxs("div",{className:"flex items-center justify-between px-3 h-14",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(T,{variant:"ghost",size:"sm",onClick:s,className:"md:hidden",children:a.jsx(Lc,{className:"w-5 h-5"})}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("h2",{className:"text-lg font-semibold",children:["Orden #",e]}),a.jsx("span",{className:`
                  px-2 py-0.5 text-xs font-medium rounded-full
                  ${t.status==="completed"?"bg-green-100 text-green-700":"bg-amber-100 text-amber-700"}
                `,children:t.status==="completed"?"Completada":"Pendiente"})]}),a.jsx("p",{className:"text-sm text-gray-500",children:h})]})]}),a.jsx("button",{onClick:s,className:"hidden md:flex p-2 hover:bg-gray-100 rounded-full transition-colors",children:a.jsx(It,{className:"w-5 h-5"})})]})}),a.jsx("div",{className:"flex-1 overflow-y-auto",children:a.jsxs("div",{className:"container mx-auto max-w-4xl px-3 py-4",children:[a.jsxs("div",{className:"hidden print:block mb-8",children:[a.jsx("h1",{className:"text-2xl font-bold text-center mb-2",children:"Orden de Compra"}),a.jsxs("div",{className:"text-center text-gray-600 mb-4",children:["#",e]})]}),a.jsxs("div",{className:"grid gap-4",children:[a.jsxs("div",{className:"grid gap-4 sm:grid-cols-3 print:grid-cols-3",children:[a.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm print:border-gray-300",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:a.jsx(On,{className:"w-5 h-5 text-blue-600"})}),a.jsx("h3",{className:"font-medium",children:"Fecha"})]}),a.jsx("p",{className:"text-gray-600",children:h})]}),a.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm print:border-gray-300",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("div",{className:"p-2 bg-purple-50 rounded-lg",children:a.jsx(li,{className:"w-5 h-5 text-purple-600"})}),a.jsx("h3",{className:"font-medium",children:"Proveedor"})]}),a.jsx("p",{className:"font-medium",children:n.commercialName}),n.legalName&&n.legalName!==n.commercialName&&a.jsx("p",{className:"text-sm text-gray-500",children:n.legalName})]}),a.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm print:border-gray-300",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("div",{className:"p-2 bg-green-50 rounded-lg",children:a.jsx(Mt,{className:"w-5 h-5 text-green-600"})}),a.jsx("h3",{className:"font-medium",children:"Resumen"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("p",{className:"text-gray-600",children:[f," ",f===1?"item":"items"]}),a.jsxs("p",{className:"text-gray-600",children:[g," ",g===1?"unidad":"unidades"]}),a.jsx("p",{className:"font-medium text-lg text-blue-600",children:ce(t.total)})]})]})]}),a.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm print:border-gray-300",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4 print:mb-2",children:[a.jsx("div",{className:"p-2 bg-amber-50 rounded-lg",children:a.jsx(di,{className:"w-5 h-5 text-amber-600"})}),a.jsx("h3",{className:"font-medium",children:"Detalles del Pedido"})]}),a.jsx(Fg,{order:t,products:r,provider:n,preview:!1})]}),t.status==="completed"?a.jsx("div",{className:"print:hidden",children:a.jsx("div",{className:"bg-white p-4 rounded-lg border shadow-sm",children:a.jsx(sc,{order:t,products:r,provider:n,onReopen:()=>c(!0)})})}):a.jsx("div",{className:"print:hidden bg-amber-50 border border-amber-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-center gap-3 text-amber-700",children:[a.jsx(Fc,{className:"w-5 h-5 flex-shrink-0"}),a.jsx("p",{children:"Esta orden está pendiente de completar"})]})})]})]})}),a.jsx(qe,{isOpen:o,onClose:()=>c(!1),title:"Reabrir orden",children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-amber-600",children:"¿Está seguro que desea reabrir esta orden para edición?"}),a.jsxs("div",{className:"flex justify-end space-x-2",children:[a.jsx(T,{variant:"outline",onClick:()=>c(!1),disabled:d,children:"Cancelar"}),a.jsx(T,{onClick:b,isLoading:d,children:"Reabrir"})]})]})})]})}function Bg({orders:t,products:e,onOrderSelect:r}){const[n,s]=w.useState(""),[i,o]=w.useState([]);return w.useEffect(()=>{if(!n.trim()){o([]);return}const c=n.toLowerCase(),l=[...t].sort((u,h)=>new Date(h.date).getTime()-new Date(u.date).getTime()),d=l.map((u,h)=>{const f=u.items.map(g=>{var y;const b=e.find(x=>x.id===g.productId);return b&&(b.name.toLowerCase().includes(c)||b.sku.toLowerCase().includes(c)||((y=b.tags)==null?void 0:y.some(x=>x.toLowerCase().includes(c))))?{product:b,quantity:g.quantity}:null}).filter(g=>g!==null);return f.length===0?null:{...u,orderNumber:l.length-h,matchingProducts:f}}).filter(u=>u!==null).slice(0,5);o(d)},[n,t,e]),a.jsxs("div",{className:"relative mb-6",children:[a.jsxs("div",{className:"relative",children:[a.jsx(ee,{placeholder:"Buscar productos en órdenes...",value:n,onChange:c=>s(c.target.value),className:"pl-10 bg-amber-50 border-amber-200 focus:border-amber-400 focus:ring-amber-400 placeholder-amber-400"}),a.jsx(jt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-amber-400"})]}),i.length>0&&a.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-amber-200 rounded-lg shadow-lg max-h-[400px] overflow-auto",children:i.map(c=>a.jsx("button",{onClick:()=>r(c,c.orderNumber),className:"w-full px-4 py-3 text-left hover:bg-amber-50 border-b border-amber-100 last:border-b-0",children:a.jsxs("div",{className:"flex items-start justify-between gap-4",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsxs("span",{className:"font-medium text-amber-700",children:["Orden #",c.orderNumber]}),a.jsx("span",{className:"text-gray-400",children:"•"}),a.jsx("span",{className:"text-sm text-gray-600",children:xe(new Date(c.date),"d 'de' MMMM, yyyy",{locale:we})})]}),a.jsx("div",{className:"space-y-1",children:c.matchingProducts.map(({product:l,quantity:d})=>a.jsxs("div",{className:"flex items-center justify-between text-sm",children:[a.jsx("span",{className:"text-gray-900",children:l.name}),a.jsxs("span",{className:"text-gray-600 whitespace-nowrap ml-2",children:[d," ",l.purchasePackaging]})]},l.id))})]}),a.jsx("div",{className:"text-amber-600 font-medium whitespace-nowrap",children:ce(c.total)})]})},c.id))}),n&&i.length===0&&a.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-amber-200 rounded-lg shadow-lg p-4 text-center text-gray-500",children:"No se encontraron productos en las órdenes"})]})}function ss(t){return new Intl.NumberFormat("es-UY",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}).format(t)}function Ug({product:t,quantity:e,onQuantityChange:r,onReview:n,isReviewed:s}){const[i,o]=w.useState(!1),[c,l]=w.useState(!1),[d,u]=w.useState(!1),[h,f]=w.useState(e.toString()),g=w.useRef(null),b=w.useRef(null),p=w.useRef(),{products:y,updateProduct:x}=Ft(),m=y.find(F=>F.id===t.id)||t;w.useEffect(()=>{f(e.toString())},[e]),w.useEffect(()=>{const F=H=>{g.current&&!g.current.contains(H.target)&&u(!1)};return document.addEventListener("mousedown",F),()=>document.removeEventListener("mousedown",F)},[]),w.useEffect(()=>{d&&b.current&&(b.current.focus(),b.current.select())},[d]);const N=async F=>{l(!0);try{await x(m.id,F),o(!1)}catch(H){console.error("Error updating product:",H)}finally{l(!1)}},S=F=>{F.target instanceof HTMLButtonElement||F.target instanceof HTMLInputElement||F.target.closest("button")||F.target.closest("input")||F.target.closest(".quantity-controls")||(p.current?(clearTimeout(p.current),p.current=void 0,r(e>0?0:m.desiredStock)):p.current=setTimeout(()=>{p.current=void 0,s||n()},250))},A=F=>{F.stopPropagation(),u(!0)},B=F=>{F>=0&&(r(F),s||n())},q=F=>{F.stopPropagation(),e>0&&B(e-1)},le=F=>{F.stopPropagation(),B(e+1)},ge=F=>{const H=F.target.value;f(H);const V=parseInt(H);!isNaN(V)&&V>=0&&B(V)};return a.jsxs(a.Fragment,{children:[a.jsx(D,{isSelected:e>0,children:a.jsx(D.Header,{className:"!p-3",children:a.jsxs("div",{className:"relative",onClick:S,children:[s&&a.jsx("div",{className:"absolute -top-2 -right-2 bg-green-500 text-white rounded-full p-1",children:a.jsx(is,{className:"w-4 h-4"})}),a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx("div",{className:`
                  flex-shrink-0 w-5 h-5 rounded border cursor-pointer transition-colors mt-1
                  ${e>0?"bg-blue-500 border-blue-500":"border-gray-300 hover:border-blue-500"}
                `,onClick:F=>{F.stopPropagation(),B(e>0?0:m.desiredStock)},children:e>0&&a.jsx(is,{className:"w-full h-full text-white p-0.5"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("h3",{className:"font-semibold text-gray-900",children:m.name}),a.jsx(T,{variant:"ghost",size:"sm",onClick:F=>{F.stopPropagation(),o(!0)},className:"p-1 hover:bg-gray-100 rounded-full",children:a.jsx(Vr,{className:"w-4 h-4 text-gray-500"})})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm text-gray-600 mb-3",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(Os,{className:"w-4 h-4 mr-1.5 flex-shrink-0"}),a.jsxs("span",{children:["Orden: ",dg(m.order)]})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(Ss,{className:"w-4 h-4 mr-1.5 flex-shrink-0"}),a.jsxs("span",{children:["Stock: ",m.minPackageStock," - ",m.desiredStock]})]})]}),e>0&&a.jsxs("div",{className:"flex items-end justify-between gap-4",children:[a.jsx("div",{className:"flex-1",children:a.jsx("div",{ref:g,className:"quantity-controls",children:d?a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(T,{type:"button",variant:"outline",size:"sm",onClick:q,disabled:e<=0,className:"w-12 h-12 rounded-full",children:a.jsx($c,{className:"w-5 h-5"})}),a.jsx(ee,{ref:b,type:"number",min:"0",value:h,onChange:ge,onClick:F=>F.stopPropagation(),placeholder:m.desiredStock.toString(),className:"text-center text-lg h-12"}),a.jsx(T,{type:"button",variant:"outline",size:"sm",onClick:le,className:"w-12 h-12 rounded-full",children:a.jsx(br,{className:"w-5 h-5"})})]}):a.jsx("button",{onClick:A,className:"w-full h-12 px-4 text-left bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors",children:a.jsxs("span",{className:"text-lg font-medium",children:[e," ",m.purchasePackaging]})})})}),a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:"text-lg font-bold text-blue-600",children:ss(m.price)}),a.jsxs("div",{className:"text-sm text-gray-500",children:["Total: ",ss(m.price*e)]})]})]}),!e&&a.jsx("div",{className:"text-lg font-bold text-blue-600",children:ss(m.price)})]})]})]})})}),i&&a.jsx(tc,{providerId:m.providerId,product:m,onSubmit:N,onCancel:()=>o(!1),isSubmitting:c})]})}function Vg({value:t,onChange:e}){return a.jsxs("div",{className:"relative mb-6",children:[a.jsx(ee,{placeholder:"Filtrar",value:t,onChange:r=>e(r.target.value),className:"pl-10"}),a.jsx(jt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"})]})}function zg({products:t,selectedProducts:e,onProductSelect:r,onProductUpdate:n}){const[s,i]=w.useState(new Set),[o,c]=w.useState(""),[l,d]=w.useState(!1),h=[...t].sort((p,y)=>p.order-y.order).filter(p=>{var y,x;if(l&&!e.has(p.id))return!1;if(o.trim()){const m=o.toLowerCase();return p.name.toLowerCase().includes(m)||p.sku.toLowerCase().includes(m)||((y=p.supplierCode)==null?void 0:y.toLowerCase().includes(m))||((x=p.tags)==null?void 0:x.some(N=>N.toLowerCase().includes(m)))}return!0}),f=(p,y)=>{y>=0&&(r(p,y),b(p))},g=async(p,y)=>{n&&(await n(p.id,y),b(p.id))},b=p=>{i(y=>new Set(y).add(p))};return a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx("div",{className:"flex-1",children:a.jsx(Vg,{value:o,onChange:c,placeholder:"Filtrar"})}),a.jsx(T,{variant:l?"primary":"outline",onClick:()=>d(!l),className:"w-10 h-10 p-0 flex items-center justify-center",title:l?"Mostrar todos":"Solo seleccionados",children:a.jsx(ui,{className:"w-4 h-4"})})]}),h.map(p=>a.jsx(Ug,{product:p,products:t,isSelected:e.has(p.id),quantity:e.get(p.id)||0,onQuantityChange:y=>f(p.id,y),onProductUpdate:g,onReview:()=>b(p.id),isReviewed:s.has(p.id)},p.id)),h.length===0&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:l?"No hay productos seleccionados":"No se encontraron productos que coincidan con la búsqueda"})]})}function Wg(t){return Number(t.reduce((e,r)=>e+Number((r.price*r.quantity).toFixed(2)),0).toFixed(2))}function qg(t,e){const r=Number(Number(t.price).toFixed(2)),n=Number((r*e).toFixed(2));return{productId:t.id,quantity:Number(e),price:r,subtotal:n}}function ac(t,e,r){if(!t||!r||r.length===0)throw new Error("Invalid order data");const n=Array.from(e.entries()).map(([i,o])=>{const c=r.find(l=>l.id===i);if(!c)throw new Error(`Product ${i} not found`);return qg(c,o)}).sort((i,o)=>{const c=r.find(d=>d.id===i.productId),l=r.find(d=>d.id===o.productId);return!c||!l?0:c.order-l.order}),s=Wg(n);return{providerId:t,date:Eg(),status:"pending",items:n,total:s}}function ic(t,e){try{if(!t.providerId)return"El proveedor es requerido";if(!t.items||t.items.length===0)return"Debe agregar al menos un producto";const r=new Set;for(const s of t.items){if(!s.productId)return"Producto inválido";if(r.has(s.productId))return"No puede haber productos duplicados";if(r.add(s.productId),s.quantity<=0)return"La cantidad debe ser mayor a 0";const i=e.find(c=>c.id===s.productId);if(!i)return"Producto no encontrado";if(Math.abs(s.price-i.price)>.01)return`El precio del producto ${i.name} no coincide`;const o=Number((s.price*s.quantity).toFixed(2));if(Math.abs(s.subtotal-o)>.01)return`El subtotal del producto ${i.name} no coincide`}const n=Number(t.items.reduce((s,i)=>s+Number((i.price*i.quantity).toFixed(2)),0).toFixed(2));return Math.abs(t.total-n)>.01?"El total no coincide":null}catch(r){return console.error("Error validating order:",r),"Error al validar la orden"}}const as=6e4;function Gg({providerId:t,selectedProducts:e,products:r,onSave:n,enabled:s=!0}){const i=w.useRef(Date.now()),o=w.useRef(),c=w.useRef(!1),l=()=>{o.current&&clearTimeout(o.current)};return w.useEffect(()=>{if(!s||!t||e.size===0){l();return}const d=async()=>{if(!c.current)try{c.current=!0;const u=ac(t,e,r),h=ic(u,r);if(h){console.warn("Autosave skipped due to validation error:",h);return}Date.now()-i.current>=as&&(await n(u),i.current=Date.now(),P.success("Orden guardada automáticamente",{duration:2e3,position:"bottom-right"}))}catch(u){console.error("Error in autosave:",u),P.error("Error al guardar automáticamente",{duration:2e3,position:"bottom-right"})}finally{c.current=!1,s&&(o.current=setTimeout(d,as))}};return o.current=setTimeout(d,as),l},[s,t,e,r,n]),{lastSaveTime:i.current}}function Hg({products:t,selectedProducts:e,onProductSelect:r,onProductUpdate:n,onConfirm:s,onCancel:i,isSubmitting:o,provider:c}){const[l,d]=w.useState(t),{orders:u,addOrder:h,updateOrder:f}=$n(c.id),[g,b]=w.useState(!1);w.useEffect(()=>{d(y=>{const x=new Set(t.map(N=>N.id)),m=y.filter(N=>!x.has(N.id));return[...t,...m]})},[t]),Gg({providerId:c.id,selectedProducts:e,products:l,onSave:async y=>{if(!g){b(!0);try{const x=new Date,m=new Date(x.setHours(0,0,0,0)),N=new Date(x.setHours(23,59,59,999)),S=u.find(A=>{const B=new Date(A.date);return B>=m&&B<=N});S?await f(S.id,y):await h(y)}catch(x){throw console.error("Error saving order:",x),x}finally{b(!1)}}}});const p=Array.from(e.entries()).reduce((y,[x,m])=>{const N=l.find(S=>S.id===x);return y+((N==null?void 0:N.price)||0)*m},0);return a.jsxs("div",{className:"fixed inset-0 bg-white z-50 flex flex-col",children:[a.jsx("div",{className:"border-b bg-white",children:a.jsxs("div",{className:"flex items-center justify-between px-2 h-14",children:[a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("h2",{className:"text-lg font-semibold truncate",children:[c.legalName&&c.legalName!==c.commercialName?a.jsxs("span",{className:"text-gray-500",children:[c.legalName," ",a.jsx("span",{className:"mx-1",children:"•"})]}):null,a.jsx("span",{children:c.commercialName})]}),e.size>0&&a.jsxs("div",{className:"text-sm text-gray-600",children:["Importe Total: ",a.jsx("span",{className:"font-medium text-blue-600",children:ce(p)})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(T,{variant:"outline",onClick:i,disabled:o||g,size:"sm",children:"Cancelar"}),a.jsx(T,{onClick:s,isLoading:o||g,size:"sm",children:"Guardar"})]})]})}),a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx("div",{className:"h-full overflow-y-auto",children:a.jsx("div",{className:"container mx-auto max-w-3xl px-2 py-4",children:a.jsx(zg,{products:l,selectedProducts:e,onProductSelect:r,onProductUpdate:n})})})})]})}function Yg(){const t=Vc(),[e,r]=zc(),{providers:n}=Zt(),[s,i]=w.useState(""),{orders:o,loading:c,addOrder:l,updateOrder:d}=$n(s),{products:u,updateProduct:h}=Xo(s),{orders:f,loading:g}=Ag(),{products:b,loading:p}=Ft(),[y,x]=w.useState(!1),[m,N]=w.useState(null),[S,A]=w.useState(null),[B,q]=w.useState(!1),[le,ge]=w.useState(new Map),[F,H]=w.useState(!1),V=n.find(Z=>Z.id===s),ot=f.sort((Z,re)=>new Date(re.date).getTime()-new Date(Z.date).getTime()).slice(0,5);w.useEffect(()=>{const Z=e.get("provider"),re=e.get("new")==="true";if(Z){if(i(Z),re)x(!0),H(!0);else{const L=new Date,Le=new Date(L.setHours(0,0,0,0)),Un=new Date(L.setHours(23,59,59,999)),de=o.find(er=>{const $t=new Date(er.date);return $t>=Le&&$t<=Un});if(de){const er=new Map;de.items.forEach($t=>{er.set($t.productId,$t.quantity)}),ge(er),N(de),x(!0),H(!0)}}r({})}},[e,r,o]);const De=(Z,re)=>{const L=new Map(le);re>0?L.set(Z,re):L.delete(Z),ge(L)},He=async()=>{if(!s||!u||!V){P.error("Seleccione un proveedor");return}if(le.size===0){P.error("Debe agregar al menos un producto");return}q(!0);try{const Z=ac(s,le,u),re=ic(Z,u);if(re){P.error(re);return}m?(await d(m.id,Z),P.success("Orden actualizada exitosamente")):(await l(Z),P.success("Orden creada exitosamente")),Ye()}catch(Z){console.error("Error saving order:",Z),P.error("Error al guardar la orden")}finally{q(!1)}},Ye=()=>{x(!1),N(null),ge(new Map),F&&t("/")},ct=(Z,re)=>{if(s||i(Z.providerId),Z.status==="completed")A({order:Z,orderNumber:re});else{const L=new Map;Z.items.forEach(Le=>{L.set(Le.productId,Le.quantity)}),ge(L),N(Z),x(!0)}},St=()=>{if(!S)return;const Z=new Map;S.order.items.forEach(re=>{Z.set(re.productId,re.quantity)}),ge(Z),N(S.order),A(null),x(!0)},Ke=c||g||p;return a.jsxs("div",{className:"space-y-4",children:[a.jsx(Bg,{orders:f,products:b,onOrderSelect:ct}),a.jsx("div",{className:"space-y-4 md:space-y-0",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:items-end gap-4",children:[a.jsx("div",{className:"flex-1",children:a.jsx(Ko,{providers:n,selectedProviderId:s,onChange:i})}),s&&a.jsx("div",{className:"flex-shrink-0 w-full md:w-auto",children:a.jsxs(T,{onClick:()=>x(!0),className:"w-full md:w-auto bg-blue-500 hover:bg-blue-600 text-white h-[48px] px-6 rounded-lg shadow-sm hover:shadow transition-all",children:[a.jsx(br,{className:"w-5 h-5 mr-2"}),a.jsx("span",{className:"whitespace-nowrap",children:"Nueva Orden"})]})})]})}),Ke?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):a.jsxs(a.Fragment,{children:[!s&&ot.length>0&&a.jsxs("div",{className:"space-y-4",children:[a.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Últimas Órdenes"}),a.jsx(ei,{orders:ot,products:b,onSelect:ct})]}),y&&V&&a.jsx(Hg,{products:u,selectedProducts:le,onProductSelect:De,onProductUpdate:h,onConfirm:He,onCancel:Ye,isSubmitting:B,provider:V}),S&&V&&a.jsx($g,{order:S.order,orderNumber:S.orderNumber,products:b,provider:V,onClose:()=>A(null),onEdit:St}),!y&&!S&&s&&a.jsx(ei,{orders:o,products:u,provider:V,onSelect:ct})]})]})}const Kg=[{day:"monday",label:"Lunes"},{day:"tuesday",label:"Martes"},{day:"wednesday",label:"Miércoles"},{day:"thursday",label:"Jueves"},{day:"friday",label:"Viernes"},{day:"saturday",label:"Sábado"},{day:"sunday",label:"Domingo"}];function Xg(){const{providers:t}=Zt(),e=xe(new Date,"EEEE",{locale:we}).toLowerCase();return a.jsxs("div",{className:"space-y-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Cronograma de Proveedores"}),a.jsxs(D,{children:[a.jsx(D.Header,{children:a.jsxs(D.Title,{children:["Hoy - ",xe(new Date,"EEEE d 'de' MMMM",{locale:we})]})}),a.jsx(D.Content,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Pedidos:"}),t.filter(r=>{var n;return(n=r.orderDays)==null?void 0:n.includes(e)}).length>0?a.jsx("ul",{className:"space-y-2",children:t.filter(r=>{var n;return(n=r.orderDays)==null?void 0:n.includes(e)}).map(r=>a.jsx("li",{className:"flex items-center justify-between bg-blue-50 p-3 rounded-lg",children:a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-blue-900",children:r.commercialName}),r.legalName&&r.legalName!==r.commercialName&&a.jsx("span",{className:"text-sm text-blue-700 block",children:r.legalName})]})},r.id))}):a.jsx("p",{className:"text-gray-500",children:"No hay pedidos programados para hoy"})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Entregas:"}),t.filter(r=>{var n;return(n=r.deliveryDays)==null?void 0:n.includes(e)}).length>0?a.jsx("ul",{className:"space-y-2",children:t.filter(r=>{var n;return(n=r.deliveryDays)==null?void 0:n.includes(e)}).map(r=>a.jsx("li",{className:"flex items-center justify-between bg-green-50 p-3 rounded-lg",children:a.jsxs("div",{children:[a.jsx("span",{className:"font-medium text-green-900",children:r.commercialName}),r.legalName&&r.legalName!==r.commercialName&&a.jsx("span",{className:"text-sm text-green-700 block",children:r.legalName})]})},r.id))}):a.jsx("p",{className:"text-gray-500",children:"No hay entregas programadas para hoy"})]})]})})]}),a.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:Kg.map(({day:r,label:n})=>a.jsxs(D,{children:[a.jsx(D.Header,{children:a.jsx(D.Title,{className:r===e?"text-blue-600":"",children:n})}),a.jsx(D.Content,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Pedidos:"}),t.filter(s=>{var i;return(i=s.orderDays)==null?void 0:i.includes(r)}).length>0?a.jsx("ul",{className:"space-y-1",children:t.filter(s=>{var i;return(i=s.orderDays)==null?void 0:i.includes(r)}).map(s=>a.jsx("li",{className:"text-sm",children:s.commercialName},s.id))}):a.jsx("p",{className:"text-sm text-gray-500",children:"No hay pedidos"})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Entregas:"}),t.filter(s=>{var i;return(i=s.deliveryDays)==null?void 0:i.includes(r)}).length>0?a.jsx("ul",{className:"space-y-1",children:t.filter(s=>{var i;return(i=s.deliveryDays)==null?void 0:i.includes(r)}).map(s=>a.jsx("li",{className:"text-sm",children:s.commercialName},s.id))}):a.jsx("p",{className:"text-sm text-gray-500",children:"No hay entregas"})]})]})})]},r))})]})}async function Qg(){try{if(!(await fetch("https://scraper-production-9c05.up.railway.app/auth")).ok)throw new Error("Error de autenticación");return!0}catch(t){return console.error("Authentication error:",t),!1}}async function Jg(t){try{if(!(t!=null&&t.trim()))throw new Error("Código de artículo inválido");const e=await fetch(`https://scraper-production-9c05.up.railway.app/stock/${t}`,{headers:{Accept:"application/json"}});if(!e.ok){let s="Error desconocido";try{const i=e.headers.get("content-type");i!=null&&i.includes("application/json")?s=(await e.json()).error||"Error desconocido":s=await e.text()||e.statusText||"Error desconocido"}catch(i){console.error("Error parsing error response:",i),s=e.statusText||"Error de comunicación con el servidor"}switch(e.status){case 404:throw new Error(`No se encontró el artículo ${t}`);case 500:throw new Error("El servidor no está disponible en este momento. Por favor, intente más tarde");case 502:case 503:case 504:throw new Error("Servicio temporalmente no disponible. Por favor, intente más tarde");case 401:case 403:throw new Error("Sesión expirada. Por favor, autentíquese nuevamente");default:throw new Error(`Error al consultar el stock: ${s}`)}}let r;try{r=await e.json()}catch(s){throw console.error("Error parsing success response:",s),new Error("Error al procesar la respuesta del servidor")}if(!r||typeof r!="object")throw new Error("Respuesta inválida del servidor");if(!("stock"in r))throw new Error("La respuesta no contiene información de stock");const n=Number(r.stock);if(isNaN(n))throw new Error("El valor de stock no es un número válido");return n}catch(e){const r={articleCode:t,error:e instanceof Error?e.message:"Error desconocido",timestamp:new Date().toISOString(),type:e instanceof Error?e.name:"UnknownError",details:e||"No additional error details available",stack:e instanceof Error?e.stack:void 0};throw console.error("Error checking stock:",r),e instanceof Error?e:new Error("Error inesperado al consultar el stock")}}function Zg({productId:t,sku:e,currentStock:r,onStockUpdate:n,isEnabled:s}){const[i,o]=w.useState(!1),[c,l]=w.useState(null),[d,u]=w.useState(""),[h,f]=w.useState(!1),g=async()=>{if(!e){P.error("Este producto no tiene SKU definido");return}if(!s){P.error("Debe autenticarse primero");return}o(!0);const y=P.loading("Consultando stock en Zureo...");try{const x=await Jg(e);if(P.dismiss(y),x===null){P.error("No se pudo obtener el stock del artículo");return}l(x),u(x.toString()),f(!0),P.success(`Stock consultado: ${x}`)}catch(x){P.dismiss(y);let m="Error al consultar stock en Zureo";x instanceof Error&&(x.message.includes("Sesión expirada")?m="Sesión expirada. Por favor, autentíquese nuevamente":x.message.includes("servidor no está disponible")||x.message.includes("temporalmente no disponible")?m="El servicio no está disponible. Por favor, intente más tarde":x.message.includes("No se encontró")?m=`No se encontró el artículo ${e}`:x.message.includes("Error al procesar")?m="Error de comunicación con el servidor":m=x.message),P.error(m),console.error("Error checking stock:",{sku:e,error:x instanceof Error?x.message:"Unknown error",timestamp:new Date().toISOString()})}finally{o(!1)}},b=async()=>{try{const y=parseInt(d);if(isNaN(y)||y<0){P.error("Ingrese un valor válido");return}await n(y),P.success("Stock actualizado exitosamente"),l(null),u(""),f(!1)}catch(y){P.error("Error al actualizar el stock"),console.error("Error updating stock:",y)}},p=()=>{l(null),u(""),f(!1)};return a.jsxs("div",{className:"space-y-3",children:[h&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ee,{type:"number",min:"0",value:d,onChange:y=>u(y.target.value),placeholder:"Ingrese cantidad",className:"text-center"}),a.jsx(T,{variant:"ghost",size:"sm",onClick:b,className:"text-green-600 hover:text-green-700 hover:bg-green-50 w-9 h-9 p-0",title:"Confirmar",children:a.jsx(is,{className:"w-5 h-5"})}),a.jsx(T,{variant:"ghost",size:"sm",onClick:p,className:"text-red-600 hover:text-red-700 hover:bg-red-50 w-9 h-9 p-0",title:"Cancelar",children:a.jsx(It,{className:"w-5 h-5"})})]}),a.jsxs(T,{variant:"outline",onClick:g,disabled:i||!e||!s,className:"w-full",title:s?"":"Debe autenticarse primero",children:[a.jsx(Ns,{className:`w-4 h-4 mr-2 ${i?"animate-spin":""}`}),"Controlar Stock"]})]})}function ep({data:t,maxDate:e,onClose:r}){const n=()=>{window.print()},i=[...e?t.filter(o=>o.lastStockCheck&&new Date(o.lastStockCheck)>=e):t].sort((o,c)=>o.lastStockCheck?c.lastStockCheck?c.lastStockCheck-o.lastStockCheck:-1:1);return a.jsxs("div",{className:"bg-white rounded-lg border shadow-lg",children:[a.jsxs("div",{className:"sticky top-0 bg-white border-b p-4 flex items-center justify-between print:hidden",children:[a.jsx("h2",{className:"text-xl font-semibold",children:"Reporte de Control de Stock"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(T,{onClick:n,className:"gap-2",children:[a.jsx(Cs,{className:"w-4 h-4"}),"Imprimir"]}),a.jsx(T,{variant:"outline",onClick:r,children:"Cerrar"})]})]}),a.jsxs("div",{className:"hidden print:block text-center mb-6 p-4",children:[a.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Reporte de Control de Stock"}),a.jsx("p",{className:"text-gray-600",children:xe(new Date,"d 'de' MMMM, yyyy",{locale:we})}),e&&a.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Controles desde: ",xe(e,"d 'de' MMMM, yyyy",{locale:we})]})]}),a.jsxs("div",{className:"p-4",children:[i.length>0?a.jsxs("table",{className:"w-full border-collapse",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b-2 border-gray-200",children:[a.jsx("th",{className:"py-2 px-4 text-left",children:"SKU"}),a.jsx("th",{className:"py-2 px-4 text-left",children:"Producto"}),a.jsx("th",{className:"py-2 px-4 text-right",children:"Stock Actual"}),a.jsx("th",{className:"py-2 px-4 text-right",children:"Última Actualización"})]})}),a.jsx("tbody",{children:i.map(o=>a.jsxs("tr",{className:"border-b border-gray-100",children:[a.jsx("td",{className:"py-2 px-4",children:o.sku}),a.jsx("td",{className:"py-2 px-4",children:o.names.map((c,l)=>a.jsx("div",{className:o.names.length>1?"text-sm text-gray-600":"",children:c},l))}),a.jsxs("td",{className:"py-2 px-4 text-right whitespace-nowrap",children:[o.currentStock," ",o.packaging]}),a.jsx("td",{className:"py-2 px-4 text-right whitespace-nowrap",children:o.lastStockCheck?xe(new Date(o.lastStockCheck),"d/MM/yyyy HH:mm",{locale:we}):a.jsx("span",{className:"text-amber-600",children:"Sin control"})})]},o.sku))})]}):a.jsx("div",{className:"text-center py-8 text-gray-500",children:"No hay productos con controles de stock en el período seleccionado"}),a.jsx("div",{className:"hidden print:block mt-8 pt-4 border-t",children:a.jsxs("p",{className:"text-sm text-gray-600",children:["Total productos: ",i.length]})})]})]})}function tp(){const{products:t,loading:e,updateProduct:r}=Ft(),[n,s]=w.useState(""),[i,o]=w.useState(!1),[c,l]=w.useState(!1),[d,u]=w.useState(!1),[h,f]=w.useState(new Date),g=async()=>{l(!0);try{const m=await Qg();o(m),m?P.success("Autenticación exitosa"):P.error("Error de autenticación")}catch(m){console.error("Authentication error:",m),P.error("Error de autenticación"),o(!1)}finally{l(!1)}},b=w.useMemo(()=>{const N=t.filter(S=>{var A;return(A=S.sku)==null?void 0:A.trim()}).reduce((S,A)=>{const B=A.sku.trim().toUpperCase();return S[B]||(S[B]={sku:B,products:[],currentStock:A.currentStock||0,lastStockCheck:A.lastStockCheck||null}),S[B].products.push(A),A.lastStockCheck&&(!S[B].lastStockCheck||A.lastStockCheck>S[B].lastStockCheck)&&(S[B].currentStock=A.currentStock||0,S[B].lastStockCheck=A.lastStockCheck),S},{});return Object.values(N).filter(S=>!n||S.sku.toLowerCase().includes(n.toLowerCase())||S.products.some(A=>{var B;return A.name.toLowerCase().includes(n.toLowerCase())||((B=A.tags)==null?void 0:B.some(q=>q.toLowerCase().includes(n.toLowerCase())))})).sort((S,A)=>!S.lastStockCheck&&!A.lastStockCheck?0:S.lastStockCheck?A.lastStockCheck?S.lastStockCheck-A.lastStockCheck:1:-1)},[t,n]),p=async(m,N)=>{var S;try{const A=((S=b.find(B=>B.sku===m))==null?void 0:S.products.map(B=>r(B.id,{currentStock:N,lastStockCheck:Date.now()})))||[];await Promise.all(A)}catch(A){throw console.error("Error updating stock:",A),A}},y=()=>{u(!0)},x=b.map(m=>({sku:m.sku,names:m.products.map(N=>N.name),currentStock:m.currentStock,lastStockCheck:m.lastStockCheck,packaging:m.products[0].salePackaging||m.products[0].purchasePackaging}));return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Control de Inventario"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(T,{onClick:y,variant:"outline",className:"gap-2",children:[a.jsx(On,{className:"w-4 h-4"}),"Ver Reporte"]}),a.jsxs(T,{onClick:g,isLoading:c,variant:i?"outline":"default",className:"gap-2",children:[a.jsx(Bc,{className:"w-4 h-4"}),i?"Autenticado":"Autenticar en Zureo"]})]})]}),!d&&a.jsxs("div",{className:"relative",children:[a.jsx(ee,{placeholder:"Buscar productos...",value:n,onChange:m=>s(m.target.value),className:"pl-10"}),a.jsx(jt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"})]}),d?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:a.jsxs("div",{className:"max-w-xs",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mostrar controles desde:"}),a.jsx("input",{type:"date",value:h?h.toISOString().split("T")[0]:"",onChange:m=>f(m.target.value?new Date(m.target.value):null),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]})}),a.jsx(ep,{data:x,maxDate:h,onClose:()=>u(!1)})]}):e?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):a.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:b.map(m=>{var S;const N=m.lastStockCheck?Math.floor((Date.now()-m.lastStockCheck)/864e5):null;return a.jsxs("div",{className:`bg-white p-4 rounded-lg border shadow-sm space-y-4 ${m.lastStockCheck?N&&N>30?"border-yellow-200 bg-yellow-50":"":"border-amber-300 bg-amber-50"}`,children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("h3",{className:"font-medium text-gray-900",children:["SKU: ",m.sku]}),a.jsxs("span",{className:"text-sm text-gray-500",children:[m.products.length," ",m.products.length===1?"producto":"productos"]})]}),a.jsx("div",{className:"space-y-1 mb-2",children:m.products.map(A=>a.jsx("p",{className:`text-sm ${m.products.length>1?"text-xs leading-tight":"text-base"} text-gray-600`,children:A.name},A.id))}),((S=m.products[0].tags)==null?void 0:S.length)>0&&a.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:m.products[0].tags.map(A=>a.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800",children:A},A))})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Stock Actual:"}),a.jsxs("p",{className:"font-medium text-gray-900",children:[m.currentStock," ",m.products[0].salePackaging||m.products[0].purchasePackaging]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-gray-500",children:"Último Control:"}),a.jsx("p",{className:`font-medium ${m.lastStockCheck?N&&N>30?"text-yellow-700":"text-gray-900":"text-amber-700"}`,children:m.lastStockCheck?a.jsxs(a.Fragment,{children:[new Date(m.lastStockCheck).toLocaleDateString(),a.jsxs("span",{className:"block text-xs text-gray-500",children:["Hace ",N," días"]})]}):"Nunca"})]})]}),a.jsx("div",{className:"pt-2 border-t",children:a.jsx(Zg,{productId:m.products[0].id,sku:m.sku,currentStock:m.currentStock,onStockUpdate:A=>p(m.sku,A),isEnabled:i})})]},m.sku)})})]})}function rp(){return a.jsx(Wc,{children:a.jsxs(il,{children:[a.jsx(Uc,{position:"top-right"}),a.jsxs(qc,{children:[a.jsx(Je,{path:"/login",element:a.jsx(Pu,{})}),a.jsx(Je,{element:a.jsx(ol,{}),children:a.jsxs(Je,{element:a.jsx(Cu,{}),children:[a.jsx(Je,{path:"/",element:a.jsx(Xm,{})}),a.jsx(Je,{path:"/providers",element:a.jsx(Jm,{})}),a.jsx(Je,{path:"/products",element:a.jsx(ug,{})}),a.jsx(Je,{path:"/recipes",element:a.jsx(bg,{})}),a.jsx(Je,{path:"/orders",element:a.jsx(Yg,{})}),a.jsx(Je,{path:"/schedule",element:a.jsx(Xg,{})}),a.jsx(Je,{path:"/inventory",element:a.jsx(tp,{})})]})})]})]})})}gi(document.getElementById("root")).render(a.jsx(w.StrictMode,{children:a.jsx(rp,{})}));
//# sourceMappingURL=index-B_ipcYmd.js.map
