var Ec=Object.defineProperty;var da=t=>{throw TypeError(t)};var Mc=(t,e,r)=>e in t?Ec(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var F=(t,e,r)=>Mc(t,typeof e!="symbol"?e+"":e,r),ua=(t,e,r)=>e.has(t)||da("Cannot "+r);var le=(t,e,r)=>(ua(t,e,"read from private field"),r?r.call(t):e.get(t)),ft=(t,e,r)=>e.has(t)?da("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,r),et=(t,e,r,n)=>(ua(t,e,"write to private field"),n?n.call(t,r):e.set(t,r),r);import{j as s,n as E,X as $t,M as Tc,L as ha,a as Rc,U as gi,P as ot,C as vr,S as Gr,b as Yr,c as Ic,d as Dc,e as Fc,T as pi,f as Os,g as vi,A as $c,h as Lc,i as kt,F as Bc,R as Ps,k as ks,B as Uc,l as wr,m as As,o as Kr,p as Vc,q as bi,r as zc,s as Es,t as Ms,u as xi,H as yi,v as Ts,w as Wc,x as Hc,y as qc,z as Gc,D as Yc,E as Kc,G as Qc,I as Xc,J as Jc,K as us,N as Zc,O as el,Q as tl,V as rl,W as nl}from"./ui-BcPllMqn.js";import{a as wi,c as fa,r as y,N as ji,O as _i,b as ma,R as pn,u as sl,d as al,H as il,e as ol,f as tt}from"./vendor-CFExb5Qq.js";import{i as cl,g as ll,s as dl,a as ul,b as hl,o as fl,r as z,c as _e,q as Gt,d as Yt,e as Kt,p as ht,u as ut,f as jr,h as Ye,j as _t}from"./firebase-B5ujwCjz.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var Ni,ga=wi;Ni=ga.createRoot,ga.hydrateRoot;/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var pa;(function(t){(function(e){var r=typeof globalThis=="object"?globalThis:typeof fa=="object"?fa:typeof self=="object"?self:typeof this=="object"?this:c(),n=a(t);typeof r.Reflect<"u"&&(n=a(r.Reflect,n)),e(n,r),typeof r.Reflect>"u"&&(r.Reflect=t);function a(l,d){return function(u,h){Object.defineProperty(l,u,{configurable:!0,writable:!0,value:h}),d&&d(u,h)}}function i(){try{return Function("return this;")()}catch{}}function o(){try{return(0,eval)("(function() { return this; })()")}catch{}}function c(){return i()||o()}})(function(e,r){var n=Object.prototype.hasOwnProperty,a=typeof Symbol=="function",i=a&&typeof Symbol.toPrimitive<"u"?Symbol.toPrimitive:"@@toPrimitive",o=a&&typeof Symbol.iterator<"u"?Symbol.iterator:"@@iterator",c=typeof Object.create=="function",l={__proto__:[]}instanceof Array,d=!c&&!l,u={create:c?function(){return Gn(Object.create(null))}:l?function(){return Gn({__proto__:null})}:function(){return Gn({})},has:d?function(x,_){return n.call(x,_)}:function(x,_){return _ in x},get:d?function(x,_){return n.call(x,_)?x[_]:void 0}:function(x,_){return x[_]}},h=Object.getPrototypeOf(Function),f=typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:Cc(),p=typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:Oc(),g=typeof WeakMap=="function"?WeakMap:Pc(),b=a?Symbol.for("@reflect-metadata:registry"):void 0,m=_c(),w=Nc(m);function v(x,_,S,P){if(D(S)){if(!ra(x))throw new TypeError;if(!na(_))throw new TypeError;return U(x,_)}else{if(!ra(x))throw new TypeError;if(!he(_))throw new TypeError;if(!he(P)&&!D(P)&&!ke(P))throw new TypeError;return ke(P)&&(P=void 0),S=Ze(S),Q(x,_,S,P)}}e("decorate",v);function j(x,_){function S(P,H){if(!he(P))throw new TypeError;if(!D(H)&&!wc(H))throw new TypeError;Je(x,_,P,H)}return S}e("metadata",j);function N(x,_,S,P){if(!he(S))throw new TypeError;return D(P)||(P=Ze(P)),Je(x,_,S,P)}e("defineMetadata",N);function C(x,_,S){if(!he(_))throw new TypeError;return D(S)||(S=Ze(S)),ce(x,_,S)}e("hasMetadata",C);function $(x,_,S){if(!he(_))throw new TypeError;return D(S)||(S=Ze(S)),Te(x,_,S)}e("hasOwnMetadata",$);function J(x,_,S){if(!he(_))throw new TypeError;return D(S)||(S=Ze(S)),Re(x,_,S)}e("getMetadata",J);function oe(x,_,S){if(!he(_))throw new TypeError;return D(S)||(S=Ze(S)),we(x,_,S)}e("getOwnMetadata",oe);function K(x,_){if(!he(x))throw new TypeError;return D(_)||(_=Ze(_)),$e(x,_)}e("getMetadataKeys",K);function V(x,_){if(!he(x))throw new TypeError;return D(_)||(_=Ze(_)),L(x,_)}e("getOwnMetadataKeys",V);function O(x,_,S){if(!he(_))throw new TypeError;if(D(S)||(S=Ze(S)),!he(_))throw new TypeError;D(S)||(S=Ze(S));var P=Cr(_,S,!1);return D(P)?!1:P.OrdinaryDeleteMetadata(x,_,S)}e("deleteMetadata",O);function U(x,_){for(var S=x.length-1;S>=0;--S){var P=x[S],H=P(_);if(!D(H)&&!ke(H)){if(!na(H))throw new TypeError;_=H}}return _}function Q(x,_,S,P){for(var H=x.length-1;H>=0;--H){var Ne=x[H],je=Ne(_,S,P);if(!D(je)&&!ke(je)){if(!he(je))throw new TypeError;P=je}}return P}function ce(x,_,S){var P=Te(x,_,S);if(P)return!0;var H=qn(_);return ke(H)?!1:ce(x,H,S)}function Te(x,_,S){var P=Cr(_,S,!1);return D(P)?!1:ta(P.OrdinaryHasOwnMetadata(x,_,S))}function Re(x,_,S){var P=Te(x,_,S);if(P)return we(x,_,S);var H=qn(_);if(!ke(H))return Re(x,H,S)}function we(x,_,S){var P=Cr(_,S,!1);if(!D(P))return P.OrdinaryGetOwnMetadata(x,_,S)}function Je(x,_,S,P){var H=Cr(S,P,!0);H.OrdinaryDefineOwnMetadata(x,_,S,P)}function $e(x,_){var S=L(x,_),P=qn(x);if(P===null)return S;var H=$e(P,_);if(H.length<=0)return S;if(S.length<=0)return H;for(var Ne=new p,je=[],X=0,M=S;X<M.length;X++){var T=M[X],R=Ne.has(T);R||(Ne.add(T),je.push(T))}for(var B=0,Z=H;B<Z.length;B++){var T=Z[B],R=Ne.has(T);R||(Ne.add(T),je.push(T))}return je}function L(x,_){var S=Cr(x,_,!1);return S?S.OrdinaryOwnMetadataKeys(x,_):[]}function q(x){if(x===null)return 1;switch(typeof x){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return x===null?1:6;default:return 6}}function D(x){return x===void 0}function ke(x){return x===null}function ir(x){return typeof x=="symbol"}function he(x){return typeof x=="object"?x!==null:typeof x=="function"}function or(x,_){switch(q(x)){case 0:return x;case 1:return x;case 2:return x;case 3:return x;case 4:return x;case 5:return x}var S="string",P=sa(x,i);if(P!==void 0){var H=P.call(x,S);if(he(H))throw new TypeError;return H}return zt(x)}function zt(x,_){var S,P;{var H=x.toString;if(sn(H)){var P=H.call(x);if(!he(P))return P}var S=x.valueOf;if(sn(S)){var P=S.call(x);if(!he(P))return P}}throw new TypeError}function ta(x){return!!x}function yc(x){return""+x}function Ze(x){var _=or(x);return ir(_)?_:yc(_)}function ra(x){return Array.isArray?Array.isArray(x):x instanceof Object?x instanceof Array:Object.prototype.toString.call(x)==="[object Array]"}function sn(x){return typeof x=="function"}function na(x){return typeof x=="function"}function wc(x){switch(q(x)){case 3:return!0;case 4:return!0;default:return!1}}function Hn(x,_){return x===_||x!==x&&_!==_}function sa(x,_){var S=x[_];if(S!=null){if(!sn(S))throw new TypeError;return S}}function aa(x){var _=sa(x,o);if(!sn(_))throw new TypeError;var S=_.call(x);if(!he(S))throw new TypeError;return S}function ia(x){return x.value}function oa(x){var _=x.next();return _.done?!1:_}function ca(x){var _=x.return;_&&_.call(x)}function qn(x){var _=Object.getPrototypeOf(x);if(typeof x!="function"||x===h||_!==h)return _;var S=x.prototype,P=S&&Object.getPrototypeOf(S);if(P==null||P===Object.prototype)return _;var H=P.constructor;return typeof H!="function"||H===x?_:H}function jc(){var x;!D(b)&&typeof r.Reflect<"u"&&!(b in r.Reflect)&&typeof r.Reflect.defineMetadata=="function"&&(x=Sc(r.Reflect));var _,S,P,H=new g,Ne={registerProvider:je,getProvider:M,setProvider:R};return Ne;function je(B){if(!Object.isExtensible(Ne))throw new Error("Cannot add provider to a frozen registry.");switch(!0){case x===B:break;case D(_):_=B;break;case _===B:break;case D(S):S=B;break;case S===B:break;default:P===void 0&&(P=new p),P.add(B);break}}function X(B,Z){if(!D(_)){if(_.isProviderFor(B,Z))return _;if(!D(S)){if(S.isProviderFor(B,Z))return _;if(!D(P))for(var fe=aa(P);;){var be=oa(fe);if(!be)return;var We=ia(be);if(We.isProviderFor(B,Z))return ca(fe),We}}}if(!D(x)&&x.isProviderFor(B,Z))return x}function M(B,Z){var fe=H.get(B),be;return D(fe)||(be=fe.get(Z)),D(be)&&(be=X(B,Z),D(be)||(D(fe)&&(fe=new f,H.set(B,fe)),fe.set(Z,be))),be}function T(B){if(D(B))throw new TypeError;return _===B||S===B||!D(P)&&P.has(B)}function R(B,Z,fe){if(!T(fe))throw new Error("Metadata provider not registered.");var be=M(B,Z);if(be!==fe){if(!D(be))return!1;var We=H.get(B);D(We)&&(We=new f,H.set(B,We)),We.set(Z,fe)}return!0}}function _c(){var x;return!D(b)&&he(r.Reflect)&&Object.isExtensible(r.Reflect)&&(x=r.Reflect[b]),D(x)&&(x=jc()),!D(b)&&he(r.Reflect)&&Object.isExtensible(r.Reflect)&&Object.defineProperty(r.Reflect,b,{enumerable:!1,configurable:!1,writable:!1,value:x}),x}function Nc(x){var _=new g,S={isProviderFor:function(T,R){var B=_.get(T);return D(B)?!1:B.has(R)},OrdinaryDefineOwnMetadata:je,OrdinaryHasOwnMetadata:H,OrdinaryGetOwnMetadata:Ne,OrdinaryOwnMetadataKeys:X,OrdinaryDeleteMetadata:M};return m.registerProvider(S),S;function P(T,R,B){var Z=_.get(T),fe=!1;if(D(Z)){if(!B)return;Z=new f,_.set(T,Z),fe=!0}var be=Z.get(R);if(D(be)){if(!B)return;if(be=new f,Z.set(R,be),!x.setProvider(T,R,S))throw Z.delete(R),fe&&_.delete(T),new Error("Wrong provider for target.")}return be}function H(T,R,B){var Z=P(R,B,!1);return D(Z)?!1:ta(Z.has(T))}function Ne(T,R,B){var Z=P(R,B,!1);if(!D(Z))return Z.get(T)}function je(T,R,B,Z){var fe=P(B,Z,!0);fe.set(T,R)}function X(T,R){var B=[],Z=P(T,R,!1);if(D(Z))return B;for(var fe=Z.keys(),be=aa(fe),We=0;;){var la=oa(be);if(!la)return B.length=We,B;var kc=ia(la);try{B[We]=kc}catch(Ac){try{ca(be)}finally{throw Ac}}We++}}function M(T,R,B){var Z=P(R,B,!1);if(D(Z)||!Z.delete(T))return!1;if(Z.size===0){var fe=_.get(R);D(fe)||(fe.delete(B),fe.size===0&&_.delete(fe))}return!0}}function Sc(x){var _=x.defineMetadata,S=x.hasOwnMetadata,P=x.getOwnMetadata,H=x.getOwnMetadataKeys,Ne=x.deleteMetadata,je=new g,X={isProviderFor:function(M,T){var R=je.get(M);return!D(R)&&R.has(T)?!0:H(M,T).length?(D(R)&&(R=new p,je.set(M,R)),R.add(T),!0):!1},OrdinaryDefineOwnMetadata:_,OrdinaryHasOwnMetadata:S,OrdinaryGetOwnMetadata:P,OrdinaryOwnMetadataKeys:H,OrdinaryDeleteMetadata:Ne};return X}function Cr(x,_,S){var P=m.getProvider(x,_);if(!D(P))return P;if(S){if(m.setProvider(x,_,w))return w;throw new Error("Illegal state.")}}function Cc(){var x={},_=[],S=function(){function X(M,T,R){this._index=0,this._keys=M,this._values=T,this._selector=R}return X.prototype["@@iterator"]=function(){return this},X.prototype[o]=function(){return this},X.prototype.next=function(){var M=this._index;if(M>=0&&M<this._keys.length){var T=this._selector(this._keys[M],this._values[M]);return M+1>=this._keys.length?(this._index=-1,this._keys=_,this._values=_):this._index++,{value:T,done:!1}}return{value:void 0,done:!0}},X.prototype.throw=function(M){throw this._index>=0&&(this._index=-1,this._keys=_,this._values=_),M},X.prototype.return=function(M){return this._index>=0&&(this._index=-1,this._keys=_,this._values=_),{value:M,done:!0}},X}(),P=function(){function X(){this._keys=[],this._values=[],this._cacheKey=x,this._cacheIndex=-2}return Object.defineProperty(X.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),X.prototype.has=function(M){return this._find(M,!1)>=0},X.prototype.get=function(M){var T=this._find(M,!1);return T>=0?this._values[T]:void 0},X.prototype.set=function(M,T){var R=this._find(M,!0);return this._values[R]=T,this},X.prototype.delete=function(M){var T=this._find(M,!1);if(T>=0){for(var R=this._keys.length,B=T+1;B<R;B++)this._keys[B-1]=this._keys[B],this._values[B-1]=this._values[B];return this._keys.length--,this._values.length--,Hn(M,this._cacheKey)&&(this._cacheKey=x,this._cacheIndex=-2),!0}return!1},X.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=x,this._cacheIndex=-2},X.prototype.keys=function(){return new S(this._keys,this._values,H)},X.prototype.values=function(){return new S(this._keys,this._values,Ne)},X.prototype.entries=function(){return new S(this._keys,this._values,je)},X.prototype["@@iterator"]=function(){return this.entries()},X.prototype[o]=function(){return this.entries()},X.prototype._find=function(M,T){if(!Hn(this._cacheKey,M)){this._cacheIndex=-1;for(var R=0;R<this._keys.length;R++)if(Hn(this._keys[R],M)){this._cacheIndex=R;break}}return this._cacheIndex<0&&T&&(this._cacheIndex=this._keys.length,this._keys.push(M),this._values.push(void 0)),this._cacheIndex},X}();return P;function H(X,M){return X}function Ne(X,M){return M}function je(X,M){return[X,M]}}function Oc(){var x=function(){function _(){this._map=new f}return Object.defineProperty(_.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),_.prototype.has=function(S){return this._map.has(S)},_.prototype.add=function(S){return this._map.set(S,S),this},_.prototype.delete=function(S){return this._map.delete(S)},_.prototype.clear=function(){this._map.clear()},_.prototype.keys=function(){return this._map.keys()},_.prototype.values=function(){return this._map.keys()},_.prototype.entries=function(){return this._map.entries()},_.prototype["@@iterator"]=function(){return this.keys()},_.prototype[o]=function(){return this.keys()},_}();return x}function Pc(){var x=16,_=u.create(),S=P();return function(){function M(){this._key=P()}return M.prototype.has=function(T){var R=H(T,!1);return R!==void 0?u.has(R,this._key):!1},M.prototype.get=function(T){var R=H(T,!1);return R!==void 0?u.get(R,this._key):void 0},M.prototype.set=function(T,R){var B=H(T,!0);return B[this._key]=R,this},M.prototype.delete=function(T){var R=H(T,!1);return R!==void 0?delete R[this._key]:!1},M.prototype.clear=function(){this._key=P()},M}();function P(){var M;do M="@@WeakMap@@"+X();while(u.has(_,M));return _[M]=!0,M}function H(M,T){if(!n.call(M,S)){if(!T)return;Object.defineProperty(M,S,{value:u.create()})}return M[S]}function Ne(M,T){for(var R=0;R<T;++R)M[R]=Math.random()*255|0;return M}function je(M){if(typeof Uint8Array=="function"){var T=new Uint8Array(M);return typeof crypto<"u"?crypto.getRandomValues(T):typeof msCrypto<"u"?msCrypto.getRandomValues(T):Ne(T,M),T}return Ne(new Array(M),M)}function X(){var M=je(x);M[6]=M[6]&79|64,M[8]=M[8]&191|128;for(var T="",R=0;R<x;++R){var B=M[R];(R===4||R===6||R===8)&&(T+="-"),B<16&&(T+="0"),T+=B.toString(16).toLowerCase()}return T}}function Gn(x){return x.__=void 0,delete x.__,x}})})(pa||(pa={}));const ml=["VITE_FIREBASE_API_KEY","VITE_FIREBASE_AUTH_DOMAIN","VITE_FIREBASE_DATABASE_URL","VITE_FIREBASE_PROJECT_ID","VITE_FIREBASE_STORAGE_BUCKET","VITE_FIREBASE_MESSAGING_SENDER_ID","VITE_FIREBASE_APP_ID"],gl={apiKey:"AIzaSyCswObxYzO5gjurKWnAI387lzoEXJjn24k",authDomain:"nrd-ordenes.firebaseapp.com",databaseURL:"https://nrd-ordenes-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"nrd-ordenes",storageBucket:"nrd-ordenes.firebasestorage.app",messagingSenderId:"158356819364",appId:"1:158356819364:web:c9a87a35706babd4608531"},pl={BASE_URL:"/ordenes/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_FIREBASE_API_KEY:"AIzaSyBopcfbHLrWQZOsgitRYWk5h26ipYbD-hE",VITE_FIREBASE_APP_ID:"1:766340976237:web:e7123eedb37568a2f9b964",VITE_FIREBASE_AUTH_DOMAIN:"nrd-ordenes-prod.firebaseapp.com",VITE_FIREBASE_DATABASE_URL:"https://nrd-ordenes-prod-default-rtdb.firebaseio.com",VITE_FIREBASE_MESSAGING_SENDER_ID:"766340976237",VITE_FIREBASE_PROJECT_ID:"nrd-ordenes-prod",VITE_FIREBASE_STORAGE_BUCKET:"nrd-ordenes-prod.firebasestorage.app"};function vl(){const t=ml.filter(r=>!pl[r]);return t.length>0?{isValid:!1,missingVars:t,config:null}:{isValid:!0,missingVars:[],config:{apiKey:"AIzaSyBopcfbHLrWQZOsgitRYWk5h26ipYbD-hE",authDomain:"nrd-ordenes-prod.firebaseapp.com",databaseURL:"https://nrd-ordenes-prod-default-rtdb.firebaseio.com",projectId:"nrd-ordenes-prod",storageBucket:"nrd-ordenes-prod.firebasestorage.app",messagingSenderId:"766340976237",appId:"1:766340976237:web:e7123eedb37568a2f9b964"}}}function bl(){return{...gl}}const Dr=vl(),xl=Dr.isValid?Dr.config:bl(),Si=cl(xl);Dr.isValid?console.info("Firebase initialized in production mode"):console.warn("Firebase initialized in demo mode. The following environment variables are missing:",Dr.missingVars);const an=!Dr.isValid,ge=ll(Si);async function yl(t,e){try{return(await dl(ge,t,e)).user}catch(r){throw console.error("Authentication error:",r),new Error("Error de autenticación: credenciales inválidas")}}async function wl(){try{await ul(ge)}catch(t){throw console.error("Sign out error:",t),new Error("Error al cerrar sesión")}}const W=hl(Si),Ci=y.createContext(void 0);function jl({children:t}){const[e,r]=y.useState(null),[n,a]=y.useState(!0),[i,o]=y.useState(null);y.useEffect(()=>{try{return fl(ge,u=>{r(u),a(!1)})}catch(d){console.error("Auth initialization error:",d),o(d instanceof Error?d:new Error("Error de autenticación")),a(!1)}},[]);const c=async(d,u)=>{if(an){E.error("Autenticación no disponible en modo demo");return}try{await yl(d,u),E.success("¡Bienvenido!")}catch(h){throw console.error("Sign in error:",h),E.error("Credenciales inválidas"),h}},l=async()=>{if(an){E.error("Cierre de sesión no disponible en modo demo");return}try{await wl(),E.success("Sesión cerrada")}catch(d){throw console.error("Sign out error:",d),E.error("Error al cerrar sesión"),d}};return i?s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 p-4",children:s.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg max-w-md w-full",children:[s.jsx("h2",{className:"text-xl font-bold text-red-600 mb-4",children:"Error de Inicialización"}),s.jsx("p",{className:"text-gray-600",children:"No se pudo inicializar la aplicación. Por favor, verifique la configuración e intente nuevamente."}),an&&s.jsx("p",{className:"mt-4 text-sm text-amber-600",children:"Ejecutando en modo demo. Algunas funciones estarán limitadas."})]})}):s.jsx(Ci.Provider,{value:{user:e,loading:n,signIn:c,signOut:l,isDemoMode:an},children:!n&&t})}function Rs(){const t=y.useContext(Ci);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}function _l(){const{user:t}=Rs();return t?s.jsx(_i,{}):s.jsx(ji,{to:"/login",replace:!0})}function pe(t){const e=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&e==="[object Date]"?new t.constructor(+t):typeof t=="number"||e==="[object Number]"||typeof t=="string"||e==="[object String]"?new Date(t):new Date(NaN)}function Nt(t,e){return t instanceof Date?new t.constructor(e):new Date(e)}function Nl(t,e){const r=pe(t);return isNaN(e)?Nt(t,NaN):(e&&r.setDate(r.getDate()+e),r)}const Oi=6048e5,Sl=864e5;let Cl={};function Qr(){return Cl}function at(t,e){var c,l,d,u;const r=Qr(),n=(e==null?void 0:e.weekStartsOn)??((l=(c=e==null?void 0:e.locale)==null?void 0:c.options)==null?void 0:l.weekStartsOn)??r.weekStartsOn??((u=(d=r.locale)==null?void 0:d.options)==null?void 0:u.weekStartsOn)??0,a=pe(t),i=a.getDay(),o=(i<n?7:0)+i-n;return a.setDate(a.getDate()-o),a.setHours(0,0,0,0),a}function vn(t){return at(t,{weekStartsOn:1})}function Pi(t){const e=pe(t),r=e.getFullYear(),n=Nt(t,0);n.setFullYear(r+1,0,4),n.setHours(0,0,0,0);const a=vn(n),i=Nt(t,0);i.setFullYear(r,0,4),i.setHours(0,0,0,0);const o=vn(i);return e.getTime()>=a.getTime()?r+1:e.getTime()>=o.getTime()?r:r-1}function Fr(t){const e=pe(t);return e.setHours(0,0,0,0),e}function va(t){const e=pe(t),r=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return r.setUTCFullYear(e.getFullYear()),+t-+r}function Ol(t,e){const r=Fr(t),n=Fr(e),a=+r-va(r),i=+n-va(n);return Math.round((a-i)/Sl)}function Pl(t){const e=Pi(t),r=Nt(t,0);return r.setFullYear(e,0,4),r.setHours(0,0,0,0),vn(r)}function kl(t,e){const r=e*7;return Nl(t,r)}function Al(t){return Nt(t,Date.now())}function El(t,e){const r=Fr(t),n=Fr(e);return+r==+n}function Ml(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function Tl(t){if(!Ml(t)&&typeof t!="number")return!1;const e=pe(t);return!isNaN(Number(e))}function Rl(t){const e=pe(t);return e.setHours(23,59,59,999),e}function ki(t){const e=pe(t),r=e.getMonth();return e.setFullYear(e.getFullYear(),r+1,0),e.setHours(23,59,59,999),e}function Il(t,e){const r=pe(t.start),n=pe(t.end);let a=+r>+n;const i=a?+r:+n,o=a?n:r;o.setHours(0,0,0,0);let c=1;const l=[];for(;+o<=i;)l.push(pe(o)),o.setDate(o.getDate()+c),o.setHours(0,0,0,0);return a?l.reverse():l}function Dl(t,e){const r=pe(t.start),n=pe(t.end);let a=+r>+n;const i=at(a?n:r,e),o=at(a?r:n,e);i.setHours(15),o.setHours(15);const c=+o.getTime();let l=i,d=(e==null?void 0:e.step)??1;if(!d)return[];d<0&&(d=-d,a=!a);const u=[];for(;+l<=c;)l.setHours(0),u.push(pe(l)),l=kl(l,d),l.setHours(15);return a?u.reverse():u}function Ai(t){const e=pe(t);return e.setDate(1),e.setHours(0,0,0,0),e}function Fl(t){const e=pe(t),r=Nt(t,0);return r.setFullYear(e.getFullYear(),0,1),r.setHours(0,0,0,0),r}function $l(t,e){var c,l;const r=Qr(),n=r.weekStartsOn??((l=(c=r.locale)==null?void 0:c.options)==null?void 0:l.weekStartsOn)??0,a=pe(t),i=a.getDay(),o=(i<n?-7:0)+6-(i-n);return a.setDate(a.getDate()+o),a.setHours(23,59,59,999),a}const Ll={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Bl=(t,e,r)=>{let n;const a=Ll[t];return typeof a=="string"?n=a:e===1?n=a.one:n=a.other.replace("{{count}}",e.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function gr(t){return(e={})=>{const r=e.width?String(e.width):t.defaultWidth;return t.formats[r]||t.formats[t.defaultWidth]}}const Ul={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Vl={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},zl={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Wl={date:gr({formats:Ul,defaultWidth:"full"}),time:gr({formats:Vl,defaultWidth:"full"}),dateTime:gr({formats:zl,defaultWidth:"full"})},Hl={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},ql=(t,e,r,n)=>Hl[t];function rt(t){return(e,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&t.formattingValues){const o=t.defaultFormattingWidth||t.defaultWidth,c=r!=null&&r.width?String(r.width):o;a=t.formattingValues[c]||t.formattingValues[o]}else{const o=t.defaultWidth,c=r!=null&&r.width?String(r.width):t.defaultWidth;a=t.values[c]||t.values[o]}const i=t.argumentCallback?t.argumentCallback(e):e;return a[i]}}const Gl={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Yl={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Kl={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Ql={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Xl={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},Jl={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},Zl=(t,e)=>{const r=Number(t),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},ed={ordinalNumber:Zl,era:rt({values:Gl,defaultWidth:"wide"}),quarter:rt({values:Yl,defaultWidth:"wide",argumentCallback:t=>t-1}),month:rt({values:Kl,defaultWidth:"wide"}),day:rt({values:Ql,defaultWidth:"wide"}),dayPeriod:rt({values:Xl,defaultWidth:"wide",formattingValues:Jl,defaultFormattingWidth:"wide"})};function nt(t){return(e,r={})=>{const n=r.width,a=n&&t.matchPatterns[n]||t.matchPatterns[t.defaultMatchWidth],i=e.match(a);if(!i)return null;const o=i[0],c=n&&t.parsePatterns[n]||t.parsePatterns[t.defaultParseWidth],l=Array.isArray(c)?rd(c,h=>h.test(o)):td(c,h=>h.test(o));let d;d=t.valueCallback?t.valueCallback(l):l,d=r.valueCallback?r.valueCallback(d):d;const u=e.slice(o.length);return{value:d,rest:u}}}function td(t,e){for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)&&e(t[r]))return r}function rd(t,e){for(let r=0;r<t.length;r++)if(e(t[r]))return r}function Ei(t){return(e,r={})=>{const n=e.match(t.matchPattern);if(!n)return null;const a=n[0],i=e.match(t.parsePattern);if(!i)return null;let o=t.valueCallback?t.valueCallback(i[0]):i[0];o=r.valueCallback?r.valueCallback(o):o;const c=e.slice(a.length);return{value:o,rest:c}}}const nd=/^(\d+)(th|st|nd|rd)?/i,sd=/\d+/i,ad={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},id={any:[/^b/i,/^(a|c)/i]},od={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},cd={any:[/1/i,/2/i,/3/i,/4/i]},ld={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},dd={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},ud={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},hd={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},fd={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},md={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},gd={ordinalNumber:Ei({matchPattern:nd,parsePattern:sd,valueCallback:t=>parseInt(t,10)}),era:nt({matchPatterns:ad,defaultMatchWidth:"wide",parsePatterns:id,defaultParseWidth:"any"}),quarter:nt({matchPatterns:od,defaultMatchWidth:"wide",parsePatterns:cd,defaultParseWidth:"any",valueCallback:t=>t+1}),month:nt({matchPatterns:ld,defaultMatchWidth:"wide",parsePatterns:dd,defaultParseWidth:"any"}),day:nt({matchPatterns:ud,defaultMatchWidth:"wide",parsePatterns:hd,defaultParseWidth:"any"}),dayPeriod:nt({matchPatterns:fd,defaultMatchWidth:"any",parsePatterns:md,defaultParseWidth:"any"})},pd={code:"en-US",formatDistance:Bl,formatLong:Wl,formatRelative:ql,localize:ed,match:gd,options:{weekStartsOn:0,firstWeekContainsDate:1}};function vd(t){const e=pe(t);return Ol(e,Fl(e))+1}function bd(t){const e=pe(t),r=+vn(e)-+Pl(e);return Math.round(r/Oi)+1}function Mi(t,e){var u,h,f,p;const r=pe(t),n=r.getFullYear(),a=Qr(),i=(e==null?void 0:e.firstWeekContainsDate)??((h=(u=e==null?void 0:e.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??a.firstWeekContainsDate??((p=(f=a.locale)==null?void 0:f.options)==null?void 0:p.firstWeekContainsDate)??1,o=Nt(t,0);o.setFullYear(n+1,0,i),o.setHours(0,0,0,0);const c=at(o,e),l=Nt(t,0);l.setFullYear(n,0,i),l.setHours(0,0,0,0);const d=at(l,e);return r.getTime()>=c.getTime()?n+1:r.getTime()>=d.getTime()?n:n-1}function xd(t,e){var c,l,d,u;const r=Qr(),n=(e==null?void 0:e.firstWeekContainsDate)??((l=(c=e==null?void 0:e.locale)==null?void 0:c.options)==null?void 0:l.firstWeekContainsDate)??r.firstWeekContainsDate??((u=(d=r.locale)==null?void 0:d.options)==null?void 0:u.firstWeekContainsDate)??1,a=Mi(t,e),i=Nt(t,0);return i.setFullYear(a,0,n),i.setHours(0,0,0,0),at(i,e)}function yd(t,e){const r=pe(t),n=+at(r,e)-+xd(r,e);return Math.round(n/Oi)+1}function ae(t,e){const r=t<0?"-":"",n=Math.abs(t).toString().padStart(e,"0");return r+n}const At={y(t,e){const r=t.getFullYear(),n=r>0?r:1-r;return ae(e==="yy"?n%100:n,e.length)},M(t,e){const r=t.getMonth();return e==="M"?String(r+1):ae(r+1,2)},d(t,e){return ae(t.getDate(),e.length)},a(t,e){const r=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(t,e){return ae(t.getHours()%12||12,e.length)},H(t,e){return ae(t.getHours(),e.length)},m(t,e){return ae(t.getMinutes(),e.length)},s(t,e){return ae(t.getSeconds(),e.length)},S(t,e){const r=e.length,n=t.getMilliseconds(),a=Math.trunc(n*Math.pow(10,r-3));return ae(a,e.length)}},cr={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},ba={G:function(t,e,r){const n=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});case"GGGG":default:return r.era(n,{width:"wide"})}},y:function(t,e,r){if(e==="yo"){const n=t.getFullYear(),a=n>0?n:1-n;return r.ordinalNumber(a,{unit:"year"})}return At.y(t,e)},Y:function(t,e,r,n){const a=Mi(t,n),i=a>0?a:1-a;if(e==="YY"){const o=i%100;return ae(o,2)}return e==="Yo"?r.ordinalNumber(i,{unit:"year"}):ae(i,e.length)},R:function(t,e){const r=Pi(t);return ae(r,e.length)},u:function(t,e){const r=t.getFullYear();return ae(r,e.length)},Q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(n);case"QQ":return ae(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(t,e,r){const n=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(n);case"qq":return ae(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(t,e,r){const n=t.getMonth();switch(e){case"M":case"MM":return At.M(t,e);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(t,e,r){const n=t.getMonth();switch(e){case"L":return String(n+1);case"LL":return ae(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(t,e,r,n){const a=yd(t,n);return e==="wo"?r.ordinalNumber(a,{unit:"week"}):ae(a,e.length)},I:function(t,e,r){const n=bd(t);return e==="Io"?r.ordinalNumber(n,{unit:"week"}):ae(n,e.length)},d:function(t,e,r){return e==="do"?r.ordinalNumber(t.getDate(),{unit:"date"}):At.d(t,e)},D:function(t,e,r){const n=vd(t);return e==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):ae(n,e.length)},E:function(t,e,r){const n=t.getDay();switch(e){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});case"EEEE":default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(t,e,r,n){const a=t.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return ae(i,2);case"eo":return r.ordinalNumber(i,{unit:"day"});case"eee":return r.day(a,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(a,{width:"short",context:"formatting"});case"eeee":default:return r.day(a,{width:"wide",context:"formatting"})}},c:function(t,e,r,n){const a=t.getDay(),i=(a-n.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return ae(i,e.length);case"co":return r.ordinalNumber(i,{unit:"day"});case"ccc":return r.day(a,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(a,{width:"narrow",context:"standalone"});case"cccccc":return r.day(a,{width:"short",context:"standalone"});case"cccc":default:return r.day(a,{width:"wide",context:"standalone"})}},i:function(t,e,r){const n=t.getDay(),a=n===0?7:n;switch(e){case"i":return String(a);case"ii":return ae(a,e.length);case"io":return r.ordinalNumber(a,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});case"iiii":default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(t,e,r){const a=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(t,e,r){const n=t.getHours();let a;switch(n===12?a=cr.noon:n===0?a=cr.midnight:a=n/12>=1?"pm":"am",e){case"b":case"bb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},B:function(t,e,r){const n=t.getHours();let a;switch(n>=17?a=cr.evening:n>=12?a=cr.afternoon:n>=4?a=cr.morning:a=cr.night,e){case"B":case"BB":case"BBB":return r.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(a,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(a,{width:"wide",context:"formatting"})}},h:function(t,e,r){if(e==="ho"){let n=t.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return At.h(t,e)},H:function(t,e,r){return e==="Ho"?r.ordinalNumber(t.getHours(),{unit:"hour"}):At.H(t,e)},K:function(t,e,r){const n=t.getHours()%12;return e==="Ko"?r.ordinalNumber(n,{unit:"hour"}):ae(n,e.length)},k:function(t,e,r){let n=t.getHours();return n===0&&(n=24),e==="ko"?r.ordinalNumber(n,{unit:"hour"}):ae(n,e.length)},m:function(t,e,r){return e==="mo"?r.ordinalNumber(t.getMinutes(),{unit:"minute"}):At.m(t,e)},s:function(t,e,r){return e==="so"?r.ordinalNumber(t.getSeconds(),{unit:"second"}):At.s(t,e)},S:function(t,e){return At.S(t,e)},X:function(t,e,r){const n=t.getTimezoneOffset();if(n===0)return"Z";switch(e){case"X":return ya(n);case"XXXX":case"XX":return Wt(n);case"XXXXX":case"XXX":default:return Wt(n,":")}},x:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"x":return ya(n);case"xxxx":case"xx":return Wt(n);case"xxxxx":case"xxx":default:return Wt(n,":")}},O:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+xa(n,":");case"OOOO":default:return"GMT"+Wt(n,":")}},z:function(t,e,r){const n=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+xa(n,":");case"zzzz":default:return"GMT"+Wt(n,":")}},t:function(t,e,r){const n=Math.trunc(t.getTime()/1e3);return ae(n,e.length)},T:function(t,e,r){const n=t.getTime();return ae(n,e.length)}};function xa(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),a=Math.trunc(n/60),i=n%60;return i===0?r+String(a):r+String(a)+e+ae(i,2)}function ya(t,e){return t%60===0?(t>0?"-":"+")+ae(Math.abs(t)/60,2):Wt(t,e)}function Wt(t,e=""){const r=t>0?"-":"+",n=Math.abs(t),a=ae(Math.trunc(n/60),2),i=ae(n%60,2);return r+a+e+i}const wa=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},Ti=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},wd=(t,e)=>{const r=t.match(/(P+)(p+)?/)||[],n=r[1],a=r[2];if(!a)return wa(t,e);let i;switch(n){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",wa(n,e)).replace("{{time}}",Ti(a,e))},jd={p:Ti,P:wd},_d=/^D+$/,Nd=/^Y+$/,Sd=["D","DD","YY","YYYY"];function Cd(t){return _d.test(t)}function Od(t){return Nd.test(t)}function Pd(t,e,r){const n=kd(t,e,r);if(console.warn(n),Sd.includes(t))throw new RangeError(n)}function kd(t,e,r){const n=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Ad=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Ed=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Md=/^'([^]*?)'?$/,Td=/''/g,Rd=/[a-zA-Z]/;function ve(t,e,r){var u,h,f,p,g,b,m,w;const n=Qr(),a=(r==null?void 0:r.locale)??n.locale??pd,i=(r==null?void 0:r.firstWeekContainsDate)??((h=(u=r==null?void 0:r.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??n.firstWeekContainsDate??((p=(f=n.locale)==null?void 0:f.options)==null?void 0:p.firstWeekContainsDate)??1,o=(r==null?void 0:r.weekStartsOn)??((b=(g=r==null?void 0:r.locale)==null?void 0:g.options)==null?void 0:b.weekStartsOn)??n.weekStartsOn??((w=(m=n.locale)==null?void 0:m.options)==null?void 0:w.weekStartsOn)??0,c=pe(t);if(!Tl(c))throw new RangeError("Invalid time value");let l=e.match(Ed).map(v=>{const j=v[0];if(j==="p"||j==="P"){const N=jd[j];return N(v,a.formatLong)}return v}).join("").match(Ad).map(v=>{if(v==="''")return{isToken:!1,value:"'"};const j=v[0];if(j==="'")return{isToken:!1,value:Id(v)};if(ba[j])return{isToken:!0,value:v};if(j.match(Rd))throw new RangeError("Format string contains an unescaped latin alphabet character `"+j+"`");return{isToken:!1,value:v}});a.localize.preprocessor&&(l=a.localize.preprocessor(c,l));const d={firstWeekContainsDate:i,weekStartsOn:o,locale:a};return l.map(v=>{if(!v.isToken)return v.value;const j=v.value;(!(r!=null&&r.useAdditionalWeekYearTokens)&&Od(j)||!(r!=null&&r.useAdditionalDayOfYearTokens)&&Cd(j))&&Pd(j,e,String(t));const N=ba[j[0]];return N(c,j,a.localize,d)}).join("")}function Id(t){const e=t.match(Md);return e?e[1].replace(Td,"'"):t}function Dd(t,e){const r=pe(t),n=pe(e);return r.getFullYear()===n.getFullYear()&&r.getMonth()===n.getMonth()}function Fd(t){return El(t,Al(t))}const $d={lessThanXSeconds:{one:"menos de un segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"medio minuto",lessThanXMinutes:{one:"menos de un minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"alrededor de 1 hora",other:"alrededor de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 día",other:"{{count}} días"},aboutXWeeks:{one:"alrededor de 1 semana",other:"alrededor de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"alrededor de 1 mes",other:"alrededor de {{count}} meses"},xMonths:{one:"1 mes",other:"{{count}} meses"},aboutXYears:{one:"alrededor de 1 año",other:"alrededor de {{count}} años"},xYears:{one:"1 año",other:"{{count}} años"},overXYears:{one:"más de 1 año",other:"más de {{count}} años"},almostXYears:{one:"casi 1 año",other:"casi {{count}} años"}},Ld=(t,e,r)=>{let n;const a=$d[t];return typeof a=="string"?n=a:e===1?n=a.one:n=a.other.replace("{{count}}",e.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"en "+n:"hace "+n:n},Bd={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/y"},Ud={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},Vd={full:"{{date}} 'a las' {{time}}",long:"{{date}} 'a las' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},zd={date:gr({formats:Bd,defaultWidth:"full"}),time:gr({formats:Ud,defaultWidth:"full"}),dateTime:gr({formats:Vd,defaultWidth:"full"})},Wd={lastWeek:"'el' eeee 'pasado a la' p",yesterday:"'ayer a la' p",today:"'hoy a la' p",tomorrow:"'mañana a la' p",nextWeek:"eeee 'a la' p",other:"P"},Hd={lastWeek:"'el' eeee 'pasado a las' p",yesterday:"'ayer a las' p",today:"'hoy a las' p",tomorrow:"'mañana a las' p",nextWeek:"eeee 'a las' p",other:"P"},qd=(t,e,r,n)=>e.getHours()!==1?Hd[t]:Wd[t],Gd={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","después de cristo"]},Yd={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1º trimestre","2º trimestre","3º trimestre","4º trimestre"]},Kd={narrow:["e","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],wide:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]},Qd={narrow:["d","l","m","m","j","v","s"],short:["do","lu","ma","mi","ju","vi","sá"],abbreviated:["dom","lun","mar","mié","jue","vie","sáb"],wide:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"]},Xd={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"mañana",afternoon:"tarde",evening:"tarde",night:"noche"}},Jd={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"de la mañana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"}},Zd=(t,e)=>Number(t)+"º",eu={ordinalNumber:Zd,era:rt({values:Gd,defaultWidth:"wide"}),quarter:rt({values:Yd,defaultWidth:"wide",argumentCallback:t=>Number(t)-1}),month:rt({values:Kd,defaultWidth:"wide"}),day:rt({values:Qd,defaultWidth:"wide"}),dayPeriod:rt({values:Xd,defaultWidth:"wide",formattingValues:Jd,defaultFormattingWidth:"wide"})},tu=/^(\d+)(º)?/i,ru=/\d+/i,nu={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|a\.?\s?e\.?\s?c\.?|d\.?\s?c\.?|e\.?\s?c\.?)/i,wide:/^(antes de cristo|antes de la era com[uú]n|despu[eé]s de cristo|era com[uú]n)/i},su={any:[/^ac/i,/^dc/i],wide:[/^(antes de cristo|antes de la era com[uú]n)/i,/^(despu[eé]s de cristo|era com[uú]n)/i]},au={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234](º)? trimestre/i},iu={any:[/1/i,/2/i,/3/i,/4/i]},ou={narrow:/^[efmajsond]/i,abbreviated:/^(ene|feb|mar|abr|may|jun|jul|ago|sep|oct|nov|dic)/i,wide:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i},cu={narrow:[/^e/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^en/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i]},lu={narrow:/^[dlmjvs]/i,short:/^(do|lu|ma|mi|ju|vi|s[áa])/i,abbreviated:/^(dom|lun|mar|mi[ée]|jue|vie|s[áa]b)/i,wide:/^(domingo|lunes|martes|mi[ée]rcoles|jueves|viernes|s[áa]bado)/i},du={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^do/i,/^lu/i,/^ma/i,/^mi/i,/^ju/i,/^vi/i,/^sa/i]},uu={narrow:/^(a|p|mn|md|(de la|a las) (mañana|tarde|noche))/i,any:/^([ap]\.?\s?m\.?|medianoche|mediodia|(de la|a las) (mañana|tarde|noche))/i},hu={any:{am:/^a/i,pm:/^p/i,midnight:/^mn/i,noon:/^md/i,morning:/mañana/i,afternoon:/tarde/i,evening:/tarde/i,night:/noche/i}},fu={ordinalNumber:Ei({matchPattern:tu,parsePattern:ru,valueCallback:function(t){return parseInt(t,10)}}),era:nt({matchPatterns:nu,defaultMatchWidth:"wide",parsePatterns:su,defaultParseWidth:"any"}),quarter:nt({matchPatterns:au,defaultMatchWidth:"wide",parsePatterns:iu,defaultParseWidth:"any",valueCallback:t=>t+1}),month:nt({matchPatterns:ou,defaultMatchWidth:"wide",parsePatterns:cu,defaultParseWidth:"any"}),day:nt({matchPatterns:lu,defaultMatchWidth:"wide",parsePatterns:du,defaultParseWidth:"any"}),dayPeriod:nt({matchPatterns:uu,defaultMatchWidth:"any",parsePatterns:hu,defaultParseWidth:"any"})},ye={code:"es",formatDistance:Ld,formatLong:zd,formatRelative:qd,localize:eu,match:fu,options:{weekStartsOn:1,firstWeekContainsDate:1}};function ne(t){return new Intl.NumberFormat("es-UY",{style:"currency",currency:"UYU"}).format(t)}function Ri(t){const e=t.replace(/\D/g,""),r=e.startsWith("598")?e.slice(3):e;return r.length>=8?`+598 ${[r.slice(0,2),r.slice(2,5),r.slice(5)].join(" ")}`:`+598 ${r}`}function ja(t){const e=t.replace(/\D/g,""),r=e.startsWith("598")?e.slice(3):e;return/^[0-9]{8,9}$/.test(r)}function Ii(t,e){const r=t.replace(/\D/g,"");return`https://wa.me/${r.startsWith("598")?r:`598${r}`}?text=${encodeURIComponent(e)}`}function Di(t){var e,r,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var a=t.length;for(e=0;e<a;e++)t[e]&&(r=Di(t[e]))&&(n&&(n+=" "),n+=r)}else for(r in t)t[r]&&(n&&(n+=" "),n+=r);return n}function mu(){for(var t,e,r=0,n="",a=arguments.length;r<a;r++)(t=arguments[r])&&(e=Di(t))&&(n&&(n+=" "),n+=e);return n}const Is="-",gu=t=>{const e=vu(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=t;return{getClassGroupId:o=>{const c=o.split(Is);return c[0]===""&&c.length!==1&&c.shift(),Fi(c,e)||pu(o)},getConflictingClassGroupIds:(o,c)=>{const l=r[o]||[];return c&&n[o]?[...l,...n[o]]:l}}},Fi=(t,e)=>{var o;if(t.length===0)return e.classGroupId;const r=t[0],n=e.nextPart.get(r),a=n?Fi(t.slice(1),n):void 0;if(a)return a;if(e.validators.length===0)return;const i=t.join(Is);return(o=e.validators.find(({validator:c})=>c(i)))==null?void 0:o.classGroupId},_a=/^\[(.+)\]$/,pu=t=>{if(_a.test(t)){const e=_a.exec(t)[1],r=e==null?void 0:e.substring(0,e.indexOf(":"));if(r)return"arbitrary.."+r}},vu=t=>{const{theme:e,prefix:r}=t,n={nextPart:new Map,validators:[]};return xu(Object.entries(t.classGroups),r).forEach(([i,o])=>{hs(o,n,i,e)}),n},hs=(t,e,r,n)=>{t.forEach(a=>{if(typeof a=="string"){const i=a===""?e:Na(e,a);i.classGroupId=r;return}if(typeof a=="function"){if(bu(a)){hs(a(n),e,r,n);return}e.validators.push({validator:a,classGroupId:r});return}Object.entries(a).forEach(([i,o])=>{hs(o,Na(e,i),r,n)})})},Na=(t,e)=>{let r=t;return e.split(Is).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},bu=t=>t.isThemeGetter,xu=(t,e)=>e?t.map(([r,n])=>{const a=n.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,c])=>[e+o,c])):i);return[r,a]}):t,yu=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,r=new Map,n=new Map;const a=(i,o)=>{r.set(i,o),e++,e>t&&(e=0,n=r,r=new Map)};return{get(i){let o=r.get(i);if(o!==void 0)return o;if((o=n.get(i))!==void 0)return a(i,o),o},set(i,o){r.has(i)?r.set(i,o):a(i,o)}}},$i="!",wu=t=>{const{separator:e,experimentalParseClassName:r}=t,n=e.length===1,a=e[0],i=e.length,o=c=>{const l=[];let d=0,u=0,h;for(let m=0;m<c.length;m++){let w=c[m];if(d===0){if(w===a&&(n||c.slice(m,m+i)===e)){l.push(c.slice(u,m)),u=m+i;continue}if(w==="/"){h=m;continue}}w==="["?d++:w==="]"&&d--}const f=l.length===0?c:c.substring(u),p=f.startsWith($i),g=p?f.substring(1):f,b=h&&h>u?h-u:void 0;return{modifiers:l,hasImportantModifier:p,baseClassName:g,maybePostfixModifierPosition:b}};return r?c=>r({className:c,parseClassName:o}):o},ju=t=>{if(t.length<=1)return t;const e=[];let r=[];return t.forEach(n=>{n[0]==="["?(e.push(...r.sort(),n),r=[]):r.push(n)}),e.push(...r.sort()),e},_u=t=>({cache:yu(t.cacheSize),parseClassName:wu(t),...gu(t)}),Nu=/\s+/,Su=(t,e)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:a}=e,i=[],o=t.trim().split(Nu);let c="";for(let l=o.length-1;l>=0;l-=1){const d=o[l],{modifiers:u,hasImportantModifier:h,baseClassName:f,maybePostfixModifierPosition:p}=r(d);let g=!!p,b=n(g?f.substring(0,p):f);if(!b){if(!g){c=d+(c.length>0?" "+c:c);continue}if(b=n(f),!b){c=d+(c.length>0?" "+c:c);continue}g=!1}const m=ju(u).join(":"),w=h?m+$i:m,v=w+b;if(i.includes(v))continue;i.push(v);const j=a(b,g);for(let N=0;N<j.length;++N){const C=j[N];i.push(w+C)}c=d+(c.length>0?" "+c:c)}return c};function Cu(){let t=0,e,r,n="";for(;t<arguments.length;)(e=arguments[t++])&&(r=Li(e))&&(n&&(n+=" "),n+=r);return n}const Li=t=>{if(typeof t=="string")return t;let e,r="";for(let n=0;n<t.length;n++)t[n]&&(e=Li(t[n]))&&(r&&(r+=" "),r+=e);return r};function Ou(t,...e){let r,n,a,i=o;function o(l){const d=e.reduce((u,h)=>h(u),t());return r=_u(d),n=r.cache.get,a=r.cache.set,i=c,c(l)}function c(l){const d=n(l);if(d)return d;const u=Su(l,r);return a(l,u),u}return function(){return i(Cu.apply(null,arguments))}}const me=t=>{const e=r=>r[t]||[];return e.isThemeGetter=!0,e},Bi=/^\[(?:([a-z-]+):)?(.+)\]$/i,Pu=/^\d+\/\d+$/,ku=new Set(["px","full","screen"]),Au=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Eu=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Mu=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Tu=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Ru=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,mt=t=>pr(t)||ku.has(t)||Pu.test(t),Et=t=>_r(t,"length",Vu),pr=t=>!!t&&!Number.isNaN(Number(t)),Yn=t=>_r(t,"number",pr),Or=t=>!!t&&Number.isInteger(Number(t)),Iu=t=>t.endsWith("%")&&pr(t.slice(0,-1)),Y=t=>Bi.test(t),Mt=t=>Au.test(t),Du=new Set(["length","size","percentage"]),Fu=t=>_r(t,Du,Ui),$u=t=>_r(t,"position",Ui),Lu=new Set(["image","url"]),Bu=t=>_r(t,Lu,Wu),Uu=t=>_r(t,"",zu),Pr=()=>!0,_r=(t,e,r)=>{const n=Bi.exec(t);return n?n[1]?typeof e=="string"?n[1]===e:e.has(n[1]):r(n[2]):!1},Vu=t=>Eu.test(t)&&!Mu.test(t),Ui=()=>!1,zu=t=>Tu.test(t),Wu=t=>Ru.test(t),Hu=()=>{const t=me("colors"),e=me("spacing"),r=me("blur"),n=me("brightness"),a=me("borderColor"),i=me("borderRadius"),o=me("borderSpacing"),c=me("borderWidth"),l=me("contrast"),d=me("grayscale"),u=me("hueRotate"),h=me("invert"),f=me("gap"),p=me("gradientColorStops"),g=me("gradientColorStopPositions"),b=me("inset"),m=me("margin"),w=me("opacity"),v=me("padding"),j=me("saturate"),N=me("scale"),C=me("sepia"),$=me("skew"),J=me("space"),oe=me("translate"),K=()=>["auto","contain","none"],V=()=>["auto","hidden","clip","visible","scroll"],O=()=>["auto",Y,e],U=()=>[Y,e],Q=()=>["",mt,Et],ce=()=>["auto",pr,Y],Te=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],Re=()=>["solid","dashed","dotted","double","none"],we=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Je=()=>["start","end","center","between","around","evenly","stretch"],$e=()=>["","0",Y],L=()=>["auto","avoid","all","avoid-page","page","left","right","column"],q=()=>[pr,Y];return{cacheSize:500,separator:":",theme:{colors:[Pr],spacing:[mt,Et],blur:["none","",Mt,Y],brightness:q(),borderColor:[t],borderRadius:["none","","full",Mt,Y],borderSpacing:U(),borderWidth:Q(),contrast:q(),grayscale:$e(),hueRotate:q(),invert:$e(),gap:U(),gradientColorStops:[t],gradientColorStopPositions:[Iu,Et],inset:O(),margin:O(),opacity:q(),padding:U(),saturate:q(),scale:q(),sepia:$e(),skew:q(),space:U(),translate:U()},classGroups:{aspect:[{aspect:["auto","square","video",Y]}],container:["container"],columns:[{columns:[Mt]}],"break-after":[{"break-after":L()}],"break-before":[{"break-before":L()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...Te(),Y]}],overflow:[{overflow:V()}],"overflow-x":[{"overflow-x":V()}],"overflow-y":[{"overflow-y":V()}],overscroll:[{overscroll:K()}],"overscroll-x":[{"overscroll-x":K()}],"overscroll-y":[{"overscroll-y":K()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[b]}],"inset-x":[{"inset-x":[b]}],"inset-y":[{"inset-y":[b]}],start:[{start:[b]}],end:[{end:[b]}],top:[{top:[b]}],right:[{right:[b]}],bottom:[{bottom:[b]}],left:[{left:[b]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Or,Y]}],basis:[{basis:O()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Y]}],grow:[{grow:$e()}],shrink:[{shrink:$e()}],order:[{order:["first","last","none",Or,Y]}],"grid-cols":[{"grid-cols":[Pr]}],"col-start-end":[{col:["auto",{span:["full",Or,Y]},Y]}],"col-start":[{"col-start":ce()}],"col-end":[{"col-end":ce()}],"grid-rows":[{"grid-rows":[Pr]}],"row-start-end":[{row:["auto",{span:[Or,Y]},Y]}],"row-start":[{"row-start":ce()}],"row-end":[{"row-end":ce()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Y]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Y]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...Je()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...Je(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...Je(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[v]}],px:[{px:[v]}],py:[{py:[v]}],ps:[{ps:[v]}],pe:[{pe:[v]}],pt:[{pt:[v]}],pr:[{pr:[v]}],pb:[{pb:[v]}],pl:[{pl:[v]}],m:[{m:[m]}],mx:[{mx:[m]}],my:[{my:[m]}],ms:[{ms:[m]}],me:[{me:[m]}],mt:[{mt:[m]}],mr:[{mr:[m]}],mb:[{mb:[m]}],ml:[{ml:[m]}],"space-x":[{"space-x":[J]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[J]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Y,e]}],"min-w":[{"min-w":[Y,e,"min","max","fit"]}],"max-w":[{"max-w":[Y,e,"none","full","min","max","fit","prose",{screen:[Mt]},Mt]}],h:[{h:[Y,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Y,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Y,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Y,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Mt,Et]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Yn]}],"font-family":[{font:[Pr]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Y]}],"line-clamp":[{"line-clamp":["none",pr,Yn]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",mt,Y]}],"list-image":[{"list-image":["none",Y]}],"list-style-type":[{list:["none","disc","decimal",Y]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[w]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[w]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...Re(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",mt,Et]}],"underline-offset":[{"underline-offset":["auto",mt,Y]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:U()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Y]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Y]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[w]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...Te(),$u]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Fu]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Bu]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[g]}],"gradient-via-pos":[{via:[g]}],"gradient-to-pos":[{to:[g]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[c]}],"border-w-x":[{"border-x":[c]}],"border-w-y":[{"border-y":[c]}],"border-w-s":[{"border-s":[c]}],"border-w-e":[{"border-e":[c]}],"border-w-t":[{"border-t":[c]}],"border-w-r":[{"border-r":[c]}],"border-w-b":[{"border-b":[c]}],"border-w-l":[{"border-l":[c]}],"border-opacity":[{"border-opacity":[w]}],"border-style":[{border:[...Re(),"hidden"]}],"divide-x":[{"divide-x":[c]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[c]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[w]}],"divide-style":[{divide:Re()}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["",...Re()]}],"outline-offset":[{"outline-offset":[mt,Y]}],"outline-w":[{outline:[mt,Et]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:Q()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[w]}],"ring-offset-w":[{"ring-offset":[mt,Et]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Mt,Uu]}],"shadow-color":[{shadow:[Pr]}],opacity:[{opacity:[w]}],"mix-blend":[{"mix-blend":[...we(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":we()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Mt,Y]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[h]}],saturate:[{saturate:[j]}],sepia:[{sepia:[C]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[w]}],"backdrop-saturate":[{"backdrop-saturate":[j]}],"backdrop-sepia":[{"backdrop-sepia":[C]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Y]}],duration:[{duration:q()}],ease:[{ease:["linear","in","out","in-out",Y]}],delay:[{delay:q()}],animate:[{animate:["none","spin","ping","pulse","bounce",Y]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[N]}],"scale-x":[{"scale-x":[N]}],"scale-y":[{"scale-y":[N]}],rotate:[{rotate:[Or,Y]}],"translate-x":[{"translate-x":[oe]}],"translate-y":[{"translate-y":[oe]}],"skew-x":[{"skew-x":[$]}],"skew-y":[{"skew-y":[$]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Y]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Y]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":U()}],"scroll-mx":[{"scroll-mx":U()}],"scroll-my":[{"scroll-my":U()}],"scroll-ms":[{"scroll-ms":U()}],"scroll-me":[{"scroll-me":U()}],"scroll-mt":[{"scroll-mt":U()}],"scroll-mr":[{"scroll-mr":U()}],"scroll-mb":[{"scroll-mb":U()}],"scroll-ml":[{"scroll-ml":U()}],"scroll-p":[{"scroll-p":U()}],"scroll-px":[{"scroll-px":U()}],"scroll-py":[{"scroll-py":U()}],"scroll-ps":[{"scroll-ps":U()}],"scroll-pe":[{"scroll-pe":U()}],"scroll-pt":[{"scroll-pt":U()}],"scroll-pr":[{"scroll-pr":U()}],"scroll-pb":[{"scroll-pb":U()}],"scroll-pl":[{"scroll-pl":U()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Y]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[mt,Et,Yn]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},qu=Ou(Hu);function Pe(...t){return qu(mu(t))}const It=[{code:"GRL",name:"General"},{code:"GFR",name:"Granja Fresco"},{code:"GRE",name:"Granja Refrigerado"},{code:"GTM",name:"Granja Terminado"},{code:"GPA",name:"Granja Panadería"},{code:"GSC",name:"Granja Seco"},{code:"HEL",name:"Heladería"},{code:"REF",name:"Refrigerado"},{code:"CON",name:"Congelado"},{code:"FRU",name:"Frutas"}],Ft={name:"Panadería Nueva Río D'or",owner:"TEJAS DE LA CRUZ YOSBANY"};function Vi(t){const e=t.toString().padStart(5,"0"),r=parseInt(e.slice(0,2))-1;return r>=0&&r<It.length?It[r].code:It[0].code}function Gu(t){const e=t.toString().padStart(5,"0");return parseInt(e.slice(2))}function zi(t){const e=Vi(t),r=Gu(t);return`${e}-${r.toString().padStart(3,"0")}`}const Sa=[{name:"Dashboard",to:"/",icon:Rc},{name:"Proveedores",to:"/providers",icon:gi},{name:"Productos",to:"/products",icon:ot},{name:"Recetas",to:"/recipes",icon:vr},{name:"Órdenes",to:"/orders",icon:Gr},{name:"Cronograma",to:"/schedule",icon:Yr},{name:"Inventario",to:"/inventory",icon:Ic}];function Yu(){const{signOut:t}=Rs(),[e,r]=y.useState(!1);return s.jsx("header",{className:"bg-white border-b border-gray-200",children:s.jsxs("div",{className:"mx-auto px-4",children:[s.jsxs("div",{className:"flex h-16 items-center justify-between",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx("h1",{className:"text-xl font-bold text-gray-900 mr-4 whitespace-nowrap",children:"Gestión de Compras"}),s.jsx("button",{onClick:()=>r(!e),className:"md:hidden ml-2 p-2 rounded-md hover:bg-gray-100",children:e?s.jsx($t,{className:"h-6 w-6"}):s.jsx(Tc,{className:"h-6 w-6"})})]}),s.jsxs("nav",{className:"hidden md:flex space-x-4",children:[Sa.map(n=>s.jsxs(ma,{to:n.to,className:({isActive:a})=>Pe("inline-flex items-center px-3 py-2 text-sm font-medium rounded-md transition-colors",a?"text-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"),children:[s.jsx(n.icon,{className:"mr-2 h-5 w-5"}),n.name]},n.name)),s.jsxs("button",{onClick:()=>t(),className:"inline-flex items-center px-3 py-2 text-sm font-medium text-gray-600 hover:text-gray-900 hover:bg-gray-50 rounded-md transition-colors",children:[s.jsx(ha,{className:"mr-2 h-5 w-5"}),"Cerrar Sesión"]})]})]}),e&&s.jsxs("nav",{className:"md:hidden py-4 space-y-2",children:[Sa.map(n=>s.jsxs(ma,{to:n.to,onClick:()=>r(!1),className:({isActive:a})=>Pe("flex items-center px-3 py-2 text-base font-medium rounded-md w-full transition-colors",a?"text-blue-600 bg-blue-50":"text-gray-600 hover:text-gray-900 hover:bg-gray-50"),children:[s.jsx(n.icon,{className:"mr-3 h-5 w-5"}),n.name]},n.name)),s.jsxs("button",{onClick:()=>t(),className:"flex items-center px-3 py-2 text-base font-medium text-gray-600 hover:text-gray-900 hover:bg-gray-50 rounded-md w-full transition-colors",children:[s.jsx(ha,{className:"mr-3 h-5 w-5"}),"Cerrar Sesión"]})]})]})})}function Ku(){return s.jsxs("div",{className:"min-h-screen flex flex-col",children:[s.jsx(Yu,{}),s.jsx("main",{className:"flex-1 overflow-auto bg-gray-100 p-4",children:s.jsx(_i,{})})]})}const I=({className:t,variant:e="primary",size:r="md",isLoading:n,children:a,...i})=>{const o="inline-flex items-center justify-center rounded-md font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",c={primary:"bg-blue-600 text-white hover:bg-blue-700",secondary:"bg-gray-100 text-gray-900 hover:bg-gray-200",outline:"border border-gray-300 bg-transparent hover:bg-gray-100",ghost:"hover:bg-gray-100 hover:text-gray-900"},l={sm:"h-9 px-3 text-sm",md:"h-10 px-4",lg:"h-11 px-8"};return s.jsxs("button",{className:Pe(o,c[e],l[r],t),disabled:n,...i,children:[n?s.jsx("span",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}):null,a]})},te=pn.forwardRef(({className:t,label:e,error:r,value:n,type:a,onChange:i,isCurrency:o,...c},l)=>{const[d,u]=y.useState(""),[h,f]=y.useState(!1),p=v=>{const j=v.toString().split(".");return j[0]=j[0].replace(/\B(?=(\d{3})+(?!\d))/g,"."),j.join(",")};y.useEffect(()=>{o&&typeof n=="number"&&!h&&u(p(n))},[n,o,h]);const g=v=>{if(o){let j=v.target.value.replace(/[^\d.,]/g,"");if(j=j.replace(/,/g,"."),j.split(".").length-1>1){const $=j.split(".");j=$[0]+"."+$.slice(1).join("")}u(j);const C=parseFloat(j)||0;i==null||i({...v,target:{...v.target,value:C.toString()}})}else if(a==="number"){const j=v.target.value;(j===""||!isNaN(Number(j)))&&(i==null||i(v))}else i==null||i(v)},b=v=>{var j;if(o){f(!0);const N=typeof n=="number"?n.toString():"0";u(N.replace(".",","))}(j=c.onFocus)==null||j.call(c,v)},m=v=>{var j;o&&(f(!1),typeof n=="number"&&u(p(n))),(j=c.onBlur)==null||j.call(c,v)},w=o?d:a==="number"&&n===0&&!c.min?"":n;return s.jsxs("div",{className:"space-y-2",children:[e&&s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:e}),s.jsxs("div",{className:"relative",children:[o&&s.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-500",children:"$"}),s.jsx("input",{className:Pe("block w-full rounded-md border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-500","focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500","disabled:cursor-not-allowed disabled:bg-gray-50 disabled:text-gray-500",r&&"border-red-500 focus:border-red-500 focus:ring-red-500",o&&"pl-7 text-right",t),ref:l,value:w,onChange:g,onFocus:b,onBlur:m,type:o?"text":a,inputMode:o?"decimal":void 0,...c})]}),r&&s.jsx("p",{className:"text-sm text-red-600",children:r})]})});te.displayName="Input";function Qu(){const{user:t,signIn:e}=Rs(),[r,n]=y.useState(!1),[a,i]=y.useState(""),[o,c]=y.useState(""),[l,d]=y.useState("");if(t)return s.jsx(ji,{to:"/",replace:!0});const u=async h=>{h.preventDefault(),d(""),n(!0);try{await e(a,o)}catch(f){console.error("Login error:",f),d("Credenciales inválidas")}finally{n(!1)}};return s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 py-12 px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"max-w-md w-full space-y-8 bg-white p-8 rounded-lg shadow-lg",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Órdenes de Compra"}),s.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Inicia sesión para continuar"})]}),s.jsxs("form",{className:"mt-8 space-y-6",onSubmit:u,children:[s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"email",className:"sr-only",children:"Correo electrónico"}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx(Dc,{className:"h-5 w-5 text-gray-400"})}),s.jsx(te,{id:"email",type:"email",value:a,onChange:h=>i(h.target.value),required:!0,className:"pl-10",placeholder:"Correo electrónico",autoComplete:"email"})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"sr-only",children:"Contraseña"}),s.jsxs("div",{className:"relative",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx(Fc,{className:"h-5 w-5 text-gray-400"})}),s.jsx(te,{id:"password",type:"password",value:o,onChange:h=>c(h.target.value),required:!0,className:"pl-10",placeholder:"Contraseña",autoComplete:"current-password"})]})]})]}),l&&s.jsx("div",{className:"text-red-600 text-sm text-center",children:l}),s.jsx(I,{type:"submit",className:"w-full",isLoading:r,children:"Iniciar sesión"})]})]})})}function re(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];throw new Error(typeof t=="number"?"[MobX] minified error nr: "+t+(r.length?" "+r.map(String).join(","):"")+". Find the full error at: https://github.com/mobxjs/mobx/blob/main/packages/mobx/src/errors.ts":"[MobX] "+t)}var Xu={};function En(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:Xu}var Wi=Object.assign,bn=Object.getOwnPropertyDescriptor,ct=Object.defineProperty,Mn=Object.prototype,fs=[];Object.freeze(fs);var Hi={};Object.freeze(Hi);var Ju=typeof Proxy<"u",Zu=Object.toString();function qi(){Ju||re("Proxy not available")}function Gi(t){var e=!1;return function(){if(!e)return e=!0,t.apply(this,arguments)}}var ur=function(){};function Ke(t){return typeof t=="function"}function Qt(t){var e=typeof t;switch(e){case"string":case"symbol":case"number":return!0}return!1}function Tn(t){return t!==null&&typeof t=="object"}function St(t){if(!Tn(t))return!1;var e=Object.getPrototypeOf(t);if(e==null)return!0;var r=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r.toString()===Zu}function Yi(t){var e=t==null?void 0:t.constructor;return e?e.name==="GeneratorFunction"||e.displayName==="GeneratorFunction":!1}function Xr(t,e,r){ct(t,e,{enumerable:!1,writable:!0,configurable:!0,value:r})}function Ki(t,e,r){ct(t,e,{enumerable:!1,writable:!1,configurable:!0,value:r})}function tr(t,e){var r="isMobX"+t;return e.prototype[r]=!0,function(n){return Tn(n)&&n[r]===!0}}function Nr(t){return t!=null&&Object.prototype.toString.call(t)==="[object Map]"}function eh(t){var e=Object.getPrototypeOf(t),r=Object.getPrototypeOf(e),n=Object.getPrototypeOf(r);return n===null}function bt(t){return t!=null&&Object.prototype.toString.call(t)==="[object Set]"}var Qi=typeof Object.getOwnPropertySymbols<"u";function th(t){var e=Object.keys(t);if(!Qi)return e;var r=Object.getOwnPropertySymbols(t);return r.length?[].concat(e,r.filter(function(n){return Mn.propertyIsEnumerable.call(t,n)})):e}var br=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Qi?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Object.getOwnPropertyNames;function Xi(t){return t===null?null:typeof t=="object"?""+t:t}function wt(t,e){return Mn.hasOwnProperty.call(t,e)}var rh=Object.getOwnPropertyDescriptors||function(e){var r={};return br(e).forEach(function(n){r[n]=bn(e,n)}),r};function Ie(t,e){return!!(t&e)}function De(t,e,r){return r?t|=e:t&=~e,t}function Ca(t,e){(e==null||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function nh(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ah(n.key),n)}}function Sr(t,e,r){return e&&nh(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t}function hr(t,e){var r=typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=ih(t))||e){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Xt(){return Xt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)({}).hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Xt.apply(null,arguments)}function Ji(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,ms(t,e)}function ms(t,e){return ms=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},ms(t,e)}function sh(t,e){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function ah(t){var e=sh(t,"string");return typeof e=="symbol"?e:e+""}function ih(t,e){if(t){if(typeof t=="string")return Ca(t,e);var r={}.toString.call(t).slice(8,-1);return r==="Object"&&t.constructor&&(r=t.constructor.name),r==="Map"||r==="Set"?Array.from(t):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ca(t,e):void 0}}var it=Symbol("mobx-stored-annotations");function lt(t){function e(r,n){if(Zr(n))return t.decorate_20223_(r,n);Jr(r,n,t)}return Object.assign(e,t)}function Jr(t,e,r){wt(t,it)||Xr(t,it,Xt({},t[it])),gh(r)||(t[it][e]=r)}function oh(t){return wt(t,it)||Xr(t,it,Xt({},t[it])),t[it]}function Zr(t){return typeof t=="object"&&typeof t.kind=="string"}var G=Symbol("mobx administration"),Lt=function(){function t(r){r===void 0&&(r="Atom"),this.name_=void 0,this.flags_=0,this.observers_=new Set,this.lastAccessedBy_=0,this.lowestObserverState_=se.NOT_TRACKING_,this.onBOL=void 0,this.onBUOL=void 0,this.name_=r}var e=t.prototype;return e.onBO=function(){this.onBOL&&this.onBOL.forEach(function(n){return n()})},e.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(n){return n()})},e.reportObserved=function(){return po(this)},e.reportChanged=function(){Ue(),vo(this),Ve()},e.toString=function(){return this.name_},Sr(t,[{key:"isBeingObserved",get:function(){return Ie(this.flags_,t.isBeingObservedMask_)},set:function(n){this.flags_=De(this.flags_,t.isBeingObservedMask_,n)}},{key:"isPendingUnobservation",get:function(){return Ie(this.flags_,t.isPendingUnobservationMask_)},set:function(n){this.flags_=De(this.flags_,t.isPendingUnobservationMask_,n)}},{key:"diffValue",get:function(){return Ie(this.flags_,t.diffValueMask_)?1:0},set:function(n){this.flags_=De(this.flags_,t.diffValueMask_,n===1)}}])}();Lt.isBeingObservedMask_=1;Lt.isPendingUnobservationMask_=2;Lt.diffValueMask_=4;var Ds=tr("Atom",Lt);function Zi(t,e,r){e===void 0&&(e=ur),r===void 0&&(r=ur);var n=new Lt(t);return e!==ur&&bf(n,e),r!==ur&&_o(n,r),n}function ch(t,e){return t===e}function lh(t,e){return zs(t,e)}function dh(t,e){return zs(t,e,1)}function uh(t,e){return Object.is?Object.is(t,e):t===e?t!==0||1/t===1/e:t!==t&&e!==e}var xn={identity:ch,structural:lh,default:uh,shallow:dh};function Jt(t,e,r){return Po(t)?t:Array.isArray(t)?Oe.array(t,{name:r}):St(t)?Oe.object(t,void 0,{name:r}):Nr(t)?Oe.map(t,{name:r}):bt(t)?Oe.set(t,{name:r}):typeof t=="function"&&!Lr(t)&&!Br(t)?Yi(t)?xr(t):$r(r,t):t}function hh(t,e,r){if(t==null||Ln(t)||$n(t)||nr(t)||st(t))return t;if(Array.isArray(t))return Oe.array(t,{name:r,deep:!1});if(St(t))return Oe.object(t,void 0,{name:r,deep:!1});if(Nr(t))return Oe.map(t,{name:r,deep:!1});if(bt(t))return Oe.set(t,{name:r,deep:!1})}function Rn(t){return t}function fh(t,e){return zs(t,e)?e:t}var mh="override";function gh(t){return t.annotationType_===mh}function en(t,e){return{annotationType_:t,options_:e,make_:ph,extend_:vh,decorate_20223_:bh}}function ph(t,e,r,n){var a;if((a=this.options_)!=null&&a.bound)return this.extend_(t,e,r,!1)===null?0:1;if(n===t.target_)return this.extend_(t,e,r,!1)===null?0:2;if(Lr(r.value))return 1;var i=eo(t,this,e,r,!1);return ct(n,e,i),2}function vh(t,e,r,n){var a=eo(t,this,e,r);return t.defineProperty_(e,a,n)}function bh(t,e){var r=e.kind,n=e.name,a=e.addInitializer,i=this,o=function(d){var u,h,f,p;return Zt((u=(h=i.options_)==null?void 0:h.name)!=null?u:n.toString(),d,(f=(p=i.options_)==null?void 0:p.autoAction)!=null?f:!1)};if(r=="field")return function(l){var d,u=l;return Lr(u)||(u=o(u)),(d=i.options_)!=null&&d.bound&&(u=u.bind(this),u.isMobxAction=!0),u};if(r=="method"){var c;return Lr(t)||(t=o(t)),(c=this.options_)!=null&&c.bound&&a(function(){var l=this,d=l[n].bind(l);d.isMobxAction=!0,l[n]=d}),t}re("Cannot apply '"+i.annotationType_+"' to '"+String(n)+"' (kind: "+r+"):"+(`
'`+i.annotationType_+"' can only be used on properties with a function value."))}function xh(t,e,r,n){e.annotationType_,n.value}function eo(t,e,r,n,a){var i,o,c,l,d,u,h;a===void 0&&(a=k.safeDescriptors),xh(t,e,r,n);var f=n.value;if((i=e.options_)!=null&&i.bound){var p;f=f.bind((p=t.proxy_)!=null?p:t.target_)}return{value:Zt((o=(c=e.options_)==null?void 0:c.name)!=null?o:r.toString(),f,(l=(d=e.options_)==null?void 0:d.autoAction)!=null?l:!1,(u=e.options_)!=null&&u.bound?(h=t.proxy_)!=null?h:t.target_:void 0),configurable:a?t.isPlainObject_:!0,enumerable:!1,writable:!a}}function to(t,e){return{annotationType_:t,options_:e,make_:yh,extend_:wh,decorate_20223_:jh}}function yh(t,e,r,n){var a;if(n===t.target_)return this.extend_(t,e,r,!1)===null?0:2;if((a=this.options_)!=null&&a.bound&&(!wt(t.target_,e)||!Br(t.target_[e]))&&this.extend_(t,e,r,!1)===null)return 0;if(Br(r.value))return 1;var i=ro(t,this,e,r,!1,!1);return ct(n,e,i),2}function wh(t,e,r,n){var a,i=ro(t,this,e,r,(a=this.options_)==null?void 0:a.bound);return t.defineProperty_(e,i,n)}function jh(t,e){var r,n=e.name,a=e.addInitializer;return Br(t)||(t=xr(t)),(r=this.options_)!=null&&r.bound&&a(function(){var i=this,o=i[n].bind(i);o.isMobXFlow=!0,i[n]=o}),t}function _h(t,e,r,n){e.annotationType_,n.value}function ro(t,e,r,n,a,i){i===void 0&&(i=k.safeDescriptors),_h(t,e,r,n);var o=n.value;if(Br(o)||(o=xr(o)),a){var c;o=o.bind((c=t.proxy_)!=null?c:t.target_),o.isMobXFlow=!0}return{value:o,configurable:i?t.isPlainObject_:!0,enumerable:!1,writable:!i}}function Fs(t,e){return{annotationType_:t,options_:e,make_:Nh,extend_:Sh,decorate_20223_:Ch}}function Nh(t,e,r){return this.extend_(t,e,r,!1)===null?0:1}function Sh(t,e,r,n){return Oh(t,this,e,r),t.defineComputedProperty_(e,Xt({},this.options_,{get:r.get,set:r.set}),n)}function Ch(t,e){var r=this,n=e.name,a=e.addInitializer;return a(function(){var i=sr(this)[G],o=Xt({},r.options_,{get:t,context:this});o.name||(o.name="ObservableObject."+n.toString()),i.values_.set(n,new Qe(o))}),function(){return this[G].getObservablePropValue_(n)}}function Oh(t,e,r,n){e.annotationType_,n.get}function In(t,e){return{annotationType_:t,options_:e,make_:Ph,extend_:kh,decorate_20223_:Ah}}function Ph(t,e,r){return this.extend_(t,e,r,!1)===null?0:1}function kh(t,e,r,n){var a,i;return Eh(t,this),t.defineObservableProperty_(e,r.value,(a=(i=this.options_)==null?void 0:i.enhancer)!=null?a:Jt,n)}function Ah(t,e){var r=this,n=e.kind,a=e.name,i=new WeakSet;function o(c,l){var d,u,h=sr(c)[G],f=new qt(l,(d=(u=r.options_)==null?void 0:u.enhancer)!=null?d:Jt,"ObservableObject."+a.toString(),!1);h.values_.set(a,f),i.add(c)}if(n=="accessor")return{get:function(){return i.has(this)||o(this,t.get.call(this)),this[G].getObservablePropValue_(a)},set:function(l){return i.has(this)||o(this,l),this[G].setObservablePropValue_(a,l)},init:function(l){return i.has(this)||o(this,l),l}}}function Eh(t,e,r,n){e.annotationType_}var Mh="true",Th=no();function no(t){return{annotationType_:Mh,options_:t,make_:Rh,extend_:Ih,decorate_20223_:Dh}}function Rh(t,e,r,n){var a,i;if(r.get)return Dn.make_(t,e,r,n);if(r.set){var o=Zt(e.toString(),r.set);return n===t.target_?t.defineProperty_(e,{configurable:k.safeDescriptors?t.isPlainObject_:!0,set:o})===null?0:2:(ct(n,e,{configurable:!0,set:o}),2)}if(n!==t.target_&&typeof r.value=="function"){var c;if(Yi(r.value)){var l,d=(l=this.options_)!=null&&l.autoBind?xr.bound:xr;return d.make_(t,e,r,n)}var u=(c=this.options_)!=null&&c.autoBind?$r.bound:$r;return u.make_(t,e,r,n)}var h=((a=this.options_)==null?void 0:a.deep)===!1?Oe.ref:Oe;if(typeof r.value=="function"&&(i=this.options_)!=null&&i.autoBind){var f;r.value=r.value.bind((f=t.proxy_)!=null?f:t.target_)}return h.make_(t,e,r,n)}function Ih(t,e,r,n){var a,i;if(r.get)return Dn.extend_(t,e,r,n);if(r.set)return t.defineProperty_(e,{configurable:k.safeDescriptors?t.isPlainObject_:!0,set:Zt(e.toString(),r.set)},n);if(typeof r.value=="function"&&(a=this.options_)!=null&&a.autoBind){var o;r.value=r.value.bind((o=t.proxy_)!=null?o:t.target_)}var c=((i=this.options_)==null?void 0:i.deep)===!1?Oe.ref:Oe;return c.extend_(t,e,r,n)}function Dh(t,e){re("'"+this.annotationType_+"' cannot be used as a decorator")}var Fh="observable",$h="observable.ref",Lh="observable.shallow",Bh="observable.struct",so={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};Object.freeze(so);function on(t){return t||so}var gs=In(Fh),Uh=In($h,{enhancer:Rn}),Vh=In(Lh,{enhancer:hh}),zh=In(Bh,{enhancer:fh}),ao=lt(gs);function cn(t){return t.deep===!0?Jt:t.deep===!1?Rn:Hh(t.defaultDecorator)}function Wh(t){var e;return t?(e=t.defaultDecorator)!=null?e:no(t):void 0}function Hh(t){var e,r;return t&&(e=(r=t.options_)==null?void 0:r.enhancer)!=null?e:Jt}function io(t,e,r){if(Zr(e))return gs.decorate_20223_(t,e);if(Qt(e)){Jr(t,e,gs);return}return Po(t)?t:St(t)?Oe.object(t,e,r):Array.isArray(t)?Oe.array(t,e):Nr(t)?Oe.map(t,e):bt(t)?Oe.set(t,e):typeof t=="object"&&t!==null?t:Oe.box(t,e)}Wi(io,ao);var qh={box:function(e,r){var n=on(r);return new qt(e,cn(n),n.name,!0,n.equals)},array:function(e,r){var n=on(r);return(k.useProxies===!1||n.proxy===!1?zf:Tf)(e,cn(n),n.name)},map:function(e,r){var n=on(r);return new Ao(e,cn(n),n.name)},set:function(e,r){var n=on(r);return new Eo(e,cn(n),n.name)},object:function(e,r,n){return Bt(function(){return So(k.useProxies===!1||(n==null?void 0:n.proxy)===!1?sr({},n):Pf({},n),e,r)})},ref:lt(Uh),shallow:lt(Vh),deep:ao,struct:lt(zh)},Oe=Wi(io,qh),oo="computed",Gh="computed.struct",ps=Fs(oo),Yh=Fs(Gh,{equals:xn.structural}),Dn=function(e,r){if(Zr(r))return ps.decorate_20223_(e,r);if(Qt(r))return Jr(e,r,ps);if(St(e))return lt(Fs(oo,e));var n=St(r)?r:{};return n.get=e,n.name||(n.name=e.name||""),new Qe(n)};Object.assign(Dn,ps);Dn.struct=lt(Yh);var Oa,Pa,yn=0,Kh=1,Qh=(Oa=(Pa=bn(function(){},"name"))==null?void 0:Pa.configurable)!=null?Oa:!1,ka={value:"action",configurable:!0,writable:!1,enumerable:!1};function Zt(t,e,r,n){r===void 0&&(r=!1);function a(){return co(t,r,e,n||this,arguments)}return a.isMobxAction=!0,a.toString=function(){return e.toString()},Qh&&(ka.value=t,ct(a,"name",ka)),a}function co(t,e,r,n,a){var i=Xh(t,e);try{return r.apply(n,a)}catch(o){throw i.error_=o,o}finally{Jh(i)}}function Xh(t,e,r,n){var a=!1,i=0,o=k.trackingDerivation,c=!e||!o;Ue();var l=k.allowStateChanges;c&&(rr(),l=$s(!0));var d=Bs(!0),u={runAsAction_:c,prevDerivation_:o,prevAllowStateChanges_:l,prevAllowStateReads_:d,notifySpy_:a,startTime_:i,actionId_:Kh++,parentActionId_:yn};return yn=u.actionId_,u}function Jh(t){yn!==t.actionId_&&re(30),yn=t.parentActionId_,t.error_!==void 0&&(k.suppressReactionErrors=!0),Ls(t.prevAllowStateChanges_),Tr(t.prevAllowStateReads_),Ve(),t.runAsAction_&&jt(t.prevDerivation_),k.suppressReactionErrors=!1}function $s(t){var e=k.allowStateChanges;return k.allowStateChanges=t,e}function Ls(t){k.allowStateChanges=t}var qt=function(t){function e(n,a,i,o,c){var l;return i===void 0&&(i="ObservableValue"),c===void 0&&(c=xn.default),l=t.call(this,i)||this,l.enhancer=void 0,l.name_=void 0,l.equals=void 0,l.hasUnreportedChange_=!1,l.interceptors_=void 0,l.changeListeners_=void 0,l.value_=void 0,l.dehancer=void 0,l.enhancer=a,l.name_=i,l.equals=c,l.value_=a(n,void 0,i),l}Ji(e,t);var r=e.prototype;return r.dehanceValue=function(a){return this.dehancer!==void 0?this.dehancer(a):a},r.set=function(a){this.value_,a=this.prepareNewValue_(a),a!==k.UNCHANGED&&this.setNewValue_(a)},r.prepareNewValue_=function(a){if(Le(this)){var i=Be(this,{object:this,type:dt,newValue:a});if(!i)return k.UNCHANGED;a=i.newValue}return a=this.enhancer(a,this.value_,this.name_),this.equals(this.value_,a)?k.UNCHANGED:a},r.setNewValue_=function(a){var i=this.value_;this.value_=a,this.reportChanged(),qe(this)&&Ge(this,{type:dt,object:this,newValue:a,oldValue:i})},r.get=function(){return this.reportObserved(),this.dehanceValue(this.value_)},r.intercept_=function(a){return tn(this,a)},r.observe_=function(a,i){return i&&a({observableKind:"value",debugObjectName:this.name_,object:this,type:dt,newValue:this.value_,oldValue:void 0}),rn(this,a)},r.raw=function(){return this.value_},r.toJSON=function(){return this.get()},r.toString=function(){return this.name_+"["+this.value_+"]"},r.valueOf=function(){return Xi(this.get())},r[Symbol.toPrimitive]=function(){return this.valueOf()},e}(Lt),Qe=function(){function t(r){this.dependenciesState_=se.NOT_TRACKING_,this.observing_=[],this.newObserving_=null,this.observers_=new Set,this.runId_=0,this.lastAccessedBy_=0,this.lowestObserverState_=se.UP_TO_DATE_,this.unboundDepsCount_=0,this.value_=new jn(null),this.name_=void 0,this.triggeredBy_=void 0,this.flags_=0,this.derivation=void 0,this.setter_=void 0,this.isTracing_=wn.NONE,this.scope_=void 0,this.equals_=void 0,this.requiresReaction_=void 0,this.keepAlive_=void 0,this.onBOL=void 0,this.onBUOL=void 0,r.get||re(31),this.derivation=r.get,this.name_=r.name||"ComputedValue",r.set&&(this.setter_=Zt("ComputedValue-setter",r.set)),this.equals_=r.equals||(r.compareStructural||r.struct?xn.structural:xn.default),this.scope_=r.context,this.requiresReaction_=r.requiresReaction,this.keepAlive_=!!r.keepAlive}var e=t.prototype;return e.onBecomeStale_=function(){nf(this)},e.onBO=function(){this.onBOL&&this.onBOL.forEach(function(n){return n()})},e.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(n){return n()})},e.get=function(){if(this.isComputing&&re(32,this.name_,this.derivation),k.inBatch===0&&this.observers_.size===0&&!this.keepAlive_)vs(this)&&(this.warnAboutUntrackedRead_(),Ue(),this.value_=this.computeValue_(!1),Ve());else if(po(this),vs(this)){var n=k.trackingContext;this.keepAlive_&&!n&&(k.trackingContext=this),this.trackAndCompute()&&rf(this),k.trackingContext=n}var a=this.value_;if(hn(a))throw a.cause;return a},e.set=function(n){if(this.setter_){this.isRunningSetter&&re(33,this.name_),this.isRunningSetter=!0;try{this.setter_.call(this.scope_,n)}finally{this.isRunningSetter=!1}}else re(34,this.name_)},e.trackAndCompute=function(){var n=this.value_,a=this.dependenciesState_===se.NOT_TRACKING_,i=this.computeValue_(!0),o=a||hn(n)||hn(i)||!this.equals_(n,i);return o&&(this.value_=i),o},e.computeValue_=function(n){this.isComputing=!0;var a=$s(!1),i;if(n)i=lo(this,this.derivation,this.scope_);else if(k.disableErrorBoundaries===!0)i=this.derivation.call(this.scope_);else try{i=this.derivation.call(this.scope_)}catch(o){i=new jn(o)}return Ls(a),this.isComputing=!1,i},e.suspend_=function(){this.keepAlive_||(bs(this),this.value_=void 0)},e.observe_=function(n,a){var i=this,o=!0,c=void 0;return ff(function(){var l=i.get();if(!o||a){var d=rr();n({observableKind:"computed",debugObjectName:i.name_,type:dt,object:i,newValue:l,oldValue:c}),jt(d)}o=!1,c=l})},e.warnAboutUntrackedRead_=function(){},e.toString=function(){return this.name_+"["+this.derivation.toString()+"]"},e.valueOf=function(){return Xi(this.get())},e[Symbol.toPrimitive]=function(){return this.valueOf()},Sr(t,[{key:"isComputing",get:function(){return Ie(this.flags_,t.isComputingMask_)},set:function(n){this.flags_=De(this.flags_,t.isComputingMask_,n)}},{key:"isRunningSetter",get:function(){return Ie(this.flags_,t.isRunningSetterMask_)},set:function(n){this.flags_=De(this.flags_,t.isRunningSetterMask_,n)}},{key:"isBeingObserved",get:function(){return Ie(this.flags_,t.isBeingObservedMask_)},set:function(n){this.flags_=De(this.flags_,t.isBeingObservedMask_,n)}},{key:"isPendingUnobservation",get:function(){return Ie(this.flags_,t.isPendingUnobservationMask_)},set:function(n){this.flags_=De(this.flags_,t.isPendingUnobservationMask_,n)}},{key:"diffValue",get:function(){return Ie(this.flags_,t.diffValueMask_)?1:0},set:function(n){this.flags_=De(this.flags_,t.diffValueMask_,n===1)}}])}();Qe.isComputingMask_=1;Qe.isRunningSetterMask_=2;Qe.isBeingObservedMask_=4;Qe.isPendingUnobservationMask_=8;Qe.diffValueMask_=16;var Fn=tr("ComputedValue",Qe),se;(function(t){t[t.NOT_TRACKING_=-1]="NOT_TRACKING_",t[t.UP_TO_DATE_=0]="UP_TO_DATE_",t[t.POSSIBLY_STALE_=1]="POSSIBLY_STALE_",t[t.STALE_=2]="STALE_"})(se||(se={}));var wn;(function(t){t[t.NONE=0]="NONE",t[t.LOG=1]="LOG",t[t.BREAK=2]="BREAK"})(wn||(wn={}));var jn=function(e){this.cause=void 0,this.cause=e};function hn(t){return t instanceof jn}function vs(t){switch(t.dependenciesState_){case se.UP_TO_DATE_:return!1;case se.NOT_TRACKING_:case se.STALE_:return!0;case se.POSSIBLY_STALE_:{for(var e=Bs(!0),r=rr(),n=t.observing_,a=n.length,i=0;i<a;i++){var o=n[i];if(Fn(o)){if(k.disableErrorBoundaries)o.get();else try{o.get()}catch{return jt(r),Tr(e),!0}if(t.dependenciesState_===se.STALE_)return jt(r),Tr(e),!0}}return ho(t),jt(r),Tr(e),!1}}}function lo(t,e,r){var n=Bs(!0);ho(t),t.newObserving_=new Array(t.runId_===0?100:t.observing_.length),t.unboundDepsCount_=0,t.runId_=++k.runId;var a=k.trackingDerivation;k.trackingDerivation=t,k.inBatch++;var i;if(k.disableErrorBoundaries===!0)i=e.call(r);else try{i=e.call(r)}catch(o){i=new jn(o)}return k.inBatch--,k.trackingDerivation=a,Zh(t),Tr(n),i}function Zh(t){for(var e=t.observing_,r=t.observing_=t.newObserving_,n=se.UP_TO_DATE_,a=0,i=t.unboundDepsCount_,o=0;o<i;o++){var c=r[o];c.diffValue===0&&(c.diffValue=1,a!==o&&(r[a]=c),a++),c.dependenciesState_>n&&(n=c.dependenciesState_)}for(r.length=a,t.newObserving_=null,i=e.length;i--;){var l=e[i];l.diffValue===0&&mo(l,t),l.diffValue=0}for(;a--;){var d=r[a];d.diffValue===1&&(d.diffValue=0,tf(d,t))}n!==se.UP_TO_DATE_&&(t.dependenciesState_=n,t.onBecomeStale_())}function bs(t){var e=t.observing_;t.observing_=[];for(var r=e.length;r--;)mo(e[r],t);t.dependenciesState_=se.NOT_TRACKING_}function uo(t){var e=rr();try{return t()}finally{jt(e)}}function rr(){var t=k.trackingDerivation;return k.trackingDerivation=null,t}function jt(t){k.trackingDerivation=t}function Bs(t){var e=k.allowStateReads;return k.allowStateReads=t,e}function Tr(t){k.allowStateReads=t}function ho(t){if(t.dependenciesState_!==se.UP_TO_DATE_){t.dependenciesState_=se.UP_TO_DATE_;for(var e=t.observing_,r=e.length;r--;)e[r].lowestObserverState_=se.UP_TO_DATE_}}var fn=function(){this.version=6,this.UNCHANGED={},this.trackingDerivation=null,this.trackingContext=null,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!1,this.allowStateReads=!0,this.enforceActions=!0,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1,this.useProxies=!0,this.verifyProxies=!1,this.safeDescriptors=!0},mn=!0,fo=!1,k=function(){var t=En();return t.__mobxInstanceCount>0&&!t.__mobxGlobals&&(mn=!1),t.__mobxGlobals&&t.__mobxGlobals.version!==new fn().version&&(mn=!1),mn?t.__mobxGlobals?(t.__mobxInstanceCount+=1,t.__mobxGlobals.UNCHANGED||(t.__mobxGlobals.UNCHANGED={}),t.__mobxGlobals):(t.__mobxInstanceCount=1,t.__mobxGlobals=new fn):(setTimeout(function(){fo||re(35)},1),new fn)}();function ef(){if((k.pendingReactions.length||k.inBatch||k.isRunningReactions)&&re(36),fo=!0,mn){var t=En();--t.__mobxInstanceCount===0&&(t.__mobxGlobals=void 0),k=new fn}}function tf(t,e){t.observers_.add(e),t.lowestObserverState_>e.dependenciesState_&&(t.lowestObserverState_=e.dependenciesState_)}function mo(t,e){t.observers_.delete(e),t.observers_.size===0&&go(t)}function go(t){t.isPendingUnobservation===!1&&(t.isPendingUnobservation=!0,k.pendingUnobservations.push(t))}function Ue(){k.inBatch++}function Ve(){if(--k.inBatch===0){bo();for(var t=k.pendingUnobservations,e=0;e<t.length;e++){var r=t[e];r.isPendingUnobservation=!1,r.observers_.size===0&&(r.isBeingObserved&&(r.isBeingObserved=!1,r.onBUO()),r instanceof Qe&&r.suspend_())}k.pendingUnobservations=[]}}function po(t){var e=k.trackingDerivation;return e!==null?(e.runId_!==t.lastAccessedBy_&&(t.lastAccessedBy_=e.runId_,e.newObserving_[e.unboundDepsCount_++]=t,!t.isBeingObserved&&k.trackingContext&&(t.isBeingObserved=!0,t.onBO())),t.isBeingObserved):(t.observers_.size===0&&k.inBatch>0&&go(t),!1)}function vo(t){t.lowestObserverState_!==se.STALE_&&(t.lowestObserverState_=se.STALE_,t.observers_.forEach(function(e){e.dependenciesState_===se.UP_TO_DATE_&&e.onBecomeStale_(),e.dependenciesState_=se.STALE_}))}function rf(t){t.lowestObserverState_!==se.STALE_&&(t.lowestObserverState_=se.STALE_,t.observers_.forEach(function(e){e.dependenciesState_===se.POSSIBLY_STALE_?e.dependenciesState_=se.STALE_:e.dependenciesState_===se.UP_TO_DATE_&&(t.lowestObserverState_=se.UP_TO_DATE_)}))}function nf(t){t.lowestObserverState_===se.UP_TO_DATE_&&(t.lowestObserverState_=se.POSSIBLY_STALE_,t.observers_.forEach(function(e){e.dependenciesState_===se.UP_TO_DATE_&&(e.dependenciesState_=se.POSSIBLY_STALE_,e.onBecomeStale_())}))}var Ct=function(){function t(r,n,a,i){r===void 0&&(r="Reaction"),this.name_=void 0,this.onInvalidate_=void 0,this.errorHandler_=void 0,this.requiresObservable_=void 0,this.observing_=[],this.newObserving_=[],this.dependenciesState_=se.NOT_TRACKING_,this.runId_=0,this.unboundDepsCount_=0,this.flags_=0,this.isTracing_=wn.NONE,this.name_=r,this.onInvalidate_=n,this.errorHandler_=a,this.requiresObservable_=i}var e=t.prototype;return e.onBecomeStale_=function(){this.schedule_()},e.schedule_=function(){this.isScheduled||(this.isScheduled=!0,k.pendingReactions.push(this),bo())},e.runReaction_=function(){if(!this.isDisposed){Ue(),this.isScheduled=!1;var n=k.trackingContext;if(k.trackingContext=this,vs(this)){this.isTrackPending=!0;try{this.onInvalidate_()}catch(a){this.reportExceptionInDerivation_(a)}}k.trackingContext=n,Ve()}},e.track=function(n){if(!this.isDisposed){Ue(),this.isRunning=!0;var a=k.trackingContext;k.trackingContext=this;var i=lo(this,n,void 0);k.trackingContext=a,this.isRunning=!1,this.isTrackPending=!1,this.isDisposed&&bs(this),hn(i)&&this.reportExceptionInDerivation_(i.cause),Ve()}},e.reportExceptionInDerivation_=function(n){var a=this;if(this.errorHandler_){this.errorHandler_(n,this);return}if(k.disableErrorBoundaries)throw n;var i="[mobx] uncaught error in '"+this+"'";k.suppressReactionErrors||console.error(i,n),k.globalReactionErrorHandlers.forEach(function(o){return o(n,a)})},e.dispose=function(){this.isDisposed||(this.isDisposed=!0,this.isRunning||(Ue(),bs(this),Ve()))},e.getDisposer_=function(n){var a=this,i=function o(){a.dispose(),n==null||n.removeEventListener==null||n.removeEventListener("abort",o)};return n==null||n.addEventListener==null||n.addEventListener("abort",i),i[G]=this,i},e.toString=function(){return"Reaction["+this.name_+"]"},e.trace=function(n){},Sr(t,[{key:"isDisposed",get:function(){return Ie(this.flags_,t.isDisposedMask_)},set:function(n){this.flags_=De(this.flags_,t.isDisposedMask_,n)}},{key:"isScheduled",get:function(){return Ie(this.flags_,t.isScheduledMask_)},set:function(n){this.flags_=De(this.flags_,t.isScheduledMask_,n)}},{key:"isTrackPending",get:function(){return Ie(this.flags_,t.isTrackPendingMask_)},set:function(n){this.flags_=De(this.flags_,t.isTrackPendingMask_,n)}},{key:"isRunning",get:function(){return Ie(this.flags_,t.isRunningMask_)},set:function(n){this.flags_=De(this.flags_,t.isRunningMask_,n)}},{key:"diffValue",get:function(){return Ie(this.flags_,t.diffValueMask_)?1:0},set:function(n){this.flags_=De(this.flags_,t.diffValueMask_,n===1)}}])}();Ct.isDisposedMask_=1;Ct.isScheduledMask_=2;Ct.isTrackPendingMask_=4;Ct.isRunningMask_=8;Ct.diffValueMask_=16;var sf=100,xs=function(e){return e()};function bo(){k.inBatch>0||k.isRunningReactions||xs(af)}function af(){k.isRunningReactions=!0;for(var t=k.pendingReactions,e=0;t.length>0;){++e===sf&&(console.error("[mobx] cycle in reaction: "+t[0]),t.splice(0));for(var r=t.splice(0),n=0,a=r.length;n<a;n++)r[n].runReaction_()}k.isRunningReactions=!1}var _n=tr("Reaction",Ct);function of(t){var e=xs;xs=function(n){return t(function(){return e(n)})}}function Rr(){return!1}function cf(t){return console.warn("[mobx.spy] Is a no-op in production builds"),function(){}}var xo="action",lf="action.bound",yo="autoAction",df="autoAction.bound",wo="<unnamed action>",ys=en(xo),uf=en(lf,{bound:!0}),ws=en(yo,{autoAction:!0}),hf=en(df,{autoAction:!0,bound:!0});function jo(t){var e=function(n,a){if(Ke(n))return Zt(n.name||wo,n,t);if(Ke(a))return Zt(n,a,t);if(Zr(a))return(t?ws:ys).decorate_20223_(n,a);if(Qt(a))return Jr(n,a,t?ws:ys);if(Qt(n))return lt(en(t?yo:xo,{name:n,autoAction:t}))};return e}var fr=jo(!1);Object.assign(fr,ys);var $r=jo(!0);Object.assign($r,ws);fr.bound=lt(uf);$r.bound=lt(hf);function Kn(t){return co(t.name||wo,!1,t,this,void 0)}function Lr(t){return Ke(t)&&t.isMobxAction===!0}function ff(t,e){var r,n,a,i;e===void 0&&(e=Hi);var o=(r=(n=e)==null?void 0:n.name)!=null?r:"Autorun",c=!e.scheduler&&!e.delay,l;if(c)l=new Ct(o,function(){this.track(h)},e.onError,e.requiresObservable);else{var d=gf(e),u=!1;l=new Ct(o,function(){u||(u=!0,d(function(){u=!1,l.isDisposed||l.track(h)}))},e.onError,e.requiresObservable)}function h(){t(l)}return(a=e)!=null&&(a=a.signal)!=null&&a.aborted||l.schedule_(),l.getDisposer_((i=e)==null?void 0:i.signal)}var mf=function(e){return e()};function gf(t){return t.scheduler?t.scheduler:t.delay?function(e){return setTimeout(e,t.delay)}:mf}var pf="onBO",vf="onBUO";function bf(t,e,r){return No(pf,t,e,r)}function _o(t,e,r){return No(vf,t,e,r)}function No(t,e,r,n){var a=Cn(e),i=Ke(n)?n:r,o=t+"L";return a[o]?a[o].add(i):a[o]=new Set([i]),function(){var c=a[o];c&&(c.delete(i),c.size===0&&delete a[o])}}var xf="never",ln="always",yf="observed";function wf(t){t.isolateGlobalState===!0&&ef();var e=t.useProxies,r=t.enforceActions;if(e!==void 0&&(k.useProxies=e===ln?!0:e===xf?!1:typeof Proxy<"u"),e==="ifavailable"&&(k.verifyProxies=!0),r!==void 0){var n=r===ln?ln:r===yf;k.enforceActions=n,k.allowStateChanges=!(n===!0||n===ln)}["computedRequiresReaction","reactionRequiresObservable","observableRequiresReaction","disableErrorBoundaries","safeDescriptors"].forEach(function(a){a in t&&(k[a]=!!t[a])}),k.allowStateReads=!k.observableRequiresReaction,t.reactionScheduler&&of(t.reactionScheduler)}function So(t,e,r,n){var a=rh(e);return Bt(function(){var i=sr(t,n)[G];br(a).forEach(function(o){i.extend_(o,a[o],r&&o in r?r[o]:!0)})}),t}function jf(t,e){return Co(Cn(t,e))}function Co(t){var e={name:t.name_};return t.observing_&&t.observing_.length>0&&(e.dependencies=_f(t.observing_).map(Co)),e}function _f(t){return Array.from(new Set(t))}var Nf=0;function Oo(){this.message="FLOW_CANCELLED"}Oo.prototype=Object.create(Error.prototype);var Qn=to("flow"),Sf=to("flow.bound",{bound:!0}),xr=Object.assign(function(e,r){if(Zr(r))return Qn.decorate_20223_(e,r);if(Qt(r))return Jr(e,r,Qn);var n=e,a=n.name||"<unnamed flow>",i=function(){var c=this,l=arguments,d=++Nf,u=fr(a+" - runid: "+d+" - init",n).apply(c,l),h,f=void 0,p=new Promise(function(g,b){var m=0;h=b;function w(N){f=void 0;var C;try{C=fr(a+" - runid: "+d+" - yield "+m++,u.next).call(u,N)}catch($){return b($)}j(C)}function v(N){f=void 0;var C;try{C=fr(a+" - runid: "+d+" - yield "+m++,u.throw).call(u,N)}catch($){return b($)}j(C)}function j(N){if(Ke(N==null?void 0:N.then)){N.then(j,b);return}return N.done?g(N.value):(f=Promise.resolve(N.value),f.then(w,v))}w(void 0)});return p.cancel=fr(a+" - runid: "+d+" - cancel",function(){try{f&&Aa(f);var g=u.return(void 0),b=Promise.resolve(g.value);b.then(ur,ur),Aa(b),h(new Oo)}catch(m){h(m)}}),p};return i.isMobXFlow=!0,i},Qn);xr.bound=lt(Sf);function Aa(t){Ke(t.cancel)&&t.cancel()}function Br(t){return(t==null?void 0:t.isMobXFlow)===!0}function Cf(t,e){return t?Ln(t)||!!t[G]||Ds(t)||_n(t)||Fn(t):!1}function Po(t){return Cf(t)}function xt(t,e){e===void 0&&(e=void 0),Ue();try{return t.apply(e)}finally{Ve()}}function lr(t){return t[G]}var Of={has:function(e,r){return lr(e).has_(r)},get:function(e,r){return lr(e).get_(r)},set:function(e,r,n){var a;return Qt(r)?(a=lr(e).set_(r,n,!0))!=null?a:!0:!1},deleteProperty:function(e,r){var n;return Qt(r)?(n=lr(e).delete_(r,!0))!=null?n:!0:!1},defineProperty:function(e,r,n){var a;return(a=lr(e).defineProperty_(r,n))!=null?a:!0},ownKeys:function(e){return lr(e).ownKeys_()},preventExtensions:function(e){re(13)}};function Pf(t,e){var r,n;return qi(),t=sr(t,e),(n=(r=t[G]).proxy_)!=null?n:r.proxy_=new Proxy(t,Of)}function Le(t){return t.interceptors_!==void 0&&t.interceptors_.length>0}function tn(t,e){var r=t.interceptors_||(t.interceptors_=[]);return r.push(e),Gi(function(){var n=r.indexOf(e);n!==-1&&r.splice(n,1)})}function Be(t,e){var r=rr();try{for(var n=[].concat(t.interceptors_||[]),a=0,i=n.length;a<i&&(e=n[a](e),e&&!e.type&&re(14),!!e);a++);return e}finally{jt(r)}}function qe(t){return t.changeListeners_!==void 0&&t.changeListeners_.length>0}function rn(t,e){var r=t.changeListeners_||(t.changeListeners_=[]);return r.push(e),Gi(function(){var n=r.indexOf(e);n!==-1&&r.splice(n,1)})}function Ge(t,e){var r=rr(),n=t.changeListeners_;if(n){n=n.slice();for(var a=0,i=n.length;a<i;a++)n[a](e);jt(r)}}function kf(t,e,r){return Bt(function(){var n,a=sr(t,r)[G];(n=e)!=null||(e=oh(t)),br(e).forEach(function(i){return a.make_(i,e[i])})}),t}var Xn=Symbol("mobx-keys");function Af(t,e,r){return St(t)?So(t,t,e,r):(Bt(function(){var n=sr(t,r)[G];if(!t[Xn]){var a=Object.getPrototypeOf(t),i=new Set([].concat(br(t),br(a)));i.delete("constructor"),i.delete(G),Xr(a,Xn,i)}t[Xn].forEach(function(o){return n.make_(o,e&&o in e?e[o]:!0)})}),t)}var Ea="splice",dt="update",Ef=1e4,Mf={get:function(e,r){var n=e[G];return r===G?n:r==="length"?n.getArrayLength_():typeof r=="string"&&!isNaN(r)?n.get_(parseInt(r)):wt(Nn,r)?Nn[r]:e[r]},set:function(e,r,n){var a=e[G];return r==="length"&&a.setArrayLength_(n),typeof r=="symbol"||isNaN(r)?e[r]=n:a.set_(parseInt(r),n),!0},preventExtensions:function(){re(15)}},Us=function(){function t(r,n,a,i){r===void 0&&(r="ObservableArray"),this.owned_=void 0,this.legacyMode_=void 0,this.atom_=void 0,this.values_=[],this.interceptors_=void 0,this.changeListeners_=void 0,this.enhancer_=void 0,this.dehancer=void 0,this.proxy_=void 0,this.lastKnownLength_=0,this.owned_=a,this.legacyMode_=i,this.atom_=new Lt(r),this.enhancer_=function(o,c){return n(o,c,"ObservableArray[..]")}}var e=t.prototype;return e.dehanceValue_=function(n){return this.dehancer!==void 0?this.dehancer(n):n},e.dehanceValues_=function(n){return this.dehancer!==void 0&&n.length>0?n.map(this.dehancer):n},e.intercept_=function(n){return tn(this,n)},e.observe_=function(n,a){return a===void 0&&(a=!1),a&&n({observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:"splice",index:0,added:this.values_.slice(),addedCount:this.values_.length,removed:[],removedCount:0}),rn(this,n)},e.getArrayLength_=function(){return this.atom_.reportObserved(),this.values_.length},e.setArrayLength_=function(n){(typeof n!="number"||isNaN(n)||n<0)&&re("Out of range: "+n);var a=this.values_.length;if(n!==a)if(n>a){for(var i=new Array(n-a),o=0;o<n-a;o++)i[o]=void 0;this.spliceWithArray_(a,0,i)}else this.spliceWithArray_(n,a-n)},e.updateArrayLength_=function(n,a){n!==this.lastKnownLength_&&re(16),this.lastKnownLength_+=a,this.legacyMode_&&a>0&&Io(n+a+1)},e.spliceWithArray_=function(n,a,i){var o=this;this.atom_;var c=this.values_.length;if(n===void 0?n=0:n>c?n=c:n<0&&(n=Math.max(0,c+n)),arguments.length===1?a=c-n:a==null?a=0:a=Math.max(0,Math.min(a,c-n)),i===void 0&&(i=fs),Le(this)){var l=Be(this,{object:this.proxy_,type:Ea,index:n,removedCount:a,added:i});if(!l)return fs;a=l.removedCount,i=l.added}if(i=i.length===0?i:i.map(function(h){return o.enhancer_(h,void 0)}),this.legacyMode_){var d=i.length-a;this.updateArrayLength_(c,d)}var u=this.spliceItemsIntoValues_(n,a,i);return(a!==0||i.length!==0)&&this.notifyArraySplice_(n,i,u),this.dehanceValues_(u)},e.spliceItemsIntoValues_=function(n,a,i){if(i.length<Ef){var o;return(o=this.values_).splice.apply(o,[n,a].concat(i))}else{var c=this.values_.slice(n,n+a),l=this.values_.slice(n+a);this.values_.length+=i.length-a;for(var d=0;d<i.length;d++)this.values_[n+d]=i[d];for(var u=0;u<l.length;u++)this.values_[n+i.length+u]=l[u];return c}},e.notifyArrayChildUpdate_=function(n,a,i){var o=!this.owned_&&Rr(),c=qe(this),l=c||o?{observableKind:"array",object:this.proxy_,type:dt,debugObjectName:this.atom_.name_,index:n,newValue:a,oldValue:i}:null;this.atom_.reportChanged(),c&&Ge(this,l)},e.notifyArraySplice_=function(n,a,i){var o=!this.owned_&&Rr(),c=qe(this),l=c||o?{observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:Ea,index:n,removed:i,added:a,removedCount:i.length,addedCount:a.length}:null;this.atom_.reportChanged(),c&&Ge(this,l)},e.get_=function(n){if(this.legacyMode_&&n>=this.values_.length){console.warn("[mobx] Out of bounds read: "+n);return}return this.atom_.reportObserved(),this.dehanceValue_(this.values_[n])},e.set_=function(n,a){var i=this.values_;if(this.legacyMode_&&n>i.length&&re(17,n,i.length),n<i.length){this.atom_;var o=i[n];if(Le(this)){var c=Be(this,{type:dt,object:this.proxy_,index:n,newValue:a});if(!c)return;a=c.newValue}a=this.enhancer_(a,o);var l=a!==o;l&&(i[n]=a,this.notifyArrayChildUpdate_(n,a,o))}else{for(var d=new Array(n+1-i.length),u=0;u<d.length-1;u++)d[u]=void 0;d[d.length-1]=a,this.spliceWithArray_(i.length,0,d)}},t}();function Tf(t,e,r,n){return r===void 0&&(r="ObservableArray"),n===void 0&&(n=!1),qi(),Bt(function(){var a=new Us(r,e,n,!1);Ki(a.values_,G,a);var i=new Proxy(a.values_,Mf);return a.proxy_=i,t&&t.length&&a.spliceWithArray_(0,0,t),i})}var Nn={clear:function(){return this.splice(0)},replace:function(e){var r=this[G];return r.spliceWithArray_(0,r.values_.length,e)},toJSON:function(){return this.slice()},splice:function(e,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i];var o=this[G];switch(arguments.length){case 0:return[];case 1:return o.spliceWithArray_(e);case 2:return o.spliceWithArray_(e,r)}return o.spliceWithArray_(e,r,a)},spliceWithArray:function(e,r,n){return this[G].spliceWithArray_(e,r,n)},push:function(){for(var e=this[G],r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return e.spliceWithArray_(e.values_.length,0,n),e.values_.length},pop:function(){return this.splice(Math.max(this[G].values_.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var e=this[G],r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return e.spliceWithArray_(0,0,n),e.values_.length},reverse:function(){return k.trackingDerivation&&re(37,"reverse"),this.replace(this.slice().reverse()),this},sort:function(){k.trackingDerivation&&re(37,"sort");var e=this.slice();return e.sort.apply(e,arguments),this.replace(e),this},remove:function(e){var r=this[G],n=r.dehanceValues_(r.values_).indexOf(e);return n>-1?(this.splice(n,1),!0):!1}};ue("at",Fe);ue("concat",Fe);ue("flat",Fe);ue("includes",Fe);ue("indexOf",Fe);ue("join",Fe);ue("lastIndexOf",Fe);ue("slice",Fe);ue("toString",Fe);ue("toLocaleString",Fe);ue("toSorted",Fe);ue("toSpliced",Fe);ue("with",Fe);ue("every",Xe);ue("filter",Xe);ue("find",Xe);ue("findIndex",Xe);ue("findLast",Xe);ue("findLastIndex",Xe);ue("flatMap",Xe);ue("forEach",Xe);ue("map",Xe);ue("some",Xe);ue("toReversed",Xe);ue("reduce",ko);ue("reduceRight",ko);function ue(t,e){typeof Array.prototype[t]=="function"&&(Nn[t]=e(t))}function Fe(t){return function(){var e=this[G];e.atom_.reportObserved();var r=e.dehanceValues_(e.values_);return r[t].apply(r,arguments)}}function Xe(t){return function(e,r){var n=this,a=this[G];a.atom_.reportObserved();var i=a.dehanceValues_(a.values_);return i[t](function(o,c){return e.call(r,o,c,n)})}}function ko(t){return function(){var e=this,r=this[G];r.atom_.reportObserved();var n=r.dehanceValues_(r.values_),a=arguments[0];return arguments[0]=function(i,o,c){return a(i,o,c,e)},n[t].apply(n,arguments)}}var Rf=tr("ObservableArrayAdministration",Us);function $n(t){return Tn(t)&&Rf(t[G])}var If={},Rt="add",Sn="delete",Ao=function(){function t(r,n,a){var i=this;n===void 0&&(n=Jt),a===void 0&&(a="ObservableMap"),this.enhancer_=void 0,this.name_=void 0,this[G]=If,this.data_=void 0,this.hasMap_=void 0,this.keysAtom_=void 0,this.interceptors_=void 0,this.changeListeners_=void 0,this.dehancer=void 0,this.enhancer_=n,this.name_=a,Ke(Map)||re(18),Bt(function(){i.keysAtom_=Zi("ObservableMap.keys()"),i.data_=new Map,i.hasMap_=new Map,r&&i.merge(r)})}var e=t.prototype;return e.has_=function(n){return this.data_.has(n)},e.has=function(n){var a=this;if(!k.trackingDerivation)return this.has_(n);var i=this.hasMap_.get(n);if(!i){var o=i=new qt(this.has_(n),Rn,"ObservableMap.key?",!1);this.hasMap_.set(n,o),_o(o,function(){return a.hasMap_.delete(n)})}return i.get()},e.set=function(n,a){var i=this.has_(n);if(Le(this)){var o=Be(this,{type:i?dt:Rt,object:this,newValue:a,name:n});if(!o)return this;a=o.newValue}return i?this.updateValue_(n,a):this.addValue_(n,a),this},e.delete=function(n){var a=this;if(this.keysAtom_,Le(this)){var i=Be(this,{type:Sn,object:this,name:n});if(!i)return!1}if(this.has_(n)){var o=Rr(),c=qe(this),l=c||o?{observableKind:"map",debugObjectName:this.name_,type:Sn,object:this,oldValue:this.data_.get(n).value_,name:n}:null;return xt(function(){var d;a.keysAtom_.reportChanged(),(d=a.hasMap_.get(n))==null||d.setNewValue_(!1);var u=a.data_.get(n);u.setNewValue_(void 0),a.data_.delete(n)}),c&&Ge(this,l),!0}return!1},e.updateValue_=function(n,a){var i=this.data_.get(n);if(a=i.prepareNewValue_(a),a!==k.UNCHANGED){var o=Rr(),c=qe(this),l=c||o?{observableKind:"map",debugObjectName:this.name_,type:dt,object:this,oldValue:i.value_,name:n,newValue:a}:null;i.setNewValue_(a),c&&Ge(this,l)}},e.addValue_=function(n,a){var i=this;this.keysAtom_,xt(function(){var d,u=new qt(a,i.enhancer_,"ObservableMap.key",!1);i.data_.set(n,u),a=u.value_,(d=i.hasMap_.get(n))==null||d.setNewValue_(!0),i.keysAtom_.reportChanged()});var o=Rr(),c=qe(this),l=c||o?{observableKind:"map",debugObjectName:this.name_,type:Rt,object:this,name:n,newValue:a}:null;c&&Ge(this,l)},e.get=function(n){return this.has(n)?this.dehanceValue_(this.data_.get(n).get()):this.dehanceValue_(void 0)},e.dehanceValue_=function(n){return this.dehancer!==void 0?this.dehancer(n):n},e.keys=function(){return this.keysAtom_.reportObserved(),this.data_.keys()},e.values=function(){var n=this,a=this.keys();return Ma({next:function(){var o=a.next(),c=o.done,l=o.value;return{done:c,value:c?void 0:n.get(l)}}})},e.entries=function(){var n=this,a=this.keys();return Ma({next:function(){var o=a.next(),c=o.done,l=o.value;return{done:c,value:c?void 0:[l,n.get(l)]}}})},e[Symbol.iterator]=function(){return this.entries()},e.forEach=function(n,a){for(var i=hr(this),o;!(o=i()).done;){var c=o.value,l=c[0],d=c[1];n.call(a,d,l,this)}},e.merge=function(n){var a=this;return nr(n)&&(n=new Map(n)),xt(function(){St(n)?th(n).forEach(function(i){return a.set(i,n[i])}):Array.isArray(n)?n.forEach(function(i){var o=i[0],c=i[1];return a.set(o,c)}):Nr(n)?(eh(n)||re(19,n),n.forEach(function(i,o){return a.set(o,i)})):n!=null&&re(20,n)}),this},e.clear=function(){var n=this;xt(function(){uo(function(){for(var a=hr(n.keys()),i;!(i=a()).done;){var o=i.value;n.delete(o)}})})},e.replace=function(n){var a=this;return xt(function(){for(var i=Df(n),o=new Map,c=!1,l=hr(a.data_.keys()),d;!(d=l()).done;){var u=d.value;if(!i.has(u)){var h=a.delete(u);if(h)c=!0;else{var f=a.data_.get(u);o.set(u,f)}}}for(var p=hr(i.entries()),g;!(g=p()).done;){var b=g.value,m=b[0],w=b[1],v=a.data_.has(m);if(a.set(m,w),a.data_.has(m)){var j=a.data_.get(m);o.set(m,j),v||(c=!0)}}if(!c)if(a.data_.size!==o.size)a.keysAtom_.reportChanged();else for(var N=a.data_.keys(),C=o.keys(),$=N.next(),J=C.next();!$.done;){if($.value!==J.value){a.keysAtom_.reportChanged();break}$=N.next(),J=C.next()}a.data_=o}),this},e.toString=function(){return"[object ObservableMap]"},e.toJSON=function(){return Array.from(this)},e.observe_=function(n,a){return rn(this,n)},e.intercept_=function(n){return tn(this,n)},Sr(t,[{key:"size",get:function(){return this.keysAtom_.reportObserved(),this.data_.size}},{key:Symbol.toStringTag,get:function(){return"Map"}}])}(),nr=tr("ObservableMap",Ao);function Ma(t){return t[Symbol.toStringTag]="MapIterator",Ws(t)}function Df(t){if(Nr(t)||nr(t))return t;if(Array.isArray(t))return new Map(t);if(St(t)){var e=new Map;for(var r in t)e.set(r,t[r]);return e}else return re(21,t)}var Ff={},Eo=function(){function t(r,n,a){var i=this;n===void 0&&(n=Jt),a===void 0&&(a="ObservableSet"),this.name_=void 0,this[G]=Ff,this.data_=new Set,this.atom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.dehancer=void 0,this.enhancer_=void 0,this.name_=a,Ke(Set)||re(22),this.enhancer_=function(o,c){return n(o,c,a)},Bt(function(){i.atom_=Zi(i.name_),r&&i.replace(r)})}var e=t.prototype;return e.dehanceValue_=function(n){return this.dehancer!==void 0?this.dehancer(n):n},e.clear=function(){var n=this;xt(function(){uo(function(){for(var a=hr(n.data_.values()),i;!(i=a()).done;){var o=i.value;n.delete(o)}})})},e.forEach=function(n,a){for(var i=hr(this),o;!(o=i()).done;){var c=o.value;n.call(a,c,c,this)}},e.add=function(n){var a=this;if(this.atom_,Le(this)){var i=Be(this,{type:Rt,object:this,newValue:n});if(!i)return this}if(!this.has(n)){xt(function(){a.data_.add(a.enhancer_(n,void 0)),a.atom_.reportChanged()});var o=!1,c=qe(this),l=c||o?{observableKind:"set",debugObjectName:this.name_,type:Rt,object:this,newValue:n}:null;c&&Ge(this,l)}return this},e.delete=function(n){var a=this;if(Le(this)){var i=Be(this,{type:Sn,object:this,oldValue:n});if(!i)return!1}if(this.has(n)){var o=!1,c=qe(this),l=c||o?{observableKind:"set",debugObjectName:this.name_,type:Sn,object:this,oldValue:n}:null;return xt(function(){a.atom_.reportChanged(),a.data_.delete(n)}),c&&Ge(this,l),!0}return!1},e.has=function(n){return this.atom_.reportObserved(),this.data_.has(this.dehanceValue_(n))},e.entries=function(){var n=0,a=Array.from(this.keys()),i=Array.from(this.values());return Ta({next:function(){var c=n;return n+=1,c<i.length?{value:[a[c],i[c]],done:!1}:{value:void 0,done:!0}}})},e.keys=function(){return this.values()},e.values=function(){this.atom_.reportObserved();var n=this,a=0,i=Array.from(this.data_.values());return Ta({next:function(){return a<i.length?{value:n.dehanceValue_(i[a++]),done:!1}:{value:void 0,done:!0}}})},e.intersection=function(n){if(bt(n)&&!st(n))return n.intersection(this);var a=new Set(this);return a.intersection(n)},e.union=function(n){if(bt(n)&&!st(n))return n.union(this);var a=new Set(this);return a.union(n)},e.difference=function(n){return new Set(this).difference(n)},e.symmetricDifference=function(n){if(bt(n)&&!st(n))return n.symmetricDifference(this);var a=new Set(this);return a.symmetricDifference(n)},e.isSubsetOf=function(n){return new Set(this).isSubsetOf(n)},e.isSupersetOf=function(n){return new Set(this).isSupersetOf(n)},e.isDisjointFrom=function(n){if(bt(n)&&!st(n))return n.isDisjointFrom(this);var a=new Set(this);return a.isDisjointFrom(n)},e.replace=function(n){var a=this;return st(n)&&(n=new Set(n)),xt(function(){Array.isArray(n)?(a.clear(),n.forEach(function(i){return a.add(i)})):bt(n)?(a.clear(),n.forEach(function(i){return a.add(i)})):n!=null&&re("Cannot initialize set from "+n)}),this},e.observe_=function(n,a){return rn(this,n)},e.intercept_=function(n){return tn(this,n)},e.toJSON=function(){return Array.from(this)},e.toString=function(){return"[object ObservableSet]"},e[Symbol.iterator]=function(){return this.values()},Sr(t,[{key:"size",get:function(){return this.atom_.reportObserved(),this.data_.size}},{key:Symbol.toStringTag,get:function(){return"Set"}}])}(),st=tr("ObservableSet",Eo);function Ta(t){return t[Symbol.toStringTag]="SetIterator",Ws(t)}var Ra=Object.create(null),Ia="remove",Mo=function(){function t(r,n,a,i){n===void 0&&(n=new Map),i===void 0&&(i=Th),this.target_=void 0,this.values_=void 0,this.name_=void 0,this.defaultAnnotation_=void 0,this.keysAtom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.proxy_=void 0,this.isPlainObject_=void 0,this.appliedAnnotations_=void 0,this.pendingKeys_=void 0,this.target_=r,this.values_=n,this.name_=a,this.defaultAnnotation_=i,this.keysAtom_=new Lt("ObservableObject.keys"),this.isPlainObject_=St(this.target_)}var e=t.prototype;return e.getObservablePropValue_=function(n){return this.values_.get(n).get()},e.setObservablePropValue_=function(n,a){var i=this.values_.get(n);if(i instanceof Qe)return i.set(a),!0;if(Le(this)){var o=Be(this,{type:dt,object:this.proxy_||this.target_,name:n,newValue:a});if(!o)return null;a=o.newValue}if(a=i.prepareNewValue_(a),a!==k.UNCHANGED){var c=qe(this),l=!1,d=c||l?{type:dt,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,oldValue:i.value_,name:n,newValue:a}:null;i.setNewValue_(a),c&&Ge(this,d)}return!0},e.get_=function(n){return k.trackingDerivation&&!wt(this.target_,n)&&this.has_(n),this.target_[n]},e.set_=function(n,a,i){return i===void 0&&(i=!1),wt(this.target_,n)?this.values_.has(n)?this.setObservablePropValue_(n,a):i?Reflect.set(this.target_,n,a):(this.target_[n]=a,!0):this.extend_(n,{value:a,enumerable:!0,writable:!0,configurable:!0},this.defaultAnnotation_,i)},e.has_=function(n){if(!k.trackingDerivation)return n in this.target_;this.pendingKeys_||(this.pendingKeys_=new Map);var a=this.pendingKeys_.get(n);return a||(a=new qt(n in this.target_,Rn,"ObservableObject.key?",!1),this.pendingKeys_.set(n,a)),a.get()},e.make_=function(n,a){if(a===!0&&(a=this.defaultAnnotation_),a!==!1){if(!(n in this.target_)){var i;if((i=this.target_[it])!=null&&i[n])return;re(1,a.annotationType_,this.name_+"."+n.toString())}for(var o=this.target_;o&&o!==Mn;){var c=bn(o,n);if(c){var l=a.make_(this,n,c,o);if(l===0)return;if(l===1)break}o=Object.getPrototypeOf(o)}Fa(this,a,n)}},e.extend_=function(n,a,i,o){if(o===void 0&&(o=!1),i===!0&&(i=this.defaultAnnotation_),i===!1)return this.defineProperty_(n,a,o);var c=i.extend_(this,n,a,o);return c&&Fa(this,i,n),c},e.defineProperty_=function(n,a,i){i===void 0&&(i=!1),this.keysAtom_;try{Ue();var o=this.delete_(n);if(!o)return o;if(Le(this)){var c=Be(this,{object:this.proxy_||this.target_,name:n,type:Rt,newValue:a.value});if(!c)return null;var l=c.newValue;a.value!==l&&(a=Xt({},a,{value:l}))}if(i){if(!Reflect.defineProperty(this.target_,n,a))return!1}else ct(this.target_,n,a);this.notifyPropertyAddition_(n,a.value)}finally{Ve()}return!0},e.defineObservableProperty_=function(n,a,i,o){o===void 0&&(o=!1),this.keysAtom_;try{Ue();var c=this.delete_(n);if(!c)return c;if(Le(this)){var l=Be(this,{object:this.proxy_||this.target_,name:n,type:Rt,newValue:a});if(!l)return null;a=l.newValue}var d=Da(n),u={configurable:k.safeDescriptors?this.isPlainObject_:!0,enumerable:!0,get:d.get,set:d.set};if(o){if(!Reflect.defineProperty(this.target_,n,u))return!1}else ct(this.target_,n,u);var h=new qt(a,i,"ObservableObject.key",!1);this.values_.set(n,h),this.notifyPropertyAddition_(n,h.value_)}finally{Ve()}return!0},e.defineComputedProperty_=function(n,a,i){i===void 0&&(i=!1),this.keysAtom_;try{Ue();var o=this.delete_(n);if(!o)return o;if(Le(this)){var c=Be(this,{object:this.proxy_||this.target_,name:n,type:Rt,newValue:void 0});if(!c)return null}a.name||(a.name="ObservableObject.key"),a.context=this.proxy_||this.target_;var l=Da(n),d={configurable:k.safeDescriptors?this.isPlainObject_:!0,enumerable:!1,get:l.get,set:l.set};if(i){if(!Reflect.defineProperty(this.target_,n,d))return!1}else ct(this.target_,n,d);this.values_.set(n,new Qe(a)),this.notifyPropertyAddition_(n,void 0)}finally{Ve()}return!0},e.delete_=function(n,a){if(a===void 0&&(a=!1),this.keysAtom_,!wt(this.target_,n))return!0;if(Le(this)){var i=Be(this,{object:this.proxy_||this.target_,name:n,type:Ia});if(!i)return null}try{var o;Ue();var c=qe(this),l=!1,d=this.values_.get(n),u=void 0;if(!d&&(c||l)){var h;u=(h=bn(this.target_,n))==null?void 0:h.value}if(a){if(!Reflect.deleteProperty(this.target_,n))return!1}else delete this.target_[n];if(d&&(this.values_.delete(n),d instanceof qt&&(u=d.value_),vo(d)),this.keysAtom_.reportChanged(),(o=this.pendingKeys_)==null||(o=o.get(n))==null||o.set(n in this.target_),c||l){var f={type:Ia,observableKind:"object",object:this.proxy_||this.target_,debugObjectName:this.name_,oldValue:u,name:n};c&&Ge(this,f)}}finally{Ve()}return!0},e.observe_=function(n,a){return rn(this,n)},e.intercept_=function(n){return tn(this,n)},e.notifyPropertyAddition_=function(n,a){var i,o=qe(this),c=!1;if(o||c){var l=o||c?{type:Rt,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,name:n,newValue:a}:null;o&&Ge(this,l)}(i=this.pendingKeys_)==null||(i=i.get(n))==null||i.set(!0),this.keysAtom_.reportChanged()},e.ownKeys_=function(){return this.keysAtom_.reportObserved(),br(this.target_)},e.keys_=function(){return this.keysAtom_.reportObserved(),Object.keys(this.target_)},t}();function sr(t,e){var r;if(wt(t,G))return t;var n=(r=e==null?void 0:e.name)!=null?r:"ObservableObject",a=new Mo(t,new Map,String(n),Wh(e));return Xr(t,G,a),t}var $f=tr("ObservableObjectAdministration",Mo);function Da(t){return Ra[t]||(Ra[t]={get:function(){return this[G].getObservablePropValue_(t)},set:function(r){return this[G].setObservablePropValue_(t,r)}})}function Ln(t){return Tn(t)?$f(t[G]):!1}function Fa(t,e,r){var n;(n=t.target_[it])==null||delete n[r]}var Lf=Ro(0),Bf=function(){var t=!1,e={};return Object.defineProperty(e,"0",{set:function(){t=!0}}),Object.create(e)[0]=1,t===!1}(),Jn=0,To=function(){};function Uf(t,e){Object.setPrototypeOf?Object.setPrototypeOf(t.prototype,e):t.prototype.__proto__!==void 0?t.prototype.__proto__=e:t.prototype=e}Uf(To,Array.prototype);var Vs=function(t){function e(n,a,i,o){var c;return i===void 0&&(i="ObservableArray"),o===void 0&&(o=!1),c=t.call(this)||this,Bt(function(){var l=new Us(i,a,o,!0);l.proxy_=c,Ki(c,G,l),n&&n.length&&c.spliceWithArray(0,0,n),Bf&&Object.defineProperty(c,"0",Lf)}),c}Ji(e,t);var r=e.prototype;return r.concat=function(){this[G].atom_.reportObserved();for(var a=arguments.length,i=new Array(a),o=0;o<a;o++)i[o]=arguments[o];return Array.prototype.concat.apply(this.slice(),i.map(function(c){return $n(c)?c.slice():c}))},r[Symbol.iterator]=function(){var n=this,a=0;return Ws({next:function(){return a<n.length?{value:n[a++],done:!1}:{done:!0,value:void 0}}})},Sr(e,[{key:"length",get:function(){return this[G].getArrayLength_()},set:function(a){this[G].setArrayLength_(a)}},{key:Symbol.toStringTag,get:function(){return"Array"}}])}(To);Object.entries(Nn).forEach(function(t){var e=t[0],r=t[1];e!=="concat"&&Xr(Vs.prototype,e,r)});function Ro(t){return{enumerable:!1,configurable:!0,get:function(){return this[G].get_(t)},set:function(r){this[G].set_(t,r)}}}function Vf(t){ct(Vs.prototype,""+t,Ro(t))}function Io(t){if(t>Jn){for(var e=Jn;e<t+100;e++)Vf(e);Jn=t}}Io(1e3);function zf(t,e,r){return new Vs(t,e,r)}function Cn(t,e){if(typeof t=="object"&&t!==null){if($n(t))return e!==void 0&&re(23),t[G].atom_;if(st(t))return t.atom_;if(nr(t)){if(e===void 0)return t.keysAtom_;var r=t.data_.get(e)||t.hasMap_.get(e);return r||re(25,e,js(t)),r}if(Ln(t)){if(!e)return re(26);var n=t[G].values_.get(e);return n||re(27,e,js(t)),n}if(Ds(t)||Fn(t)||_n(t))return t}else if(Ke(t)&&_n(t[G]))return t[G];re(28)}function Wf(t,e){if(t||re(29),Ds(t)||Fn(t)||_n(t)||nr(t)||st(t))return t;if(t[G])return t[G];re(24,t)}function js(t,e){var r;if(e!==void 0)r=Cn(t,e);else{if(Lr(t))return t.name;Ln(t)||nr(t)||st(t)?r=Wf(t):r=Cn(t)}return r.name_}function Bt(t){var e=rr(),r=$s(!0);Ue();try{return t()}finally{Ve(),Ls(r),jt(e)}}var $a=Mn.toString;function zs(t,e,r){return r===void 0&&(r=-1),_s(t,e,r)}function _s(t,e,r,n,a){if(t===e)return t!==0||1/t===1/e;if(t==null||e==null)return!1;if(t!==t)return e!==e;var i=typeof t;if(i!=="function"&&i!=="object"&&typeof e!="object")return!1;var o=$a.call(t);if(o!==$a.call(e))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:+t==0?1/+t===1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object Symbol]":return typeof Symbol<"u"&&Symbol.valueOf.call(t)===Symbol.valueOf.call(e);case"[object Map]":case"[object Set]":r>=0&&r++;break}t=La(t),e=La(e);var c=o==="[object Array]";if(!c){if(typeof t!="object"||typeof e!="object")return!1;var l=t.constructor,d=e.constructor;if(l!==d&&!(Ke(l)&&l instanceof l&&Ke(d)&&d instanceof d)&&"constructor"in t&&"constructor"in e)return!1}if(r===0)return!1;r<0&&(r=-1),n=n||[],a=a||[];for(var u=n.length;u--;)if(n[u]===t)return a[u]===e;if(n.push(t),a.push(e),c){if(u=t.length,u!==e.length)return!1;for(;u--;)if(!_s(t[u],e[u],r-1,n,a))return!1}else{var h=Object.keys(t),f;if(u=h.length,Object.keys(e).length!==u)return!1;for(;u--;)if(f=h[u],!(wt(e,f)&&_s(t[f],e[f],r-1,n,a)))return!1}return n.pop(),a.pop(),!0}function La(t){return $n(t)?t.slice():Nr(t)||nr(t)||bt(t)||st(t)?Array.from(t.entries()):t}var Ba,Hf=((Ba=En().Iterator)==null?void 0:Ba.prototype)||{};function Ws(t){return t[Symbol.iterator]=qf,Object.assign(Object.create(Hf),t)}function qf(){return this}["Symbol","Map","Set"].forEach(function(t){var e=En();typeof e[t]>"u"&&re("MobX requires global '"+t+"' to be available or polyfilled")});typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__=="object"&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:cf,extras:{getDebugName:js},$mobx:G});if(!y.useState)throw new Error("mobx-react-lite requires React with Hooks support");if(!kf)throw new Error("mobx-react-lite@3 requires mobx at least version 6 to be available");function Gf(t){t()}function Yf(t){t||(t=Gf),wf({reactionScheduler:t})}function Kf(t){return jf(t)}var Qf=1e4,Xf=1e4,Jf=function(){function t(e){var r=this;Object.defineProperty(this,"finalize",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"registrations",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"sweepTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sweep",{enumerable:!0,configurable:!0,writable:!0,value:function(n){n===void 0&&(n=Qf),clearTimeout(r.sweepTimeout),r.sweepTimeout=void 0;var a=Date.now();r.registrations.forEach(function(i,o){a-i.registeredAt>=n&&(r.finalize(i.value),r.registrations.delete(o))}),r.registrations.size>0&&r.scheduleSweep()}}),Object.defineProperty(this,"finalizeAllImmediately",{enumerable:!0,configurable:!0,writable:!0,value:function(){r.sweep(0)}})}return Object.defineProperty(t.prototype,"register",{enumerable:!1,configurable:!0,writable:!0,value:function(e,r,n){this.registrations.set(n,{value:r,registeredAt:Date.now()}),this.scheduleSweep()}}),Object.defineProperty(t.prototype,"unregister",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this.registrations.delete(e)}}),Object.defineProperty(t.prototype,"scheduleSweep",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.sweepTimeout===void 0&&(this.sweepTimeout=setTimeout(this.sweep,Xf))}}),t}(),Zf=typeof FinalizationRegistry<"u"?FinalizationRegistry:Jf,Ns=new Zf(function(t){var e;(e=t.reaction)===null||e===void 0||e.dispose(),t.reaction=null}),Do={exports:{}},Fo={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yr=y;function em(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var tm=typeof Object.is=="function"?Object.is:em,rm=yr.useState,nm=yr.useEffect,sm=yr.useLayoutEffect,am=yr.useDebugValue;function im(t,e){var r=e(),n=rm({inst:{value:r,getSnapshot:e}}),a=n[0].inst,i=n[1];return sm(function(){a.value=r,a.getSnapshot=e,Zn(a)&&i({inst:a})},[t,r,e]),nm(function(){return Zn(a)&&i({inst:a}),t(function(){Zn(a)&&i({inst:a})})},[t]),am(r),r}function Zn(t){var e=t.getSnapshot;t=t.value;try{var r=e();return!tm(t,r)}catch{return!0}}function om(t,e){return e()}var cm=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?om:im;Fo.useSyncExternalStore=yr.useSyncExternalStore!==void 0?yr.useSyncExternalStore:cm;Do.exports=Fo;var lm=Do.exports;function Ua(t){t.reaction=new Ct("observer".concat(t.name),function(){var e;t.stateVersion=Symbol(),(e=t.onStoreChange)===null||e===void 0||e.call(t)})}function dm(t,e){e===void 0&&(e="observed");var r=pn.useRef(null);if(!r.current){var n={reaction:null,onStoreChange:null,stateVersion:Symbol(),name:e,subscribe:function(c){return Ns.unregister(n),n.onStoreChange=c,n.reaction||(Ua(n),n.stateVersion=Symbol()),function(){var l;n.onStoreChange=null,(l=n.reaction)===null||l===void 0||l.dispose(),n.reaction=null}},getSnapshot:function(){return n.stateVersion}};r.current=n}var a=r.current;a.reaction||(Ua(a),Ns.register(r,a,a)),pn.useDebugValue(a.reaction,Kf),lm.useSyncExternalStore(a.subscribe,a.getSnapshot,a.getSnapshot);var i,o;if(a.reaction.track(function(){try{i=t()}catch(c){o=c}}),o)throw o;return i}var es,ts,$o=typeof Symbol=="function"&&Symbol.for,um=(ts=(es=Object.getOwnPropertyDescriptor(function(){},"name"))===null||es===void 0?void 0:es.configurable)!==null&&ts!==void 0?ts:!1,Va=$o?Symbol.for("react.forward_ref"):typeof y.forwardRef=="function"&&y.forwardRef(function(t){return null}).$$typeof,za=$o?Symbol.for("react.memo"):typeof y.memo=="function"&&y.memo(function(t){return null}).$$typeof;function hm(t,e){var r;if(za&&t.$$typeof===za)throw new Error("[mobx-react-lite] You are trying to use `observer` on a function component wrapped in either another `observer` or `React.memo`. The observer already applies 'React.memo' for you.");var n=(r=void 0)!==null&&r!==void 0?r:!1,a=t,i=t.displayName||t.name;if(Va&&t.$$typeof===Va&&(n=!0,a=t.render,typeof a!="function"))throw new Error("[mobx-react-lite] `render` property of ForwardRef was not a function");var o=function(c,l){return dm(function(){return a(c,l)},i)};return o.displayName=t.displayName,um&&Object.defineProperty(o,"name",{value:t.name,writable:!0,configurable:!0}),t.contextTypes&&(o.contextTypes=t.contextTypes),n&&(o=y.forwardRef(o)),o=y.memo(o),mm(t,o),o}var fm={$$typeof:!0,render:!0,compare:!0,type:!0,displayName:!0};function mm(t,e){Object.keys(t).forEach(function(r){fm[r]||Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})}var rs;Yf(wi.unstable_batchedUpdates);rs=Ns.finalizeAllImmediately;function A({children:t,className:e,isSelected:r,onClick:n}){return s.jsx("div",{className:Pe("rounded-lg transition-all duration-200 h-full",r?"border-2 border-blue-500 shadow-sm ring-2 ring-blue-100 bg-blue-50":"border border-gray-200 shadow-sm hover:border-gray-300 hover:shadow bg-gradient-to-br from-slate-50 to-gray-50",n&&"cursor-pointer",e),onClick:n,children:t})}A.Header=function({children:e,className:r}){return s.jsx("div",{className:Pe("p-3 sm:p-4 space-y-2",r),children:e})};A.Content=function({children:e,className:r}){return s.jsx("div",{className:Pe("px-3 sm:px-4 pb-3 sm:pb-4",r),children:e})};A.Footer=function({children:e,className:r}){return s.jsx("div",{className:Pe("px-3 sm:px-4 py-2 sm:py-3 border-t bg-white/50 rounded-b-lg",r),children:e})};A.Title=function({children:e,className:r}){return s.jsx("h3",{className:Pe("text-base sm:text-lg font-semibold text-gray-900 line-clamp-2",r),children:e})};A.Grid=function({children:e,className:r}){return s.jsx("div",{className:Pe("grid grid-cols-2 gap-2 text-sm text-gray-600",r),children:e})};const ns=Symbol.for("@inversifyjs/common/islazyServiceIdentifier");var di,Vr,ui;let gm=(di=ns,ui=class{constructor(e){F(this,di);ft(this,Vr);et(this,Vr,e),this[ns]=!0}static is(e){return typeof e=="object"&&e!==null&&e[ns]===!0}unwrap(){return le(this,Vr).call(this)}},Vr=new WeakMap,ui);function Ot(t,e){return Reflect.getMetadata(e,t)}function Wa(t,e,r,n){const a=n(Ot(t,e)??r);Reflect.defineMetadata(e,a,t)}const Bn="named",Hs="name",qs="unmanaged",Gs="optional",Ys="inject",Ks="multi_inject",Lo="post_construct",Bo="pre_destroy",pm=[Ys,Ks,Hs,qs,Bn,Gs],ss=Symbol.for("@inversifyjs/core/InversifyCoreError");var hi,fi;let er=class Uo extends(fi=Error,hi=ss,fi){constructor(r,n,a){super(n,a);F(this,hi);F(this,"kind");this[ss]=!0,this.kind=r}static is(r){return typeof r=="object"&&r!==null&&r[ss]===!0}static isErrorOfKind(r,n){return Uo.is(r)&&r.kind===n}};var Pt,Me;function Vo(t,e){const r=[];for(let n=0;n<e.length;++n)e[n]===void 0&&r.push(n);if(r.length>0)throw new er(Pt.missingInjectionDecorator,`Found unexpected missing metadata on type "${t.name}" at constructor indexes "${r.join('", "')}".

Are you using @inject, @multiInject or @unmanaged decorators at those indexes?

If you're using typescript and want to rely on auto injection, set "emitDecoratorMetadata" compiler option to true`)}function zo(t){return{kind:Me.singleInjection,name:void 0,optional:!1,tags:new Map,targetName:void 0,value:t}}function Un(t){const e=t.find(o=>o.key===Ys),r=t.find(o=>o.key===Ks);if(t.find(o=>o.key===qs)!==void 0)return function(o,c){if(c!==void 0||o!==void 0)throw new er(Pt.missingInjectionDecorator,"Expected a single @inject, @multiInject or @unmanaged metadata");return{kind:Me.unmanaged}}(e,r);if(r===void 0&&e===void 0)throw new er(Pt.missingInjectionDecorator,"Expected @inject, @multiInject or @unmanaged metadata");const n=t.find(o=>o.key===Bn),a=t.find(o=>o.key===Gs),i=t.find(o=>o.key===Hs);return{kind:e===void 0?Me.multipleInjection:Me.singleInjection,name:n==null?void 0:n.value,optional:a!==void 0,tags:new Map(t.filter(o=>pm.every(c=>o.key!==c)).map(o=>[o.key,o.value])),targetName:i==null?void 0:i.value,value:e===void 0?r==null?void 0:r.value:e.value}}function Wo(t,e,r){try{return Un(r)}catch(n){throw er.isErrorOfKind(n,Pt.missingInjectionDecorator)?new er(Pt.missingInjectionDecorator,`Expected a single @inject, @multiInject or @unmanaged decorator at type "${t.name}" at constructor arguments at index "${e.toString()}"`,{cause:n}):n}}function vm(t){const e=Ot(t,"design:paramtypes"),r=Ot(t,"inversify:tagged"),n=[];if(r!==void 0)for(const[a,i]of Object.entries(r)){const o=parseInt(a);n[o]=Wo(t,o,i)}if(e!==void 0){for(let a=0;a<e.length;++a)if(n[a]===void 0){const i=e[a];n[a]=zo(i)}}return Vo(t,n),n}function Ho(t,e,r){try{return Un(r)}catch(n){throw er.isErrorOfKind(n,Pt.missingInjectionDecorator)?new er(Pt.missingInjectionDecorator,`Expected a single @inject, @multiInject or @unmanaged decorator at type "${t.name}" at property "${e.toString()}"`,{cause:n}):n}}function qo(t){const e=Ot(t,"inversify:tagged_props"),r=new Map;if(e!==void 0)for(const n of Reflect.ownKeys(e)){const a=e[n];r.set(n,Ho(t,n,a))}return r}function bm(t){const e=Ot(t,Lo),r=Ot(t,Bo);return{constructorArguments:vm(t),lifecycle:{postConstructMethodName:e==null?void 0:e.value,preDestroyMethodName:r==null?void 0:r.value},properties:qo(t)}}function xm(t,e){const r=e.getConstructorMetadata(t),n=[];for(const[a,i]of Object.entries(r.userGeneratedMetadata)){const o=parseInt(a);n[o]=Wo(t,o,i)}if(r.compilerGeneratedMetadata!==void 0){for(let a=0;a<r.compilerGeneratedMetadata.length;++a)if(n[a]===void 0){const i=r.compilerGeneratedMetadata[a];n[a]=zo(i)}}return Vo(t,n),n}function Go(t,e){const r=e.getPropertiesMetadata(t),n=new Map;for(const a of Reflect.ownKeys(r)){const i=r[a];n.set(a,Ho(t,a,i))}return n}function ym(t,e){const r=Ot(t,Lo),n=Ot(t,Bo);return{constructorArguments:xm(t,e),lifecycle:{postConstructMethodName:r==null?void 0:r.value,preDestroyMethodName:n==null?void 0:n.value},properties:Go(t,e)}}function Ha(t){const e=Object.getPrototypeOf(t.prototype);return e==null?void 0:e.constructor}function wm(t){return t.kind===Me.unmanaged?[{key:qs,value:!0}]:function(e){const r=[jm(e)];e.name!==void 0&&r.push({key:Bn,value:e.name}),e.optional&&r.push({key:Gs,value:!0});for(const[n,a]of e.tags)r.push({key:n,value:a});return e.targetName!==void 0&&r.push({key:Hs,value:e.targetName}),r}(t)}function jm(t){let e;switch(t.kind){case Me.multipleInjection:e={key:Ks,value:t.value};break;case Me.singleInjection:e={key:Ys,value:t.value}}return e}(function(t){t[t.injectionDecoratorConflict=0]="injectionDecoratorConflict",t[t.missingInjectionDecorator=1]="missingInjectionDecorator",t[t.planning=2]="planning",t[t.unknown=3]="unknown"})(Pt||(Pt={})),function(t){t[t.multipleInjection=0]="multipleInjection",t[t.singleInjection=1]="singleInjection",t[t.unmanaged=2]="unmanaged"}(Me||(Me={}));var vt,mi;let _m=(mi=class{constructor(e){ft(this,vt);et(this,vt,e)}startsWith(e){return le(this,vt).startsWith(e)}endsWith(e){return le(this,vt).endsWith(e)}contains(e){return le(this,vt).includes(e)}equals(e){return le(this,vt)===e}value(){return le(this,vt)}},vt=new WeakMap,mi);const as="@inversifyjs/core/targetId";var Ce,zr,Wr,Ht,Hr,qr;class On{constructor(e,r,n){ft(this,Ce);ft(this,zr);ft(this,Wr);ft(this,Ht);ft(this,Hr);ft(this,qr);et(this,zr,function(){const a=Ot(Object,as)??0;return a===Number.MAX_SAFE_INTEGER?Wa(Object,as,a,()=>Number.MIN_SAFE_INTEGER):Wa(Object,as,a,i=>i+1),a}()),et(this,Wr,e),et(this,Ht,void 0),et(this,Ce,r),et(this,Hr,new _m(typeof e=="string"?e:e.toString().slice(7,-1))),et(this,qr,n)}get id(){return le(this,zr)}get identifier(){return le(this,Wr)}get metadata(){return le(this,Ht)===void 0&&et(this,Ht,wm(le(this,Ce))),le(this,Ht)}get name(){return le(this,Hr)}get type(){return le(this,qr)}get serviceIdentifier(){return gm.is(le(this,Ce).value)?le(this,Ce).value.unwrap():le(this,Ce).value}getCustomTags(){return[...le(this,Ce).tags.entries()].map(([e,r])=>({key:e,value:r}))}getNamedTag(){return le(this,Ce).name===void 0?null:{key:Bn,value:le(this,Ce).name}}hasTag(e){return this.metadata.some(r=>r.key===e)}isArray(){return le(this,Ce).kind===Me.multipleInjection}isNamed(){return le(this,Ce).name!==void 0}isOptional(){return le(this,Ce).optional}isTagged(){return le(this,Ce).tags.size>0}matchesArray(e){return this.isArray()&&le(this,Ce).value===e}matchesNamedTag(e){return le(this,Ce).name===e}matchesTag(e){return r=>this.metadata.some(n=>n.key===e&&n.value===r)}}Ce=new WeakMap,zr=new WeakMap,Wr=new WeakMap,Ht=new WeakMap,Hr=new WeakMap,qr=new WeakMap;const Yo=t=>function(e,r){return function(n){const a=e(n);let i=Ha(n);for(;i!==void 0&&i!==Object;){const c=r(i);for(const[l,d]of c)a.properties.has(l)||a.properties.set(l,d);i=Ha(i)}const o=[];for(const c of a.constructorArguments)if(c.kind!==Me.unmanaged){const l=c.targetName??"";o.push(new On(l,c,"ConstructorArgument"))}for(const[c,l]of a.properties)if(l.kind!==Me.unmanaged){const d=l.targetName??c;o.push(new On(d,l,"ClassProperty"))}return o}}(t===void 0?bm:e=>ym(e,t),t===void 0?qo:e=>Go(e,t)),He="named",Nm="unmanaged",Sm="optional",Cm="inject",Om="multi_inject",Pm="inversify:tagged",km="inversify:tagged_props",Am="design:paramtypes",qa="post_construct",Ss="pre_destroy",xe={Request:"Request",Singleton:"Singleton",Transient:"Transient"},de={ConstantValue:"ConstantValue",Constructor:"Constructor",DynamicValue:"DynamicValue",Factory:"Factory",Function:"Function",Instance:"Instance",Invalid:"Invalid",Provider:"Provider"},Ko={ClassProperty:"ClassProperty",ConstructorArgument:"ConstructorArgument",Variable:"Variable"};let Em=0;function Vn(){return Em++}class Qs{constructor(e,r){F(this,"id");F(this,"moduleId");F(this,"activated");F(this,"serviceIdentifier");F(this,"implementationType");F(this,"cache");F(this,"dynamicValue");F(this,"scope");F(this,"type");F(this,"factory");F(this,"provider");F(this,"constraint");F(this,"onActivation");F(this,"onDeactivation");this.id=Vn(),this.activated=!1,this.serviceIdentifier=e,this.scope=r,this.type=de.Invalid,this.constraint=n=>!0,this.implementationType=null,this.cache=null,this.factory=null,this.provider=null,this.onActivation=null,this.onDeactivation=null,this.dynamicValue=null}clone(){const e=new Qs(this.serviceIdentifier,this.scope);return e.activated=e.scope===xe.Singleton&&this.activated,e.implementationType=this.implementationType,e.dynamicValue=this.dynamicValue,e.scope=this.scope,e.type=this.type,e.factory=this.factory,e.provider=this.provider,e.constraint=this.constraint,e.onActivation=this.onActivation,e.onDeactivation=this.onDeactivation,e.cache=this.cache,e}}const Ga="NULL argument",Ya="Key Not Found",Mm="Ambiguous match found for serviceIdentifier:",Tm="No matching bindings found for serviceIdentifier:",Cs=(t,e)=>`onDeactivation() error in class ${t}: ${e}`;class Rm{getConstructorMetadata(e){return{compilerGeneratedMetadata:Reflect.getMetadata(Am,e)??[],userGeneratedMetadata:Reflect.getMetadata(Pm,e)??{}}}getPropertiesMetadata(e){return Reflect.getMetadata(km,e)??{}}}var mr;function Qo(t){return t instanceof RangeError||t.message==="Maximum call stack size exceeded"}(function(t){t[t.MultipleBindingsAvailable=2]="MultipleBindingsAvailable",t[t.NoBindingsAvailable=0]="NoBindingsAvailable",t[t.OnlyOneBindingAvailable=1]="OnlyOneBindingAvailable"})(mr||(mr={}));function Dt(t){return typeof t=="function"?t.name:typeof t=="symbol"?t.toString():t}function Ka(t,e,r){let n="";const a=r(t,e);return a.length!==0&&(n=`
Registered bindings:`,a.forEach(i=>{let o="Object";i.implementationType!==null&&(o=Zo(i.implementationType)),n=`${n}
 ${o}`,i.constraint.metaData&&(n=`${n} - ${i.constraint.metaData}`)})),n}function Xo(t,e){return t.parentRequest!==null&&(t.parentRequest.serviceIdentifier===e||Xo(t.parentRequest,e))}function Jo(t){t.childRequests.forEach(e=>{if(Xo(t,e.serviceIdentifier)){const r=function(n){return function i(o,c=[]){const l=Dt(o.serviceIdentifier);return c.push(l),o.parentRequest!==null?i(o.parentRequest,c):c}(n).reverse().join(" --> ")}(e);throw new Error(`Circular dependency found: ${r}`)}Jo(e)})}function Zo(t){if(t.name!=null&&t.name!=="")return t.name;{const e=t.toString(),r=e.match(/^function\s*([^\s(]+)/);return r===null?`Anonymous function: ${e}`:r[1]}}function Qa(t){return`{"key":"${t.key.toString()}","value":"${t.value.toString()}"}`}class ec{constructor(e){F(this,"id");F(this,"container");F(this,"plan");F(this,"currentRequest");this.id=Vn(),this.container=e}addPlan(e){this.plan=e}setCurrentRequest(e){this.currentRequest=e}}class gn{constructor(e,r){F(this,"key");F(this,"value");this.key=e,this.value=r}toString(){return this.key===He?`named: ${String(this.value).toString()} `:`tagged: { key:${this.key.toString()}, value: ${String(this.value)} }`}}class Im{constructor(e,r){F(this,"parentContext");F(this,"rootRequest");this.parentContext=e,this.rootRequest=r}}function tc(t,e){const r=function(c){const l=Object.getPrototypeOf(c.prototype);return l==null?void 0:l.constructor}(e);if(r===void 0||r===Object)return 0;const n=Yo(t)(r),a=n.map(c=>c.metadata.filter(l=>l.key===Nm)),i=[].concat.apply([],a).length,o=n.length-i;return o>0?o:tc(t,r)}class nn{constructor(e,r,n,a,i){F(this,"id");F(this,"serviceIdentifier");F(this,"parentContext");F(this,"parentRequest");F(this,"bindings");F(this,"childRequests");F(this,"target");F(this,"requestScope");this.id=Vn(),this.serviceIdentifier=e,this.parentContext=r,this.parentRequest=n,this.target=i,this.childRequests=[],this.bindings=Array.isArray(a)?a:[a],this.requestScope=n===null?new Map:null}addChildRequest(e,r,n){const a=new nn(e,this.parentContext,this,r,n);return this.childRequests.push(a),a}}function Pn(t){return t._bindingDictionary}function Xa(t,e,r,n,a){let i=Er(r.container,a.serviceIdentifier),o=[];return i.length===mr.NoBindingsAvailable&&r.container.options.autoBindInjectable===!0&&typeof a.serviceIdentifier=="function"&&t.getConstructorMetadata(a.serviceIdentifier).compilerGeneratedMetadata&&(r.container.bind(a.serviceIdentifier).toSelf(),i=Er(r.container,a.serviceIdentifier)),o=e?i:i.filter(c=>{const l=new nn(c.serviceIdentifier,r,n,c,a);return c.constraint(l)}),function(c,l,d,u,h){switch(l.length){case mr.NoBindingsAvailable:if(u.isOptional())return l;{const f=Dt(c);let p=Tm;throw p+=function(g,b){if(b.isTagged()||b.isNamed()){let m="";const w=b.getNamedTag(),v=b.getCustomTags();return w!==null&&(m+=Qa(w)+`
`),v!==null&&v.forEach(j=>{m+=Qa(j)+`
`}),` ${g}
 ${g} - ${m}`}return` ${g}`}(f,u),p+=Ka(h,f,Er),d!==null&&(p+=`
Trying to resolve bindings for "${Dt(d.serviceIdentifier)}"`),new Error(p)}case mr.OnlyOneBindingAvailable:return l;case mr.MultipleBindingsAvailable:default:if(u.isArray())return l;{const f=Dt(c);let p=`${Mm} ${f}`;throw p+=Ka(h,f,Er),new Error(p)}}}(a.serviceIdentifier,o,n,a,r.container),o}function rc(t,e){const r=e.isMultiInject?Om:Cm,n=[new gn(r,t)];return e.customTag!==void 0&&n.push(new gn(e.customTag.key,e.customTag.value)),e.isOptional===!0&&n.push(new gn(Sm,!0)),n}function nc(t,e,r,n,a,i){let o,c;if(a===null){o=Xa(t,e,n,null,i),c=new nn(r,n,null,o,i);const l=new Im(n,c);n.addPlan(l)}else o=Xa(t,e,n,a,i),c=a.addChildRequest(i.serviceIdentifier,o,i);o.forEach(l=>{let d=null;if(i.isArray())d=c.addChildRequest(l.serviceIdentifier,l,i);else{if(l.cache!==null)return;d=c}if(l.type===de.Instance&&l.implementationType!==null){const u=function(h,f){return Yo(h)(f)}(t,l.implementationType);if(n.container.options.skipBaseClassChecks!==!0){const h=tc(t,l.implementationType);if(u.length<h){const f=`The number of constructor arguments in the derived class ${Zo(l.implementationType)} must be >= than the number of constructor arguments of its base class.`;throw new Error(f)}}u.forEach(h=>{nc(t,!1,h.serviceIdentifier,n,d,h)})}})}function Er(t,e){let r=[];const n=Pn(t);return n.hasKey(e)?r=n.get(e):t.parent!==null&&(r=Er(t.parent,e)),r}function Dm(t,e,r,n,a,i=!1){const o=new ec(e),c=function(l,d,u){const h=rc(d,u),f=Un(h);if(f.kind===Me.unmanaged)throw new Error("Unexpected metadata when creating target");return new On("",f,l)}(r,n,a);try{return nc(t,i,n,o,null,c),o}catch(l){throw Qo(l)&&Jo(o.plan.rootRequest),l}}function Ae(t){return(typeof t=="object"&&t!==null||typeof t=="function")&&typeof t.then=="function"}function sc(t){return!!Ae(t)||Array.isArray(t)&&t.some(Ae)}const Fm=(t,e,r)=>{t.has(e.id)||t.set(e.id,r)},$m=(t,e)=>{t.cache=e,t.activated=!0,Ae(e)&&Lm(t,e)},Lm=async(t,e)=>{try{const r=await e;t.cache=r}catch(r){throw t.cache=null,t.activated=!1,r}};var Ir;(function(t){t.DynamicValue="toDynamicValue",t.Factory="toFactory",t.Provider="toProvider"})(Ir||(Ir={}));function Bm(t,e,r){let n;if(e.length>0){const a=function(o,c){return o.reduce((l,d)=>{const u=c(d);return d.target.type===Ko.ConstructorArgument?l.constructorInjections.push(u):(l.propertyRequests.push(d),l.propertyInjections.push(u)),l.isAsync||(l.isAsync=sc(u)),l},{constructorInjections:[],isAsync:!1,propertyInjections:[],propertyRequests:[]})}(e,r),i={...a,constr:t};n=a.isAsync?async function(o){const c=await Za(o.constructorInjections),l=await Za(o.propertyInjections);return Ja({...o,constructorInjections:c,propertyInjections:l})}(i):Ja(i)}else n=new t;return n}function Ja(t){const e=new t.constr(...t.constructorInjections);return t.propertyRequests.forEach((r,n)=>{const a=r.target.identifier,i=t.propertyInjections[n];r.target.isOptional()&&i===void 0||(e[a]=i)}),e}async function Za(t){const e=[];for(const r of t)Array.isArray(r)?e.push(Promise.all(r)):e.push(r);return Promise.all(e)}function ei(t,e){const r=function(n,a){var c;if(Reflect.hasMetadata(qa,n)){const l=Reflect.getMetadata(qa,n);try{return(c=a[l.value])==null?void 0:c.call(a)}catch(d){if(d instanceof Error)throw new Error((i=n.name,o=d.message,`@postConstruct error in class ${i}: ${o}`))}}var i,o}(t,e);return Ae(r)?r.then(()=>e):e}function Um(t,e){t.scope!==xe.Singleton&&function(r,n){const a=`Class cannot be instantiated in ${r.scope===xe.Request?"request":"transient"} scope.`;if(typeof r.onDeactivation=="function")throw new Error(Cs(n.name,a));if(Reflect.hasMetadata(Ss,n))throw new Error(`@preDestroy error in class ${n.name}: ${a}`)}(t,e)}const Xs=t=>e=>{e.parentContext.setCurrentRequest(e);const r=e.bindings,n=e.childRequests,a=e.target&&e.target.isArray(),i=!(e.parentRequest&&e.parentRequest.target&&e.target&&e.parentRequest.target.matchesArray(e.target.serviceIdentifier));if(a&&i)return n.map(o=>Xs(t)(o));{if(e.target.isOptional()&&r.length===0)return;const o=r[0];return Hm(t,e,o)}},Vm=(t,e)=>{const r=(n=>{switch(n.type){case de.Factory:return{factory:n.factory,factoryType:Ir.Factory};case de.Provider:return{factory:n.provider,factoryType:Ir.Provider};case de.DynamicValue:return{factory:n.dynamicValue,factoryType:Ir.DynamicValue};default:throw new Error(`Unexpected factory type ${n.type}`)}})(t);return((n,a)=>{try{return n()}catch(i){throw Qo(i)?a():i}})(()=>r.factory.bind(t)(e),()=>{return new Error((n=r.factoryType,a=e.currentRequest.serviceIdentifier.toString(),`It looks like there is a circular dependency in one of the '${n}' bindings. Please investigate bindings with service identifier '${a}'.`));var n,a})},zm=(t,e,r)=>{let n;const a=e.childRequests;switch((i=>{let o=null;switch(i.type){case de.ConstantValue:case de.Function:o=i.cache;break;case de.Constructor:case de.Instance:o=i.implementationType;break;case de.DynamicValue:o=i.dynamicValue;break;case de.Provider:o=i.provider;break;case de.Factory:o=i.factory}if(o===null){const c=Dt(i.serviceIdentifier);throw new Error(`Invalid binding type: ${c}`)}})(r),r.type){case de.ConstantValue:case de.Function:n=r.cache;break;case de.Constructor:n=r.implementationType;break;case de.Instance:n=function(i,o,c,l){Um(i,o);const d=Bm(o,c,l);return Ae(d)?d.then(u=>ei(o,u)):ei(o,d)}(r,r.implementationType,a,Xs(t));break;default:n=Vm(r,e.parentContext)}return n},Wm=(t,e,r)=>{let n=((a,i)=>i.scope===xe.Singleton&&i.activated?i.cache:i.scope===xe.Request&&a.has(i.id)?a.get(i.id):null)(t,e);return n!==null||(n=r(),((a,i,o)=>{i.scope===xe.Singleton&&$m(i,o),i.scope===xe.Request&&Fm(a,i,o)})(t,e,n)),n},Hm=(t,e,r)=>Wm(t,r,()=>{let n=zm(t,e,r);return n=Ae(n)?n.then(a=>ti(e,r,a)):ti(e,r,n),n});function ti(t,e,r){let n=qm(t.parentContext,e,r);const a=Km(t.parentContext.container);let i,o=a.next();do{i=o.value;const c=t.parentContext,l=t.serviceIdentifier,d=Ym(i,l);n=Ae(n)?ac(d,c,n):Gm(d,c,n),o=a.next()}while(o.done!==!0&&!Pn(i).hasKey(t.serviceIdentifier));return n}const qm=(t,e,r)=>{let n;return n=typeof e.onActivation=="function"?e.onActivation(t,r):r,n},Gm=(t,e,r)=>{let n=t.next();for(;n.done!==!0;){if(Ae(r=n.value(e,r)))return ac(t,e,r);n=t.next()}return r},ac=async(t,e,r)=>{let n=await r,a=t.next();for(;a.done!==!0;)n=await a.value(e,n),a=t.next();return n},Ym=(t,e)=>{const r=t._activations;return r.hasKey(e)?r.get(e).values():[].values()},Km=t=>{const e=[t];let r=t.parent;for(;r!==null;)e.push(r),r=r.parent;return{next:()=>{const n=e.pop();return n!==void 0?{done:!1,value:n}:{done:!0,value:void 0}}}},gt=(t,e)=>{const r=t.parentRequest;return r!==null&&(!!e(r)||gt(r,e))},Mr=t=>e=>{const r=n=>n!==null&&n.target!==null&&n.target.matchesTag(t)(e);return r.metaData=new gn(t,e),r},dn=Mr(He),is=t=>e=>{let r=null;if(e!==null){if(r=e.bindings[0],typeof t=="string")return r.serviceIdentifier===t;{const n=e.bindings[0].implementationType;return t===n}}return!1};class kn{constructor(e){F(this,"_binding");this._binding=e}when(e){return this._binding.constraint=e,new Se(this._binding)}whenTargetNamed(e){return this._binding.constraint=dn(e),new Se(this._binding)}whenTargetIsDefault(){return this._binding.constraint=e=>e===null?!1:e.target!==null&&!e.target.isNamed()&&!e.target.isTagged(),new Se(this._binding)}whenTargetTagged(e,r){return this._binding.constraint=Mr(e)(r),new Se(this._binding)}whenInjectedInto(e){return this._binding.constraint=r=>r!==null&&is(e)(r.parentRequest),new Se(this._binding)}whenParentNamed(e){return this._binding.constraint=r=>r!==null&&dn(e)(r.parentRequest),new Se(this._binding)}whenParentTagged(e,r){return this._binding.constraint=n=>n!==null&&Mr(e)(r)(n.parentRequest),new Se(this._binding)}whenAnyAncestorIs(e){return this._binding.constraint=r=>r!==null&&gt(r,is(e)),new Se(this._binding)}whenNoAncestorIs(e){return this._binding.constraint=r=>r!==null&&!gt(r,is(e)),new Se(this._binding)}whenAnyAncestorNamed(e){return this._binding.constraint=r=>r!==null&&gt(r,dn(e)),new Se(this._binding)}whenNoAncestorNamed(e){return this._binding.constraint=r=>r!==null&&!gt(r,dn(e)),new Se(this._binding)}whenAnyAncestorTagged(e,r){return this._binding.constraint=n=>n!==null&&gt(n,Mr(e)(r)),new Se(this._binding)}whenNoAncestorTagged(e,r){return this._binding.constraint=n=>n!==null&&!gt(n,Mr(e)(r)),new Se(this._binding)}whenAnyAncestorMatches(e){return this._binding.constraint=r=>r!==null&&gt(r,e),new Se(this._binding)}whenNoAncestorMatches(e){return this._binding.constraint=r=>r!==null&&!gt(r,e),new Se(this._binding)}}class Se{constructor(e){F(this,"_binding");this._binding=e}onActivation(e){return this._binding.onActivation=e,new kn(this._binding)}onDeactivation(e){return this._binding.onDeactivation=e,new kn(this._binding)}}class pt{constructor(e){F(this,"_bindingWhenSyntax");F(this,"_bindingOnSyntax");F(this,"_binding");this._binding=e,this._bindingWhenSyntax=new kn(this._binding),this._bindingOnSyntax=new Se(this._binding)}when(e){return this._bindingWhenSyntax.when(e)}whenTargetNamed(e){return this._bindingWhenSyntax.whenTargetNamed(e)}whenTargetIsDefault(){return this._bindingWhenSyntax.whenTargetIsDefault()}whenTargetTagged(e,r){return this._bindingWhenSyntax.whenTargetTagged(e,r)}whenInjectedInto(e){return this._bindingWhenSyntax.whenInjectedInto(e)}whenParentNamed(e){return this._bindingWhenSyntax.whenParentNamed(e)}whenParentTagged(e,r){return this._bindingWhenSyntax.whenParentTagged(e,r)}whenAnyAncestorIs(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)}whenNoAncestorIs(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)}whenAnyAncestorNamed(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)}whenAnyAncestorTagged(e,r){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,r)}whenNoAncestorNamed(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)}whenNoAncestorTagged(e,r){return this._bindingWhenSyntax.whenNoAncestorTagged(e,r)}whenAnyAncestorMatches(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)}whenNoAncestorMatches(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)}onActivation(e){return this._bindingOnSyntax.onActivation(e)}onDeactivation(e){return this._bindingOnSyntax.onDeactivation(e)}}class Qm{constructor(e){F(this,"_binding");this._binding=e}inRequestScope(){return this._binding.scope=xe.Request,new pt(this._binding)}inSingletonScope(){return this._binding.scope=xe.Singleton,new pt(this._binding)}inTransientScope(){return this._binding.scope=xe.Transient,new pt(this._binding)}}class ri{constructor(e){F(this,"_bindingInSyntax");F(this,"_bindingWhenSyntax");F(this,"_bindingOnSyntax");F(this,"_binding");this._binding=e,this._bindingWhenSyntax=new kn(this._binding),this._bindingOnSyntax=new Se(this._binding),this._bindingInSyntax=new Qm(e)}inRequestScope(){return this._bindingInSyntax.inRequestScope()}inSingletonScope(){return this._bindingInSyntax.inSingletonScope()}inTransientScope(){return this._bindingInSyntax.inTransientScope()}when(e){return this._bindingWhenSyntax.when(e)}whenTargetNamed(e){return this._bindingWhenSyntax.whenTargetNamed(e)}whenTargetIsDefault(){return this._bindingWhenSyntax.whenTargetIsDefault()}whenTargetTagged(e,r){return this._bindingWhenSyntax.whenTargetTagged(e,r)}whenInjectedInto(e){return this._bindingWhenSyntax.whenInjectedInto(e)}whenParentNamed(e){return this._bindingWhenSyntax.whenParentNamed(e)}whenParentTagged(e,r){return this._bindingWhenSyntax.whenParentTagged(e,r)}whenAnyAncestorIs(e){return this._bindingWhenSyntax.whenAnyAncestorIs(e)}whenNoAncestorIs(e){return this._bindingWhenSyntax.whenNoAncestorIs(e)}whenAnyAncestorNamed(e){return this._bindingWhenSyntax.whenAnyAncestorNamed(e)}whenAnyAncestorTagged(e,r){return this._bindingWhenSyntax.whenAnyAncestorTagged(e,r)}whenNoAncestorNamed(e){return this._bindingWhenSyntax.whenNoAncestorNamed(e)}whenNoAncestorTagged(e,r){return this._bindingWhenSyntax.whenNoAncestorTagged(e,r)}whenAnyAncestorMatches(e){return this._bindingWhenSyntax.whenAnyAncestorMatches(e)}whenNoAncestorMatches(e){return this._bindingWhenSyntax.whenNoAncestorMatches(e)}onActivation(e){return this._bindingOnSyntax.onActivation(e)}onDeactivation(e){return this._bindingOnSyntax.onDeactivation(e)}}class Xm{constructor(e){F(this,"_binding");this._binding=e}to(e){return this._binding.type=de.Instance,this._binding.implementationType=e,new ri(this._binding)}toSelf(){if(typeof this._binding.serviceIdentifier!="function")throw new Error("The toSelf function can only be applied when a constructor is used as service identifier");const e=this._binding.serviceIdentifier;return this.to(e)}toConstantValue(e){return this._binding.type=de.ConstantValue,this._binding.cache=e,this._binding.dynamicValue=null,this._binding.implementationType=null,this._binding.scope=xe.Singleton,new pt(this._binding)}toDynamicValue(e){return this._binding.type=de.DynamicValue,this._binding.cache=null,this._binding.dynamicValue=e,this._binding.implementationType=null,new ri(this._binding)}toConstructor(e){return this._binding.type=de.Constructor,this._binding.implementationType=e,this._binding.scope=xe.Singleton,new pt(this._binding)}toFactory(e){return this._binding.type=de.Factory,this._binding.factory=e,this._binding.scope=xe.Singleton,new pt(this._binding)}toFunction(e){if(typeof e!="function")throw new Error("Value provided to function binding must be a function!");const r=this.toConstantValue(e);return this._binding.type=de.Function,this._binding.scope=xe.Singleton,r}toAutoFactory(e){return this._binding.type=de.Factory,this._binding.factory=r=>()=>r.container.get(e),this._binding.scope=xe.Singleton,new pt(this._binding)}toAutoNamedFactory(e){return this._binding.type=de.Factory,this._binding.factory=r=>n=>r.container.getNamed(e,n),new pt(this._binding)}toProvider(e){return this._binding.type=de.Provider,this._binding.provider=e,this._binding.scope=xe.Singleton,new pt(this._binding)}toService(e){this._binding.type=de.DynamicValue,Object.defineProperty(this._binding,"cache",{configurable:!0,enumerable:!0,get:()=>null,set(r){}}),this._binding.dynamicValue=r=>{try{return r.container.get(e)}catch{return r.container.getAsync(e)}},this._binding.implementationType=null}}class Js{constructor(){F(this,"bindings");F(this,"activations");F(this,"deactivations");F(this,"middleware");F(this,"moduleActivationStore")}static of(e,r,n,a,i){const o=new Js;return o.bindings=e,o.middleware=r,o.deactivations=a,o.activations=n,o.moduleActivationStore=i,o}}class yt{constructor(){F(this,"_map");this._map=new Map}getMap(){return this._map}add(e,r){if(this._checkNonNulish(e),r==null)throw new Error(Ga);const n=this._map.get(e);n!==void 0?n.push(r):this._map.set(e,[r])}get(e){this._checkNonNulish(e);const r=this._map.get(e);if(r!==void 0)return r;throw new Error(Ya)}remove(e){if(this._checkNonNulish(e),!this._map.delete(e))throw new Error(Ya)}removeIntersection(e){this.traverse((r,n)=>{const a=e.hasKey(r)?e.get(r):void 0;if(a!==void 0){const i=n.filter(o=>!a.some(c=>o===c));this._setValue(r,i)}})}removeByCondition(e){const r=[];return this._map.forEach((n,a)=>{const i=[];for(const o of n)e(o)?r.push(o):i.push(o);this._setValue(a,i)}),r}hasKey(e){return this._checkNonNulish(e),this._map.has(e)}clone(){const e=new yt;return this._map.forEach((r,n)=>{r.forEach(a=>{var i;e.add(n,typeof(i=a)=="object"&&i!==null&&"clone"in i&&typeof i.clone=="function"?a.clone():a)})}),e}traverse(e){this._map.forEach((r,n)=>{e(n,r)})}_checkNonNulish(e){if(e==null)throw new Error(Ga)}_setValue(e,r){r.length>0?this._map.set(e,r):this._map.delete(e)}}class Zs{constructor(){F(this,"_map",new Map)}remove(e){const r=this._map.get(e);return r===void 0?this._getEmptyHandlersStore():(this._map.delete(e),r)}addDeactivation(e,r,n){this._getModuleActivationHandlers(e).onDeactivations.add(r,n)}addActivation(e,r,n){this._getModuleActivationHandlers(e).onActivations.add(r,n)}clone(){const e=new Zs;return this._map.forEach((r,n)=>{e._map.set(n,{onActivations:r.onActivations.clone(),onDeactivations:r.onDeactivations.clone()})}),e}_getModuleActivationHandlers(e){let r=this._map.get(e);return r===void 0&&(r=this._getEmptyHandlersStore(),this._map.set(e,r)),r}_getEmptyHandlersStore(){return{onActivations:new yt,onDeactivations:new yt}}}class An{constructor(e){F(this,"id");F(this,"parent");F(this,"options");F(this,"_middleware");F(this,"_bindingDictionary");F(this,"_activations");F(this,"_deactivations");F(this,"_snapshots");F(this,"_metadataReader");F(this,"_moduleActivationStore");const r=e||{};if(typeof r!="object")throw new Error("Invalid Container constructor argument. Container options must be an object.");if(r.defaultScope===void 0)r.defaultScope=xe.Transient;else if(r.defaultScope!==xe.Singleton&&r.defaultScope!==xe.Transient&&r.defaultScope!==xe.Request)throw new Error('Invalid Container option. Default scope must be a string ("singleton" or "transient").');if(r.autoBindInjectable===void 0)r.autoBindInjectable=!1;else if(typeof r.autoBindInjectable!="boolean")throw new Error("Invalid Container option. Auto bind injectable must be a boolean");if(r.skipBaseClassChecks===void 0)r.skipBaseClassChecks=!1;else if(typeof r.skipBaseClassChecks!="boolean")throw new Error("Invalid Container option. Skip base check must be a boolean");this.options={autoBindInjectable:r.autoBindInjectable,defaultScope:r.defaultScope,skipBaseClassChecks:r.skipBaseClassChecks},this.id=Vn(),this._bindingDictionary=new yt,this._snapshots=[],this._middleware=null,this._activations=new yt,this._deactivations=new yt,this.parent=null,this._metadataReader=new Rm,this._moduleActivationStore=new Zs}static merge(e,r,...n){const a=new An,i=[e,r,...n].map(c=>Pn(c)),o=Pn(a);return i.forEach(c=>{var l;l=o,c.traverse((d,u)=>{u.forEach(h=>{l.add(h.serviceIdentifier,h.clone())})})}),a}load(...e){const r=this._getContainerModuleHelpersFactory();for(const n of e){const a=r(n.id);n.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction,a.unbindAsyncFunction,a.onActivationFunction,a.onDeactivationFunction)}}async loadAsync(...e){const r=this._getContainerModuleHelpersFactory();for(const n of e){const a=r(n.id);await n.registry(a.bindFunction,a.unbindFunction,a.isboundFunction,a.rebindFunction,a.unbindAsyncFunction,a.onActivationFunction,a.onDeactivationFunction)}}unload(...e){e.forEach(r=>{const n=this._removeModuleBindings(r.id);this._deactivateSingletons(n),this._removeModuleHandlers(r.id)})}async unloadAsync(...e){for(const r of e){const n=this._removeModuleBindings(r.id);await this._deactivateSingletonsAsync(n),this._removeModuleHandlers(r.id)}}bind(e){return this._bind(this._buildBinding(e))}rebind(e){return this.unbind(e),this.bind(e)}async rebindAsync(e){return await this.unbindAsync(e),this.bind(e)}unbind(e){if(this._bindingDictionary.hasKey(e)){const r=this._bindingDictionary.get(e);this._deactivateSingletons(r)}this._removeServiceFromDictionary(e)}async unbindAsync(e){if(this._bindingDictionary.hasKey(e)){const r=this._bindingDictionary.get(e);await this._deactivateSingletonsAsync(r)}this._removeServiceFromDictionary(e)}unbindAll(){this._bindingDictionary.traverse((e,r)=>{this._deactivateSingletons(r)}),this._bindingDictionary=new yt}async unbindAllAsync(){const e=[];this._bindingDictionary.traverse((r,n)=>{e.push(this._deactivateSingletonsAsync(n))}),await Promise.all(e),this._bindingDictionary=new yt}onActivation(e,r){this._activations.add(e,r)}onDeactivation(e,r){this._deactivations.add(e,r)}isBound(e){let r=this._bindingDictionary.hasKey(e);return!r&&this.parent&&(r=this.parent.isBound(e)),r}isCurrentBound(e){return this._bindingDictionary.hasKey(e)}isBoundNamed(e,r){return this.isBoundTagged(e,He,r)}isBoundTagged(e,r,n){let a=!1;if(this._bindingDictionary.hasKey(e)){const i=this._bindingDictionary.get(e),o=function(c,l,d){const u=rc(l,d),h=Un(u);if(h.kind===Me.unmanaged)throw new Error("Unexpected metadata when creating target");const f=new On("",h,"Variable"),p=new ec(c);return new nn(l,p,null,[],f)}(this,e,{customTag:{key:r,value:n},isMultiInject:!1});a=i.some(c=>c.constraint(o))}return!a&&this.parent&&(a=this.parent.isBoundTagged(e,r,n)),a}snapshot(){this._snapshots.push(Js.of(this._bindingDictionary.clone(),this._middleware,this._activations.clone(),this._deactivations.clone(),this._moduleActivationStore.clone()))}restore(){const e=this._snapshots.pop();if(e===void 0)throw new Error("No snapshot available to restore.");this._bindingDictionary=e.bindings,this._activations=e.activations,this._deactivations=e.deactivations,this._middleware=e.middleware,this._moduleActivationStore=e.moduleActivationStore}createChild(e){const r=new An(e||this.options);return r.parent=this,r}applyMiddleware(...e){const r=this._middleware?this._middleware:this._planAndResolve();this._middleware=e.reduce((n,a)=>a(n),r)}applyCustomMetadataReader(e){this._metadataReader=e}get(e){const r=this._getNotAllArgs(e,!1,!1);return this._getButThrowIfAsync(r)}async getAsync(e){const r=this._getNotAllArgs(e,!1,!1);return this._get(r)}getTagged(e,r,n){const a=this._getNotAllArgs(e,!1,!1,r,n);return this._getButThrowIfAsync(a)}async getTaggedAsync(e,r,n){const a=this._getNotAllArgs(e,!1,!1,r,n);return this._get(a)}getNamed(e,r){return this.getTagged(e,He,r)}async getNamedAsync(e,r){return this.getTaggedAsync(e,He,r)}getAll(e,r){const n=this._getAllArgs(e,r,!1);return this._getButThrowIfAsync(n)}async getAllAsync(e,r){const n=this._getAllArgs(e,r,!1);return this._getAll(n)}getAllTagged(e,r,n){const a=this._getNotAllArgs(e,!0,!1,r,n);return this._getButThrowIfAsync(a)}async getAllTaggedAsync(e,r,n){const a=this._getNotAllArgs(e,!0,!1,r,n);return this._getAll(a)}getAllNamed(e,r){return this.getAllTagged(e,He,r)}async getAllNamedAsync(e,r){return this.getAllTaggedAsync(e,He,r)}resolve(e){const r=this.isBound(e);r||this.bind(e).toSelf();const n=this.get(e);return r||this.unbind(e),n}tryGet(e){const r=this._getNotAllArgs(e,!1,!0);return this._getButThrowIfAsync(r)}async tryGetAsync(e){const r=this._getNotAllArgs(e,!1,!0);return this._get(r)}tryGetTagged(e,r,n){const a=this._getNotAllArgs(e,!1,!0,r,n);return this._getButThrowIfAsync(a)}async tryGetTaggedAsync(e,r,n){const a=this._getNotAllArgs(e,!1,!0,r,n);return this._get(a)}tryGetNamed(e,r){return this.tryGetTagged(e,He,r)}async tryGetNamedAsync(e,r){return this.tryGetTaggedAsync(e,He,r)}tryGetAll(e,r){const n=this._getAllArgs(e,r,!0);return this._getButThrowIfAsync(n)}async tryGetAllAsync(e,r){const n=this._getAllArgs(e,r,!0);return this._getAll(n)}tryGetAllTagged(e,r,n){const a=this._getNotAllArgs(e,!0,!0,r,n);return this._getButThrowIfAsync(a)}async tryGetAllTaggedAsync(e,r,n){const a=this._getNotAllArgs(e,!0,!0,r,n);return this._getAll(a)}tryGetAllNamed(e,r){return this.tryGetAllTagged(e,He,r)}async tryGetAllNamedAsync(e,r){return this.tryGetAllTaggedAsync(e,He,r)}_preDestroy(e,r){var n;if(e!==void 0&&Reflect.hasMetadata(Ss,e)){const a=Reflect.getMetadata(Ss,e);return(n=r[a.value])==null?void 0:n.call(r)}}_removeModuleHandlers(e){const r=this._moduleActivationStore.remove(e);this._activations.removeIntersection(r.onActivations),this._deactivations.removeIntersection(r.onDeactivations)}_removeModuleBindings(e){return this._bindingDictionary.removeByCondition(r=>r.moduleId===e)}_deactivate(e,r){const n=r==null?void 0:Object.getPrototypeOf(r).constructor;try{if(this._deactivations.hasKey(e.serviceIdentifier)){const i=this._deactivateContainer(r,this._deactivations.get(e.serviceIdentifier).values());if(Ae(i))return this._handleDeactivationError(i.then(async()=>this._propagateContainerDeactivationThenBindingAndPreDestroyAsync(e,r,n)),e.serviceIdentifier)}const a=this._propagateContainerDeactivationThenBindingAndPreDestroy(e,r,n);if(Ae(a))return this._handleDeactivationError(a,e.serviceIdentifier)}catch(a){if(a instanceof Error)throw new Error(Cs(Dt(e.serviceIdentifier),a.message))}}async _handleDeactivationError(e,r){try{await e}catch(n){if(n instanceof Error)throw new Error(Cs(Dt(r),n.message))}}_deactivateContainer(e,r){let n=r.next();for(;typeof n.value=="function";){const a=n.value(e);if(Ae(a))return a.then(async()=>this._deactivateContainerAsync(e,r));n=r.next()}}async _deactivateContainerAsync(e,r){let n=r.next();for(;typeof n.value=="function";)await n.value(e),n=r.next()}_getContainerModuleHelpersFactory(){const e=l=>d=>{const u=this._buildBinding(d);return u.moduleId=l,this._bind(u)},r=()=>l=>{this.unbind(l)},n=()=>async l=>this.unbindAsync(l),a=()=>l=>this.isBound(l),i=l=>{const d=e(l);return u=>(this.unbind(u),d(u))},o=l=>(d,u)=>{this._moduleActivationStore.addActivation(l,d,u),this.onActivation(d,u)},c=l=>(d,u)=>{this._moduleActivationStore.addDeactivation(l,d,u),this.onDeactivation(d,u)};return l=>({bindFunction:e(l),isboundFunction:a(),onActivationFunction:o(l),onDeactivationFunction:c(l),rebindFunction:i(l),unbindAsyncFunction:n(),unbindFunction:r()})}_bind(e){return this._bindingDictionary.add(e.serviceIdentifier,e),new Xm(e)}_buildBinding(e){const r=this.options.defaultScope||xe.Transient;return new Qs(e,r)}async _getAll(e){return Promise.all(this._get(e))}_get(e){const r={...e,contextInterceptor:n=>n,targetType:Ko.Variable};if(this._middleware){const n=this._middleware(r);if(n==null)throw new Error("Invalid return type in middleware. Middleware must return!");return n}return this._planAndResolve()(r)}_getButThrowIfAsync(e){const r=this._get(e);if(sc(r))throw new Error(`You are attempting to construct ${function(n){return typeof n=="function"?`[function/class ${n.name||"<anonymous>"}]`:typeof n=="symbol"?n.toString():`'${n}'`}(e.serviceIdentifier)} in a synchronous way but it has asynchronous dependencies.`);return r}_getAllArgs(e,r,n){return{avoidConstraints:!(r!=null&&r.enforceBindingConstraints),isMultiInject:!0,isOptional:n,serviceIdentifier:e}}_getNotAllArgs(e,r,n,a,i){return{avoidConstraints:!1,isMultiInject:r,isOptional:n,key:a,serviceIdentifier:e,value:i}}_getPlanMetadataFromNextArgs(e){const r={isMultiInject:e.isMultiInject};return e.key!==void 0&&(r.customTag={key:e.key,value:e.value}),e.isOptional===!0&&(r.isOptional=!0),r}_planAndResolve(){return e=>{let r=Dm(this._metadataReader,this,e.targetType,e.serviceIdentifier,this._getPlanMetadataFromNextArgs(e),e.avoidConstraints);return r=e.contextInterceptor(r),function(a){return Xs(a.plan.rootRequest.requestScope)(a.plan.rootRequest)}(r)}}_deactivateIfSingleton(e){if(e.activated)return Ae(e.cache)?e.cache.then(r=>this._deactivate(e,r)):this._deactivate(e,e.cache)}_deactivateSingletons(e){for(const r of e)if(Ae(this._deactivateIfSingleton(r)))throw new Error("Attempting to unbind dependency with asynchronous destruction (@preDestroy or onDeactivation)")}async _deactivateSingletonsAsync(e){await Promise.all(e.map(async r=>this._deactivateIfSingleton(r)))}_propagateContainerDeactivationThenBindingAndPreDestroy(e,r,n){return this.parent?this._deactivate.bind(this.parent)(e,r):this._bindingDeactivationAndPreDestroy(e,r,n)}async _propagateContainerDeactivationThenBindingAndPreDestroyAsync(e,r,n){this.parent?await this._deactivate.bind(this.parent)(e,r):await this._bindingDeactivationAndPreDestroyAsync(e,r,n)}_removeServiceFromDictionary(e){try{this._bindingDictionary.remove(e)}catch{throw new Error(`Could not unbind serviceIdentifier: ${Dt(e)}`)}}_bindingDeactivationAndPreDestroy(e,r,n){if(typeof e.onDeactivation=="function"){const a=e.onDeactivation(r);if(Ae(a))return a.then(()=>this._preDestroy(n,r))}return this._preDestroy(n,r)}async _bindingDeactivationAndPreDestroyAsync(e,r,n){typeof e.onDeactivation=="function"&&await e.onDeactivation(r),await this._preDestroy(n,r)}}const Ee={Logger:Symbol.for("Logger"),OrderRepository:Symbol.for("OrderRepository"),ProductRepository:Symbol.for("ProductRepository"),ProviderRepository:Symbol.for("ProviderRepository"),AnalyticsService:Symbol.for("AnalyticsService"),DashboardViewModel:Symbol.for("DashboardViewModel")};class Jm{formatMessage(e,r,...n){const a=new Date().toISOString(),i=n.map(o=>o instanceof Error?`${o.name}: ${o.message}
${o.stack}`:JSON.stringify(o)).join(" ");return`[${a}] [${e}] ${r} ${i}`.trim()}debug(e,...r){}info(e,...r){console.info(this.formatMessage("INFO",e,...r))}warn(e,...r){console.warn(this.formatMessage("WARN",e,...r))}error(e,r,...n){console.error(this.formatMessage("ERROR",e,r,...n))}}class Zm extends Error{constructor(e,r){super(e,r),this.name=this.constructor.name,Error.captureStackTrace(this,this.constructor)}}let ee=class extends Zm{constructor(e,r){super(e,r),this.name="DatabaseError"}};class eg{constructor(){this.COLLECTION="orders"}checkAuth(){if(!ge.currentUser)throw new ee("User not authenticated")}async getAll(){try{this.checkAuth();const e=z(W,this.COLLECTION),r=await _e(e);return r.exists()?Object.entries(r.val()).map(([n,a])=>({id:n,...a})):[]}catch(e){throw e instanceof ee?e:new ee("Failed to fetch orders",{cause:e})}}async getById(e){try{this.checkAuth();const r=z(W,`${this.COLLECTION}/${e}`),n=await _e(r);return n.exists()?{id:e,...n.val()}:null}catch(r){throw r instanceof ee?r:new ee("Failed to fetch order",{cause:r})}}async getByProvider(e){try{this.checkAuth();const r=z(W,this.COLLECTION),n=Gt(r,Yt("providerId"),Kt(e)),a=await _e(n);return a.exists()?Object.entries(a.val()).map(([i,o])=>({id:i,...o})).sort((i,o)=>o.date-i.date):[]}catch(r){throw r instanceof ee?r:new ee("Failed to fetch provider orders",{cause:r})}}async create(e){try{this.checkAuth();const r=z(W,this.COLLECTION),n=ht(r);if(!n.key)throw new ee("Failed to generate order ID");return await ut(n,e),n.key}catch(r){throw r instanceof ee?r:new ee("Failed to create order",{cause:r})}}async update(e,r){try{this.checkAuth();const n=z(W,`${this.COLLECTION}/${e}`);await ut(n,r)}catch(n){throw n instanceof ee?n:new ee("Failed to update order",{cause:n})}}async delete(e){try{this.checkAuth();const r=z(W,`${this.COLLECTION}/${e}`);await jr(r)}catch(r){throw r instanceof ee?r:new ee("Failed to delete order",{cause:r})}}subscribeToProviderOrders(e,r){try{this.checkAuth();const n=z(W,this.COLLECTION),a=Gt(n,Yt("providerId"),Kt(e));return Ye(a,o=>{if(!o.exists()){r([]);return}const c=Object.entries(o.val()).map(([l,d])=>({id:l,...d})).sort((l,d)=>d.date-l.date);r(c)})}catch(n){throw n instanceof ee?n:new ee("Failed to subscribe to provider orders",{cause:n})}}}function ni(t){var e,r,n;return(e=t.name)!=null&&e.trim()?(r=t.sku)!=null&&r.trim()?(n=t.purchasePackaging)!=null&&n.trim()?t.providerId?typeof t.minPackageStock!="number"||isNaN(t.minPackageStock)?{field:"minPackageStock",message:"El stock mínimo debe ser un número válido"}:typeof t.desiredStock!="number"||isNaN(t.desiredStock)?{field:"desiredStock",message:"El stock deseado debe ser un número válido"}:t.minPackageStock<0?{field:"minPackageStock",message:"El stock mínimo no puede ser negativo"}:t.desiredStock<0?{field:"desiredStock",message:"El stock deseado no puede ser negativo"}:t.minPackageStock>t.desiredStock?{field:"minPackageStock",message:"El stock mínimo no puede ser mayor al stock deseado"}:typeof t.price!="number"||isNaN(t.price)?{field:"price",message:"El precio debe ser un número válido"}:t.price<0?{field:"price",message:"El precio no puede ser negativo"}:typeof t.order!="number"||isNaN(t.order)?{field:"order",message:"El orden debe ser un número válido"}:null:{field:"providerId",message:"El proveedor es requerido"}:{field:"purchasePackaging",message:"El empaque de compra es requerido"}:{field:"sku",message:"El SKU es requerido"}:{field:"name",message:"El nombre es requerido"}}class tg{constructor(){this.COLLECTION="products"}checkAuth(){if(!ge.currentUser)throw new ee("User not authenticated")}async getAll(){try{this.checkAuth();const e=z(W,this.COLLECTION),r=await _e(e);return r.exists()?Object.entries(r.val()).map(([n,a])=>({id:n,...a})):[]}catch(e){throw new ee("Failed to fetch products",{cause:e})}}async getById(e){try{this.checkAuth();const r=z(W,`${this.COLLECTION}/${e}`),n=await _e(r);return n.exists()?{id:e,...n.val()}:null}catch(r){throw new ee("Failed to fetch product",{cause:r})}}async getByProvider(e){try{this.checkAuth();const r=z(W,this.COLLECTION),n=Gt(r,Yt("providerId"),Kt(e)),a=await _e(n);return a.exists()?Object.entries(a.val()).map(([i,o])=>({id:i,...o})).sort((i,o)=>i.order-o.order):[]}catch(r){throw new ee("Failed to fetch provider products",{cause:r})}}async create(e){var r,n,a;try{this.checkAuth();const i=ni(e);if(i)throw new ee(i.message);const o=z(W,this.COLLECTION),c=ht(o);if(!c.key)throw new ee("Failed to generate product ID");const l={name:e.name.trim().toUpperCase(),sku:e.sku.trim().toUpperCase(),supplierCode:((r=e.supplierCode)==null?void 0:r.trim().toUpperCase())||"",purchasePackaging:e.purchasePackaging.trim().toUpperCase(),salePackaging:((n=e.salePackaging)==null?void 0:n.trim().toUpperCase())||"",price:Number(e.price)||0,minPackageStock:Number(e.minPackageStock)||0,desiredStock:Number(e.desiredStock)||0,order:Number(e.order)||0,providerId:e.providerId,tags:Array.isArray(e.tags)?e.tags:[],isProduction:!!e.isProduction};return e.isProduction&&(l.unitMeasure=((a=e.unitMeasure)==null?void 0:a.trim().toUpperCase())||"UNIDAD",l.pricePerUnit=Number(e.pricePerUnit)||0),await ut(c,l),c.key}catch(i){throw new ee("Failed to create product",{cause:i})}}async update(e,r){var n,a,i,o,c,l;try{this.checkAuth();const d=z(W,`${this.COLLECTION}/${e}`),u=await _e(d);if(!u.exists())throw new ee("Product not found");const h=u.val(),f={...h,...r,name:((n=r.name)==null?void 0:n.trim().toUpperCase())??h.name,sku:((a=r.sku)==null?void 0:a.trim().toUpperCase())??h.sku,supplierCode:((i=r.supplierCode)==null?void 0:i.trim().toUpperCase())??h.supplierCode??"",purchasePackaging:((o=r.purchasePackaging)==null?void 0:o.trim().toUpperCase())??h.purchasePackaging,salePackaging:((c=r.salePackaging)==null?void 0:c.trim().toUpperCase())??h.salePackaging??"",price:typeof r.price=="number"?Number(r.price):h.price,minPackageStock:typeof r.minPackageStock=="number"?Number(r.minPackageStock):h.minPackageStock,desiredStock:typeof r.desiredStock=="number"?Number(r.desiredStock):h.desiredStock,order:typeof r.order=="number"?Number(r.order):h.order,tags:r.tags??h.tags??[],isProduction:typeof r.isProduction=="boolean"?r.isProduction:h.isProduction};f.isProduction?(f.unitMeasure=((l=r.unitMeasure)==null?void 0:l.trim().toUpperCase())??h.unitMeasure??"UNIDAD",f.pricePerUnit=typeof r.pricePerUnit=="number"?Number(r.pricePerUnit):h.pricePerUnit??0):(delete f.unitMeasure,delete f.pricePerUnit);const p=ni(f);if(p)throw new ee(p.message);await ut(d,f)}catch(d){throw new ee("Failed to update product",{cause:d})}}async delete(e){try{this.checkAuth();const r=z(W,`${this.COLLECTION}/${e}`);await jr(r)}catch(r){throw new ee("Failed to delete product",{cause:r})}}subscribeToProviderProducts(e,r){try{this.checkAuth();const n=z(W,this.COLLECTION),a=Gt(n,Yt("providerId"),Kt(e));return Ye(a,o=>{if(!o.exists()){r([]);return}const c=Object.entries(o.val()).map(([l,d])=>({id:l,...d})).sort((l,d)=>l.order-d.order);r(c)})}catch(n){throw new ee("Failed to subscribe to provider products",{cause:n})}}}class rg{constructor(){this.COLLECTION="providers"}async getAll(){try{const e=z(W,this.COLLECTION),r=await _e(e);return r.exists()?Object.entries(r.val()).map(([n,a])=>({id:n,...a})):[]}catch(e){throw new ee("Failed to fetch providers",{cause:e})}}async getById(e){try{const r=z(W,`${this.COLLECTION}/${e}`),n=await _e(r);return n.exists()?{id:e,...n.val()}:null}catch(r){throw new ee("Failed to fetch provider",{cause:r})}}async create(e){try{const r=z(W,this.COLLECTION),n=ht(r);if(!n.key)throw new ee("Failed to generate provider ID");return await ut(n,e),n.key}catch(r){throw new ee("Failed to create provider",{cause:r})}}async update(e,r){try{const n=z(W,`${this.COLLECTION}/${e}`);await ut(n,r)}catch(n){throw new ee("Failed to update provider",{cause:n})}}async delete(e){try{const r=z(W,`${this.COLLECTION}/${e}`);await jr(r)}catch(r){throw new ee("Failed to delete provider",{cause:r})}}subscribeToProviders(e){const r=z(W,this.COLLECTION);return Ye(r,a=>{if(!a.exists()){e([]);return}const i=Object.entries(a.val()).map(([o,c])=>({id:o,...c}));e(i)})}}class ng{constructor(e,r,n,a){this.orderRepository=e,this.productRepository=r,this.providerRepository=n,this.logger=a}calculateOrderStats(e){const r=e.length,n=e.reduce((a,i)=>a+i.total,0);return{total:r,totalAmount:n,averageAmount:r>0?n/r:0,byStatus:{pending:e.filter(a=>a.status==="pending").length,completed:e.filter(a=>a.status==="completed").length}}}calculateProductStats(e,r){const n=new Map;for(const a of e)for(const i of a.items){const o=r.get(i.productId);if(!o)continue;const c=n.get(i.productId)||{name:o.name,totalQuantity:0,totalAmount:0,orderCount:0,lastOrderDate:null};c.totalQuantity+=i.quantity,c.totalAmount+=i.subtotal,c.orderCount++,c.lastOrderDate=Math.max(a.date,c.lastOrderDate||0),n.set(i.productId,c)}return Array.from(n.entries()).map(([a,i])=>({id:a,name:i.name,totalQuantity:i.totalQuantity,totalAmount:i.totalAmount,orderCount:i.orderCount,averageQuantityPerOrder:i.totalQuantity/i.orderCount,lastOrderDate:i.lastOrderDate})).sort((a,i)=>i.totalAmount-a.totalAmount)}calculateProviderStats(e,r){const n=new Map;for(const a of e){if(!r.get(a.providerId))continue;const o=n.get(a.providerId)||{totalOrders:0,totalAmount:0,lastOrderDate:null};o.totalOrders++,o.totalAmount+=a.total,o.lastOrderDate=Math.max(a.date,o.lastOrderDate||0),n.set(a.providerId,o)}return Array.from(n.entries()).map(([a,i])=>{const o=r.get(a);return{id:a,name:o.commercialName,totalOrders:i.totalOrders,totalAmount:i.totalAmount,averageOrderAmount:i.totalAmount/i.totalOrders,lastOrderDate:i.lastOrderDate}}).sort((a,i)=>i.totalAmount-a.totalAmount)}async getDashboardStats(){try{this.logger.debug("Fetching dashboard stats");const[e,r,n]=await Promise.all([this.orderRepository.getAll(),this.productRepository.getAll(),this.providerRepository.getAll()]),a=new Map(r.map(b=>[b.id,b])),i=new Map(n.map(b=>[b.id,b])),o=new Date,c=at(o),l=$l(o),d=Ai(o),u=ki(o),h=e.filter(b=>{const m=new Date(b.date);return m>=Fr(o)&&m<=Rl(o)}),f=e.filter(b=>{const m=new Date(b.date);return m>=c&&m<=l}),p=e.filter(b=>{const m=new Date(b.date);return m>=d&&m<=u}),g={orders:{today:this.calculateOrderStats(h),week:this.calculateOrderStats(f),month:this.calculateOrderStats(p)},topProducts:this.calculateProductStats(e,a).slice(0,10),topProviders:this.calculateProviderStats(e,i).slice(0,5),totals:{products:r.length,providers:n.length,orders:e.length}};return this.logger.debug("Dashboard stats calculated successfully",{todayOrders:g.orders.today.total,weekOrders:g.orders.week.total,monthOrders:g.orders.month.total,topProducts:g.topProducts.length,topProviders:g.topProviders.length}),g}catch(e){throw this.logger.error("Error calculating dashboard stats",e),e}}}class sg{constructor(e,r){this.analyticsService=e,this.logger=r,this.stats={orders:{today:{total:0,totalAmount:0,averageAmount:0,byStatus:{pending:0,completed:0}},week:{total:0,totalAmount:0,averageAmount:0,byStatus:{pending:0,completed:0}},month:{total:0,totalAmount:0,averageAmount:0,byStatus:{pending:0,completed:0}}},topProducts:[],topProductsByTags:[],totals:{products:0,providers:0,orders:0}},this.loading=!0,this.error=null,this.lastUpdate=null,Af(this),this.loadStats()}async loadStats(){try{this.loading=!0,this.error=null,this.logger.info("Loading dashboard stats");const e=await this.analyticsService.getDashboardStats();Kn(()=>{this.stats={orders:e.orders||this.stats.orders,topProducts:e.topProducts||[],topProductsByTags:e.topProductsByTags||[],totals:e.totals||this.stats.totals},this.lastUpdate=Date.now()}),this.logger.debug("Dashboard stats loaded successfully",{todayOrders:e.orders.today.total,weekOrders:e.orders.week.total,monthOrders:e.orders.month.total})}catch(e){Kn(()=>{this.error="Error al cargar las estadísticas"}),this.logger.error("Failed to load dashboard stats",e),E.error(this.error)}finally{Kn(()=>{this.loading=!1})}}get todayOrdersCount(){return this.stats.orders.today.total}get todayOrdersAmount(){return this.stats.orders.today.totalAmount}get weekOrdersCount(){return this.stats.orders.week.total}get weekOrdersAmount(){return this.stats.orders.week.totalAmount}get monthOrdersCount(){return this.stats.orders.month.total}get monthOrdersAmount(){return this.stats.orders.month.totalAmount}get pendingOrdersCount(){return this.stats.orders.today.byStatus.pending}get completedOrdersCount(){return this.stats.orders.today.byStatus.completed}get totalProducts(){return this.stats.totals.products}get totalProviders(){return this.stats.totals.providers}get totalOrders(){return this.stats.totals.orders}get topProducts(){return this.stats.topProducts||[]}get topProductsByTags(){return this.stats.topProductsByTags||[]}get currentDayName(){const e=ve(new Date,"EEEE",{locale:ye});return{lunes:"monday",martes:"tuesday",miércoles:"wednesday",jueves:"thursday",viernes:"friday",sábado:"saturday",domingo:"sunday"}[e]}get formattedLastUpdate(){return this.lastUpdate?ve(this.lastUpdate,"d 'de' MMMM, yyyy HH:mm",{locale:ye}):null}get isStale(){return this.lastUpdate?Date.now()-this.lastUpdate>5*60*1e3:!0}}const Ut=new An;Ut.bind(Ee.Logger).to(Jm).inSingletonScope();Ut.bind(Ee.OrderRepository).to(eg).inSingletonScope();Ut.bind(Ee.ProductRepository).to(tg).inSingletonScope();Ut.bind(Ee.ProviderRepository).to(rg).inSingletonScope();Ut.bind(Ee.AnalyticsService).toDynamicValue(t=>{const e=t.container.get(Ee.OrderRepository),r=t.container.get(Ee.ProductRepository),n=t.container.get(Ee.ProviderRepository),a=t.container.get(Ee.Logger);return new ng(e,r,n,a)}).inSingletonScope();Ut.bind(Ee.DashboardViewModel).toDynamicValue(t=>{const e=t.container.get(Ee.AnalyticsService),r=t.container.get(Ee.Logger);return new sg(e,r)}).inSingletonScope();function ag(){return Ut.get(Ee.DashboardViewModel)}function kr({title:t,icon:e,children:r,loading:n,className:a,onClick:i}){return s.jsx(A,{className:a,onClick:i,children:s.jsx(A.Header,{className:"!p-4",children:s.jsxs("div",{className:"flex items-start justify-between gap-4",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"text-sm font-medium text-gray-600 mb-1",children:t}),n?s.jsx("div",{className:"h-6 w-24 bg-gray-200 rounded animate-pulse"}):s.jsx("div",{className:"break-words",children:r})]}),s.jsx("div",{className:"flex-shrink-0 p-2 bg-blue-100 rounded-lg",children:e})]})})})}function ze({isOpen:t,onClose:e,title:r,children:n,className:a}){return t?s.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:s.jsxs("div",{className:"flex min-h-full items-center justify-center p-4 text-center",children:[s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-25",onClick:e}),s.jsxs("div",{className:Pe("relative transform overflow-hidden rounded-lg bg-white p-6 text-left shadow-xl transition-all w-full max-w-md",a),children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold",children:r}),s.jsx("button",{onClick:e,className:"rounded-full p-1 hover:bg-gray-100",children:s.jsx($t,{className:"w-5 h-5"})})]}),n]})]})}):null}function ig({isOpen:t,onClose:e,products:r}){return s.jsx(ze,{isOpen:t,onClose:e,title:"Top 10 Productos Más Valorados",children:s.jsx("div",{className:"space-y-4",children:r.map((n,a)=>s.jsxs("div",{className:"flex items-start gap-4 p-4 bg-white rounded-lg border transition-colors hover:bg-gray-50",children:[s.jsx("div",{className:"flex-shrink-0 w-8 h-8 flex items-center justify-center rounded-full bg-blue-100 text-blue-600 font-bold",children:a+1}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("h3",{className:"font-medium text-gray-900 truncate",children:n.name}),s.jsxs("div",{className:"mt-2 grid grid-cols-3 gap-2 text-sm text-gray-600",children:[s.jsx("div",{className:"flex items-center gap-1",children:s.jsx("span",{className:"font-medium text-blue-600",children:ne(n.totalAmount)})}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(ot,{className:"w-4 h-4"}),s.jsxs("span",{children:[n.totalQuantity," ",n.purchasePackaging]})]}),s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx(Gr,{className:"w-4 h-4"}),s.jsxs("span",{children:[n.orderCount," órdenes"]})]})]})]})]},n.id))})})}function og({isOpen:t,onClose:e,tagStats:r}){const[n,a]=y.useState(null);return s.jsx(ze,{isOpen:t,onClose:e,title:"Top Productos por Etiquetas",children:s.jsxs("div",{className:"space-y-4",children:[r.map(i=>s.jsxs("div",{className:"bg-white p-4 rounded-lg border transition-colors hover:bg-gray-50",children:[s.jsx("button",{onClick:()=>a(n===i.tag?null:i.tag),className:"w-full",children:s.jsxs("div",{className:"flex items-start justify-between gap-4",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("div",{className:"p-2 rounded-full bg-blue-100",children:s.jsx(pi,{className:"w-4 h-4 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium text-gray-900",children:i.tag}),s.jsxs("p",{className:"text-sm text-gray-500",children:[i.products.length," productos"]})]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"font-medium text-blue-600",children:ne(i.totalAmount)}),s.jsxs("div",{className:"text-sm text-gray-500",children:[i.orderCount," órdenes"]})]})]})}),n===i.tag&&s.jsx("div",{className:"mt-4 space-y-3",children:i.products.map(o=>s.jsxs("div",{className:"flex items-center justify-between gap-4 p-3 bg-gray-50 rounded-lg",children:[s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900",children:o.name}),s.jsxs("div",{className:"flex items-center gap-4 mt-1 text-sm text-gray-600",children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(ot,{className:"w-4 h-4"}),o.totalQuantity," ",o.purchasePackaging]}),s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(Gr,{className:"w-4 h-4"}),o.orderCount," órdenes"]})]})]}),s.jsx("div",{className:"text-right",children:s.jsx("div",{className:"font-medium text-blue-600",children:ne(o.totalAmount)})})]},o.id))})]},i.tag)),r.length===0&&s.jsx("div",{className:"text-center py-8 text-gray-500",children:"No hay datos disponibles"})]})})}function cg({tagStats:t,onClick:e,loading:r}){if(r)return s.jsx(A,{children:s.jsx(A.Header,{className:"!p-4",children:s.jsxs("div",{className:"animate-pulse space-y-3",children:[s.jsx("div",{className:"h-5 bg-gray-200 rounded w-3/4"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})})});if(t.length===0)return null;const n=t[0];return s.jsx(A,{className:e?"cursor-pointer hover:shadow-md transition-shadow":"",onClick:e,children:s.jsx(A.Header,{className:"!p-4",children:s.jsx("div",{className:"flex items-center justify-between gap-4",children:s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsx("div",{className:"p-2 bg-rose-100 rounded-lg",children:s.jsx(pi,{className:"w-5 h-5 text-rose-600"})}),s.jsx("h3",{className:"text-sm font-medium text-gray-600",children:"Productos por Etiquetas"})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-lg font-bold text-gray-900 truncate",children:n.tag}),s.jsxs("span",{className:"px-2 py-0.5 text-xs font-medium rounded-full bg-rose-100 text-rose-700",children:[n.products.length," productos"]})]}),s.jsxs("div",{className:"mt-1 flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(ot,{className:"w-4 h-4"}),s.jsxs("span",{children:[n.totalQuantity," unidades"]})]}),s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(Os,{className:"w-4 h-4"}),s.jsxs("span",{children:[n.orderCount," órdenes"]})]})]})]}),s.jsx("div",{className:"space-y-2",children:n.products.slice(0,3).map(a=>s.jsxs("div",{className:"flex items-center justify-between gap-2 p-2 bg-gray-50 rounded-lg",children:[s.jsxs("div",{className:"min-w-0",children:[s.jsx("div",{className:"font-medium text-sm text-gray-900 truncate",children:a.name}),s.jsxs("div",{className:"text-xs text-gray-600",children:[a.totalQuantity," ",a.purchasePackaging]})]}),s.jsx("div",{className:"text-sm font-medium text-blue-600 whitespace-nowrap",children:ne(a.totalAmount)})]},a.id))}),s.jsx("div",{className:"pt-2 border-t",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:"Total Ventas"}),s.jsx("span",{className:"text-lg font-bold text-blue-600",children:ne(n.totalAmount)})]})})]})]})})})})}function Vt(){const[t,e]=y.useState([]),[r,n]=y.useState(!0);return y.useEffect(()=>{const i=z(W,"products"),o=Ye(i,c=>{if(!c.exists()){e([]),n(!1);return}const l=Object.entries(c.val()).map(([d,u])=>({id:d,...u}));e(l),n(!1)});return()=>o()},[]),{products:t,loading:r,updateProduct:async(i,o)=>{try{const c=z(W,`products/${i}`);await ut(c,o),E.success("Producto actualizado exitosamente")}catch(c){throw console.error("Error updating product:",c),E.error("Error al actualizar el producto"),c}}}}function ar(){const[t,e]=y.useState([]),[r,n]=y.useState(!0);return y.useEffect(()=>{const l=z(W,"providers"),d=Ye(l,u=>{const h=u.val(),f=h?Object.entries(h).map(([p,g])=>({id:p,...g})):[];e(f),n(!1)});return()=>d()},[]),{providers:t,loading:r,addProvider:async l=>{const d=z(W,"providers");await ht(d,l)},updateProvider:async(l,d)=>{const u=z(W,`providers/${l}`);await ut(u,d)},deleteProvider:async l=>{const d=z(W,`providers/${l}`);await jr(d)},getProvider:async l=>{const d=z(W,`providers/${l}`),u=await _e(d);return u.exists()?{id:l,...u.val()}:null}}}class ie extends Error{constructor(e,r){super(e,r),this.name="DatabaseError"}}async function lg(t,e){var r,n,a,i,o;if(!ge.currentUser)throw new ie("User not authenticated");try{const c=z(W,`products/${t}`),l=await _e(c);if(!l.exists())throw new ie("Product not found");const d=l.val(),u={...d,...e,name:((r=e.name)==null?void 0:r.trim().toUpperCase())??d.name,sku:((n=e.sku)==null?void 0:n.trim().toUpperCase())??d.sku,supplierCode:((a=e.supplierCode)==null?void 0:a.trim().toUpperCase())??d.supplierCode??"",purchasePackaging:((i=e.purchasePackaging)==null?void 0:i.trim().toUpperCase())??d.purchasePackaging,salePackaging:((o=e.salePackaging)==null?void 0:o.trim().toUpperCase())??d.salePackaging??"",price:typeof e.price=="number"?Number(e.price):d.price,minPackageStock:typeof e.minPackageStock=="number"?Number(e.minPackageStock):d.minPackageStock,desiredStock:typeof e.desiredStock=="number"?Number(e.desiredStock):d.desiredStock,order:typeof e.order=="number"?Number(e.order):d.order,tags:e.tags??d.tags??[],isProduction:typeof e.isProduction=="boolean"?e.isProduction:d.isProduction};await ut(c,u)}catch(c){throw console.error("Error updating product:",c),new ie("Failed to update product",{cause:c})}}function dg(t){const e=[];let r="",n=!1;for(let a=0;a<t.length;a++){const i=t[a];i==='"'?n&&t[a+1]==='"'?(r+='"',a++):n=!n:i===","&&!n?(e.push(r.trim()),r=""):r+=i}return e.push(r.trim()),e}function ug(t){return t.trim().split(/\r?\n/).map(r=>dg(r))}function hg(t){return t.map(e=>e.toLowerCase().trim().normalize("NFD").replace(/[\u0300-\u036f]/g,""))}function fg(t){const e=ug(t);if(e.length<2)throw new Error("El archivo está vacío o no tiene el formato correcto");const r=hg(e[0]),n=["fecha","rut","codigo","nombre","precio"],a=n.filter(o=>!r.includes(o));if(a.length>0)throw new Error(`Faltan las siguientes columnas: ${a.join(", ")}`);const i=n.map(o=>r.indexOf(o));return e.slice(1).map(o=>{if(o.length<i.length)throw new Error("Número incorrecto de columnas");return{fecha:o[i[0]],rut:o[i[1]],codigo:o[i[2]],nombre:o[i[3]],precio:o[i[4]]}})}function mg(t){const e=t.rut.replace(/\D/g,"");if(!e)return"RUT vacío";if(!/^\d{12}$/.test(e))return"RUT inválido";if(!t.codigo.trim())return"Código vacío";const n=t.precio.replace(/[^\d.,]/g,"").replace(/\./g,"").replace(",","."),a=parseFloat(n);return isNaN(a)||a<0?"Precio inválido":null}function gg(t){let e=t.replace(/[^\d.,]/g,"");e.includes(",")&&(e.indexOf(".")<e.indexOf(",")?e=e.replace(/\./g,"").replace(",","."):e=e.replace(",","."));const r=parseFloat(e);if(isNaN(r))throw new Error(`Precio inválido: ${t}`);return Number(r.toFixed(2))}async function pg(t,e,r){const n={updated:0,errors:[],details:{updatedProducts:[],notFoundProducts:[],invalidRows:[]}};try{if(!t.trim())throw new Error("El archivo está vacío");const a=fg(t);if(a.length===0)throw new Error("No se encontraron datos para procesar");for(const[i,o]of a.entries())try{const c=mg(o);if(c){n.details.invalidRows.push({row:i+2,reason:c});continue}const l=o.rut.replace(/\D/g,""),d=r.find(h=>{var f;return((f=h.rut)==null?void 0:f.replace(/\D/g,""))===l});if(!d){n.details.notFoundProducts.push({code:o.codigo,providerRut:o.rut,csvName:o.nombre});continue}const u=e.find(h=>{var f;return h.providerId===d.id&&((f=h.supplierCode)==null?void 0:f.toLowerCase())===o.codigo.toLowerCase()});if(!u){n.details.notFoundProducts.push({code:o.codigo,providerRut:o.rut,csvName:o.nombre});continue}try{const h=gg(o.precio);Math.abs(u.price-h)>.01&&(await lg(u.id,{price:h}),n.updated++,n.details.updatedProducts.push({name:u.name,oldPrice:u.price,newPrice:h,csvName:o.nombre}))}catch(h){n.details.invalidRows.push({row:i+2,reason:h instanceof Error?h.message:"Precio inválido"})}}catch(c){n.details.invalidRows.push({row:i+2,reason:c instanceof Error?c.message:"Error desconocido"})}return n}catch(a){throw new Error(a instanceof Error?a.message:"Error procesando el archivo")}}function vg({isOpen:t,onClose:e,result:r}){const[n,a]=y.useState(""),i=y.useMemo(()=>{if(!r)return null;const l=n.toLowerCase();return{updatedProducts:r.details.updatedProducts.filter(d=>d.name.toLowerCase().includes(l)||d.csvName.toLowerCase().includes(l)),notFoundProducts:r.details.notFoundProducts.filter(d=>d.code.toLowerCase().includes(l)||d.csvName.toLowerCase().includes(l)||d.providerRut.toLowerCase().includes(l)),invalidRows:r.details.invalidRows.filter(d=>d.reason.toLowerCase().includes(l))}},[r,n]);if(!r||!i)return null;const o=r.updated>0,c=r.errors.length>0;return s.jsx(ze,{isOpen:t,onClose:e,title:"Resultado de la Importación",children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center gap-3 p-4 rounded-lg bg-gray-50",children:[o&&!c?s.jsx(vi,{className:"w-6 h-6 text-green-500 flex-shrink-0"}):c?s.jsx($c,{className:"w-6 h-6 text-amber-500 flex-shrink-0"}):s.jsx(Lc,{className:"w-6 h-6 text-red-500 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium",children:"Resumen de la importación"}),s.jsxs("p",{className:"text-sm text-gray-600",children:[r.updated," producto",r.updated!==1?"s":""," actualizado",r.updated!==1?"s":""]})]})]}),s.jsxs("div",{className:"relative",children:[s.jsx(te,{placeholder:"Buscar en los resultados...",value:n,onChange:l=>a(l.target.value),className:"pl-10"}),s.jsx(kt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"})]}),s.jsxs("div",{className:"space-y-6 max-h-[60vh] overflow-y-auto",children:[i.updatedProducts.length>0&&s.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[s.jsxs("h4",{className:"font-medium text-green-800 mb-3",children:["Productos Actualizados (",i.updatedProducts.length,")"]}),s.jsx("div",{className:"space-y-3",children:i.updatedProducts.map((l,d)=>s.jsxs("div",{className:"bg-white rounded-lg p-3 shadow-sm",children:[s.jsx("div",{className:"font-medium text-green-700",children:l.name}),s.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:["Nombre en CSV: ",l.csvName]}),s.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:["Precio anterior: $",l.oldPrice.toFixed(2)," → Nuevo precio: $",l.newPrice.toFixed(2)]})]},d))})]}),i.notFoundProducts.length>0&&s.jsxs("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:[s.jsxs("h4",{className:"font-medium text-amber-800 mb-3",children:["Productos no encontrados (",i.notFoundProducts.length,")"]}),s.jsx("div",{className:"space-y-3",children:i.notFoundProducts.map((l,d)=>s.jsxs("div",{className:"bg-white rounded-lg p-3 shadow-sm",children:[s.jsxs("div",{className:"font-medium text-amber-700",children:["Código: ",l.code]}),s.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:["Nombre en CSV: ",l.csvName]}),s.jsxs("div",{className:"text-sm text-gray-600",children:["RUT Proveedor: ",l.providerRut]})]},d))})]}),i.invalidRows.length>0&&s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[s.jsxs("h4",{className:"font-medium text-red-800 mb-3",children:["Filas con errores (",i.invalidRows.length,")"]}),s.jsx("div",{className:"space-y-3",children:i.invalidRows.map((l,d)=>s.jsxs("div",{className:"bg-white rounded-lg p-3 shadow-sm",children:[s.jsxs("div",{className:"font-medium text-red-700",children:["Fila ",l.row]}),s.jsx("div",{className:"text-sm text-gray-600 mt-1",children:l.reason})]},d))})]})]}),s.jsx("div",{className:"flex justify-end",children:s.jsx(I,{onClick:e,children:"Cerrar"})})]})})}function bg(){const t=y.useRef(null),[e,r]=y.useState(!1),[n,a]=y.useState(null),[i,o]=y.useState(!1),{products:c,loading:l}=Vt(),{providers:d,loading:u}=ar(),h=async p=>{var b;const g=(b=p.target.files)==null?void 0:b[0];if(g){if(!g.name.toLowerCase().endsWith(".csv")){E.error("El archivo debe ser de tipo CSV");return}r(!0);try{const m=await g.text(),w=await pg(m,c,d);a(w),o(!0),w.updated>0&&E.success(`${w.updated} productos actualizados`)}catch(m){E.error(m instanceof Error?m.message:"Error al procesar el archivo")}finally{r(!1),t.current&&(t.current.value="")}}},f=()=>{var p;(p=t.current)==null||p.click()};return l||u?s.jsx(A,{children:s.jsx(A.Header,{className:"!p-4",children:s.jsxs("div",{className:"animate-pulse",children:[s.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),s.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]})})}):s.jsxs(s.Fragment,{children:[s.jsx(A,{children:s.jsxs(A.Header,{className:"!p-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{children:s.jsx("h3",{className:"text-lg font-bold mt-1",children:"Actualizar Precios"})}),s.jsx("div",{className:"p-2 bg-violet-100 rounded-lg",children:s.jsx(Bc,{className:"w-5 h-5 text-violet-600"})})]}),s.jsxs("div",{className:"mt-4",children:[s.jsx("input",{ref:t,type:"file",accept:".csv",onChange:h,className:"hidden"}),s.jsx(I,{onClick:f,isLoading:e,className:"w-full",children:e?"Procesando...":"Seleccionar Archivo"}),s.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Formato: Fecha, RUT, Código, Nombre, Precio"})]})]})}),s.jsx(vg,{isOpen:i,onClose:()=>o(!1),result:n})]})}const xg=hm(()=>{const t=ag(),[e,r]=y.useState(!1),[n,a]=y.useState(!1),[i,o]=y.useState(!1),c=async()=>{o(!0),await t.loadStats(),o(!1)},l=t.topProducts[0];return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard"}),s.jsxs(I,{variant:"outline",size:"sm",onClick:c,disabled:t.loading||i,className:"gap-2",children:[s.jsx(Ps,{className:`w-4 h-4 ${i?"animate-spin":""}`}),"Actualizar"]})]}),s.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[s.jsx(A,{children:s.jsx(A.Header,{className:"!p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-2xl font-bold capitalize",children:ve(new Date,"EEEE",{locale:ye})}),s.jsx("div",{className:"text-sm text-gray-600 mt-1",children:ve(new Date,"dd/MM/yyyy")})]}),s.jsx("div",{className:"p-2 bg-orange-100 rounded-lg",children:s.jsx(Yr,{className:"w-5 h-5 text-orange-600"})})]})})}),s.jsx(kr,{title:"Total Productos",icon:s.jsx(ks,{className:"w-5 h-5 text-indigo-600"}),loading:t.loading,children:s.jsx("h3",{className:"text-2xl font-bold mt-1",children:t.totalProducts})}),s.jsx(kr,{title:"Total Proveedores",icon:s.jsx(gi,{className:"w-5 h-5 text-emerald-600"}),loading:t.loading,children:s.jsx("h3",{className:"text-2xl font-bold mt-1",children:t.totalProviders})}),s.jsx(kr,{title:"Total Órdenes",icon:s.jsx(Gr,{className:"w-5 h-5 text-amber-600"}),loading:t.loading,children:s.jsx("h3",{className:"text-2xl font-bold mt-1",children:t.totalOrders})}),s.jsx(A,{children:s.jsx(A.Header,{className:"!p-4",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pedidos Hoy"}),s.jsx("h3",{className:"text-2xl font-bold mt-1",children:t.loading?s.jsx("span",{className:"text-gray-400",children:"..."}):t.todayOrdersCount}),s.jsx("div",{className:"text-sm text-gray-500 mt-1",children:ne(t.todayOrdersAmount)})]}),s.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:s.jsx(ot,{className:"w-5 h-5 text-purple-600"})})]})})}),s.jsxs(kr,{title:"Órdenes Semanales",icon:s.jsx(Uc,{className:"w-5 h-5 text-blue-600"}),loading:t.loading,children:[s.jsx("h3",{className:"text-2xl font-bold mt-1",children:t.weekOrdersCount}),s.jsx("div",{className:"text-sm text-gray-500 mt-1",children:ne(t.weekOrdersAmount)})]}),s.jsx(kr,{title:"Producto Más Valorado",icon:s.jsx(Os,{className:"w-5 h-5 text-green-600"}),loading:t.loading,className:"cursor-pointer hover:shadow-md transition-shadow",onClick:()=>r(!0),children:l&&s.jsxs("div",{className:"mt-1",children:[s.jsx("h3",{className:"text-lg font-bold break-words",children:l.name}),s.jsxs("div",{className:"flex items-center justify-between mt-1",children:[s.jsx("span",{className:"text-lg font-bold text-blue-600",children:ne(l.totalAmount)}),s.jsxs("span",{className:"text-sm text-gray-500",children:[l.totalQuantity," unidades"]})]})]})}),s.jsx(cg,{tagStats:t.topProductsByTags,loading:t.loading,onClick:()=>a(!0)}),s.jsx(bg,{})]}),s.jsx(ig,{isOpen:e,onClose:()=>r(!1),products:t.topProducts}),s.jsx(og,{isOpen:n,onClose:()=>a(!1),tagStats:t.topProductsByTags}),t.formattedLastUpdate&&s.jsxs("div",{className:"text-center text-sm text-gray-500",children:["Última actualización: ",t.formattedLastUpdate,t.isStale&&s.jsx("span",{className:"text-amber-500 ml-2",children:"(Datos desactualizados)"})]})]})}),si=[{value:"monday",label:"Lunes"},{value:"tuesday",label:"Martes"},{value:"wednesday",label:"Miércoles"},{value:"thursday",label:"Jueves"},{value:"friday",label:"Viernes"},{value:"saturday",label:"Sábado"},{value:"sunday",label:"Domingo"}],yg=Array.from({length:31},(t,e)=>e+1);function wg({initialData:t,onSubmit:e,onCancel:r,isLoading:n}){const[a,i]=pn.useState({commercialName:(t==null?void 0:t.commercialName)||"",legalName:(t==null?void 0:t.legalName)||"",rut:(t==null?void 0:t.rut)||"",phone:(t==null?void 0:t.phone)||"",deliveryDays:(t==null?void 0:t.deliveryDays)||[],orderDays:(t==null?void 0:t.orderDays)||[],billingType:(t==null?void 0:t.billingType)||"weekly",billingDays:(t==null?void 0:t.billingDays)||[]}),[o,c]=y.useState(""),l=p=>{let g=p.target.value;g=g.replace(/\D/g,""),g.startsWith("598")&&(g=g.slice(3)),g=g.slice(0,9),i(b=>({...b,phone:g})),g&&!ja(g)?c("Ingrese un número de celular válido de Uruguay (8 o 9 dígitos)"):c("")},d=async p=>{if(p.preventDefault(),a.phone&&!ja(a.phone)){c("Ingrese un número de celular válido de Uruguay (8 o 9 dígitos)");return}await e(a)},u=(p,g)=>{i(b=>{var m,w;return{...b,[g==="delivery"?"deliveryDays":"orderDays"]:(m=b[g==="delivery"?"deliveryDays":"orderDays"])!=null&&m.includes(p)?(w=b[g==="delivery"?"deliveryDays":"orderDays"])==null?void 0:w.filter(v=>v!==p):[...b[g==="delivery"?"deliveryDays":"orderDays"]||[],p]}})},h=p=>{i(g=>({...g,billingDays:[p]}))},f=a.phone?Ri(a.phone):"";return s.jsxs("form",{onSubmit:d,className:"space-y-6",children:[s.jsx(te,{label:"Nombre comercial",value:a.commercialName,onChange:p=>i(g=>({...g,commercialName:p.target.value})),required:!0}),s.jsx(te,{label:"Razón social",value:a.legalName,onChange:p=>i(g=>({...g,legalName:p.target.value}))}),s.jsx(te,{label:"RUT",value:a.rut,onChange:p=>i(g=>({...g,rut:p.target.value}))}),s.jsxs("div",{children:[s.jsx(te,{label:"Celular",type:"tel",value:a.phone,onChange:l,error:o,placeholder:"93609319"}),a.phone&&s.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:["Se guardará como: ",f]})]}),s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Tipo de Facturación"}),s.jsxs("div",{className:"flex gap-4",children:[s.jsxs("label",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"radio",checked:a.billingType==="weekly",onChange:()=>i(p=>({...p,billingType:"weekly",billingDays:[]})),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),s.jsx("span",{children:"Semanal"})]}),s.jsxs("label",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"radio",checked:a.billingType==="monthly",onChange:()=>i(p=>({...p,billingType:"monthly",billingDays:[]})),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),s.jsx("span",{children:"Mensual"})]})]})]}),a.billingType==="monthly"&&s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Día de facturación"}),s.jsx("div",{className:"grid grid-cols-7 gap-2",children:yg.map(p=>{var g;return s.jsx("button",{type:"button",onClick:()=>h(p),className:`
                    px-2 py-1 text-sm font-medium rounded-md transition-colors
                    ${(g=a.billingDays)!=null&&g.includes(p)?"bg-blue-100 text-blue-800 hover:bg-blue-200":"bg-gray-50 text-gray-600 hover:bg-gray-100"}
                  `,children:p},p)})})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Días de pedido"}),s.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-7 gap-2",children:si.map(({value:p,label:g})=>{var b;return s.jsx("button",{type:"button",onClick:()=>u(p,"order"),className:`
                  px-3 py-2 text-sm font-medium rounded-md transition-colors
                  ${(b=a.orderDays)!=null&&b.includes(p)?"bg-blue-100 text-blue-800 hover:bg-blue-200":"bg-gray-50 text-gray-600 hover:bg-gray-100"}
                `,children:g},p)})})]}),s.jsxs("div",{className:"space-y-3",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Días de entrega"}),s.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-7 gap-2",children:si.map(({value:p,label:g})=>{var b;return s.jsx("button",{type:"button",onClick:()=>u(p,"delivery"),className:`
                  px-3 py-2 text-sm font-medium rounded-md transition-colors
                  ${(b=a.deliveryDays)!=null&&b.includes(p)?"bg-green-100 text-green-800 hover:bg-green-200":"bg-gray-50 text-gray-600 hover:bg-gray-100"}
                `,children:g},p)})})]})]}),s.jsxs("div",{className:"flex justify-end space-x-4",children:[s.jsx(I,{type:"button",variant:"outline",onClick:r,children:"Cancelar"}),s.jsxs(I,{type:"submit",isLoading:n,children:[t?"Actualizar":"Crear"," Proveedor"]})]})]})}function jg(){const{providers:t,loading:e,addProvider:r,updateProvider:n,deleteProvider:a}=ar(),[i,o]=y.useState(!1),[c,l]=y.useState(null),[d,u]=y.useState(!1),[h,f]=y.useState(null),p=async j=>{u(!0);try{c?(await n(c.id,j),E.success("Proveedor actualizado exitosamente")):(await r(j),E.success("Proveedor creado exitosamente")),m()}catch{E.error("Ocurrió un error al guardar el proveedor")}finally{u(!1)}},g=async j=>{f(j)},b=async()=>{if(h)try{await a(h.id),E.success("Proveedor eliminado exitosamente"),f(null)}catch{E.error("Ocurrió un error al eliminar el proveedor")}},m=()=>{o(!1),l(null)},w=j=>{l(j),o(!0)},v=()=>{if(c){const j=ze({isOpen:!0,onClose:()=>{},title:"Advertencia",children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-amber-600",children:"Hay un proveedor en edición. ¿Desea cancelar los cambios y crear uno nuevo?"}),s.jsxs("div",{className:"flex justify-end space-x-2",children:[s.jsx(I,{variant:"outline",onClick:()=>j.close(),children:"Cancelar"}),s.jsx(I,{onClick:()=>{l(null),o(!0),j.close()},children:"Continuar"})]})]})})}else o(!0)};return e?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):i||c?s.jsxs("div",{className:"bg-white p-4 md:p-6 rounded-lg shadow",children:[s.jsxs("h2",{className:"text-xl font-semibold mb-4",children:[c?"Editar":"Nuevo"," Proveedor"]}),s.jsx(wg,{initialData:c||void 0,onSubmit:p,onCancel:m,isLoading:d})]}):s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex justify-end",children:s.jsxs(I,{onClick:v,children:[s.jsx(wr,{className:"w-4 h-4 mr-2"}),"Nuevo Proveedor"]})}),s.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:t.map(j=>s.jsxs("div",{className:"bg-white p-4 md:p-6 rounded-lg shadow-sm space-y-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("h3",{className:"text-lg font-semibold break-words",children:j.commercialName}),j.legalName&&s.jsx("p",{className:"text-sm text-gray-600 break-words",children:j.legalName}),j.rut&&s.jsxs("p",{className:"text-sm text-gray-600",children:["RUT: ",j.rut]}),j.phone&&s.jsxs("p",{className:"text-sm text-gray-600",children:["Celular: ",Ri(j.phone)]})]}),s.jsxs("div",{className:"flex flex-wrap gap-2 items-center justify-between",children:[s.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.jsxs(I,{variant:"outline",size:"sm",onClick:()=>w(j),children:[s.jsx(As,{className:"w-4 h-4 mr-2"}),"Editar"]}),s.jsxs(I,{variant:"outline",size:"sm",onClick:()=>g(j),children:[s.jsx(Kr,{className:"w-4 h-4 mr-2"}),"Eliminar"]})]}),j.phone&&s.jsx("a",{href:Ii(j.phone,""),target:"_blank",rel:"noopener noreferrer",children:s.jsx(I,{variant:"ghost",size:"sm",children:s.jsx(Vc,{className:"w-4 h-4"})})})]})]},j.id))}),s.jsx(ze,{isOpen:!!h,onClose:()=>f(null),title:"Eliminar proveedor",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("p",{className:"text-amber-600",children:['¿Está seguro que desea eliminar el proveedor "',h==null?void 0:h.commercialName,'"?']}),s.jsxs("div",{className:"flex justify-end space-x-2",children:[s.jsx(I,{variant:"outline",onClick:()=>f(null),children:"Cancelar"}),s.jsx(I,{onClick:b,children:"Eliminar"})]})]})})]})}function ic({providers:t,selectedProviderId:e,onChange:r}){const[n,a]=y.useState(!1),[i,o]=y.useState(""),c=t.find(f=>f.id===e),l=y.useRef(null);y.useEffect(()=>{const f=p=>{l.current&&!l.current.contains(p.target)&&a(!1)};return document.addEventListener("mousedown",f),()=>document.removeEventListener("mousedown",f)},[]);const d=t.filter(f=>{var p;return f.commercialName.toLowerCase().includes(i.toLowerCase())||((p=f.legalName)==null?void 0:p.toLowerCase().includes(i.toLowerCase()))}),u=f=>{r(f),a(!1),o("")},h=f=>{f.stopPropagation(),r(""),o("")};return s.jsxs("div",{className:"relative",ref:l,children:[s.jsx("div",{className:"mb-2",children:s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Proveedor"})}),s.jsx("div",{role:"button",tabIndex:0,onClick:()=>a(!n),onKeyDown:f=>{(f.key==="Enter"||f.key===" ")&&a(!n)},className:Pe("relative w-full rounded-lg border bg-white px-4 py-3 h-[48px] cursor-pointer","focus:outline-none focus:ring-2 focus:ring-blue-500",e?"border-blue-200 hover:border-blue-300":"border-gray-200 hover:border-gray-300","transition-all duration-200 flex items-center"),children:s.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[s.jsx(bi,{className:`
            w-5 h-5 flex-shrink-0
            ${e?"text-blue-500":"text-gray-400"}
          `}),s.jsx("div",{className:"flex-1 min-w-0",children:c?s.jsxs("div",{children:[s.jsx("div",{className:"font-medium text-gray-900 truncate",children:c.commercialName}),c.legalName&&c.legalName!==c.commercialName&&s.jsx("div",{className:"text-sm text-gray-500 truncate",children:c.legalName})]}):s.jsx("span",{className:"text-gray-500",children:"Seleccionar proveedor..."})}),s.jsxs("div",{className:"flex items-center gap-2",children:[e&&s.jsx("div",{role:"button",tabIndex:0,onClick:h,onKeyDown:f=>{(f.key==="Enter"||f.key===" ")&&h(f)},className:"p-1 hover:bg-gray-100 rounded-full transition-colors cursor-pointer",children:s.jsx($t,{className:"w-4 h-4 text-gray-400"})}),s.jsx(zc,{className:`
              w-5 h-5 transition-transform duration-200
              ${e?"text-blue-500":"text-gray-400"}
              ${n?"rotate-180":""}
            `})]})]})}),n&&s.jsxs("div",{className:"absolute z-10 mt-2 w-full rounded-lg bg-white shadow-lg border border-gray-200",children:[s.jsx("div",{className:"p-2 border-b",children:s.jsxs("div",{className:"relative",children:[s.jsx(kt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),s.jsx("input",{type:"text",value:i,onChange:f=>o(f.target.value),placeholder:"Buscar proveedor...",className:`
                  w-full rounded-md border border-gray-200 pl-9 pr-4 py-2 text-sm
                  placeholder-gray-400 focus:border-blue-500 focus:ring-1 focus:ring-blue-500
                `})]})}),s.jsx("div",{className:"max-h-60 overflow-auto",children:d.length>0?s.jsx("div",{className:"py-1",children:d.map(f=>s.jsxs("div",{role:"button",tabIndex:0,onClick:()=>u(f.id),onKeyDown:p=>{(p.key==="Enter"||p.key===" ")&&u(f.id)},className:Pe("px-4 py-2 cursor-pointer hover:bg-gray-50 transition-colors",f.id===e&&"bg-blue-50"),children:[s.jsx("div",{className:"font-medium text-gray-900",children:f.commercialName}),f.legalName&&f.legalName!==f.commercialName&&s.jsx("div",{className:"text-sm text-gray-500",children:f.legalName})]},f.id))}):s.jsx("div",{className:"px-4 py-3 text-sm text-gray-500 text-center",children:"No se encontraron proveedores"})})]})]})}function oc(t){const[e,r]=y.useState([]),[n,a]=y.useState(!0),i=Ut.get(Ee.ProductRepository);return y.useEffect(()=>{if(!t){r([]),a(!1);return}const d=i.subscribeToProviderProducts(t,u=>{r(u),a(!1)});return()=>d()},[t,i]),{products:e,loading:n,addProduct:async d=>{try{await i.create(d),E.success("Producto creado exitosamente")}catch(u){throw console.error("Error creating product:",u),u}},updateProduct:async(d,u)=>{try{await i.update(d,u),E.success("Producto actualizado exitosamente")}catch(h){throw console.error("Error updating product:",h),h}},deleteProduct:async d=>{try{await i.delete(d),E.success("Producto eliminado exitosamente")}catch(u){throw console.error("Error deleting product:",u),u}}}}function ai({product:t,onEdit:e,onDelete:r}){return s.jsx("div",{className:"bg-gradient-to-br from-gray-50 to-white rounded-lg border border-gray-200 shadow-sm hover:shadow-md transition-shadow p-4",children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"flex items-start justify-between gap-2",children:s.jsxs("h3",{className:"text-lg font-semibold text-gray-900 truncate",children:[t.name,t.isProduction&&s.jsxs("span",{className:"ml-2 inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-amber-100 text-amber-800",children:[s.jsx(vr,{className:"w-3 h-3 mr-1"}),"Producción"]})]})}),s.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm text-gray-600",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(ot,{className:"w-4 h-4 mr-1.5 flex-shrink-0 text-gray-500"}),s.jsx("span",{className:"truncate",children:t.purchasePackaging})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx(ks,{className:"w-4 h-4 mr-1.5 flex-shrink-0 text-gray-500"}),s.jsxs("span",{children:["Stock: ",t.minPackageStock," - ",t.desiredStock]})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx(Es,{className:"w-4 h-4 mr-1.5 flex-shrink-0 text-gray-500"}),s.jsx("span",{className:"truncate",children:t.supplierCode||"Sin código"})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx(Ms,{className:"w-4 h-4 mr-1.5 text-gray-400"}),s.jsx("span",{children:zi(t.order)})]})]}),s.jsxs("div",{className:"flex items-center justify-between gap-2 pt-2 border-t",children:[s.jsx("div",{className:"text-xl font-bold text-blue-600",children:ne(t.price)}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(I,{variant:"outline",size:"sm",onClick:()=>e(t),children:[s.jsx(As,{className:"w-4 h-4 mr-2"}),"Editar"]}),s.jsxs(I,{variant:"outline",size:"sm",onClick:()=>r(t),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:[s.jsx(Kr,{className:"w-4 h-4 mr-2"}),"Eliminar"]})]})]})]})})}function _g(t){const[e,r]=y.useState(!1);return y.useEffect(()=>{const n=window.matchMedia(t);r(n.matches);const a=i=>{r(i.matches)};return n.addEventListener("change",a),()=>n.removeEventListener("change",a)},[t]),e}function Ng({products:t,onEdit:e,onDelete:r}){const n=_g("(min-width: 1024px)"),a=[...t].sort((i,o)=>i.order-o.order);return n?s.jsx("div",{className:"grid grid-cols-2 xl:grid-cols-3 2xl:grid-cols-4 gap-4",children:a.map(i=>s.jsx(ai,{product:i,onEdit:e,onDelete:r},i.id))}):s.jsx("div",{className:"space-y-4",children:a.map(i=>s.jsx(ai,{product:i,onEdit:e,onDelete:r},i.id))})}function Sg({onProductSelect:t}){const[e,r]=y.useState(""),[n,a]=y.useState([]),{products:i,loading:o}=Vt();return y.useEffect(()=>{if(!e.trim()){a([]);return}const c=e.toLowerCase(),l=i.filter(d=>{var u,h;return d.name.toLowerCase().includes(c)||d.sku.toLowerCase().includes(c)||((u=d.supplierCode)==null?void 0:u.toLowerCase().includes(c))||((h=d.tags)==null?void 0:h.some(f=>f.toLowerCase().includes(c)))}).sort((d,u)=>{const h=d.name.toLowerCase().startsWith(c),f=u.name.toLowerCase().startsWith(c);return h&&!f?-1:!h&&f?1:d.name.localeCompare(u.name)}).slice(0,5);a(l)},[e,i]),s.jsxs("div",{className:"relative mb-6",children:[s.jsxs("div",{className:"relative",children:[s.jsx(te,{placeholder:"Buscar productos globalmente...",value:e,onChange:c=>r(c.target.value),className:"pl-10"}),s.jsx(kt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"})]}),n.length>0&&s.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-auto",children:n.map(c=>s.jsx("button",{onClick:()=>t(c),className:"w-full px-4 py-2 text-left hover:bg-gray-50",children:s.jsxs("div",{className:"flex items-center justify-between gap-4",children:[s.jsxs("div",{className:"min-w-0",children:[s.jsx("div",{className:"font-medium text-gray-900 truncate",children:c.name}),s.jsxs("div",{className:"text-sm text-gray-500",children:["SKU: ",c.sku,c.supplierCode&&s.jsxs("span",{className:"ml-2",children:["• Código: ",c.supplierCode]})]})]}),s.jsx("div",{className:"text-blue-600 font-medium whitespace-nowrap",children:ne(c.price)})]})},c.id))}),e&&n.length===0&&!o&&s.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg p-4 text-center text-gray-500",children:"No se encontraron productos"})]})}function Cg({products:t,onFilter:e}){const[r,n]=y.useState(""),[a,i]=y.useState(!1);y.useEffect(()=>{const c=r.toLowerCase(),d=t.filter(u=>{var h,f;return a&&!u.isProduction?!1:!c&&!a?!0:u.name.toLowerCase().includes(c)||u.sku.toLowerCase().includes(c)||((h=u.supplierCode)==null?void 0:h.toLowerCase().includes(c))||((f=u.tags)==null?void 0:f.some(p=>p.toLowerCase().includes(c)))}).sort((u,h)=>{if(a){if(u.isProduction&&!h.isProduction)return-1;if(!u.isProduction&&h.isProduction)return 1}return u.name.localeCompare(h.name)});e(d,r.length>0||a)},[r,a,t,e]);const o=t.filter(c=>c.isProduction).length;return s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(te,{placeholder:"Filtrar productos...",value:r,onChange:c=>n(c.target.value),className:"pl-10"}),s.jsx(kt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"})]}),s.jsxs(I,{variant:a?"primary":"outline",onClick:()=>i(!a),className:"flex items-center gap-2 min-w-[140px] justify-center",title:a?"Mostrar todos":"Solo producción",children:[s.jsx(xi,{className:"w-4 h-4"}),s.jsxs("span",{className:"text-sm",children:["Producción (",o,")"]})]})]})}function Og({label:t,value:e=[],onChange:r,suggestions:n=[],error:a,className:i}){const[o,c]=y.useState(""),[l,d]=y.useState(!1),u=y.useRef(null),h=y.useRef(null);y.useEffect(()=>{const v=j=>{h.current&&!h.current.contains(j.target)&&d(!1)};return document.addEventListener("mousedown",v),()=>document.removeEventListener("mousedown",v)},[]);const f=v=>{c(v.target.value.toUpperCase()),d(!0)},p=v=>{v.key==="Enter"&&o.trim()?(v.preventDefault(),g(o.trim())):v.key==="Backspace"&&!o&&e.length>0&&b(e[e.length-1])},g=v=>{const j=v.toUpperCase();e.includes(j)||r([...e,j]),c(""),d(!1)},b=v=>{r(e.filter(j=>j!==v))},m=v=>{var j;g(v),(j=u.current)==null||j.focus()},w=n.filter(v=>!e.includes(v)&&v.includes(o.toUpperCase()));return s.jsxs("div",{ref:h,className:"relative",children:[t&&s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:t}),s.jsxs("div",{className:Pe("flex flex-wrap items-center gap-2 min-h-[42px] w-full rounded-lg border border-gray-300 bg-white px-3 py-1.5","focus-within:border-blue-500 focus-within:ring-1 focus-within:ring-blue-500",a&&"border-red-500 focus-within:border-red-500 focus-within:ring-red-500",i),children:[e.map(v=>s.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-sm bg-blue-100 text-blue-800",children:[v,s.jsx("button",{type:"button",onClick:()=>b(v),className:"ml-1 p-0.5 hover:bg-blue-200 rounded-full transition-colors",children:s.jsx($t,{className:"w-3 h-3"})})]},v)),s.jsx("div",{className:"flex-1 min-w-[120px]",children:s.jsx("input",{ref:u,type:"text",className:"w-full outline-none bg-transparent text-gray-900 placeholder-gray-500 text-sm",value:o,onChange:f,onKeyDown:p,onFocus:()=>d(!0),placeholder:"Agregar etiqueta..."})})]}),a&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:a}),l&&o&&w.length>0&&s.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-60 overflow-auto",children:w.map(v=>s.jsxs("button",{type:"button",className:"w-full px-4 py-2 text-left text-sm hover:bg-gray-100 focus:bg-gray-100 focus:outline-none flex items-center gap-2",onClick:()=>m(v),children:[s.jsx(wr,{className:"w-4 h-4 text-gray-400"}),v]},v))})]})}function Pg(){const[t,e]=y.useState([]),[r,n]=y.useState(!0);return y.useEffect(()=>{const i=z(W,"measures"),o=Ye(i,c=>{const l=c.val(),d=l?Object.values(l):[];e([...d].sort()),n(!1)});return()=>o()},[]),{measures:t,loading:r,addMeasure:async i=>{const o=z(W,"measures"),c=ht(o);await _t(c,i.toUpperCase())}}}function os({value:t,onChange:e,required:r,className:n,label:a,placeholder:i="Seleccionar..."}){const{measures:o,loading:c}=Pg();return s.jsxs("div",{className:"space-y-2",children:[a&&s.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[a,r&&s.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),s.jsxs("select",{value:t,onChange:l=>e(l.target.value),required:r,disabled:c,className:Pe("w-full rounded-md border border-gray-300 px-3 py-2 text-gray-900","focus:border-blue-500 focus:ring-1 focus:ring-blue-500","disabled:bg-gray-50 disabled:text-gray-500",n),children:[s.jsx("option",{value:"",disabled:!0,children:c?"Cargando...":i}),!c&&o.map(l=>s.jsx("option",{value:l,children:l},l))]})]})}function kg(){const[t,e]=y.useState([]),[r,n]=y.useState(!0);return y.useEffect(()=>{const i=z(W,"tags"),o=z(W,"products"),c=Ye(i,d=>{const u=d.val(),h=u?Object.values(u):[];e(h.sort()),n(!1)}),l=Ye(o,d=>{const u=d.val();if(u){const h=Object.values(u).flatMap(f=>f.tags||[]).filter(Boolean).map(f=>f.toUpperCase());e(f=>[...new Set([...f,...h])].sort())}});return()=>{c(),l()}},[]),{tags:t,loading:r,addTag:async i=>{const o=z(W,"tags"),c=ht(o);await _t(c,i.toUpperCase())}}}const un="M",cs=4;function Ag(){const[t,e]=y.useState(""),[r,n]=y.useState(!0);return y.useEffect(()=>{(async()=>{try{const i=z(W,"products"),o=await _e(i);if(!o.exists()){e(`${un}${"0".repeat(cs-1)}1`);return}const c=Object.values(o.val()),l=new RegExp(`^${un}\\d{${cs}}$`),d=c.map(f=>f.sku).filter(f=>l.test(f)).map(f=>parseInt(f.slice(un.length))),h=(d.length>0?Math.max(...d)+1:1).toString().padStart(cs,"0");e(`${un}${h}`)}catch(i){console.error("Error generating SKU suggestion:",i),e("")}finally{n(!1)}})()},[]),{suggestedSku:t,loading:r}}const ii={GRL:{bg:"bg-gray-100",border:"border-gray-200",text:"text-gray-800"},GFR:{bg:"bg-green-100",border:"border-green-200",text:"text-green-800"},GRE:{bg:"bg-emerald-100",border:"border-emerald-200",text:"text-emerald-800"},GTM:{bg:"bg-teal-100",border:"border-teal-200",text:"text-teal-800"},GPA:{bg:"bg-amber-100",border:"border-amber-200",text:"text-amber-800"},GSC:{bg:"bg-orange-100",border:"border-orange-200",text:"text-orange-800"},HEL:{bg:"bg-blue-100",border:"border-blue-200",text:"text-blue-800"},REF:{bg:"bg-indigo-100",border:"border-indigo-200",text:"text-indigo-800"},CON:{bg:"bg-purple-100",border:"border-purple-200",text:"text-purple-800"},FRU:{bg:"bg-rose-100",border:"border-rose-200",text:"text-rose-800"}};function Eg(t){return ii[t]||ii.GRL}function cc({providerId:t,initialData:e,onSubmit:r,onCancel:n,isLoading:a,onDirtyChange:i}){const{providers:o}=ar(),{tags:c,addTag:l}=kg(),{suggestedSku:d}=Ag(),[u,h]=y.useState({name:(e==null?void 0:e.name)||"",sku:(e==null?void 0:e.sku)||"",supplierCode:(e==null?void 0:e.supplierCode)||"",purchasePackaging:(e==null?void 0:e.purchasePackaging)||"",salePackaging:(e==null?void 0:e.salePackaging)||"",order:(e==null?void 0:e.order)||0,price:(e==null?void 0:e.price)||0,desiredStock:(e==null?void 0:e.desiredStock)||0,minPackageStock:(e==null?void 0:e.minPackageStock)||0,providerId:(e==null?void 0:e.providerId)||t,tags:(e==null?void 0:e.tags)||[],isProduction:(e==null?void 0:e.isProduction)||!1,unitMeasure:(e==null?void 0:e.unitMeasure)||"UNIDAD",pricePerUnit:(e==null?void 0:e.pricePerUnit)||0}),f=(m,w)=>{h(v=>{const j={[m]:w};return m==="isProduction"&&w===!0&&(j.unitMeasure=v.unitMeasure||"UNIDAD"),{...v,...j}})},p=async m=>{m.preventDefault(),await r(u)},g=m=>{f("name",m.target.value.toUpperCase())},b=Eg(Vi(u.order));return s.jsxs("form",{onSubmit:p,className:"space-y-6",children:[s.jsxs(A,{children:[s.jsx(A.Header,{children:s.jsx(A.Title,{children:"Información Básica"})}),s.jsxs(A.Content,{className:"space-y-4",children:[s.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[s.jsx(te,{label:"Nombre del producto",value:u.name,onChange:m=>f("name",m.target.value),onBlur:g,required:!0}),s.jsx(te,{label:!e&&d?`SKU (Sugerido: ${d})`:"SKU",value:u.sku,onChange:m=>f("sku",m.target.value.toUpperCase()),required:!0})]}),s.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Proveedor"}),s.jsx("select",{value:u.providerId,onChange:m=>f("providerId",m.target.value),className:"w-full rounded-md border border-gray-300 px-3 py-2 text-gray-900 focus:border-blue-500 focus:ring-1 focus:ring-blue-500",children:o.map(m=>s.jsx("option",{value:m.id,children:m.commercialName},m.id))})]}),s.jsx(te,{label:"Código de proveedor",value:u.supplierCode,onChange:m=>f("supplierCode",m.target.value.toUpperCase()),placeholder:"Código asignado por el proveedor"})]}),s.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[s.jsx(os,{label:"Empaque de Compra",value:u.purchasePackaging,onChange:m=>f("purchasePackaging",m),required:!0,placeholder:"Seleccionar empaque de compra"}),s.jsx(os,{label:"Empaque de Venta",value:u.salePackaging,onChange:m=>f("salePackaging",m),placeholder:"Seleccionar empaque de venta"})]})]})]}),s.jsxs(A,{children:[s.jsx(A.Header,{children:s.jsx(A.Title,{children:"Material de Producción"})}),s.jsx(A.Content,{children:s.jsxs("fieldset",{children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"checkbox",id:"isProduction",checked:u.isProduction,onChange:m=>f("isProduction",m.target.checked),className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),s.jsxs("label",{htmlFor:"isProduction",className:"text-sm font-medium text-gray-700 flex items-center gap-2",children:[s.jsx(vr,{className:"w-4 h-4"}),"Material de producción"]})]}),u.isProduction&&s.jsxs("div",{className:"mt-4 grid gap-4 sm:grid-cols-2",children:[s.jsx(os,{label:"Unidad de Medida",value:u.unitMeasure||"UNIDAD",onChange:m=>f("unitMeasure",m),required:!0,placeholder:"Seleccionar unidad de medida"}),s.jsx(te,{label:"Precio por Unidad",type:"number",value:u.pricePerUnit,onChange:m=>f("pricePerUnit",parseFloat(m.target.value)||0),min:0,step:"0.01",required:!0,isCurrency:!0})]})]})})]}),s.jsxs(A,{children:[s.jsx(A.Header,{children:s.jsx(A.Title,{children:"Etiquetas y Orden"})}),s.jsxs(A.Content,{className:"space-y-4",children:[s.jsx(Og,{label:"Etiquetas",value:u.tags,onChange:async m=>{f("tags",m);for(const w of m)c.includes(w)||await l(w)},suggestions:c}),s.jsx("div",{className:`rounded-lg p-4 border ${b.bg} ${b.border}`,children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("label",{className:`text-sm font-medium ${b.text}`,children:"Orden del Producto"}),s.jsx("div",{className:`text-lg font-bold mt-1 ${b.text}`,children:zi(u.order)})]}),s.jsx(Ms,{className:`w-5 h-5 ${b.text}`})]})})]})]}),s.jsxs(A,{children:[s.jsx(A.Header,{children:s.jsx(A.Title,{children:"Precio y Stock"})}),s.jsxs(A.Content,{className:"space-y-4",children:[s.jsx(te,{label:"Precio",value:u.price,onChange:m=>f("price",parseFloat(m.target.value)||0),min:0,required:!0,isCurrency:!0}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(te,{label:"Stock mínimo",type:"number",value:u.minPackageStock,onChange:m=>f("minPackageStock",parseInt(m.target.value)||0),min:0,required:!0}),s.jsx(te,{label:"Stock deseado",type:"number",value:u.desiredStock,onChange:m=>f("desiredStock",parseInt(m.target.value)||0),min:0,required:!0})]})]})]}),s.jsxs("div",{className:"flex justify-end space-x-4",children:[s.jsx(I,{type:"button",variant:"outline",onClick:n,disabled:a,children:"Cancelar"}),s.jsxs(I,{type:"submit",isLoading:a,children:[e?"Actualizar":"Crear"," Producto"]})]})]})}function Mg({providerId:t,initialData:e,onSubmit:r,onCancel:n,isLoading:a}){const[i,o]=y.useState(!1),c=()=>{i?confirm("¿Está seguro que desea descartar los cambios?")&&n():n()};return s.jsxs("div",{className:"fixed inset-0 bg-white z-50 flex flex-col",children:[s.jsx("div",{className:"border-b bg-white",children:s.jsxs("div",{className:"flex items-center justify-between px-4 h-14",children:[s.jsxs("h2",{className:"text-lg font-semibold",children:[e?"Editar":"Nuevo"," Producto"]}),s.jsx(I,{variant:"ghost",size:"sm",onClick:c,className:"p-2 hover:bg-gray-100 rounded-full",children:s.jsx($t,{className:"w-5 h-5"})})]})}),s.jsx("div",{className:"flex-1 overflow-hidden",children:s.jsx("div",{className:"h-full overflow-y-auto px-4 py-6",children:s.jsx("div",{className:"max-w-3xl mx-auto",children:s.jsx(cc,{providerId:t,initialData:e,onSubmit:r,onCancel:n,isLoading:a,onDirtyChange:o})})})})]})}function lc(t){const e=t.toString().padStart(5,"0"),r=parseInt(e.slice(0,2))-1;return r>=0&&r<It.length?It[r].code:It[0].code}function Tg(t){const e=t.toString().padStart(5,"0");return parseInt(e.slice(2))}function Rg(t,e){const r=It.findIndex(n=>n.code===t)+1;return parseInt(`${r.toString().padStart(2,"0")}${e.toString().padStart(3,"0")}`)}function Ig(t){const e=lc(t),r=Tg(t);return`${e}-${r.toString().padStart(3,"0")}`}function Dg(){const{providers:t}=ar(),[e,r]=y.useState(""),{products:n,loading:a,addProduct:i,updateProduct:o,deleteProduct:c}=oc(e),[l,d]=y.useState([]),[u,h]=y.useState(!1),[f,p]=y.useState(null),[g,b]=y.useState(!1),[m,w]=y.useState(null),[v,j]=y.useState(!1),N=async O=>{b(!0);try{if(f)await o(f.id,O),J();else{const U=It[0].code,Q=n.filter(Te=>lc(Te.order)===U),ce=Rg(U,Q.length+1);await i({...O,order:ce}),J()}}catch(U){console.error("Error al guardar producto:",U),E.error("Error al guardar el producto")}finally{b(!1)}},C=async O=>{w(O)},$=async()=>{if(m)try{await c(m.id),w(null)}catch{E.error("Error al eliminar el producto")}},J=()=>{h(!1),p(null)},oe=O=>{p(O),h(!0)},K=()=>{if(f){const O=ze({isOpen:!0,onClose:()=>{},title:"Advertencia",children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-amber-600",children:"Hay un producto en edición. ¿Desea cancelar los cambios y crear uno nuevo?"}),s.jsxs("div",{className:"flex justify-end space-x-2",children:[s.jsx(I,{variant:"outline",onClick:()=>O.close(),children:"Cancelar"}),s.jsx(I,{onClick:()=>{p(null),h(!0),O.close()},children:"Continuar"})]})]})})}else h(!0)},V=y.useCallback((O,U)=>{d(O),j(U)},[]);return s.jsxs("div",{className:"space-y-6",children:[s.jsx(Sg,{onProductSelect:oe}),s.jsx("div",{className:"space-y-4 md:space-y-0",children:s.jsxs("div",{className:"flex flex-col md:flex-row md:items-end gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsx(ic,{providers:t,selectedProviderId:e,onChange:r})}),e&&s.jsx("div",{className:"flex-shrink-0 w-full md:w-auto",children:s.jsxs(I,{onClick:K,className:"w-full md:w-auto bg-blue-500 hover:bg-blue-600 text-white h-[48px] px-6 rounded-lg shadow-sm hover:shadow transition-all",children:[s.jsx(wr,{className:"w-5 h-5 mr-2"}),s.jsx("span",{className:"whitespace-nowrap",children:"Nuevo Producto"})]})})]})}),u&&s.jsx(Mg,{providerId:(f==null?void 0:f.providerId)||e,initialData:f||void 0,onSubmit:N,onCancel:J,isLoading:g}),e?a?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):!u&&s.jsxs(s.Fragment,{children:[s.jsx(Cg,{products:n,onFilter:V}),!v||l.length>0?s.jsx(Ng,{products:v?l:n,onEdit:oe,onDelete:C,providerId:e}):s.jsx("div",{className:"flex items-center justify-center h-64 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:s.jsx("p",{className:"text-gray-500 text-center px-4",children:"No se encontraron productos que coincidan con la búsqueda"})})]}):s.jsx("div",{className:"flex items-center justify-center h-64 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:s.jsx("p",{className:"text-gray-500 text-center px-4",children:"Seleccione un proveedor para ver sus productos"})}),s.jsx(ze,{isOpen:!!m,onClose:()=>w(null),title:"Eliminar producto",children:s.jsxs("div",{className:"space-y-4",children:[s.jsxs("p",{className:"text-amber-600",children:['¿Está seguro que desea eliminar el producto "',m==null?void 0:m.name,'"?']}),s.jsxs("div",{className:"flex justify-end space-x-2",children:[s.jsx(I,{variant:"outline",onClick:()=>w(null),children:"Cancelar"}),s.jsx(I,{onClick:$,children:"Eliminar"})]})]})})]})}const dc=`
  /* Reset */
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  /* Base styles */
  body {
    font-family: 'Courier New', monospace;
    font-size: 12px;
    line-height: 1.2;
    background: #f3f4f6;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  /* Preview Container */
  .content {
    width: 80mm;
    background: white;
    margin: 20px auto;
    padding: 2mm;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    border-radius: 4px;
  }

  /* Header */
  .header {
    margin-bottom: 3mm;
    border-bottom: 1px dashed #000;
    padding-bottom: 2mm;
  }

  .header div {
    margin-bottom: 1mm;
    font-weight: bold;
  }

  /* Business Info - Larger */
  .header div:nth-child(1) {
    font-size: 14px;
  }

  /* Owner Info */
  .header div:nth-child(2) {
    font-size: 12px;
  }

  /* Date - Smaller */
  .header div:nth-child(3) {
    font-size: 10px;
  }

  /* Table */
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 2mm;
  }

  tr {
    border-bottom: none;
  }

  td {
    padding: 0.5mm 1mm;
    font-size: 12px;
    vertical-align: top;
  }

  td.quantity {
    white-space: nowrap;
    padding-right: 2mm;
    width: 1%;
    font-weight: bold;
  }

  td.name {
    word-break: break-word;
  }

  /* Summary Section */
  .summary {
    margin-top: 3mm;
    padding-top: 2mm;
    border-top: 1px dashed #000;
  }

  .summary-row {
    display: flex;
    justify-content: space-between;
    margin-bottom: 1mm;
    font-size: 12px;
  }

  .summary-label {
    font-weight: normal;
  }

  .summary-value {
    font-weight: bold;
  }

  /* Print Controls */
  .controls {
    position: fixed;
    top: 20px;
    right: 20px;
    display: flex;
    gap: 10px;
    z-index: 100;
  }

  .print-button {
    padding: 12px 24px;
    background: #2563eb;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    display: flex;
    align-items: center;
    gap: 8px;
    transition: all 0.2s;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
  }

  .print-button:hover {
    background: #1d4ed8;
    transform: translateY(-1px);
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
  }

  .print-button:active {
    transform: translateY(0);
  }

  .print-button:disabled {
    background: #9ca3af;
    cursor: not-allowed;
    transform: none;
  }

  .print-button svg {
    width: 16px;
    height: 16px;
  }

  /* Print Media Styles */
  @media print {
    @page {
      size: 80mm auto;
      margin: 0;
    }

    body {
      width: 80mm;
      margin: 0;
      padding: 0;
      background: white;
      min-height: auto;
    }

    .content {
      width: 100%;
      margin: 0;
      padding: 2mm;
      box-shadow: none;
      border-radius: 0;
    }

    .controls {
      display: none !important;
    }

    /* Print header styles */
    .header {
      margin-bottom: 3mm;
      padding-bottom: 2mm;
    }

    .header div:nth-child(1) {
      font-size: 14px;
      font-weight: bold;
    }

    .header div:nth-child(2) {
      font-size: 12px;
      font-weight: bold;
    }

    .header div:nth-child(3) {
      font-size: 10px;
    }

    /* Print table styles */
    table {
      margin: 2mm 0;
    }

    td {
      padding: 0.5mm 1mm;
      font-size: 12px;
    }

    td.quantity {
      font-weight: bold;
    }

    /* Print summary styles */
    .summary {
      margin-top: 3mm;
      padding-top: 2mm;
      border-top: 1px dashed #000;
    }

    .summary-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 1mm;
      font-size: 12px;
    }

    .summary-label {
      font-weight: normal;
    }

    .summary-value {
      font-weight: bold;
    }
  }
`,uc=`
  let isPrinting = false;
  let retryCount = 0;
  const MAX_RETRIES = 3;

  function createPrintIcon() {
    return \`
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z" />
      </svg>
    \`;
  }

  function showError(message) {
    const existingError = document.querySelector('.error-message');
    if (existingError) {
      existingError.remove();
    }

    const errorDiv = document.createElement('div');
    errorDiv.className = 'error-message';
    errorDiv.textContent = message;
    document.body.appendChild(errorDiv);

    const printButton = document.getElementById('print-button');
    if (printButton) {
      printButton.disabled = false;
    }

    // Auto-hide error after 5 seconds
    setTimeout(() => {
      errorDiv.remove();
    }, 5000);
  }

  function setupPrintButton() {
    const printButton = document.getElementById('print-button');
    if (printButton) {
      printButton.innerHTML = createPrintIcon() + 'Imprimir';
    }
  }

  function handlePrint() {
    if (isPrinting) return;

    try {
      const printButton = document.getElementById('print-button');
      printButton.disabled = true;
      isPrinting = true;

      window.print();

      // Handle print completion
      window.onafterprint = () => {
        isPrinting = false;
        setTimeout(() => {
          window.close();
        }, 100);
      };

      // Timeout handler for print dialog
      setTimeout(() => {
        if (!window.closed && isPrinting) {
          isPrinting = false;
          printButton.disabled = false;
          
          if (retryCount < MAX_RETRIES) {
            retryCount++;
            showError('La impresión está tardando más de lo esperado. Intente nuevamente.');
          } else {
            showError('No se pudo completar la impresión. Por favor, cierre esta ventana e intente nuevamente.');
          }
        }
      }, 2000);

    } catch (error) {
      console.error('Print error:', error);
      isPrinting = false;
      showError('Error al imprimir. Por favor, intente nuevamente.');
    }
  }

  window.onload = () => {
    try {
      setupPrintButton();
      // Delay initial print to ensure content is rendered
      setTimeout(handlePrint, 800);
    } catch (error) {
      console.error('Print error:', error);
      showError('Error al iniciar la impresión. Por favor, use el botón Imprimir.');
    }
  };

  window.onerror = (message, source, lineno, colno, error) => {
    console.error('Print error:', { message, source, lineno, colno, error });
    showError('Ocurrió un error inesperado. Por favor, intente nuevamente.');
    return false;
  };
`;function Fg(t,e){const r=ve(new Date,"dd/MM/yyyy HH:mm",{locale:ye}),a=t.materials.sort((i,o)=>{const c=e.find(d=>d.id===i.productId),l=e.find(d=>d.id===o.productId);return!c||!l?0:c.order-l.order}).map(i=>{const o=e.find(c=>c.id===i.productId);return o?`
        <tr>
          <td class="quantity">${i.quantity} ${i.unit}</td>
          <td class="material">${o.name}</td>
        </tr>
      `:""}).join("");return`
    <!DOCTYPE html>
    <html>
      <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Receta: ${t.name}</title>
        <style>
          ${dc}
          
          /* Recipe specific styles */
          .recipe-header {
            text-align: center;
            margin: 3mm 0;
            padding-bottom: 2mm;
            border-bottom: 1px dashed #000;
          }
          
          .recipe-header h1 {
            font-size: 16px;
            font-weight: bold;
            margin: 0 0 2mm 0;
          }
          
          .recipe-header p {
            font-size: 12px;
            margin: 0;
          }
          
          table thead tr th {
            font-size: 12px;
            font-weight: bold;
            padding: 1mm 0;
          }
          
          table thead tr th.quantity-header {
            text-align: left;
            width: 30%;
          }
          
          table thead tr th.material-header {
            text-align: right;
            width: 70%;
          }
          
          td.quantity {
            font-weight: bold;
            width: 30%;
            text-align: left;
            white-space: nowrap;
          }
          
          td.material {
            width: 70%;
            text-align: right;
            padding-left: 2mm;
          }
          
          .notes {
            margin-top: 3mm;
            padding-top: 2mm;
            border-top: 1px dashed #000;
          }
          
          .notes h2 {
            font-size: 12px;
            font-weight: bold;
            margin: 0 0 1mm 0;
          }
          
          .notes p {
            font-size: 12px;
            margin: 0;
            white-space: pre-line;
          }
        </style>
      </head>
      <body>
        <div class="content">
          <div class="header">
            <div>${Ft.name}</div>
            <div>${Ft.owner}</div>
            <div>Fecha: ${r}</div>
          </div>

          <div class="recipe-header">
            <h1>${t.name}</h1>
            <p>Rendimiento: ${t.yield} ${t.yieldUnit}</p>
          </div>

          <table>
            <thead>
              <tr>
                <th class="quantity-header">Cantidad</th>
                <th class="material-header">Material</th>
              </tr>
            </thead>
            <tbody>
              ${a}
            </tbody>
          </table>

          ${t.notes?`
            <div class="notes">
              <h2>Notas:</h2>
              <p>${t.notes.replace(/\n/g,"<br>")}</p>
            </div>
          `:""}
        </div>

        <div class="controls">
          <button id="print-button" class="print-button">
            Imprimir
          </button>
        </div>

        <script>${uc}<\/script>
      </body>
    </html>
  `}function $g({recipes:t,onEdit:e,onDelete:r}){var c;const[n,a]=y.useState(null),{products:i}=Vt(),o=l=>{const d=Fg(l,i),u=window.open("","_blank");if(!u)throw new Error("No se pudo crear la pestaña de impresión");u.document.write(d),u.document.close()};return t.length===0?s.jsx("div",{className:"text-center py-12 bg-gray-50 rounded-lg border-2 border-dashed",children:s.jsx("p",{className:"text-gray-500",children:"No hay recetas para mostrar"})}):s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:t.map(l=>{var p;const d=(p=l.costHistory)==null?void 0:p[l.costHistory.length-1],u=l.costThreshold||20,h=d&&Math.abs(d.changePercentage)>u,f=(d==null?void 0:d.changePercentage)>0;return s.jsxs("div",{className:`
                bg-white rounded-lg shadow-sm p-4 space-y-4 transition-colors
                ${h?`border-2 ${f?"border-red-500":"border-green-500"}`:"border"}
                ${h&&f?"bg-red-50":h?"bg-green-50":""}
              `,children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h3",{className:"text-lg font-semibold flex-1 break-words",children:l.name}),l.isBase&&s.jsxs("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-amber-100 text-amber-800",children:[s.jsx(vr,{className:"w-3 h-3 mr-1"}),"Base"]})]}),s.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Rendimiento: ",l.yield," ",l.yieldUnit]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Costo Total:"}),s.jsx("p",{className:"font-medium",children:ne(l.totalCost)})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Costo Unitario:"}),s.jsxs("p",{className:"font-medium",children:[ne(l.unitCost)," / ",l.yieldUnit]})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx("span",{className:"text-gray-500",children:"Precio Sugerido:"}),s.jsxs("p",{className:"font-medium text-blue-600",children:[ne(l.suggestedPrice)," / ",l.yieldUnit]})]})]}),h&&s.jsxs("div",{className:`p-2 rounded-lg ${f?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:[s.jsxs("div",{className:"font-medium",children:[f?"Aumento":"Reducción"," significativo"]}),s.jsxs("div",{className:"text-sm",children:[d.changePercentage>0?"+":"",d.changePercentage.toFixed(2),"% en el último mes"]})]}),s.jsxs("div",{className:"text-xs text-gray-500 pt-2 border-t",children:["Última actualización: ",ve(l.lastUpdated,"d 'de' MMMM, yyyy HH:mm",{locale:ye})]}),s.jsxs("div",{className:"flex justify-end gap-1 pt-2 border-t",children:[s.jsx(I,{variant:"ghost",size:"sm",onClick:()=>a(l),title:"Ver historial de costos",className:"w-9 h-9 p-0",children:s.jsx(yi,{className:"w-4 h-4"})}),s.jsx(I,{variant:"ghost",size:"sm",onClick:()=>o(l),title:"Imprimir receta",className:"w-9 h-9 p-0",children:s.jsx(Ts,{className:"w-4 h-4"})}),s.jsx(I,{variant:"ghost",size:"sm",onClick:()=>e(l),title:"Editar receta",className:"w-9 h-9 p-0",children:s.jsx(As,{className:"w-4 h-4"})}),s.jsx(I,{variant:"ghost",size:"sm",onClick:()=>r(l),title:"Eliminar receta",className:"w-9 h-9 p-0 text-red-600 hover:text-red-700 hover:bg-red-50",children:s.jsx(Kr,{className:"w-4 h-4"})})]})]},l.id)})}),s.jsx(ze,{isOpen:!!n,onClose:()=>a(null),title:`Historial de Costos - ${n==null?void 0:n.name}`,children:s.jsxs("div",{className:"space-y-4",children:[(c=n==null?void 0:n.costHistory)!=null&&c.length?s.jsx("div",{className:"space-y-3",children:n.costHistory.map((l,d)=>{const u=Math.abs(l.changePercentage)>(n.costThreshold||20),h=l.changePercentage>0;return s.jsxs("div",{className:`p-3 rounded-lg ${u?h?"bg-red-50 border-2 border-red-500":"bg-green-50 border-2 border-green-500":"bg-gray-50 border border-gray-200"}`,children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-gray-600",children:ve(l.date,"d 'de' MMMM, yyyy HH:mm",{locale:ye})}),s.jsxs("span",{className:`text-sm font-medium ${l.changePercentage>0?"text-red-600":"text-green-600"}`,children:[l.changePercentage>0?"+":"",l.changePercentage.toFixed(2),"%"]})]}),s.jsxs("div",{className:"mt-1",children:[s.jsx("span",{className:"font-medium",children:ne(l.unitCost)}),s.jsxs("span",{className:"text-gray-500",children:[" ","/ ",n.yieldUnit]})]})]},`${l.date}-${d}`)})}):s.jsx("p",{className:"text-gray-500 text-center py-4",children:"No hay historial de costos disponible"}),s.jsx("div",{className:"flex justify-end",children:s.jsx(I,{onClick:()=>a(null),children:"Cerrar"})})]})})]})}const Ur="monthlyFixedCosts";async function ea(){try{if(!ge.currentUser)throw new ie("User not authenticated");const t=z(W,Ur);(await _e(t)).exists()||await _t(t,{})}catch(t){throw new ie("Failed to initialize fixed costs collection",{cause:t})}}async function Lg(t){try{if(!ge.currentUser)throw new ie("User not authenticated");await ea();const e=await hc(t.month,t.year);if(e){const a=z(W,`${Ur}/${e.id}`);return await _t(a,{...t,lastUpdated:Date.now()}),e.id}const r=z(W,Ur),n=ht(r);if(!n.key)throw new ie("Failed to generate document ID");return await _t(n,{...t,lastUpdated:Date.now()}),n.key}catch(e){throw e instanceof ie?e:new ie("Failed to save monthly fixed costs",{cause:e})}}async function hc(t,e){try{if(!ge.currentUser)throw new ie("User not authenticated");await ea();const r=z(W,Ur),n=Gt(r,Yt("month"),Kt(t)),a=await _e(n);if(!a.exists())return null;const o=Object.entries(a.val()).find(([c,l])=>l.year===e);return o?{id:o[0],...o[1]}:null}catch(r){throw r instanceof ie?r:new ie("Failed to get monthly fixed costs",{cause:r})}}async function Bg(){try{if(!ge.currentUser)throw new ie("User not authenticated");const t=new Date;return hc(t.getMonth()+1,t.getFullYear())}catch(t){throw t instanceof ie?t:new ie("Failed to get current month fixed costs",{cause:t})}}async function Ug(){try{if(!ge.currentUser)throw new ie("User not authenticated");await ea();const t=z(W,Ur),e=await _e(t);return e.exists()?Object.entries(e.val()).map(([r,n])=>({id:r,...n})).sort((r,n)=>n.lastUpdated-r.lastUpdated):[]}catch(t){throw t instanceof ie?t:new ie("Failed to get fixed costs history",{cause:t})}}function fc(){const[t,e]=y.useState(null),[r,n]=y.useState([]),[a,i]=y.useState(!0),[o,c]=y.useState(null);y.useEffect(()=>{l()},[]);const l=async()=>{try{i(!0),c(null);const[u,h]=await Promise.all([Bg(),Ug()]);e(u),n(h)}catch(u){console.error("Error loading fixed costs:",u),c("Error al cargar los costos fijos")}finally{i(!1)}};return{currentCosts:t,history:r,loading:a,error:o,updateFixedCosts:async u=>{try{c(null),await Lg(u),await l(),E.success("Costos fijos actualizados exitosamente")}catch(h){throw console.error("Error updating fixed costs:",h),c("Error al actualizar los costos fijos"),h}},loadData:l}}function Vg({products:t,recipes:e,onSelect:r,selectedMaterials:n}){const[a,i]=y.useState(""),[o,c]=y.useState(null),[l,d]=y.useState(0),[u,h]=y.useState(!1),f=t.filter(w=>w.isProduction&&!n.includes(w.id)),p=e.filter(w=>w.isBase&&!n.includes(w.id)),g=[...f.map(w=>({id:w.id,type:"product",name:w.name,sku:w.sku,unit:w.unitMeasure||w.purchasePackaging,unitCost:w.pricePerUnit||0})),...p.map(w=>({id:w.id,type:"recipe",name:w.name,unit:w.yieldUnit,unitCost:w.unitCost}))].filter(w=>{const v=a.toLowerCase();return w.name.toLowerCase().includes(v)||w.type==="product"&&w.sku.toLowerCase().includes(v)}).sort((w,v)=>{const j=w.name.toLowerCase().startsWith(a.toLowerCase()),N=v.name.toLowerCase().startsWith(a.toLowerCase());return j&&!N?-1:!j&&N?1:w.name.localeCompare(v.name)}).slice(0,5),b=w=>{c({id:w.id,type:w.type}),i(w.name),h(!1)},m=()=>{o&&l>0&&(r(o,l),c(null),i(""),d(0))};return s.jsx("div",{className:"space-y-4",children:s.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[s.jsxs("div",{className:"relative",children:[s.jsxs("div",{className:"relative",children:[s.jsx(te,{placeholder:"Buscar material...",value:a,onChange:w=>{i(w.target.value),h(!0),c(null)},onFocus:()=>h(!0),className:"pl-10"}),s.jsx(kt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"})]}),u&&a&&g.length>0&&s.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border rounded-md shadow-lg",children:g.map(w=>s.jsxs("button",{type:"button",onClick:()=>b(w),className:"w-full px-4 py-2 text-left hover:bg-gray-50",children:[s.jsx("div",{className:"font-medium",children:w.name}),s.jsxs("div",{className:"text-sm text-gray-500 flex items-center justify-between",children:[s.jsx("span",{children:w.type==="product"?w.sku:"Receta Base"}),s.jsxs("span",{className:"text-blue-600 font-medium",children:[ne(w.unitCost)," / ",w.unit]})]})]},`${w.type}-${w.id}`))}),u&&a&&g.length===0&&s.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border rounded-md shadow-lg p-4 text-center text-gray-500",children:"No se encontraron materiales disponibles"}),!a&&s.jsxs("div",{className:"mt-1 text-xs text-gray-500",children:[f.length," materiales de producción y ",p.length," recetas base disponibles"]})]}),o&&s.jsxs("div",{className:"flex gap-2",children:[s.jsx(te,{type:"number",value:l,onChange:w=>d(Number(w.target.value)),min:0,step:"0.01",placeholder:"Cantidad",className:"flex-1"}),s.jsx(I,{type:"button",onClick:m,disabled:l<=0,children:"Agregar"})]})]})})}function zg({materials:t,products:e,recipes:r,onRemove:n}){if(t.length===0)return s.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:[s.jsx(ot,{className:"w-8 h-8 text-gray-400 mx-auto mb-3"}),s.jsx("p",{className:"text-gray-500",children:"No hay materiales agregados"}),s.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Utilice el buscador para agregar materiales a la receta"})]});const a=t.reduce((i,o)=>i+o.totalCost,0);return s.jsx("div",{className:"overflow-hidden rounded-lg border border-gray-200 bg-white",children:s.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{scope:"col",className:"px-4 py-3 text-left text-sm font-medium text-gray-500",children:"Material"}),s.jsx("th",{scope:"col",className:"px-4 py-3 text-center text-sm font-medium text-gray-500 w-32",children:"Cantidad"}),s.jsx("th",{scope:"col",className:"px-4 py-3 text-right text-sm font-medium text-gray-500 w-32",children:"Costo"}),s.jsx("th",{scope:"col",className:"px-4 py-3 text-center text-sm font-medium text-gray-500 w-16",children:s.jsx("span",{className:"sr-only",children:"Acciones"})})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:t.map((i,o)=>{const c=e.find(h=>h.id===i.id),l=r.find(h=>h.id===i.id),d=c||l;if(!d)return null;const u=i.type==="recipe";return s.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[s.jsx("td",{className:"px-4 py-3",children:s.jsx("div",{className:"flex items-center",children:s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[u?s.jsx(vr,{className:"w-4 h-4 text-amber-500 flex-shrink-0"}):s.jsx(ot,{className:"w-4 h-4 text-blue-500 flex-shrink-0"}),s.jsx("span",{className:"font-medium text-gray-900 truncate",children:d.name})]}),s.jsx("div",{className:"mt-1 flex items-center gap-3 text-sm text-gray-500",children:u?s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(vr,{className:"w-4 h-4"}),"Receta Base"]}):s.jsxs(s.Fragment,{children:[s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(ot,{className:"w-4 h-4"}),c.sku]}),c.unitMeasure&&s.jsxs("span",{className:"flex items-center gap-1",children:[s.jsx(Wc,{className:"w-4 h-4"}),c.unitMeasure]})]})})]})})}),s.jsx("td",{className:"px-4 py-3 text-center",children:s.jsxs("span",{className:"font-medium",children:[i.quantity," ",i.unit]})}),s.jsxs("td",{className:"px-4 py-3 text-right",children:[s.jsx("div",{className:"font-medium text-gray-900",children:ne(i.totalCost)}),s.jsxs("div",{className:"text-sm text-gray-500",children:[ne(i.unitCost)," c/u"]})]}),s.jsx("td",{className:"px-4 py-3 text-center",children:s.jsx(I,{type:"button",variant:"ghost",size:"sm",onClick:()=>n(o),className:"text-red-600 hover:text-red-700 hover:bg-red-50 p-1 rounded-full",children:s.jsx(Kr,{className:"w-4 h-4"})})})]},`${i.type}-${i.id}-${o}`)})}),s.jsx("tfoot",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("td",{colSpan:2,className:"px-4 py-3 text-sm font-medium text-gray-500",children:"Total Materiales"}),s.jsx("td",{colSpan:2,className:"px-4 py-3 text-right",children:s.jsx("span",{className:"font-bold text-blue-600",children:ne(a)})})]})})]})})}function oi(t,e){return t<=0?0:Number((e/t*100).toFixed(2))}function Wg(t,e,r){if(t.type==="product"){const n=e.find(a=>a.id===t.id);return n?t.quantity*(n.pricePerUnit||0):0}else{const n=r.find(a=>a.id===t.id);return n?t.quantity*n.unitCost:0}}function Tt(t,e,r,n,a,i,o){const c=t.reduce((g,b)=>g+Wg(b,e,r),0),l=c*a/100,d=Number((c+l).toFixed(2)),u=n>0?Number((d/n).toFixed(2)):0,h=i/100,f=h<1?Number((u/(1-h)).toFixed(2)):Number((u*2).toFixed(2));let p;return o&&Math.abs(u-o)>.01&&(p=[{date:Date.now(),unitCost:u,changePercentage:Number(((u-o)/o*100).toFixed(2))}]),{totalCost:d,unitCost:u,suggestedPrice:f,costHistory:p}}function mc(t,e,r,n=new Set){var o;if(n.has(r))return t;n.add(r);const a=t.filter(c=>c.materials.some(l=>l.type==="recipe"&&l.id===r));let i=[...t];for(const c of a){const l=Tt(c.materials,e,i,c.yield,c.fixedCostPercentage,c.profitPercentage,c.unitCost),d=i.findIndex(u=>u.id===c.id);if(d!==-1){const u=c.costHistory||[];(o=l.costHistory)!=null&&o[0]&&u.push(l.costHistory[0]),i[d]={...c,totalCost:l.totalCost,unitCost:l.unitCost,suggestedPrice:l.suggestedPrice,costHistory:u,lastUpdated:Date.now()},i=mc(i,e,c.id,n)}}return i}function Hg({initialData:t,onSubmit:e,onCancel:r,isLoading:n,recipes:a}){var f;const{products:i,loading:o}=Vt(),{currentCosts:c}=fc(),[l,d]=y.useState({name:(t==null?void 0:t.name)||"",yield:(t==null?void 0:t.yield)||0,yieldUnit:(t==null?void 0:t.yieldUnit)||"",materials:(t==null?void 0:t.materials)||[],fixedCostPercentage:(t==null?void 0:t.fixedCostPercentage)||15,profitPercentage:(t==null?void 0:t.profitPercentage)||90,notes:(t==null?void 0:t.notes)||"",totalCost:(t==null?void 0:t.totalCost)||0,unitCost:(t==null?void 0:t.unitCost)||0,suggestedPrice:(t==null?void 0:t.suggestedPrice)||0,lastUpdated:Date.now(),costHistory:(t==null?void 0:t.costHistory)||[],costThreshold:(t==null?void 0:t.costThreshold)||20,isBase:(t==null?void 0:t.isBase)||!1}),u=async p=>{if(p.preventDefault(),l.materials.length===0){E.error("Debe agregar al menos un material");return}if(!l.name||!l.yield||!l.yieldUnit){E.error("Complete todos los campos requeridos");return}await e(l)},h=(p,g)=>{if(p.type==="product"){const b=i.find(v=>v.id===p.id);if(!b)return;const m=b.pricePerUnit||0,w=m*g;d(v=>{const j=[...v.materials,{id:p.id,type:"product",quantity:g,unit:b.unitMeasure||b.purchasePackaging,unitCost:m,totalCost:w}],N=Tt(j,i,a,v.yield,v.fixedCostPercentage,v.profitPercentage,v.unitCost);return{...v,materials:j,totalCost:N.totalCost,unitCost:N.unitCost,suggestedPrice:N.suggestedPrice,costHistory:N.costHistory?[...v.costHistory||[],...N.costHistory]:v.costHistory}})}else{const b=a.find(v=>v.id===p.id);if(!b)return;const m=b.unitCost,w=m*g;d(v=>{const j=[...v.materials,{id:p.id,type:"recipe",quantity:g,unit:b.yieldUnit,unitCost:m,totalCost:w}],N=Tt(j,i,a,v.yield,v.fixedCostPercentage,v.profitPercentage,v.unitCost);return{...v,materials:j,totalCost:N.totalCost,unitCost:N.unitCost,suggestedPrice:N.suggestedPrice,costHistory:N.costHistory?[...v.costHistory||[],...N.costHistory]:v.costHistory}})}};return o?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):s.jsxs("form",{onSubmit:u,className:"space-y-6",children:[s.jsxs(A,{children:[s.jsx(A.Header,{children:s.jsx(A.Title,{children:"Información Básica"})}),s.jsxs(A.Content,{className:"space-y-4",children:[s.jsx(te,{label:"Nombre de la receta",value:l.name,onChange:p=>d(g=>({...g,name:p.target.value})),required:!0}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsx(te,{type:"number",label:"Rendimiento",value:l.yield,onChange:p=>d(g=>{const b=Number(p.target.value),m=Tt(g.materials,i,a,b,g.fixedCostPercentage,g.profitPercentage,g.unitCost);return{...g,yield:b,totalCost:m.totalCost,unitCost:m.unitCost,suggestedPrice:m.suggestedPrice,costHistory:m.costHistory?[...g.costHistory||[],...m.costHistory]:g.costHistory}}),min:0,step:"0.01",required:!0}),s.jsx(te,{label:"Unidad",value:l.yieldUnit,onChange:p=>d(g=>({...g,yieldUnit:p.target.value.toUpperCase()})),required:!0})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("input",{type:"checkbox",id:"isBase",checked:l.isBase,onChange:p=>d(g=>({...g,isBase:p.target.checked})),className:"h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),s.jsx("label",{htmlFor:"isBase",className:"text-sm font-medium text-gray-700",children:"Receta base (puede usarse como material en otras recetas)"})]})]})]}),s.jsxs(A,{children:[s.jsx(A.Header,{children:s.jsx(A.Title,{children:"Materiales"})}),s.jsxs(A.Content,{className:"space-y-4",children:[s.jsx(Vg,{products:i,recipes:a,onSelect:h,selectedMaterials:l.materials.map(p=>p.id)}),s.jsx(zg,{materials:l.materials,products:i,recipes:a,onRemove:p=>{d(g=>{const b=g.materials.filter((w,v)=>v!==p),m=Tt(b,i,a,g.yield,g.fixedCostPercentage,g.profitPercentage,g.unitCost);return{...g,materials:b,totalCost:m.totalCost,unitCost:m.unitCost,suggestedPrice:m.suggestedPrice,costHistory:m.costHistory?[...g.costHistory||[],...m.costHistory]:g.costHistory}})}})]})]}),s.jsxs(A,{children:[s.jsx(A.Header,{children:s.jsx(A.Title,{children:"Configuración de Costos"})}),s.jsx(A.Content,{children:s.jsxs("div",{className:"grid gap-6",children:[s.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("div",{className:"text-sm font-medium text-blue-700",children:"Costo Fijo:"}),s.jsxs("div",{className:"text-lg font-bold text-blue-700",children:[l.fixedCostPercentage.toFixed(2),"%"]})]}),s.jsx("p",{className:"text-sm text-blue-600",children:c?"Basado en los costos del mes actual":"Usando valor por defecto (15%)"})]}),s.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("div",{className:"text-sm font-medium text-green-700",children:"Beneficio:"}),s.jsx(te,{type:"number",value:l.profitPercentage,onChange:p=>d(g=>{const b=Number(p.target.value),m=Tt(g.materials,i,a,g.yield,g.fixedCostPercentage,b,g.unitCost);return{...g,profitPercentage:b,totalCost:m.totalCost,unitCost:m.unitCost,suggestedPrice:m.suggestedPrice,costHistory:m.costHistory?[...g.costHistory||[],...m.costHistory]:g.costHistory}}),min:0,max:99.99,required:!0,className:"w-24 text-right bg-white"})]}),s.jsx("p",{className:"text-sm text-green-600",children:"Porcentaje de beneficio esperado"})]})]}),s.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:s.jsxs("div",{className:"grid gap-4",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"text-sm text-gray-600",children:"Costo de Materiales:"}),s.jsx("div",{className:"text-lg font-medium text-gray-900",children:ne(l.totalCost)})]}),s.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Total de ",l.materials.length," materiales"]})]}),s.jsxs("div",{className:"pt-4 border-t border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"text-sm text-gray-600",children:["Costo por ",l.yieldUnit||"unidad",":"]}),s.jsx("div",{className:"text-lg font-medium text-blue-600",children:ne(l.unitCost)})]}),s.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Para un rendimiento de ",l.yield," ",l.yieldUnit]})]}),s.jsxs("div",{className:"pt-4 border-t border-gray-200",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"text-sm text-gray-600",children:["Precio Sugerido por ",l.yieldUnit||"unidad",":"]}),s.jsx("div",{className:"text-lg font-bold text-green-600",children:ne(l.suggestedPrice)})]}),s.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Con ",l.profitPercentage,"% de beneficio esperado"]})]})]})}),((f=l.costHistory)==null?void 0:f.length)>0&&s.jsxs("div",{className:"bg-amber-50 p-4 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-2 text-amber-700",children:[s.jsx("div",{className:"text-sm font-medium",children:"Umbral de Alerta:"}),s.jsxs("div",{className:"text-lg font-bold",children:[l.costThreshold,"%"]})]}),s.jsx("p",{className:"text-sm text-amber-600 mt-1",children:"Se notificará cuando el cambio en los costos supere este porcentaje"})]})]})})]}),s.jsxs(A,{children:[s.jsx(A.Header,{children:s.jsx(A.Title,{children:"Notas Adicionales"})}),s.jsx(A.Content,{children:s.jsx("textarea",{value:l.notes,onChange:p=>d(g=>({...g,notes:p.target.value})),rows:3,className:"w-full rounded-md border border-gray-300 px-3 py-2 focus:border-blue-500 focus:ring-1 focus:ring-blue-500"})})]}),s.jsxs("div",{className:"flex justify-end space-x-4",children:[s.jsx(I,{type:"button",variant:"outline",onClick:r,disabled:n,children:"Cancelar"}),s.jsxs(I,{type:"submit",isLoading:n,children:[t?"Actualizar":"Crear"," Receta"]})]})]})}function qg({initialData:t,onSubmit:e,onCancel:r,isLoading:n,history:a=[]}){const[i,o]=y.useState(!1),[c,l]=y.useState({month:new Date().getMonth()+1,year:new Date().getFullYear(),totalMaterialsCost:(t==null?void 0:t.totalMaterialsCost)||0,totalFixedCosts:(t==null?void 0:t.totalFixedCosts)||0,totalSales:(t==null?void 0:t.totalSales)||0,productionSales:(t==null?void 0:t.productionSales)||0,fixedCostPercentage:(t==null?void 0:t.fixedCostPercentage)||0,lastUpdated:Date.now()}),d=async b=>{if(b.preventDefault(),c.totalSales<c.productionSales){alert("Las ventas de producción no pueden ser mayores que las ventas totales");return}const m=c.totalSales>0?c.productionSales/c.totalSales*100:0,w=c.totalFixedCosts*(m/100),v=oi(c.totalMaterialsCost,w);try{o(!0),await e({...c,fixedCostPercentage:v,lastUpdated:Date.now()})}catch(j){console.error("Error saving fixed costs:",j)}finally{o(!1)}},u=c.totalSales>0?c.productionSales/c.totalSales*100:0,h=c.totalFixedCosts*(u/100),f=oi(c.totalMaterialsCost,h),p=a.reduce((b,m)=>{const w=m.year,v=m.month;return b[w]||(b[w]={}),b[w][v]||(b[w][v]=[]),b[w][v].push(m),b},{}),g=Object.keys(p).map(Number).sort((b,m)=>m-b);return s.jsxs("form",{onSubmit:d,className:"space-y-6",children:[s.jsxs(A,{children:[s.jsx(A.Header,{children:s.jsx(A.Title,{children:"Ventas"})}),s.jsxs(A.Content,{className:"space-y-4",children:[s.jsx(te,{label:"Ventas Totales",type:"number",min:"0",step:"any",value:c.totalSales,onChange:b=>l(m=>({...m,totalSales:parseFloat(b.target.value)||0})),required:!0,isCurrency:!0,disabled:i}),s.jsx(te,{label:"Ventas de Producción Propia",type:"number",min:"0",step:"any",value:c.productionSales,onChange:b=>l(m=>({...m,productionSales:parseFloat(b.target.value)||0})),required:!0,isCurrency:!0,disabled:i}),s.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[s.jsx("div",{className:"text-sm text-blue-600 mb-2",children:"Porcentaje de Ventas de Producción:"}),s.jsxs("div",{className:"text-2xl font-bold text-blue-700",children:[u.toFixed(2),"%"]})]})]})]}),s.jsxs(A,{children:[s.jsx(A.Header,{children:s.jsx(A.Title,{children:"Costos"})}),s.jsxs(A.Content,{className:"space-y-4",children:[s.jsx(te,{label:"Costo Total de Materiales",type:"number",min:"0",step:"any",value:c.totalMaterialsCost,onChange:b=>l(m=>({...m,totalMaterialsCost:parseFloat(b.target.value)||0})),required:!0,isCurrency:!0,disabled:i}),s.jsx(te,{label:"Gastos Fijos Totales",type:"number",min:"0",step:"any",value:c.totalFixedCosts,onChange:b=>l(m=>({...m,totalFixedCosts:parseFloat(b.target.value)||0})),required:!0,isCurrency:!0,disabled:i}),s.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-4",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Gastos Fijos de Producción:"}),s.jsx("div",{className:"text-xl font-bold text-blue-600",children:ne(h)}),s.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:[u.toFixed(2),"% de ",ne(c.totalFixedCosts)]})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Porcentaje sobre Materiales:"}),s.jsxs("div",{className:"text-xl font-bold text-blue-600",children:[f.toFixed(2),"%"]}),s.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:[ne(h)," / ",ne(c.totalMaterialsCost)]})]})]})]})]}),g.length>0&&s.jsxs(A,{children:[s.jsx(A.Header,{children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(yi,{className:"w-5 h-5 text-gray-500"}),s.jsx(A.Title,{children:"Historial por Año y Mes"})]})}),s.jsx(A.Content,{children:s.jsx("div",{className:"space-y-6",children:g.map(b=>s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:b}),s.jsx("div",{className:"space-y-4",children:Object.entries(p[b]).sort(([m],[w])=>Number(w)-Number(m)).map(([m,w])=>{const v=ve(new Date(b,Number(m)-1),"MMMM",{locale:ye}),j=w[w.length-1],N=a.find($=>$.year===b&&$.month===Number(m)-1),C=N?(j.fixedCostPercentage-N.fixedCostPercentage)/N.fixedCostPercentage*100:0;return s.jsxs("div",{className:"space-y-2",children:[s.jsx("h4",{className:"font-medium text-gray-700 capitalize",children:v}),s.jsxs("div",{className:`p-4 rounded-lg ${Math.abs(C)>10?C>0?"bg-red-50":"bg-green-50":"bg-gray-50"}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("div",{className:"text-sm text-gray-600",children:"Última actualización:"}),N&&s.jsxs("div",{className:`text-sm font-medium ${C>0?"text-red-600":"text-green-600"}`,children:[C>0?"+":"",C.toFixed(2),"%"]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Materiales:"}),s.jsx("div",{className:"font-medium",children:ne(j.totalMaterialsCost)})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Gastos Fijos:"}),s.jsx("div",{className:"font-medium",children:ne(j.totalFixedCosts)})]}),s.jsxs("div",{className:"col-span-2",children:[s.jsx("span",{className:"text-gray-600",children:"Porcentaje:"}),s.jsxs("div",{className:"font-medium",children:[j.fixedCostPercentage.toFixed(2),"%"]})]})]}),Math.abs(C)>10&&s.jsxs("div",{className:`mt-2 flex items-center gap-1.5 text-sm ${C>0?"text-red-600":"text-green-600"}`,children:[C>0?s.jsx(Os,{className:"w-4 h-4"}):s.jsx(Hc,{className:"w-4 h-4"}),s.jsxs("span",{children:[C>0?"Aumento significativo":"Reducción significativa"," respecto al mes anterior"]})]})]})]},m)})})]},b))})})]}),s.jsxs("div",{className:"flex justify-end space-x-4",children:[s.jsx(I,{type:"button",variant:"outline",onClick:r,disabled:i||n,children:"Cancelar"}),s.jsx(I,{type:"submit",disabled:i||n,className:"min-w-[100px]",children:i?s.jsxs(s.Fragment,{children:[s.jsx(qc,{className:"w-4 h-4 mr-2 animate-spin"}),"Guardando..."]}):"Guardar"})]})]})}function Gg(){const[t,e]=y.useState([]),[r,n]=y.useState(!0);return y.useEffect(()=>{const c=z(W,"recipes"),l=Ye(c,d=>{if(!d.exists()){e([]),n(!1);return}const u=Object.entries(d.val()).map(([h,f])=>({id:h,...f}));e(u),n(!1)});return()=>l()},[]),{recipes:t,loading:r,addRecipe:async c=>{const l=z(W,"recipes");await ht(l,{...c,lastUpdated:Date.now()})},updateRecipe:async(c,l)=>{const d=z(W,`recipes/${c}`);await ut(d,{...l,lastUpdated:Date.now()})},deleteRecipe:async c=>{const l=z(W,`recipes/${c}`);await jr(l)}}}function Yg(){const{recipes:t,loading:e,addRecipe:r,updateRecipe:n,deleteRecipe:a}=Gg(),{products:i,loading:o}=Vt(),{currentCosts:c,loading:l,updateFixedCosts:d}=fc(),[u,h]=y.useState(!1),[f,p]=y.useState(!1),[g,b]=y.useState(null),[m,w]=y.useState(""),[v,j]=y.useState(!1),[N,C]=y.useState(!1),J=[...t].sort((Q,ce)=>Q.isBase&&!ce.isBase?-1:!Q.isBase&&ce.isBase?1:Q.name.localeCompare(ce.name)).filter(Q=>Q.name.toLowerCase().includes(m.toLowerCase())),oe=async Q=>{j(!0);try{g?(await n(g.id,{...Q,costThreshold:Q.costThreshold||20,lastUpdated:Date.now()}),E.success("Receta actualizada exitosamente")):(await r({...Q,costHistory:[],costThreshold:20,lastUpdated:Date.now()}),E.success("Receta creada exitosamente")),V()}catch{E.error("Error al guardar la receta")}finally{j(!1)}},K=async Q=>{try{await a(Q.id),E.success("Receta eliminada exitosamente")}catch{E.error("Error al eliminar la receta")}},V=()=>{h(!1),b(null)},O=Q=>{b(Q),h(!0)},U=async()=>{var Te,Re;if(!i.length){E.error("No hay productos disponibles para actualizar los costos");return}if(!c){E.error("Debe configurar los costos fijos del mes actual primero"),p(!0);return}C(!0);let Q=0,ce=0;try{let we=[...t];const Je=we.filter(L=>L.isBase);for(const L of Je)try{const q=Tt(L.materials,i,we,L.yield,c.fixedCostPercentage,L.profitPercentage,L.unitCost);if(q.totalCost!==L.totalCost||q.unitCost!==L.unitCost||q.suggestedPrice!==L.suggestedPrice){const D=L.costHistory||[];(Te=q.costHistory)!=null&&Te[0]&&D.push(q.costHistory[0]);const ke={...L,totalCost:q.totalCost,unitCost:q.unitCost,suggestedPrice:q.suggestedPrice,fixedCostPercentage:c.fixedCostPercentage,costHistory:D,lastUpdated:Date.now()};await n(L.id,ke),Q++;const ir=we.findIndex(he=>he.id===L.id);ir!==-1&&(we[ir]=ke),we=mc(we,i,L.id)}}catch(q){console.error(`Error updating recipe ${L.id}:`,q),ce++}const $e=we.filter(L=>!L.isBase);for(const L of $e)try{const q=Tt(L.materials,i,we,L.yield,c.fixedCostPercentage,L.profitPercentage,L.unitCost);if(q.totalCost!==L.totalCost||q.unitCost!==L.unitCost||q.suggestedPrice!==L.suggestedPrice){const D=L.costHistory||[];(Re=q.costHistory)!=null&&Re[0]&&D.push(q.costHistory[0]),await n(L.id,{...L,totalCost:q.totalCost,unitCost:q.unitCost,suggestedPrice:q.suggestedPrice,fixedCostPercentage:c.fixedCostPercentage,costHistory:D,lastUpdated:Date.now()}),Q++}}catch(q){console.error(`Error updating recipe ${L.id}:`,q),ce++}Q>0?E.success(`${Q} recetas actualizadas exitosamente`):ce===0&&E.success("Los costos están actualizados"),ce>0&&E.error(`Error al actualizar ${ce} recetas`)}catch{E.error("Error al actualizar los costos")}finally{C(!1)}};return s.jsxs("div",{className:"space-y-6",children:[u?s.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4 md:p-6",children:s.jsx(Hg,{initialData:g,onSubmit:oe,onCancel:V,isLoading:v,recipes:t})}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex flex-col gap-4",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx(te,{placeholder:"Buscar recetas...",value:m,onChange:Q=>w(Q.target.value),className:"pl-10"}),s.jsx(kt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"})]}),s.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2",children:[s.jsxs(I,{onClick:()=>p(!0),variant:"outline",className:"w-full",children:[s.jsx(Gc,{className:"w-4 h-4 mr-2 sm:mr-2"}),s.jsx("span",{className:"hidden sm:inline",children:"Costos Fijos"}),s.jsx("span",{className:"sm:hidden",children:"Costos"})]}),s.jsxs(I,{onClick:U,variant:"outline",isLoading:N,disabled:N||e||o||l,className:"w-full",children:[s.jsx(Ps,{className:"w-4 h-4 mr-2 sm:mr-2"}),s.jsx("span",{className:"hidden sm:inline",children:"Actualizar Costos"}),s.jsx("span",{className:"sm:hidden",children:"Actualizar"})]}),s.jsxs(I,{onClick:()=>h(!0),className:"w-full sm:col-auto col-span-2",children:[s.jsx(wr,{className:"w-4 h-4 mr-2"}),s.jsx("span",{children:"Nueva Receta"})]})]})]}),e?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):s.jsx($g,{recipes:J,onEdit:O,onDelete:K})]}),s.jsx(ze,{isOpen:f,onClose:()=>p(!1),title:"Configuración de Costos Fijos",children:s.jsx(qg,{initialData:c||void 0,onSubmit:async Q=>{try{await d(Q),p(!1),U()}catch{}},onCancel:()=>p(!1)})})]})}async function Kg(t,e){if(!ge.currentUser)throw new ie("User not authenticated");try{const r=z(W,t),n=ht(r);if(!n.key)throw new ie("Failed to generate document ID");return await _t(n,e),n.key}catch(r){throw new ie("Failed to create document",{cause:r})}}async function Qg(t,e,r){if(!ge.currentUser)throw new ie("User not authenticated");try{const n=z(W,`${t}/${e}`);await _t(n,r)}catch(n){throw new ie("Failed to update document",{cause:n})}}async function Xg(t,e){if(!ge.currentUser)throw new ie("User not authenticated");try{const r=z(W,`${t}/${e}`);await jr(r)}catch(r){throw new ie("Failed to delete document",{cause:r})}}async function Jg(t,e,r){if(!ge.currentUser)throw new ie("User not authenticated");try{const n=z(W,t),a=Gt(n,Yt(e),Kt(r)),i=await _e(a);return i.exists()?Object.entries(i.val()).map(([o,c])=>({id:o,...c})):[]}catch(n){throw new ie("Failed to query documents",{cause:n})}}const Zg=["UNIDAD","KILOGRAMO","GRAMO","LITRO","CENTÍMETRO","MILILITRO","BOLSA","PLANCHA","CAJON","CAJA","FRACO","BOTELLA","FUNDA","SACHET","ATADO","ROLLO"].sort();async function ep(){try{const t=z(W,"measures"),e=await _e(t),n=(e.exists()?Object.values(e.val()):[]).map(i=>i.toUpperCase()),a=Zg.filter(i=>!n.includes(i.toUpperCase()));for(const i of a){const o=ht(t);await _t(o,i)}console.info(`Initialized ${a.length} standard measures`)}catch(t){console.error("Error initializing measures:",t)}}const tp=["orders","products","providers","measures","monthlyFixedCosts"];async function rp(t){try{if(!ge.currentUser)return{name:t,exists:!1};const e=z(W,t),r=await _e(e);return{name:t,exists:r.exists()}}catch(e){return{name:t,exists:!1,error:e instanceof Error?e.message:"Unknown error"}}}async function np(t){if(!ge.currentUser){console.warn(`Skipping collection creation for "${t}" - user not authenticated`);return}const e=z(W,t);await _t(e,{})}async function sp(){try{if(!ge.currentUser){console.info("Skipping collections initialization - user not authenticated");return}console.info("Starting collections initialization...");const e=(await Promise.all(tp.map(r=>rp(r)))).filter(r=>!r.exists).map(async({name:r})=>{try{await np(r),console.info(`Collection "${r}" created successfully`)}catch(n){console.error(`Failed to create collection "${r}":`,n)}});await Promise.all(e),await ep(),console.info("Collections initialization completed")}catch(t){console.error("Failed to initialize collections:",t)}}ge.onAuthStateChanged(t=>{t&&sp().catch(e=>{console.error("Critical error during collections initialization:",e)})});const dr="orders";async function ap(t){if(!ge.currentUser)return console.warn("User not authenticated, returning empty orders"),[];try{return(await Jg(dr,"providerId",t)).sort((r,n)=>new Date(n.date).getTime()-new Date(r.date).getTime())}catch(e){return console.error("Error fetching provider orders:",e),E.error("Error al cargar las órdenes"),[]}}const Ar={subscribeToProviderOrders(t,e){if(!ge.currentUser)return console.warn("User not authenticated, skipping subscription"),e([]),()=>{};const r=z(W,dr),n=Gt(r,Yt("providerId"),Kt(t));return Ye(n,i=>{if(!i.exists()){e([]);return}const c=Object.entries(i.val()).map(([l,d])=>({id:l,...d})).sort((l,d)=>new Date(d.date).getTime()-new Date(l.date).getTime());e(c)},i=>{console.error("Error fetching provider orders:",i),E.error("Error al cargar las órdenes"),e([])})},async getByProvider(t){return ap(t)},async create(t){if(!ge.currentUser)throw new Error("User not authenticated");try{return await Kg(dr,t)}catch(e){throw console.error("Error creating order:",e),E.error("Error al crear la orden"),e}},async update(t,e){if(!ge.currentUser)throw new Error("User not authenticated");try{const r=z(W,`${dr}/${t}`),n=await _e(r);if(!n.exists())throw new Error("Order not found");const i={...n.val(),...e};await Qg(dr,t,i)}catch(r){throw console.error("Error updating order:",r),E.error("Error al actualizar la orden"),r}},async delete(t){if(!ge.currentUser)throw new Error("User not authenticated");try{await Xg(dr,t)}catch(e){throw console.error("Error deleting order:",e),E.error("Error al eliminar la orden"),e}}};function zn(t){const[e,r]=y.useState([]),[n,a]=y.useState(!0);return y.useEffect(()=>{let l;return(async()=>{if(!t){r([]),a(!1);return}try{const u=await Ar.getByProvider(t);u&&r(u),l=Ar.subscribeToProviderOrders(t,h=>{r(h)})}catch(u){console.error("Error setting up orders subscription:",u),E.error("Error al cargar las órdenes")}finally{a(!1)}})(),()=>{l&&l()}},[t]),{orders:e,loading:n,addOrder:async l=>{try{const d=await Ar.create(l);if(!d)throw new Error("Failed to create order");return d}catch(d){throw console.error("Error creating order:",d),new Error("Error al crear la orden")}},updateOrder:async(l,d)=>{try{await Ar.update(l,d)}catch(u){throw console.error("Error updating order:",u),new Error("Error al actualizar la orden")}},deleteOrder:async l=>{try{await Ar.delete(l)}catch(d){throw console.error("Error deleting order:",d),new Error("Error al eliminar la orden")}}}}function gc(){const[t,e]=y.useState([]),[r,n]=y.useState(!0);return y.useEffect(()=>{const a=z(W,"orders"),i=Ye(a,o=>{if(!o.exists()){e([]),n(!1);return}const l=Object.entries(o.val()).map(([d,u])=>({id:d,...u})).sort((d,u)=>new Date(u.date).getTime()-new Date(d.date).getTime());e(l),n(!1)});return()=>i()},[]),{orders:t,loading:r}}function Wn(t){return new Date(t)}function ip(){return Date.now()}function op(t){const e=ve(Wn(t),"dd/MM/yyyy HH:mm",{locale:ye});return[Ft.name,Ft.owner,`Pedido Fecha: ${e}`,""]}function cp(t,e,r){return`${`${t} ${e}`.padEnd(15)}${r}`}function lp(t,e){return e.sort((r,n)=>{const a=t.find(o=>o.id===r.productId),i=t.find(o=>o.id===n.productId);return!a||!i?0:a.order-i.order}).map(r=>{const n=t.find(a=>a.id===r.productId);return n?cp(r.quantity,n.purchasePackaging,n.name):null}).filter(r=>r!==null)}function dp(t){const e=t.length,r=t.reduce((n,a)=>n+a.quantity,0);return["","--------------------------------",`Total Items: ${e}`,`Total Unidades: ${r}`,""]}function pc(t,e,r=!1){if(r){const o=[`Pedido Fecha: ${ve(Wn(t.date),"dd/MM/yyyy HH:mm",{locale:ye})}`,Ft.name,Ft.owner,""],c=t.items.sort((h,f)=>{const p=e.find(b=>b.id===h.productId),g=e.find(b=>b.id===f.productId);return!p||!g?0:p.order-g.order}).map(h=>{const f=e.find(p=>p.id===h.productId);return f?`• *${h.quantity} ${f.purchasePackaging}* - ${f.name}`:null}).filter(Boolean),l=t.items.length,d=t.items.reduce((h,f)=>h+f.quantity,0),u=["","--------------------------------",`Total Items: ${l}`,`Total Unidades: ${d}`];return[...o,...c,...u].join(`
`)}const n=op(t.date),a=lp(e,t.items),i=dp(t.items);return[...n,...a,...i].join(`
`)}function up(t,e,r){return pc(t,e,!0)}function hp(t,e){const r=ve(Wn(t.date),"dd/MM/yyyy HH:mm",{locale:ye}),n=t.items.sort((c,l)=>{const d=e.find(h=>h.id===c.productId),u=e.find(h=>h.id===l.productId);return!d||!u?0:d.order-u.order}),a=n.length,i=n.reduce((c,l)=>c+l.quantity,0),o=n.map(c=>{const l=e.find(d=>d.id===c.productId);return l?`
        <tr>
          <td class="quantity">${c.quantity} ${l.purchasePackaging}</td>
          <td class="name">${l.name}</td>
        </tr>
      `:""}).join("");return`
    <!DOCTYPE html>
    <html>
      <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Orden de Compra</title>
        <style>${dc}</style>
      </head>
      <body>
        <div class="content">
          <div class="header">
            <div>${Ft.name}</div>
            <div>${Ft.owner}</div>
            <div>Pedido Fecha: ${r}</div>
          </div>

          <table>
            <tbody>
              ${o}
            </tbody>
          </table>

          <div class="summary">
            <div class="summary-row">
              <span class="summary-label">Total Items:</span>
              <span class="summary-value">${a}</span>
            </div>
            <div class="summary-row">
              <span class="summary-label">Total Unidades:</span>
              <span class="summary-value">${i}</span>
            </div>
          </div>
        </div>

        <div class="controls">
          <button id="print-button" class="print-button">
            Imprimir
          </button>
        </div>

        <script>${uc}<\/script>
      </body>
    </html>
  `}function vc({order:t,products:e,provider:r,onReopen:n}){const{updateOrder:a,deleteOrder:i}=zn(r.id),[o,c]=y.useState(!1),[l,d]=y.useState(!1),u=async()=>{if(!r.phone){E.error("Este proveedor no tiene número de teléfono registrado");return}d(!0);try{t.status==="pending"&&await a(t.id,{...t,status:"completed"});const p=up(t,e,r),g=Ii(r.phone,p);window.open(g,"_blank"),t.status==="pending"&&E.success("Orden completada y enviada por WhatsApp")}catch(p){console.error("Error sending WhatsApp:",p),E.error("Error al enviar por WhatsApp")}finally{d(!1)}},h=async()=>{d(!0);try{t.status==="pending"&&await a(t.id,{...t,status:"completed"});const p=hp(t,e),g=window.open("","_blank");if(!g)throw new Error("No se pudo crear la pestaña de impresión");g.document.write(p),g.document.close(),t.status==="pending"&&E.success("Orden completada e impresa")}catch(p){console.error("Error printing order:",p),E.error("Error al imprimir la orden")}finally{d(!1)}},f=async()=>{d(!0);try{await i(t.id),E.success("Orden eliminada exitosamente"),c(!1)}catch(p){console.error("Error deleting order:",p),E.error("Error al eliminar la orden")}finally{d(!1)}};return s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex items-center justify-end gap-2",children:[r.phone&&s.jsx(I,{type:"button",variant:"ghost",size:"sm",onClick:u,disabled:l,className:"text-green-600 hover:text-green-700 hover:bg-green-50 w-11 h-11 p-0",title:"Enviar por WhatsApp",children:s.jsx(Yc,{className:"w-5 h-5"})}),s.jsx(I,{type:"button",variant:"ghost",size:"sm",onClick:h,disabled:l,className:"text-gray-600 hover:text-gray-700 hover:bg-gray-50 w-11 h-11 p-0",title:"Imprimir",children:s.jsx(Ts,{className:"w-5 h-5"})}),t.status==="completed"&&n&&s.jsx(I,{type:"button",variant:"ghost",size:"sm",onClick:n,disabled:l,className:"text-blue-600 hover:text-blue-700 hover:bg-blue-50 w-11 h-11 p-0",title:"Reabrir orden",children:s.jsx(Kc,{className:"w-5 h-5"})}),s.jsx(I,{type:"button",variant:"ghost",size:"sm",onClick:()=>c(!0),disabled:l,className:"text-red-600 hover:text-red-700 hover:bg-red-50 w-11 h-11 p-0",title:"Eliminar orden",children:s.jsx(Kr,{className:"w-5 h-5"})})]}),s.jsx(ze,{isOpen:o,onClose:()=>c(!1),title:"Eliminar orden",children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-amber-600",children:"¿Está seguro que desea eliminar esta orden?"}),s.jsxs("div",{className:"flex justify-end space-x-2",children:[s.jsx(I,{variant:"outline",onClick:()=>c(!1),disabled:l,children:"Cancelar"}),s.jsx(I,{onClick:f,isLoading:l,children:"Eliminar"})]})]})})]})}function ci({orders:t,products:e,provider:r,onSelect:n}){const{providers:a}=ar(),i=[...t].sort((o,c)=>new Date(c.date).getTime()-new Date(o.date).getTime());return s.jsxs("div",{className:"space-y-4",children:[i.map((o,c)=>{const l=new Set(o.items.map(f=>f.productId)).size,d=o.items.reduce((f,p)=>f+p.quantity,0),u=i.length-c,h=r||a.find(f=>f.id===o.providerId);return h?s.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-sm hover:shadow-md transition-shadow",children:[s.jsxs("div",{className:"cursor-pointer",onClick:()=>n(o,u),children:[s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[o.status==="completed"?s.jsx(vi,{className:"w-5 h-5 text-green-500"}):s.jsx(Qc,{className:"w-5 h-5 text-yellow-500"}),s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-semibold",children:["Orden #",u," - ",ve(new Date(o.date),"d 'de' MMMM, yyyy",{locale:ye})]}),s.jsxs("p",{className:"text-sm text-gray-600",children:[h.commercialName,h.legalName&&h.legalName!==h.commercialName&&s.jsxs("span",{className:"text-gray-400",children:[" • ",h.legalName]})]})]})]})}),s.jsxs("div",{className:"flex items-center justify-between text-gray-600 mt-2",children:[s.jsxs("div",{className:"space-x-2",children:[s.jsxs("span",{children:[l," ",l===1?"producto":"productos"]}),s.jsx("span",{className:"text-gray-400",children:"•"}),s.jsxs("span",{children:[d," ",d===1?"unidad":"unidades"]})]}),s.jsx("span",{className:"font-medium text-blue-600",children:ne(o.total)})]})]}),s.jsx("div",{className:"mt-4 pt-4 border-t",children:s.jsx(vc,{order:o,products:e,provider:h})})]},o.id):null}),t.length===0&&s.jsx("div",{className:"text-center py-8 text-gray-500",children:"No hay órdenes para mostrar"})]})}function fp({order:t,products:e,provider:r,preview:n=!0}){[...t.items].sort((i,o)=>{const c=e.find(d=>d.id===i.productId),l=e.find(d=>d.id===o.productId);return!c||!l?0:c.order-l.order});const a=pc(t,e,n);return s.jsx("div",{className:"font-mono text-sm bg-gray-50 p-4 rounded-lg overflow-x-auto whitespace-pre-wrap",children:a})}function mp({order:t,orderNumber:e,products:r,provider:n,onClose:a,onEdit:i}){const[o,c]=y.useState(!1),{updateOrder:l}=zn(n.id),[d,u]=y.useState(!1),h=ve(Wn(t.date),"d 'de' MMMM, yyyy HH:mm",{locale:ye}),f=t.items.length,p=t.items.reduce((b,m)=>b+m.quantity,0),g=async()=>{u(!0);try{await l(t.id,{...t,status:"pending"}),E.success("Orden reabierta exitosamente"),i==null||i()}catch(b){console.error("Error reopening order:",b),E.error("Error al reabrir la orden")}finally{u(!1),c(!1)}};return s.jsxs("div",{className:"fixed inset-0 bg-gray-50 z-50 flex flex-col",children:[s.jsx("div",{className:"bg-white border-b print:hidden sticky top-0 z-10",children:s.jsxs("div",{className:"flex items-center justify-between px-3 h-14",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(I,{variant:"ghost",size:"sm",onClick:a,className:"md:hidden",children:s.jsx(Xc,{className:"w-5 h-5"})}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("h2",{className:"text-lg font-semibold",children:["Orden #",e]}),s.jsx("span",{className:`
                  px-2 py-0.5 text-xs font-medium rounded-full
                  ${t.status==="completed"?"bg-green-100 text-green-700":"bg-amber-100 text-amber-700"}
                `,children:t.status==="completed"?"Completada":"Pendiente"})]}),s.jsx("p",{className:"text-sm text-gray-500",children:h})]})]}),s.jsx("button",{onClick:a,className:"hidden md:flex p-2 hover:bg-gray-100 rounded-full transition-colors",children:s.jsx($t,{className:"w-5 h-5"})})]})}),s.jsx("div",{className:"flex-1 overflow-y-auto",children:s.jsxs("div",{className:"container mx-auto max-w-4xl px-3 py-4",children:[s.jsxs("div",{className:"hidden print:block mb-8",children:[s.jsx("h1",{className:"text-2xl font-bold text-center mb-2",children:"Orden de Compra"}),s.jsxs("div",{className:"text-center text-gray-600 mb-4",children:["#",e]})]}),s.jsxs("div",{className:"grid gap-4",children:[s.jsxs("div",{className:"grid gap-4 sm:grid-cols-3 print:grid-cols-3",children:[s.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm print:border-gray-300",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:s.jsx(Yr,{className:"w-5 h-5 text-blue-600"})}),s.jsx("h3",{className:"font-medium",children:"Fecha"})]}),s.jsx("p",{className:"text-gray-600",children:h})]}),s.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm print:border-gray-300",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:"p-2 bg-purple-50 rounded-lg",children:s.jsx(bi,{className:"w-5 h-5 text-purple-600"})}),s.jsx("h3",{className:"font-medium",children:"Proveedor"})]}),s.jsx("p",{className:"font-medium",children:n.commercialName}),n.legalName&&n.legalName!==n.commercialName&&s.jsx("p",{className:"text-sm text-gray-500",children:n.legalName})]}),s.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm print:border-gray-300",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.jsx("div",{className:"p-2 bg-green-50 rounded-lg",children:s.jsx(ot,{className:"w-5 h-5 text-green-600"})}),s.jsx("h3",{className:"font-medium",children:"Resumen"})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("p",{className:"text-gray-600",children:[f," ",f===1?"item":"items"]}),s.jsxs("p",{className:"text-gray-600",children:[p," ",p===1?"unidad":"unidades"]}),s.jsx("p",{className:"font-medium text-lg text-blue-600",children:ne(t.total)})]})]})]}),s.jsxs("div",{className:"bg-white p-4 rounded-lg border shadow-sm print:border-gray-300",children:[s.jsxs("div",{className:"flex items-center gap-3 mb-4 print:mb-2",children:[s.jsx("div",{className:"p-2 bg-amber-50 rounded-lg",children:s.jsx(Es,{className:"w-5 h-5 text-amber-600"})}),s.jsx("h3",{className:"font-medium",children:"Detalles del Pedido"})]}),s.jsx(fp,{order:t,products:r,provider:n,preview:!1})]}),t.status==="completed"?s.jsx("div",{className:"print:hidden",children:s.jsx("div",{className:"bg-white p-4 rounded-lg border shadow-sm",children:s.jsx(vc,{order:t,products:r,provider:n,onReopen:()=>c(!0)})})}):s.jsx("div",{className:"print:hidden bg-amber-50 border border-amber-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-center gap-3 text-amber-700",children:[s.jsx(Jc,{className:"w-5 h-5 flex-shrink-0"}),s.jsx("p",{children:"Esta orden está pendiente de completar"})]})})]})]})}),s.jsx(ze,{isOpen:o,onClose:()=>c(!1),title:"Reabrir orden",children:s.jsxs("div",{className:"space-y-4",children:[s.jsx("p",{className:"text-amber-600",children:"¿Está seguro que desea reabrir esta orden para edición?"}),s.jsxs("div",{className:"flex justify-end space-x-2",children:[s.jsx(I,{variant:"outline",onClick:()=>c(!1),disabled:d,children:"Cancelar"}),s.jsx(I,{onClick:g,isLoading:d,children:"Reabrir"})]})]})})]})}function gp({orders:t,products:e,onOrderSelect:r}){const[n,a]=y.useState(""),[i,o]=y.useState([]);return y.useEffect(()=>{if(!n.trim()){o([]);return}const c=n.toLowerCase(),l=[...t].sort((u,h)=>new Date(h.date).getTime()-new Date(u.date).getTime()),d=l.map((u,h)=>{const f=u.items.map(p=>{var m;const g=e.find(w=>w.id===p.productId);return g&&(g.name.toLowerCase().includes(c)||g.sku.toLowerCase().includes(c)||((m=g.tags)==null?void 0:m.some(w=>w.toLowerCase().includes(c))))?{product:g,quantity:p.quantity}:null}).filter(p=>p!==null);return f.length===0?null:{...u,orderNumber:l.length-h,matchingProducts:f}}).filter(u=>u!==null).slice(0,5);o(d)},[n,t,e]),s.jsxs("div",{className:"relative mb-6",children:[s.jsxs("div",{className:"relative",children:[s.jsx(te,{placeholder:"Buscar productos en órdenes...",value:n,onChange:c=>a(c.target.value),className:"pl-10 bg-amber-50 border-amber-200 focus:border-amber-400 focus:ring-amber-400 placeholder-amber-400"}),s.jsx(kt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-amber-400"})]}),i.length>0&&s.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-amber-200 rounded-lg shadow-lg max-h-[400px] overflow-auto",children:i.map(c=>s.jsx("button",{onClick:()=>r(c,c.orderNumber),className:"w-full px-4 py-3 text-left hover:bg-amber-50 border-b border-amber-100 last:border-b-0",children:s.jsxs("div",{className:"flex items-start justify-between gap-4",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[s.jsxs("span",{className:"font-medium text-amber-700",children:["Orden #",c.orderNumber]}),s.jsx("span",{className:"text-gray-400",children:"•"}),s.jsx("span",{className:"text-sm text-gray-600",children:ve(new Date(c.date),"d 'de' MMMM, yyyy",{locale:ye})})]}),s.jsx("div",{className:"space-y-1",children:c.matchingProducts.map(({product:l,quantity:d})=>s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{className:"text-gray-900",children:l.name}),s.jsxs("span",{className:"text-gray-600 whitespace-nowrap ml-2",children:[d," ",l.purchasePackaging]})]},l.id))})]}),s.jsx("div",{className:"text-amber-600 font-medium whitespace-nowrap",children:ne(c.total)})]})},c.id))}),n&&i.length===0&&s.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-amber-200 rounded-lg shadow-lg p-4 text-center text-gray-500",children:"No se encontraron productos en las órdenes"})]})}function ls(t){return new Intl.NumberFormat("es-UY",{style:"decimal",minimumFractionDigits:2,maximumFractionDigits:2}).format(t)}function pp({providerId:t,product:e,onSubmit:r,onCancel:n,isSubmitting:a}){const[i,o]=y.useState(!1),c=()=>{i?confirm("¿Está seguro que desea descartar los cambios?")&&n():n()},l=async d=>{await r(e,d)};return s.jsxs("div",{className:"fixed inset-0 bg-white z-50 flex flex-col",children:[s.jsx("div",{className:"border-b bg-white",children:s.jsxs("div",{className:"flex items-center justify-between px-4 h-14",children:[s.jsx("h2",{className:"text-lg font-semibold",children:"Editar Producto"}),s.jsx(I,{variant:"ghost",size:"sm",onClick:c,className:"p-2 hover:bg-gray-100 rounded-full",children:s.jsx($t,{className:"w-5 h-5"})})]})}),s.jsx("div",{className:"flex-1 overflow-hidden",children:s.jsx("div",{className:"h-full overflow-y-auto px-4 py-6",children:s.jsx("div",{className:"max-w-3xl mx-auto",children:s.jsx(cc,{providerId:t,initialData:e,onSubmit:l,onCancel:n,isLoading:a,onDirtyChange:o})})})})]})}function vp({product:t,quantity:e,onQuantityChange:r,onReview:n,isReviewed:a,allowEdit:i=!0}){const[o,c]=y.useState(!1),[l,d]=y.useState(!1),[u,h]=y.useState(!1),[f,p]=y.useState(e.toString()),g=y.useRef(null),b=y.useRef(null),m=y.useRef(),{products:w,updateProduct:v}=Vt(),j=w.find(O=>O.id===t.id)||t;y.useEffect(()=>{p(e.toString())},[e]),y.useEffect(()=>{const O=U=>{g.current&&!g.current.contains(U.target)&&h(!1)};return document.addEventListener("mousedown",O),()=>document.removeEventListener("mousedown",O)},[]),y.useEffect(()=>{u&&b.current&&(b.current.focus(),b.current.select())},[u]);const N=async O=>{d(!0);try{await v(j.id,O),c(!1)}catch(U){console.error("Error updating product:",U)}finally{d(!1)}},C=O=>{O.target instanceof HTMLButtonElement||O.target instanceof HTMLInputElement||O.target.closest("button")||O.target.closest("input")||O.target.closest(".quantity-controls")||(m.current?(clearTimeout(m.current),m.current=void 0,r(e>0?0:j.desiredStock)):m.current=setTimeout(()=>{m.current=void 0,a||n()},250))},$=O=>{O.stopPropagation(),h(!0)},J=O=>{O>=0&&(r(O),a||n())},oe=O=>{O.stopPropagation(),e>0&&J(e-1)},K=O=>{O.stopPropagation(),J(e+1)},V=O=>{const U=O.target.value;p(U);const Q=parseInt(U);!isNaN(Q)&&Q>=0&&J(Q)};return s.jsxs(s.Fragment,{children:[s.jsx(A,{isSelected:e>0,children:s.jsx(A.Header,{className:"!p-3",children:s.jsxs("div",{className:"relative",onClick:C,children:[a&&s.jsx("div",{className:"absolute -top-2 -right-2 bg-green-500 text-white rounded-full p-1",children:s.jsx(us,{className:"w-4 h-4"})}),s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("div",{className:`
                  flex-shrink-0 w-5 h-5 rounded border cursor-pointer transition-colors mt-1
                  ${e>0?"bg-blue-500 border-blue-500":"border-gray-300 hover:border-blue-500"}
                `,onClick:O=>{O.stopPropagation(),J(e>0?0:j.desiredStock)},children:e>0&&s.jsx(us,{className:"w-full h-full text-white p-0.5"})}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"flex items-center gap-2 mb-2",children:s.jsx("h3",{className:"font-semibold text-gray-900",children:j.name})}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm text-gray-600 mb-3",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(Ms,{className:"w-4 h-4 mr-1.5 flex-shrink-0"}),s.jsxs("span",{children:["Orden: ",Ig(j.order)]})]}),s.jsxs("div",{className:"flex items-center",children:[s.jsx(ks,{className:"w-4 h-4 mr-1.5 flex-shrink-0"}),s.jsxs("span",{children:["Stock: ",j.minPackageStock," - ",j.desiredStock]})]})]}),e>0&&s.jsxs("div",{className:"flex items-end justify-between gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsx("div",{ref:g,className:"quantity-controls",children:u?s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(I,{type:"button",variant:"outline",size:"sm",onClick:oe,disabled:e<=0,className:"w-12 h-12 rounded-full",children:s.jsx(Zc,{className:"w-5 h-5"})}),s.jsx(te,{ref:b,type:"number",min:"0",value:f,onChange:V,onClick:O=>O.stopPropagation(),placeholder:j.desiredStock.toString(),className:"text-center text-lg h-12"}),s.jsx(I,{type:"button",variant:"outline",size:"sm",onClick:K,className:"w-12 h-12 rounded-full",children:s.jsx(wr,{className:"w-5 h-5"})})]}):s.jsx("button",{onClick:$,className:"w-full h-12 px-4 text-left bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors",children:s.jsxs("span",{className:"text-lg font-medium",children:[e," ",j.purchasePackaging]})})})}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-lg font-bold text-blue-600",children:ls(j.price)}),s.jsxs("div",{className:"text-sm text-gray-500",children:["Total: ",ls(j.price*e)]})]})]}),!e&&s.jsx("div",{className:"text-lg font-bold text-blue-600",children:ls(j.price)})]})]})]})})}),i&&o&&s.jsx(pp,{providerId:j.providerId,product:j,onSubmit:N,onCancel:()=>c(!1),isSubmitting:l})]})}function bp({value:t,onChange:e}){return s.jsxs("div",{className:"relative mb-6",children:[s.jsx(te,{placeholder:"Filtrar",value:t,onChange:r=>e(r.target.value),className:"pl-10"}),s.jsx(kt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"})]})}function xp({products:t,selectedProducts:e,onProductSelect:r,allowEdit:n=!0}){const[a,i]=y.useState(new Set),[o,c]=y.useState(""),[l,d]=y.useState(!1),h=[...t].sort((g,b)=>g.order-b.order).filter(g=>{var b,m;if(l&&!e.has(g.id))return!1;if(o.trim()){const w=o.toLowerCase();return g.name.toLowerCase().includes(w)||g.sku.toLowerCase().includes(w)||((b=g.supplierCode)==null?void 0:b.toLowerCase().includes(w))||((m=g.tags)==null?void 0:m.some(v=>v.toLowerCase().includes(w)))}return!0}),f=(g,b)=>{b>=0&&(r(g,b),p(g))},p=g=>{i(b=>new Set(b).add(g))};return s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsx("div",{className:"flex-1",children:s.jsx(bp,{value:o,onChange:c,placeholder:"Filtrar"})}),s.jsx(I,{variant:l?"primary":"outline",onClick:()=>d(!l),className:"w-10 h-10 p-0 flex items-center justify-center",title:l?"Mostrar todos":"Solo seleccionados",children:s.jsx(xi,{className:"w-4 h-4"})})]}),h.map(g=>s.jsx(vp,{product:g,products:t,isSelected:e.has(g.id),quantity:e.get(g.id)||0,onQuantityChange:b=>f(g.id,b),onReview:()=>p(g.id),isReviewed:a.has(g.id),allowEdit:n},g.id)),h.length===0&&s.jsx("div",{className:"text-center py-8 text-gray-500",children:l?"No hay productos seleccionados":"No se encontraron productos que coincidan con la búsqueda"})]})}function yp(t){return Number(t.reduce((e,r)=>e+Number((r.price*r.quantity).toFixed(2)),0).toFixed(2))}function wp(t,e){const r=Number(Number(t.price).toFixed(2)),n=Number((r*e).toFixed(2));return{productId:t.id,quantity:Number(e),price:r,subtotal:n}}function bc(t,e,r){if(!t||!r||r.length===0)throw new Error("Invalid order data");const n=Array.from(e.entries()).map(([i,o])=>{const c=r.find(l=>l.id===i);if(!c)throw new Error(`Product ${i} not found`);return wp(c,o)}).sort((i,o)=>{const c=r.find(d=>d.id===i.productId),l=r.find(d=>d.id===o.productId);return!c||!l?0:c.order-l.order}),a=yp(n);return{providerId:t,date:ip(),status:"pending",items:n,total:a}}function xc(t,e){try{if(!t.providerId)return"El proveedor es requerido";if(!t.items||t.items.length===0)return"Debe agregar al menos un producto";const r=new Set;for(const a of t.items){if(!a.productId)return"Producto inválido";if(r.has(a.productId))return"No puede haber productos duplicados";if(r.add(a.productId),a.quantity<=0)return"La cantidad debe ser mayor a 0";const i=e.find(c=>c.id===a.productId);if(!i)return"Producto no encontrado";if(Math.abs(a.price-i.price)>.01)return`El precio del producto ${i.name} no coincide`;const o=Number((a.price*a.quantity).toFixed(2));if(Math.abs(a.subtotal-o)>.01)return`El subtotal del producto ${i.name} no coincide`}const n=Number(t.items.reduce((a,i)=>a+Number((i.price*i.quantity).toFixed(2)),0).toFixed(2));return Math.abs(t.total-n)>.01?"El total no coincide":null}catch(r){return console.error("Error validating order:",r),"Error al validar la orden"}}const ds=6e4,jp=2e3;function _p({providerId:t,selectedProducts:e,products:r,onSave:n,enabled:a=!0}){const i=y.useRef(Date.now()),o=y.useRef(),c=y.useRef(),l=y.useRef(!1),d=y.useRef(!0),u=y.useRef(""),h=()=>{const p=Array.from(e.entries()).sort(([g],[b])=>g.localeCompare(b)).map(([g,b])=>`${g}:${b}`).join(",");return`${t}-${p}`},f=()=>{o.current&&(clearTimeout(o.current),o.current=void 0),c.current&&(clearTimeout(c.current),c.current=void 0),d.current=!1};return y.useEffect(()=>{if(d.current=!0,!a||!t||e.size===0){f();return}const p=async()=>{if(!(!d.current||l.current))try{const g=h();if(g===u.current)return;l.current=!0;const b=bc(t,e,r),m=xc(b,r);if(m){console.warn("Autosave skipped due to validation error:",m);return}Date.now()-i.current>=ds&&(await n(b),d.current&&(i.current=Date.now(),u.current=g,E.success("Orden guardada automáticamente",{duration:2e3,position:"bottom-right"})))}catch(g){console.error("Error in autosave:",g),d.current&&E.error("Error al guardar automáticamente",{duration:2e3,position:"bottom-right"})}finally{l.current=!1,d.current&&a&&(o.current=setTimeout(p,ds))}};return c.current&&clearTimeout(c.current),c.current=setTimeout(()=>{o.current&&clearTimeout(o.current),o.current=setTimeout(p,ds)},jp),f},[a,t,e,r,n]),{lastSaveTime:i.current}}function Np({products:t,selectedProducts:e,onProductSelect:r,onConfirm:n,onCancel:a,isSubmitting:i,provider:o}){const[c,l]=y.useState(t),{orders:d,addOrder:u,updateOrder:h}=zn(o.id),[f,p]=y.useState(!1);y.useEffect(()=>{l(b=>{const m=new Set(t.map(v=>v.id)),w=b.filter(v=>!m.has(v.id));return[...t,...w]})},[t]),_p({providerId:o.id,selectedProducts:e,products:c,onSave:async b=>{if(!f){p(!0);try{const m=new Date,w=new Date(m.setHours(0,0,0,0)),v=new Date(m.setHours(23,59,59,999)),j=d.find(N=>{const C=new Date(N.date);return C>=w&&C<=v});j?await h(j.id,b):await u(b)}catch(m){throw console.error("Error saving order:",m),m}finally{p(!1)}}}});const g=Array.from(e.entries()).reduce((b,[m,w])=>{const v=c.find(j=>j.id===m);return b+((v==null?void 0:v.price)||0)*w},0);return s.jsxs("div",{className:"fixed inset-0 bg-white z-50 flex flex-col",children:[s.jsx("div",{className:"border-b bg-white",children:s.jsxs("div",{className:"flex items-center justify-between px-2 h-14",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("h2",{className:"text-lg font-semibold truncate",children:[o.legalName&&o.legalName!==o.commercialName?s.jsxs("span",{className:"text-gray-500",children:[o.legalName," ",s.jsx("span",{className:"mx-1",children:"•"})]}):null,s.jsx("span",{children:o.commercialName})]}),e.size>0&&s.jsxs("div",{className:"text-sm text-gray-600",children:["Importe Total: ",s.jsx("span",{className:"font-medium text-blue-600",children:ne(g)})]})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(I,{variant:"outline",onClick:a,disabled:i||f,size:"sm",children:"Cancelar"}),s.jsx(I,{onClick:n,isLoading:i||f,size:"sm",children:"Guardar"})]})]})}),s.jsx("div",{className:"flex-1 overflow-hidden",children:s.jsx("div",{className:"h-full overflow-y-auto",children:s.jsx("div",{className:"container mx-auto max-w-3xl px-2 py-4",children:s.jsx(xp,{products:c,selectedProducts:e,onProductSelect:r,allowEdit:!1})})})})]})}function Sp(){const t=sl(),[e,r]=al(),{providers:n}=ar(),[a,i]=y.useState(""),{orders:o,loading:c,addOrder:l,updateOrder:d}=zn(a),{products:u,updateProduct:h}=oc(a),{orders:f,loading:p}=gc(),{products:g,loading:b}=Vt(),[m,w]=y.useState(!1),[v,j]=y.useState(null),[N,C]=y.useState(null),[$,J]=y.useState(!1),[oe,K]=y.useState(new Map),[V,O]=y.useState(!1),U=n.find(L=>L.id===a),Q=f.sort((L,q)=>new Date(q.date).getTime()-new Date(L.date).getTime()).slice(0,5);y.useEffect(()=>{const L=e.get("provider"),q=e.get("new")==="true";if(L){if(i(L),q)w(!0),O(!0);else{const D=new Date,ke=new Date(D.setHours(0,0,0,0)),ir=new Date(D.setHours(23,59,59,999)),he=o.find(or=>{const zt=new Date(or.date);return zt>=ke&&zt<=ir});if(he){const or=new Map;he.items.forEach(zt=>{or.set(zt.productId,zt.quantity)}),K(or),j(he),w(!0),O(!0)}}r({})}},[e,r,o]);const ce=(L,q)=>{const D=new Map(oe);q>0?D.set(L,q):D.delete(L),K(D)},Te=async()=>{if(!a||!u||!U){E.error("Seleccione un proveedor");return}if(oe.size===0){E.error("Debe agregar al menos un producto");return}J(!0);try{const L=bc(a,oe,u),q=xc(L,u);if(q){E.error(q);return}v?(await d(v.id,L),E.success("Orden actualizada exitosamente")):(await l(L),E.success("Orden creada exitosamente")),Re()}catch(L){console.error("Error saving order:",L),E.error("Error al guardar la orden")}finally{J(!1)}},Re=()=>{w(!1),j(null),K(new Map),V&&t("/")},we=(L,q)=>{if(a||i(L.providerId),L.status==="completed")C({order:L,orderNumber:q});else{const D=new Map;L.items.forEach(ke=>{D.set(ke.productId,ke.quantity)}),K(D),j(L),w(!0)}},Je=()=>{if(!N)return;const L=new Map;N.order.items.forEach(q=>{L.set(q.productId,q.quantity)}),K(L),j(N.order),C(null),w(!0)},$e=c||p||b;return s.jsxs("div",{className:"space-y-4",children:[s.jsx(gp,{orders:f,products:g,onOrderSelect:we}),s.jsx("div",{className:"space-y-4 md:space-y-0",children:s.jsxs("div",{className:"flex flex-col md:flex-row md:items-end gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsx(ic,{providers:n,selectedProviderId:a,onChange:i})}),a&&s.jsx("div",{className:"flex-shrink-0 w-full md:w-auto",children:s.jsxs(I,{onClick:()=>w(!0),className:"w-full md:w-auto bg-blue-500 hover:bg-blue-600 text-white h-[48px] px-6 rounded-lg shadow-sm hover:shadow transition-all",children:[s.jsx(wr,{className:"w-5 h-5 mr-2"}),s.jsx("span",{className:"whitespace-nowrap",children:"Nueva Orden"})]})})]})}),$e?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):s.jsxs(s.Fragment,{children:[!a&&Q.length>0&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Últimas Órdenes"}),s.jsx(ci,{orders:Q,products:g,onSelect:we})]}),m&&U&&s.jsx(Np,{products:u,selectedProducts:oe,onProductSelect:ce,onProductUpdate:h,onConfirm:Te,onCancel:Re,isSubmitting:$,provider:U}),N&&U&&s.jsx(mp,{order:N.order,orderNumber:N.orderNumber,products:g,provider:U,onClose:()=>C(null),onEdit:Je}),!m&&!N&&a&&s.jsx(ci,{orders:o,products:u,provider:U,onSelect:we})]})]})}function Cp({isOpen:t,onClose:e,date:r,events:n}){return s.jsx(ze,{isOpen:t,onClose:e,title:ve(r,"EEEE d 'de' MMMM, yyyy",{locale:ye}),children:s.jsxs("div",{className:"space-y-6",children:[n.billing.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-medium text-amber-900 mb-3",children:"Facturas"}),s.jsx("div",{className:"space-y-2",children:n.billing.map(a=>s.jsxs("div",{className:"bg-amber-50 p-3 rounded-lg",children:[s.jsx("div",{className:"font-medium text-amber-900",children:a.commercialName}),a.legalName&&a.legalName!==a.commercialName&&s.jsx("div",{className:"text-sm text-amber-700",children:a.legalName})]},a.id))})]}),n.orders.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-medium text-blue-900 mb-3",children:"Pedidos"}),s.jsx("div",{className:"space-y-2",children:n.orders.map(a=>s.jsxs("div",{className:"bg-blue-50 p-3 rounded-lg",children:[s.jsx("div",{className:"font-medium text-blue-900",children:a.commercialName}),a.legalName&&a.legalName!==a.commercialName&&s.jsx("div",{className:"text-sm text-blue-700",children:a.legalName})]},a.id))})]}),n.deliveries.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"text-lg font-medium text-green-900 mb-3",children:"Entregas"}),s.jsx("div",{className:"space-y-2",children:n.deliveries.map(a=>s.jsxs("div",{className:"bg-green-50 p-3 rounded-lg",children:[s.jsx("div",{className:"font-medium text-green-900",children:a.commercialName}),a.legalName&&a.legalName!==a.commercialName&&s.jsx("div",{className:"text-sm text-green-700",children:a.legalName})]},a.id))})]}),n.billing.length===0&&n.orders.length===0&&n.deliveries.length===0&&s.jsx("div",{className:"text-center py-8 text-gray-500",children:"No hay eventos programados para este día"})]})})}const li=[{day:"monday",label:"Lunes"},{day:"tuesday",label:"Martes"},{day:"wednesday",label:"Miércoles"},{day:"thursday",label:"Jueves"},{day:"friday",label:"Viernes"},{day:"saturday",label:"Sábado"},{day:"sunday",label:"Domingo"}],Op={sunday:0,monday:1,tuesday:2,wednesday:3,thursday:4,friday:5,saturday:6},Pp={0:"sunday",1:"monday",2:"tuesday",3:"wednesday",4:"thursday",5:"friday",6:"saturday"};function kp(){const{providers:t}=ar(),{orders:e}=gc(),[r,n]=y.useState(!1),[a,i]=y.useState(null),[o,c]=y.useState(null),l=ve(new Date,"EEEE",{locale:ye}).toLowerCase(),d=new Date,u=d.getDate(),h=d.getDay(),p=e.filter(N=>{const C=new Date(N.date),$=new Date;return C.getFullYear()===$.getFullYear()&&C.getMonth()===$.getMonth()&&C.getDate()===$.getDate()}).reduce((N,C)=>(N[C.providerId]||(N[C.providerId]=[]),N[C.providerId].push(C),N),{}),g=t.filter(N=>{var C;return N.billingType==="monthly"&&((C=N.billingDays)==null?void 0:C.includes(u))}),b=Ai(d),m=ki(d),w=Dl({start:b,end:m},{weekStartsOn:1}),v=N=>{const C=N.getDate(),$=Pp[N.getDay()],J=t.filter(V=>{var O;return V.billingType==="monthly"&&((O=V.billingDays)==null?void 0:O.includes(C))}),oe=t.filter(V=>{var O;return(O=V.orderDays)==null?void 0:O.includes($)}),K=t.filter(V=>{var O;return(O=V.deliveryDays)==null?void 0:O.includes($)});return{billing:J,orders:oe,deliveries:K}},j=N=>{const C=v(N);i(N),c(C)};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Cronograma de Proveedores"}),s.jsx(I,{variant:"outline",onClick:()=>n(!r),className:"gap-2",children:r?s.jsxs(s.Fragment,{children:[s.jsx(el,{className:"w-4 h-4"}),"Vista Semanal"]}):s.jsxs(s.Fragment,{children:[s.jsx(Yr,{className:"w-4 h-4"}),"Vista Mensual"]})})]}),r?s.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[s.jsx("div",{className:"p-4 border-b",children:s.jsx("h2",{className:"text-lg font-semibold",children:ve(d,"MMMM yyyy",{locale:ye})})}),s.jsx("div",{className:"grid grid-cols-7 border-b",children:li.map(({label:N})=>s.jsx("div",{className:"p-2 text-center font-medium text-sm border-r last:border-r-0",children:N},N))}),s.jsx("div",{className:"divide-y",children:w.map((N,C)=>{const $=Il({start:N,end:new Date(N.getTime()+5184e5)});return s.jsx("div",{className:"grid grid-cols-7 min-h-[120px]",children:$.map((J,oe)=>{const K=v(J),V=Dd(J,d),O=Fd(J),U=K.billing.length>0||K.orders.length>0||K.deliveries.length>0;return s.jsxs("div",{onClick:()=>j(J),className:`p-2 border-r last:border-r-0 ${V?"bg-white":"bg-gray-50"} ${O?"bg-blue-50":""} ${U?"cursor-pointer hover:bg-gray-50":""}`,children:[s.jsx("div",{className:`text-sm font-medium mb-1 ${V?"text-gray-900":"text-gray-400"} ${O?"text-blue-600":""}`,children:ve(J,"d")}),s.jsxs("div",{className:"space-y-1 text-xs",children:[K.billing.length>0&&s.jsxs("div",{className:"text-amber-600 font-medium truncate",children:[K.billing.length," ",K.billing.length===1?"factura":"facturas"]}),K.orders.length>0&&s.jsxs("div",{className:"text-blue-600 font-medium truncate",children:[K.orders.length," ",K.orders.length===1?"pedido":"pedidos"]}),K.deliveries.length>0&&s.jsxs("div",{className:"text-green-600 font-medium truncate",children:[K.deliveries.length," ",K.deliveries.length===1?"entrega":"entregas"]})]})]},oe)})},C)})})]}):s.jsxs(s.Fragment,{children:[s.jsxs(A,{children:[s.jsx(A.Header,{children:s.jsxs(A.Title,{children:["Hoy - ",ve(new Date,"EEEE d 'de' MMMM",{locale:ye})]})}),s.jsx(A.Content,{children:s.jsxs("div",{className:"space-y-6",children:[g.length>0&&s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Facturas:"}),s.jsx("ul",{className:"space-y-2",children:g.map(N=>s.jsx("li",{className:"bg-amber-50 p-3 rounded-lg",children:s.jsx("div",{className:"flex items-center justify-between",children:s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-amber-900",children:N.commercialName}),N.legalName&&N.legalName!==N.commercialName&&s.jsx("span",{className:"text-sm text-amber-700 block",children:N.legalName})]})})},N.id))})]}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Pedidos:"}),Object.keys(p).length>0?s.jsx("ul",{className:"space-y-2",children:Object.entries(p).map(([N,C])=>{var V;const $=t.find(O=>O.id===N);if(!$)return null;const J=C.reduce((O,U)=>O+U.total,0),oe=C.reduce((O,U)=>O+U.items.length,0),K=C.reduce((O,U)=>O+U.items.reduce((Q,ce)=>Q+ce.quantity,0),0);return s.jsxs("li",{className:"bg-blue-50 p-3 rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-blue-900",children:$.commercialName}),$.legalName&&$.legalName!==$.commercialName&&s.jsx("span",{className:"text-sm text-blue-700 block",children:$.legalName}),s.jsxs("div",{className:"text-sm text-blue-600",children:[s.jsxs("span",{children:[C.length," ",C.length===1?"pedido":"pedidos"]}),s.jsx("span",{className:"mx-1",children:"•"}),s.jsxs("span",{children:[oe," ",oe===1?"producto":"productos"]}),s.jsx("span",{className:"mx-1",children:"•"}),s.jsxs("span",{children:[K," ",K===1?"unidad":"unidades"]})]})]}),s.jsx("div",{className:"text-right",children:s.jsx("span",{className:"font-medium text-blue-900",children:ne(J)})})]}),((V=$.deliveryDays)==null?void 0:V.includes(l))&&s.jsx("div",{className:"mt-2 pt-2 border-t border-blue-200",children:s.jsx("div",{className:"text-sm text-blue-700",children:s.jsx("span",{className:"font-medium",children:"Entrega programada para hoy"})})})]},N)})}):s.jsx("p",{className:"text-gray-500",children:"No hay pedidos realizados hoy"})]})]})})]}),s.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4",children:li.map(({day:N,label:C})=>{const $=Op[N],J=t.filter(V=>{var O;return V.billingType==="monthly"&&((O=V.billingDays)==null?void 0:O.includes(u))&&$===h}),oe=t.filter(V=>{var O;return(O=V.orderDays)==null?void 0:O.includes(N)}),K=t.filter(V=>{var O;return(O=V.deliveryDays)==null?void 0:O.includes(N)});return s.jsxs(A,{children:[s.jsx(A.Header,{children:s.jsx(A.Title,{className:N===l?"text-blue-600":"",children:C})}),s.jsx(A.Content,{children:s.jsxs("div",{className:"space-y-4",children:[J.length>0&&s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx("div",{className:"p-1.5 bg-amber-100 rounded-md",children:s.jsx(Es,{className:"w-4 h-4 text-amber-600"})}),s.jsx("h4",{className:"text-sm font-medium text-amber-900",children:"Facturas"})]}),s.jsx("ul",{className:"space-y-2",children:J.map(V=>s.jsxs("li",{className:"bg-amber-50 px-3 py-2 rounded-md border border-amber-100 hover:bg-amber-100 transition-colors",children:[s.jsx("div",{className:"font-medium text-amber-900",children:V.commercialName}),V.legalName&&V.legalName!==V.commercialName&&s.jsx("div",{className:"text-sm text-amber-700 mt-0.5",children:V.legalName})]},V.id))})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx("div",{className:"p-1.5 bg-blue-100 rounded-md",children:s.jsx(Gr,{className:"w-4 h-4 text-blue-600"})}),s.jsx("h4",{className:"text-sm font-medium text-blue-900",children:"Pedidos"})]}),oe.length>0?s.jsx("ul",{className:"space-y-2",children:oe.map(V=>s.jsxs("li",{className:"bg-blue-50 px-3 py-2 rounded-md border border-blue-100 hover:bg-blue-100 transition-colors",children:[s.jsx("div",{className:"font-medium text-blue-900",children:V.commercialName}),V.legalName&&V.legalName!==V.commercialName&&s.jsx("div",{className:"text-sm text-blue-700 mt-0.5",children:V.legalName})]},V.id))}):s.jsx("p",{className:"text-sm text-gray-500 bg-gray-50 px-3 py-2 rounded-md border border-gray-100",children:"No hay pedidos programados"})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[s.jsx("div",{className:"p-1.5 bg-green-100 rounded-md",children:s.jsx(tl,{className:"w-4 h-4 text-green-600"})}),s.jsx("h4",{className:"text-sm font-medium text-green-900",children:"Entregas"})]}),K.length>0?s.jsx("ul",{className:"space-y-2",children:K.map(V=>s.jsxs("li",{className:"bg-green-50 px-3 py-2 rounded-md border border-green-100 hover:bg-green-100 transition-colors",children:[s.jsx("div",{className:"font-medium text-green-900",children:V.commercialName}),V.legalName&&V.legalName!==V.commercialName&&s.jsx("div",{className:"text-sm text-green-700 mt-0.5",children:V.legalName})]},V.id))}):s.jsx("p",{className:"text-sm text-gray-500 bg-gray-50 px-3 py-2 rounded-md border border-gray-100",children:"No hay entregas programadas"})]})]})})]},N)})})]}),a&&o&&s.jsx(Cp,{isOpen:!0,onClose:()=>{i(null),c(null)},date:a,events:o})]})}async function Ap(){try{if(!(await fetch("https://scraper-production-9c05.up.railway.app/auth")).ok)throw new Error("Error de autenticación");return!0}catch(t){return console.error("Authentication error:",t),!1}}async function Ep(t){try{if(!(t!=null&&t.trim()))throw new Error("Código de artículo inválido");const e=await fetch(`https://scraper-production-9c05.up.railway.app/stock/${t}`,{headers:{Accept:"application/json"}});if(!e.ok){let a="Error desconocido";try{const i=e.headers.get("content-type");i!=null&&i.includes("application/json")?a=(await e.json()).error||"Error desconocido":a=await e.text()||e.statusText||"Error desconocido"}catch(i){console.error("Error parsing error response:",i),a=e.statusText||"Error de comunicación con el servidor"}switch(e.status){case 404:throw new Error(`No se encontró el artículo ${t}`);case 500:throw new Error("El servidor no está disponible en este momento. Por favor, intente más tarde");case 502:case 503:case 504:throw new Error("Servicio temporalmente no disponible. Por favor, intente más tarde");case 401:case 403:throw new Error("Sesión expirada. Por favor, autentíquese nuevamente");default:throw new Error(`Error al consultar el stock: ${a}`)}}let r;try{r=await e.json()}catch(a){throw console.error("Error parsing success response:",a),new Error("Error al procesar la respuesta del servidor")}if(!r||typeof r!="object")throw new Error("Respuesta inválida del servidor");if(!("stock"in r))throw new Error("La respuesta no contiene información de stock");const n=Number(r.stock);if(isNaN(n))throw new Error("El valor de stock no es un número válido");return n}catch(e){const r={articleCode:t,error:e instanceof Error?e.message:"Error desconocido",timestamp:new Date().toISOString(),type:e instanceof Error?e.name:"UnknownError",details:e||"No additional error details available",stack:e instanceof Error?e.stack:void 0};throw console.error("Error checking stock:",r),e instanceof Error?e:new Error("Error inesperado al consultar el stock")}}function Mp({productId:t,sku:e,currentStock:r,onStockUpdate:n,isEnabled:a}){const[i,o]=y.useState(!1),[c,l]=y.useState(null),[d,u]=y.useState(""),[h,f]=y.useState(!1),p=async()=>{if(!e){E.error("Este producto no tiene SKU definido");return}if(!a){E.error("Debe autenticarse primero");return}o(!0);const m=E.loading("Consultando stock en Zureo...");try{const w=await Ep(e);if(E.dismiss(m),w===null){E.error("No se pudo obtener el stock del artículo");return}l(w),u(w.toString()),f(!0),E.success(`Stock consultado: ${w}`)}catch(w){E.dismiss(m);let v="Error al consultar stock en Zureo";w instanceof Error&&(w.message.includes("Sesión expirada")?v="Sesión expirada. Por favor, autentíquese nuevamente":w.message.includes("servidor no está disponible")||w.message.includes("temporalmente no disponible")?v="El servicio no está disponible. Por favor, intente más tarde":w.message.includes("No se encontró")?v=`No se encontró el artículo ${e}`:w.message.includes("Error al procesar")?v="Error de comunicación con el servidor":v=w.message),E.error(v),console.error("Error checking stock:",{sku:e,error:w instanceof Error?w.message:"Unknown error",timestamp:new Date().toISOString()})}finally{o(!1)}},g=async()=>{try{const m=parseInt(d);if(isNaN(m)||m<0){E.error("Ingrese un valor válido");return}await n(m),E.success("Stock actualizado exitosamente"),l(null),u(""),f(!1)}catch(m){E.error("Error al actualizar el stock"),console.error("Error updating stock:",m)}},b=()=>{l(null),u(""),f(!1)};return s.jsxs("div",{className:"space-y-3",children:[h&&s.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2",children:[s.jsx(te,{type:"number",min:"0",value:d,onChange:m=>u(m.target.value),placeholder:"Ingrese cantidad",className:"text-center flex-1"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(I,{variant:"ghost",size:"sm",onClick:g,className:"flex-1 sm:flex-none text-green-600 hover:text-green-700 hover:bg-green-50",title:"Confirmar",children:[s.jsx(us,{className:"w-5 h-5"}),s.jsx("span",{className:"sm:hidden ml-2",children:"Confirmar"})]}),s.jsxs(I,{variant:"ghost",size:"sm",onClick:b,className:"flex-1 sm:flex-none text-red-600 hover:text-red-700 hover:bg-red-50",title:"Cancelar",children:[s.jsx($t,{className:"w-5 h-5"}),s.jsx("span",{className:"sm:hidden ml-2",children:"Cancelar"})]})]})]}),s.jsxs(I,{variant:"outline",onClick:p,disabled:i||!e||!a,className:"w-full",title:a?"":"Debe autenticarse primero",children:[s.jsx(Ps,{className:`w-4 h-4 mr-2 ${i?"animate-spin":""}`}),"Controlar Stock"]})]})}function Tp({data:t,maxDate:e,onClose:r}){const n=()=>{window.print()},i=[...e?t.filter(o=>o.lastStockCheck&&new Date(o.lastStockCheck)>=e):t].sort((o,c)=>o.lastStockCheck?c.lastStockCheck?c.lastStockCheck-o.lastStockCheck:-1:1);return s.jsxs("div",{className:"bg-white rounded-lg border shadow-lg",children:[s.jsxs("div",{className:"sticky top-0 bg-white border-b p-4 flex items-center justify-between print:hidden",children:[s.jsx("h2",{className:"text-xl font-semibold",children:"Reporte de Control de Stock"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs(I,{onClick:n,className:"gap-2",children:[s.jsx(Ts,{className:"w-4 h-4"}),"Imprimir"]}),s.jsx(I,{variant:"outline",onClick:r,children:"Cerrar"})]})]}),s.jsxs("div",{className:"hidden print:block text-center mb-6 p-4",children:[s.jsx("h1",{className:"text-2xl font-bold mb-2",children:"Reporte de Control de Stock"}),s.jsx("p",{className:"text-gray-600",children:ve(new Date,"d 'de' MMMM, yyyy",{locale:ye})}),e&&s.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Controles desde: ",ve(e,"d 'de' MMMM, yyyy",{locale:ye})]})]}),s.jsxs("div",{className:"p-4",children:[i.length>0?s.jsxs("table",{className:"w-full border-collapse",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b-2 border-gray-200",children:[s.jsx("th",{className:"py-2 px-4 text-left",children:"SKU"}),s.jsx("th",{className:"py-2 px-4 text-left",children:"Producto"}),s.jsx("th",{className:"py-2 px-4 text-right",children:"Stock Actual"}),s.jsx("th",{className:"py-2 px-4 text-right",children:"Última Actualización"})]})}),s.jsx("tbody",{children:i.map(o=>s.jsxs("tr",{className:"border-b border-gray-100",children:[s.jsx("td",{className:"py-2 px-4",children:o.sku}),s.jsx("td",{className:"py-2 px-4",children:o.names.map((c,l)=>s.jsx("div",{className:o.names.length>1?"text-sm text-gray-600":"",children:c},l))}),s.jsxs("td",{className:"py-2 px-4 text-right whitespace-nowrap",children:[o.currentStock," ",o.packaging]}),s.jsx("td",{className:"py-2 px-4 text-right whitespace-nowrap",children:o.lastStockCheck?ve(new Date(o.lastStockCheck),"d/MM/yyyy HH:mm",{locale:ye}):s.jsx("span",{className:"text-amber-600",children:"Sin control"})})]},o.sku))})]}):s.jsx("div",{className:"text-center py-8 text-gray-500",children:"No hay productos con controles de stock en el período seleccionado"}),s.jsx("div",{className:"hidden print:block mt-8 pt-4 border-t",children:s.jsxs("p",{className:"text-sm text-gray-600",children:["Total productos: ",i.length]})})]})]})}function Rp(){const{products:t,loading:e,updateProduct:r}=Vt(),[n,a]=y.useState(""),[i,o]=y.useState(!1),[c,l]=y.useState(!1),[d,u]=y.useState(!1),[h,f]=y.useState(new Date),p=async()=>{l(!0);try{const v=await Ap();o(v),v?E.success("Autenticación exitosa"):E.error("Error de autenticación")}catch(v){console.error("Authentication error:",v),E.error("Error de autenticación"),o(!1)}finally{l(!1)}},g=y.useMemo(()=>{const j=t.filter(N=>{var C;return(C=N.sku)==null?void 0:C.trim()}).reduce((N,C)=>{const $=C.sku.trim().toUpperCase();return N[$]||(N[$]={sku:$,products:[],currentStock:C.currentStock||0,lastStockCheck:C.lastStockCheck||null}),N[$].products.push(C),C.lastStockCheck&&(!N[$].lastStockCheck||C.lastStockCheck>N[$].lastStockCheck)&&(N[$].currentStock=C.currentStock||0,N[$].lastStockCheck=C.lastStockCheck),N},{});return Object.values(j).filter(N=>!n||N.sku.toLowerCase().includes(n.toLowerCase())||N.products.some(C=>{var $;return C.name.toLowerCase().includes(n.toLowerCase())||(($=C.tags)==null?void 0:$.some(J=>J.toLowerCase().includes(n.toLowerCase())))})).sort((N,C)=>!N.lastStockCheck&&!C.lastStockCheck?0:N.lastStockCheck?C.lastStockCheck?N.lastStockCheck-C.lastStockCheck:1:-1)},[t,n]),b=async(v,j)=>{var N;try{const C=((N=g.find($=>$.sku===v))==null?void 0:N.products.map($=>r($.id,{currentStock:j,lastStockCheck:Date.now()})))||[];await Promise.all(C)}catch(C){throw console.error("Error updating stock:",C),C}},m=()=>{u(!0)},w=g.map(v=>({sku:v.sku,names:v.products.map(j=>j.name),currentStock:v.currentStock,lastStockCheck:v.lastStockCheck,packaging:v.products[0].salePackaging||v.products[0].purchasePackaging}));return s.jsxs("div",{className:"space-y-6",children:[s.jsx("div",{className:"flex flex-col gap-4",children:s.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[s.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Control de Inventario"}),s.jsxs("div",{className:"grid grid-cols-2 sm:flex gap-2 w-full sm:w-auto",children:[s.jsxs(I,{onClick:m,variant:"outline",className:"w-full sm:w-auto gap-2",children:[s.jsx(Yr,{className:"w-4 h-4"}),s.jsx("span",{className:"whitespace-nowrap",children:"Ver Reporte"})]}),s.jsxs(I,{onClick:p,isLoading:c,variant:i?"outline":"default",className:"w-full sm:w-auto gap-2",children:[s.jsx(rl,{className:"w-4 h-4"}),s.jsx("span",{className:"whitespace-nowrap",children:i?"Autenticado":"Autenticar"})]})]})]})}),!d&&s.jsxs("div",{className:"relative",children:[s.jsx(te,{placeholder:"Buscar productos...",value:n,onChange:v=>a(v.target.value),className:"pl-10"}),s.jsx(kt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"})]}),d?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"bg-blue-50 p-4 rounded-lg",children:s.jsxs("div",{className:"w-full sm:max-w-xs",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mostrar controles desde:"}),s.jsx("input",{type:"date",value:h?h.toISOString().split("T")[0]:"",onChange:v=>f(v.target.value?new Date(v.target.value):null),className:"w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500"})]})}),s.jsx(Tp,{data:w,maxDate:h,onClose:()=>u(!1)})]}):e?s.jsx("div",{className:"flex items-center justify-center h-64",children:s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):s.jsx("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:g.map(v=>{var N;const j=v.lastStockCheck?Math.floor((Date.now()-v.lastStockCheck)/864e5):null;return s.jsxs("div",{className:`bg-white p-4 rounded-lg border shadow-sm space-y-4 ${v.lastStockCheck?j&&j>30?"border-yellow-200 bg-yellow-50":"":"border-amber-300 bg-amber-50"}`,children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("h3",{className:"font-medium text-gray-900",children:["SKU: ",v.sku]}),s.jsxs("span",{className:"text-sm text-gray-500",children:[v.products.length," ",v.products.length===1?"producto":"productos"]})]}),s.jsx("div",{className:"space-y-1 mb-2",children:v.products.map(C=>s.jsx("p",{className:`text-sm ${v.products.length>1?"text-xs leading-tight":"text-base"} text-gray-600`,children:C.name},C.id))}),((N=v.products[0].tags)==null?void 0:N.length)>0&&s.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:v.products[0].tags.map(C=>s.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-gray-100 text-gray-800",children:C},C))})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Stock Actual:"}),s.jsxs("p",{className:"font-medium text-gray-900",children:[v.currentStock," ",v.products[0].salePackaging||v.products[0].purchasePackaging]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-500",children:"Último Control:"}),s.jsx("p",{className:`font-medium ${v.lastStockCheck?j&&j>30?"text-yellow-700":"text-gray-900":"text-amber-700"}`,children:v.lastStockCheck?s.jsxs(s.Fragment,{children:[new Date(v.lastStockCheck).toLocaleDateString(),s.jsxs("span",{className:"block text-xs text-gray-500",children:["Hace ",j," días"]})]}):"Nunca"})]})]}),s.jsx("div",{className:"pt-2 border-t",children:s.jsx(Mp,{productId:v.products[0].id,sku:v.sku,currentStock:v.currentStock,onStockUpdate:C=>b(v.sku,C),isEnabled:i})})]},v.sku)})})]})}function Ip(){return s.jsx(il,{children:s.jsxs(jl,{children:[s.jsx(nl,{position:"top-right"}),s.jsxs(ol,{children:[s.jsx(tt,{path:"/login",element:s.jsx(Qu,{})}),s.jsx(tt,{element:s.jsx(_l,{}),children:s.jsxs(tt,{element:s.jsx(Ku,{}),children:[s.jsx(tt,{path:"/",element:s.jsx(xg,{})}),s.jsx(tt,{path:"/providers",element:s.jsx(jg,{})}),s.jsx(tt,{path:"/products",element:s.jsx(Dg,{})}),s.jsx(tt,{path:"/recipes",element:s.jsx(Yg,{})}),s.jsx(tt,{path:"/orders",element:s.jsx(Sp,{})}),s.jsx(tt,{path:"/schedule",element:s.jsx(kp,{})}),s.jsx(tt,{path:"/inventory",element:s.jsx(Rp,{})})]})})]})]})})}Ni(document.getElementById("root")).render(s.jsx(y.StrictMode,{children:s.jsx(Ip,{})}));
//# sourceMappingURL=index-C5JAlN8c.js.map
